var Uw=Object.defineProperty;var Lg=r=>{throw TypeError(r)};var Hw=(r,e,t)=>e in r?Uw(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var vt=(r,e,t)=>Hw(r,typeof e!="symbol"?e+"":e,t),Gc=(r,e,t)=>e.has(r)||Lg("Cannot "+t);var vr=(r,e,t)=>(Gc(r,e,"read from private field"),t?t.call(r):e.get(r)),Yc=(r,e,t)=>e.has(r)?Lg("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Bo=(r,e,t,n)=>(Gc(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Vc=(r,e,t)=>(Gc(r,e,"access private method"),t);import{z as Ga,ac as Dg,C as ps,A as Mi,B as Yl,d as Mu,D as bm,E as wm,c1 as Xw,aC as xm,J as qw,dl as Zw,dm as Kw,bD as Qw,H as Em,a as pa,aL as Jw,cE as ex,aN as Ig,bx as Ns,b as $r,o as Nn,e as jt,cV as Ri,a5 as Su,dn as Tf,dp as tx,cZ as Tu,P as Mm,bX as nx,dq as rx,dr as Rg,ds as Uc,dt as ix,du as sx,g as vs,aq as Ou,dv as Sm,j as ax,dj as Tm,w as ox,l as $t,k as rn,a2 as Om,F as lx,Z as ux,dw as cx,h as Hc,c as Ya,X as Ra,Y as dx,O as jg,b8 as hx}from"./index-D_-DzWhp.js";import{c as fx,t as gx,d as px}from"./timer-CPe8tIZ0.js";import{_ as Ye,a as ke,b as $,c as Vt,d as ue,e as Xc,f as po}from"./tslib.es6-BHeKr2nR.js";import{d as vx,a as mx}from"./index-CB0NKgKL.js";import{_ as yx}from"./Popover-uiGA841y.js";import{a as bx,_ as wx}from"./Grid-CLqtPmRw.js";import{N as xx}from"./Tag-wiA3KfAO.js";import{g as Ex}from"./get-slot-Bk_rJcZu.js";import{_ as Mx}from"./Divider-B3MX9R6D.js";import"./get-C9XpniJp.js";import"./isSymbol-DUeTwM-o.js";import"./toNumber-u1TW7FQK.js";import"./map-BMPY2oeZ.js";import"./Follower-CPJzzLbY.js";import"./next-frame-once-C5Ksf8W7.js";import"./cssr-BW6v_MNg.js";import"./use-merged-state-DuV1Lu3L.js";import"./use-compitable-Cr7qxnTd.js";const Nt="0!important",km="-1px!important";function Rs(r){return ps(`${r}-type`,[Mi("& +",[Ga("button",{},[ps(`${r}-type`,[Yl("border",{borderLeftWidth:Nt}),Yl("state-border",{left:km})])])])])}function js(r){return ps(`${r}-type`,[Mi("& +",[Ga("button",[ps(`${r}-type`,[Yl("border",{borderTopWidth:Nt}),Yl("state-border",{top:km})])])])])}const Sx=Ga("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[Dg("vertical",{flexDirection:"row"},[Dg("rtl",[Ga("button",[Mi("&:first-child:not(:last-child)",`
 margin-right: ${Nt};
 border-top-right-radius: ${Nt};
 border-bottom-right-radius: ${Nt};
 `),Mi("&:last-child:not(:first-child)",`
 margin-left: ${Nt};
 border-top-left-radius: ${Nt};
 border-bottom-left-radius: ${Nt};
 `),Mi("&:not(:first-child):not(:last-child)",`
 margin-left: ${Nt};
 margin-right: ${Nt};
 border-radius: ${Nt};
 `),Rs("default"),ps("ghost",[Rs("primary"),Rs("info"),Rs("success"),Rs("warning"),Rs("error")])])])]),ps("vertical",{flexDirection:"column"},[Ga("button",[Mi("&:first-child:not(:last-child)",`
 margin-bottom: ${Nt};
 margin-left: ${Nt};
 margin-right: ${Nt};
 border-bottom-left-radius: ${Nt};
 border-bottom-right-radius: ${Nt};
 `),Mi("&:last-child:not(:first-child)",`
 margin-top: ${Nt};
 margin-left: ${Nt};
 margin-right: ${Nt};
 border-top-left-radius: ${Nt};
 border-top-right-radius: ${Nt};
 `),Mi("&:not(:first-child):not(:last-child)",`
 margin: ${Nt};
 border-radius: ${Nt};
 `),js("default"),ps("ghost",[js("primary"),js("info"),js("success"),js("warning"),js("error")])])])]),Tx={size:{type:String,default:void 0},vertical:Boolean},Ox=Mu({name:"ButtonGroup",props:Tx,setup(r){const{mergedClsPrefixRef:e,mergedRtlRef:t}=wm(r);return Xw("-button-group",Sx,e),qw(Zw,r),{rtlEnabled:xm("ButtonGroup",t,e),mergedClsPrefix:e}},render(){const{mergedClsPrefix:r}=this;return bm("div",{class:[`${r}-button-group`,this.rtlEnabled&&`${r}-button-group--rtl`,this.vertical&&`${r}-button-group--vertical`],role:"group"},this.$slots)}});function kx(){return Kw}const Nx={self:kx},Ax=Object.assign(Object.assign({},Em.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),Cx=Mu({name:"Flex",props:Ax,setup(r){const{mergedClsPrefixRef:e,mergedRtlRef:t}=wm(r),n=Em("Flex","-flex",void 0,Nx,r,e);return{rtlEnabled:xm("Flex",t,e),mergedClsPrefix:e,margin:pa(()=>{const{size:s}=r;if(Array.isArray(s))return{horizontal:s[0],vertical:s[1]};if(typeof s=="number")return{horizontal:s,vertical:s};const{self:{[Jw("gap",s)]:a}}=n.value,{row:o,col:l}=ex(a);return{horizontal:Ig(l),vertical:Ig(o)}})}},render(){const{vertical:r,reverse:e,align:t,inline:n,justify:i,margin:s,wrap:a,mergedClsPrefix:o,rtlEnabled:l}=this,u=Qw(Ex(this),!1);return u.length?bm("div",{role:"none",class:[`${o}-flex`,l&&`${o}-flex--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:r&&!e?"column":r&&e?"column-reverse":!r&&e?"row-reverse":"row",justifyContent:i,flexWrap:!a||r?"nowrap":"wrap",alignItems:t,gap:`${s.vertical}px ${s.horizontal}px`}},u):null}}),Px={class:"inline-block",viewBox:"0 0 56 56",width:"1em",height:"1em"};function _x(r,e){return Nn(),$r("svg",Px,e[0]||(e[0]=[jt("path",{fill:"currentColor",d:"M28 51.906c13.055 0 23.906-10.828 23.906-23.906c0-13.055-10.875-23.906-23.93-23.906C14.899 4.094 4.095 14.945 4.095 28c0 13.078 10.828 23.906 23.906 23.906"},null,-1)]))}const Lx=Ns({name:"f7-circle-fill",render:_x}),Dx={class:"inline-block",viewBox:"0 0 56 56",width:"1em",height:"1em"};function Ix(r,e){return Nn(),$r("svg",Dx,e[0]||(e[0]=[jt("path",{fill:"currentColor",d:"M28 51.906c13.055 0 23.906-10.851 23.906-23.906c0-13.078-10.875-23.906-23.93-23.906C14.899 4.094 4.095 14.922 4.095 28c0 13.055 10.828 23.906 23.906 23.906m-9.07-11.11c-.586 0-1.102-.515-1.102-1.077V19.82c0-1.008.492-1.758 1.453-2.18c.844-.374 1.57-.585 3.375-.585c4.242 0 6.89 2.086 10.875 2.086c1.922 0 2.93-.493 3.54-.493c.796 0 1.406.493 1.406 1.172v11.555c0 1.055-.446 1.734-1.454 2.18c-.867.398-1.617.609-3.375.609c-4.078 0-6.68-2.062-10.875-2.062c-1.43 0-2.367.28-2.789.468v7.149c0 .586-.445 1.078-1.054 1.078"},null,-1)]))}const Rx=Ns({name:"f7-flag-circle-fill",render:Ix}),jx={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function Bx(r,e){return Nn(),$r("svg",jx,e[0]||(e[0]=[jt("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m0-2a8 8 0 1 0 0-16a8 8 0 0 0 0 16m-1-4h2v2h-2zm0-1.992s2-.008 2 0C13 13.006 16 12 16 10c0-2.21-1.773-4-3.991-4A4 4 0 0 0 8 10h2c0-1.1.9-2 2-2s2 .9 2 2c0 .9-3 2.367-3 4.008"},null,-1)]))}const zx=Ns({name:"fe-question",render:Bx}),Fx={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function $x(r,e){return Nn(),$r("svg",Fx,e[0]||(e[0]=[jt("g",{fill:"currentColor"},[jt("path",{d:"M4 6v6h2V8h4V6zm16 12h-6v-2h4v-4h2z"}),jt("path",{"fill-rule":"evenodd",d:"M4 2a4 4 0 0 0-4 4v12a4 4 0 0 0 4 4h16a4 4 0 0 0 4-4V6a4 4 0 0 0-4-4zm16 2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2","clip-rule":"evenodd"})],-1)]))}const Wx=Ns({name:"gg-ratio",render:$x}),Gx={class:"inline-block",viewBox:"0 0 48 48",width:"1em",height:"1em"};function Yx(r,e){return Nn(),$r("svg",Gx,e[0]||(e[0]=[jt("g",{fill:"none"},[jt("rect",{width:"36",height:"36",x:"6",y:"6",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"4",rx:"3"}),jt("path",{fill:"currentColor","fill-rule":"evenodd",d:"M24 22.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5m0 8a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5","clip-rule":"evenodd"}),jt("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4",d:"M15.5 17v14m17-14v14"})],-1)]))}const Vx=Ns({name:"icon-park-outline-equal-ratio",render:Yx}),Ux={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function Hx(r,e){return Nn(),$r("svg",Ux,e[0]||(e[0]=[jt("g",{fill:"none"},[jt("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),jt("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 0 1 6.873 13.502l-.197.26l3.652 3.652a1 1 0 0 1-1.32 1.498l-.094-.084l-3.652-3.652A8.5 8.5 0 1 1 10.5 2m0 2a6.5 6.5 0 1 0 0 13a6.5 6.5 0 0 0 0-13m0 2a1 1 0 0 1 .993.883L11.5 7v2.5H14a1 1 0 0 1 .117 1.993L14 11.5h-2.5V14a1 1 0 0 1-1.993.117L9.5 14v-2.5H7a1 1 0 0 1-.117-1.993L7 9.5h2.5V7a1 1 0 0 1 1-1"})],-1)]))}const Xx=Ns({name:"mingcute-zoom-in-line",render:Hx}),qx={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function Zx(r,e){return Nn(),$r("svg",qx,e[0]||(e[0]=[jt("g",{fill:"none"},[jt("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),jt("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 0 1 6.676 13.762l3.652 3.652a1 1 0 0 1-1.414 1.414l-3.652-3.652A8.5 8.5 0 1 1 10.5 2m0 2a6.5 6.5 0 1 0 0 13a6.5 6.5 0 0 0 0-13M14 9.5a1 1 0 1 1 0 2H7a1 1 0 1 1 0-2z"})],-1)]))}const Kx=Ns({name:"mingcute-zoom-out-line",render:Zx}),Nm=tx?window:void 0;function ph(r){var e;const t=Ri(r);return(e=t==null?void 0:t.$el)!=null?e:t}function Qx(...r){const e=[],t=()=>{e.forEach(o=>o()),e.length=0},n=(o,l,u,c)=>(o.addEventListener(l,u,c),()=>o.removeEventListener(l,u,c)),i=pa(()=>{const o=Uc(Ri(r[0])).filter(l=>l!=null);return o.every(l=>typeof l!="string")?o:void 0}),s=ix(()=>{var o,l;return[(l=(o=i.value)==null?void 0:o.map(u=>ph(u)))!=null?l:[Nm].filter(u=>u!=null),Uc(Ri(i.value?r[1]:r[0])),Uc(vs(i.value?r[2]:r[1])),Ri(i.value?r[3]:r[2])]},([o,l,u,c])=>{if(t(),!(o!=null&&o.length)||!(l!=null&&l.length)||!(u!=null&&u.length))return;const d=sx(c)?{...c}:c;e.push(...o.flatMap(h=>l.flatMap(f=>u.map(g=>n(h,f,g,d)))))},{flush:"post"}),a=()=>{s(),t()};return Tf(t),a}function Jx(){const r=Tu(!1),e=nx();return e&&Mm(()=>{r.value=!0},e),r}function eE(r){const e=Jx();return pa(()=>(e.value,!!r()))}function Bg(r,e,t={}){const{window:n=Nm,...i}=t;let s;const a=eE(()=>n&&"ResizeObserver"in n),o=()=>{s&&(s.disconnect(),s=void 0)},l=pa(()=>{const d=Ri(r);return Array.isArray(d)?d.map(h=>ph(h)):[ph(d)]}),u=Su(l,d=>{if(o(),a.value&&n){s=new ResizeObserver(e);for(const h of d)h&&s.observe(h,i)}},{immediate:!0,flush:"post"}),c=()=>{o(),u()};return Tf(c),{isSupported:a,stop:c}}function qc(r){return typeof Window<"u"&&r instanceof Window?r.document.documentElement:typeof Document<"u"&&r instanceof Document?r.documentElement:r}const tE={mounted(r,e){typeof e.value=="function"?Bg(r,e.value):Bg(r,...e.value)}};function Am(r){const e=window.getComputedStyle(r);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&r.clientWidth<r.scrollWidth||e.overflowY==="auto"&&r.clientHeight<r.scrollHeight)return!0;{const t=r.parentNode;return!t||t.tagName==="BODY"?!1:Am(t)}}function nE(r){const e=r||window.event,t=e.target;return Am(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const Zc=new WeakMap;function rE(r,e=!1){const t=Tu(e);let n=null,i="";Su(rx(r),o=>{const l=qc(Ri(o));if(l){const u=l;if(Zc.get(u)||Zc.set(u,u.style.overflow),u.style.overflow!=="hidden"&&(i=u.style.overflow),u.style.overflow==="hidden")return t.value=!0;if(t.value)return u.style.overflow="hidden"}},{immediate:!0});const s=()=>{const o=qc(Ri(r));!o||t.value||(Rg&&(n=Qx(o,"touchmove",l=>{nE(l)},{passive:!1})),o.style.overflow="hidden",t.value=!0)},a=()=>{const o=qc(Ri(r));!o||!t.value||(Rg&&(n==null||n()),o.style.overflow=i,Zc.delete(o),t.value=!1)};return Tf(a),pa({get(){return t.value},set(o){o?s():a()}})}function iE(){let r=!1;const e=Tu(!1);return(t,n)=>{if(e.value=n.value,r)return;r=!0;const i=rE(t,n.value);Su(e,s=>i.value=s)}}iE();function $i(r){"@babel/helpers - typeof";return $i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(r)}function sE(r,e){if($i(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if($i(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Cm(r){var e=sE(r,"string");return $i(e)=="symbol"?e:e+""}function be(r,e,t){return(e=Cm(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function zg(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function We(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?zg(Object(t),!0).forEach(function(n){be(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):zg(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function oe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Fg(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,Cm(n.key),n)}}function le(r,e,t){return e&&Fg(r.prototype,e),t&&Fg(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function vh(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function aE(r){if(Array.isArray(r))return vh(r)}function oE(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Of(r,e){if(r){if(typeof r=="string")return vh(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?vh(r,e):void 0}}function lE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wt(r){return aE(r)||oE(r)||Of(r)||lE()}function aa(r){return aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aa(r)}function Pm(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pm=function(){return!!r})()}function uE(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function cE(r,e){if(e&&($i(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uE(r)}function Fe(r,e,t){return e=aa(e),cE(r,Pm()?Reflect.construct(e,t||[],aa(r).constructor):e.apply(r,t))}function mh(r,e){return mh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},mh(r,e)}function $e(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&mh(r,e)}function dE(r){if(Array.isArray(r))return r}function hE(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],l=!0,u=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function fE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Be(r,e){return dE(r)||hE(r,e)||Of(r,e)||fE()}var Kc={exports:{}},$g;function gE(){return $g||($g=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,d||l,h),g=t?t+u:u;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,g=new Array(f);h<f;h++)g[h]=d[h].fn;return g},o.prototype.listenerCount=function(u){var c=t?t+u:u,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,c,d,h,f,g){var v=t?t+u:u;if(!this._events[v])return!1;var p=this._events[v],y=arguments.length,b,E;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,d),!0;case 4:return p.fn.call(p.context,c,d,h),!0;case 5:return p.fn.call(p.context,c,d,h,f),!0;case 6:return p.fn.call(p.context,c,d,h,f,g),!0}for(E=1,b=new Array(y-1);E<y;E++)b[E-1]=arguments[E];p.fn.apply(p.context,b)}else{var T=p.length,S;for(E=0;E<T;E++)switch(p[E].once&&this.removeListener(u,p[E].fn,void 0,!0),y){case 1:p[E].fn.call(p[E].context);break;case 2:p[E].fn.call(p[E].context,c);break;case 3:p[E].fn.call(p[E].context,c,d);break;case 4:p[E].fn.call(p[E].context,c,d,h);break;default:if(!b)for(S=1,b=new Array(y-1);S<y;S++)b[S-1]=arguments[S];p[E].fn.apply(p[E].context,b)}}return!0},o.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},o.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},o.prototype.removeListener=function(u,c,d,h){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return a(this,f),this;var g=this._events[f];if(g.fn)g.fn===c&&(!h||g.once)&&(!d||g.context===d)&&a(this,f);else{for(var v=0,p=[],y=g.length;v<y;v++)(g[v].fn!==c||h&&!g[v].once||d&&g[v].context!==d)&&p.push(g[v]);p.length?this._events[f]=p.length===1?p[0]:p:a(this,f)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o}(Kc)),Kc.exports}var pE=gE();const kf=Ou(pE);var bt=1e-6,Ut=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function _m(){var r=new Ut(9);return Ut!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function vE(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function mE(r,e,t,n,i,s,a,o,l){var u=new Ut(9);return u[0]=r,u[1]=e,u[2]=t,u[3]=n,u[4]=i,u[5]=s,u[6]=a,u[7]=o,u[8]=l,u}function ut(){var r=new Ut(16);return Ut!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function Lm(r){var e=new Ut(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function oa(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Dm(r,e,t,n,i,s,a,o,l,u,c,d,h,f,g,v){var p=new Ut(16);return p[0]=r,p[1]=e,p[2]=t,p[3]=n,p[4]=i,p[5]=s,p[6]=a,p[7]=o,p[8]=l,p[9]=u,p[10]=c,p[11]=d,p[12]=h,p[13]=f,p[14]=g,p[15]=v,p}function yh(r,e,t,n,i,s,a,o,l,u,c,d,h,f,g,v,p){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=s,r[5]=a,r[6]=o,r[7]=l,r[8]=u,r[9]=c,r[10]=d,r[11]=h,r[12]=f,r[13]=g,r[14]=v,r[15]=p,r}function Wi(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Im(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],s=e[6],a=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=s,r[11]=e[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function Rr(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15],b=t*o-n*a,E=t*l-i*a,T=t*u-s*a,S=n*l-i*o,k=n*u-s*o,A=i*u-s*l,O=c*v-d*g,C=c*p-h*g,P=c*y-f*g,L=d*p-h*v,R=d*y-f*v,z=h*y-f*p,Y=b*z-E*R+T*L+S*P-k*C+A*O;return Y?(Y=1/Y,r[0]=(o*z-l*R+u*L)*Y,r[1]=(i*R-n*z-s*L)*Y,r[2]=(v*A-p*k+y*S)*Y,r[3]=(h*k-d*A-f*S)*Y,r[4]=(l*P-a*z-u*C)*Y,r[5]=(t*z-i*P+s*C)*Y,r[6]=(p*T-g*A-y*E)*Y,r[7]=(c*A-h*T+f*E)*Y,r[8]=(a*R-o*P+u*O)*Y,r[9]=(n*P-t*R-s*O)*Y,r[10]=(g*k-v*T+y*b)*Y,r[11]=(d*T-c*k-f*b)*Y,r[12]=(o*C-a*L-l*O)*Y,r[13]=(t*L-n*C+i*O)*Y,r[14]=(v*E-g*S-p*b)*Y,r[15]=(c*S-d*E+h*b)*Y,r):null}function yE(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15];return r[0]=o*(h*y-f*p)-d*(l*y-u*p)+v*(l*f-u*h),r[1]=-(n*(h*y-f*p)-d*(i*y-s*p)+v*(i*f-s*h)),r[2]=n*(l*y-u*p)-o*(i*y-s*p)+v*(i*u-s*l),r[3]=-(n*(l*f-u*h)-o*(i*f-s*h)+d*(i*u-s*l)),r[4]=-(a*(h*y-f*p)-c*(l*y-u*p)+g*(l*f-u*h)),r[5]=t*(h*y-f*p)-c*(i*y-s*p)+g*(i*f-s*h),r[6]=-(t*(l*y-u*p)-a*(i*y-s*p)+g*(i*u-s*l)),r[7]=t*(l*f-u*h)-a*(i*f-s*h)+c*(i*u-s*l),r[8]=a*(d*y-f*v)-c*(o*y-u*v)+g*(o*f-u*d),r[9]=-(t*(d*y-f*v)-c*(n*y-s*v)+g*(n*f-s*d)),r[10]=t*(o*y-u*v)-a*(n*y-s*v)+g*(n*u-s*o),r[11]=-(t*(o*f-u*d)-a*(n*f-s*d)+c*(n*u-s*o)),r[12]=-(a*(d*p-h*v)-c*(o*p-l*v)+g*(o*h-l*d)),r[13]=t*(d*p-h*v)-c*(n*p-i*v)+g*(n*h-i*d),r[14]=-(t*(o*p-l*v)-a*(n*p-i*v)+g*(n*l-i*o)),r[15]=t*(o*h-l*d)-a*(n*h-i*d)+c*(n*l-i*o),r}function Rm(r){var e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],l=r[7],u=r[8],c=r[9],d=r[10],h=r[11],f=r[12],g=r[13],v=r[14],p=r[15],y=e*a-t*s,b=e*o-n*s,E=e*l-i*s,T=t*o-n*a,S=t*l-i*a,k=n*l-i*o,A=u*g-c*f,O=u*v-d*f,C=u*p-h*f,P=c*v-d*g,L=c*p-h*g,R=d*p-h*v;return y*R-b*L+E*P+T*C-S*O+k*A}function Mn(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],f=e[10],g=e[11],v=e[12],p=e[13],y=e[14],b=e[15],E=t[0],T=t[1],S=t[2],k=t[3];return r[0]=E*n+T*o+S*d+k*v,r[1]=E*i+T*l+S*h+k*p,r[2]=E*s+T*u+S*f+k*y,r[3]=E*a+T*c+S*g+k*b,E=t[4],T=t[5],S=t[6],k=t[7],r[4]=E*n+T*o+S*d+k*v,r[5]=E*i+T*l+S*h+k*p,r[6]=E*s+T*u+S*f+k*y,r[7]=E*a+T*c+S*g+k*b,E=t[8],T=t[9],S=t[10],k=t[11],r[8]=E*n+T*o+S*d+k*v,r[9]=E*i+T*l+S*h+k*p,r[10]=E*s+T*u+S*f+k*y,r[11]=E*a+T*c+S*g+k*b,E=t[12],T=t[13],S=t[14],k=t[15],r[12]=E*n+T*o+S*d+k*v,r[13]=E*i+T*l+S*h+k*p,r[14]=E*s+T*u+S*f+k*y,r[15]=E*a+T*c+S*g+k*b,r}function ta(r,e,t){var n=t[0],i=t[1],s=t[2],a,o,l,u,c,d,h,f,g,v,p,y;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*s+e[12],r[13]=e[1]*n+e[5]*i+e[9]*s+e[13],r[14]=e[2]*n+e[6]*i+e[10]*s+e[14],r[15]=e[3]*n+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],l=e[2],u=e[3],c=e[4],d=e[5],h=e[6],f=e[7],g=e[8],v=e[9],p=e[10],y=e[11],r[0]=a,r[1]=o,r[2]=l,r[3]=u,r[4]=c,r[5]=d,r[6]=h,r[7]=f,r[8]=g,r[9]=v,r[10]=p,r[11]=y,r[12]=a*n+c*i+g*s+e[12],r[13]=o*n+d*i+v*s+e[13],r[14]=l*n+h*i+p*s+e[14],r[15]=u*n+f*i+y*s+e[15]),r}function jm(r,e,t){var n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function bE(r,e,t,n){var i=n[0],s=n[1],a=n[2],o=Math.hypot(i,s,a),l,u,c,d,h,f,g,v,p,y,b,E,T,S,k,A,O,C,P,L,R,z,Y,U;return o<bt?null:(o=1/o,i*=o,s*=o,a*=o,l=Math.sin(t),u=Math.cos(t),c=1-u,d=e[0],h=e[1],f=e[2],g=e[3],v=e[4],p=e[5],y=e[6],b=e[7],E=e[8],T=e[9],S=e[10],k=e[11],A=i*i*c+u,O=s*i*c+a*l,C=a*i*c-s*l,P=i*s*c-a*l,L=s*s*c+u,R=a*s*c+i*l,z=i*a*c+s*l,Y=s*a*c-i*l,U=a*a*c+u,r[0]=d*A+v*O+E*C,r[1]=h*A+p*O+T*C,r[2]=f*A+y*O+S*C,r[3]=g*A+b*O+k*C,r[4]=d*P+v*L+E*R,r[5]=h*P+p*L+T*R,r[6]=f*P+y*L+S*R,r[7]=g*P+b*L+k*R,r[8]=d*z+v*Y+E*U,r[9]=h*z+p*Y+T*U,r[10]=f*z+y*Y+S*U,r[11]=g*z+b*Y+k*U,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function Bm(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[4],a=e[5],o=e[6],l=e[7],u=e[8],c=e[9],d=e[10],h=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*i+u*n,r[5]=a*i+c*n,r[6]=o*i+d*n,r[7]=l*i+h*n,r[8]=u*i-s*n,r[9]=c*i-a*n,r[10]=d*i-o*n,r[11]=h*i-l*n,r}function zm(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],l=e[3],u=e[8],c=e[9],d=e[10],h=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i-u*n,r[1]=a*i-c*n,r[2]=o*i-d*n,r[3]=l*i-h*n,r[8]=s*n+u*i,r[9]=a*n+c*i,r[10]=o*n+d*i,r[11]=l*n+h*i,r}function wE(r,e,t){var n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],l=e[3],u=e[4],c=e[5],d=e[6],h=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i+u*n,r[1]=a*i+c*n,r[2]=o*i+d*n,r[3]=l*i+h*n,r[4]=u*i-s*n,r[5]=c*i-a*n,r[6]=d*i-o*n,r[7]=h*i-l*n,r}function Oi(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function us(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Fm(r,e,t){var n=t[0],i=t[1],s=t[2],a=Math.hypot(n,i,s),o,l,u;return a<bt?null:(a=1/a,n*=a,i*=a,s*=a,o=Math.sin(e),l=Math.cos(e),u=1-l,r[0]=n*n*u+l,r[1]=i*n*u+s*o,r[2]=s*n*u-i*o,r[3]=0,r[4]=n*i*u-s*o,r[5]=i*i*u+l,r[6]=s*i*u+n*o,r[7]=0,r[8]=n*s*u+i*o,r[9]=i*s*u-n*o,r[10]=s*s*u+l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function $m(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Wm(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function bh(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Gm(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=n+n,l=i+i,u=s+s,c=n*o,d=n*l,h=n*u,f=i*l,g=i*u,v=s*u,p=a*o,y=a*l,b=a*u;return r[0]=1-(f+v),r[1]=d+b,r[2]=h-y,r[3]=0,r[4]=d-b,r[5]=1-(c+v),r[6]=g+p,r[7]=0,r[8]=h+y,r[9]=g-p,r[10]=1-(c+f),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function xE(r,e){var t=new Ut(3),n=-e[0],i=-e[1],s=-e[2],a=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=n*n+i*i+s*s+a*a;return d>0?(t[0]=(o*a+c*n+l*s-u*i)*2/d,t[1]=(l*a+c*i+u*n-o*s)*2/d,t[2]=(u*a+c*s+o*i-l*n)*2/d):(t[0]=(o*a+c*n+l*s-u*i)*2,t[1]=(l*a+c*i+u*n-o*s)*2,t[2]=(u*a+c*s+o*i-l*n)*2),Gm(r,e,t),r}function Vl(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function la(r,e){var t=e[0],n=e[1],i=e[2],s=e[4],a=e[5],o=e[6],l=e[8],u=e[9],c=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(s,a,o),r[2]=Math.hypot(l,u,c),r}function Ul(r,e){var t=new Ut(3);la(t,e);var n=1/t[0],i=1/t[1],s=1/t[2],a=e[0]*n,o=e[1]*i,l=e[2]*s,u=e[4]*n,c=e[5]*i,d=e[6]*s,h=e[8]*n,f=e[9]*i,g=e[10]*s,v=a+c+g,p=0;return v>0?(p=Math.sqrt(v+1)*2,r[3]=.25*p,r[0]=(d-f)/p,r[1]=(h-l)/p,r[2]=(o-u)/p):a>c&&a>g?(p=Math.sqrt(1+a-c-g)*2,r[3]=(d-f)/p,r[0]=.25*p,r[1]=(o+u)/p,r[2]=(h+l)/p):c>g?(p=Math.sqrt(1+c-a-g)*2,r[3]=(h-l)/p,r[0]=(o+u)/p,r[1]=.25*p,r[2]=(d+f)/p):(p=Math.sqrt(1+g-a-c)*2,r[3]=(o-u)/p,r[0]=(h+l)/p,r[1]=(d+f)/p,r[2]=.25*p),r}function EE(r,e,t,n){var i=e[0],s=e[1],a=e[2],o=e[3],l=i+i,u=s+s,c=a+a,d=i*l,h=i*u,f=i*c,g=s*u,v=s*c,p=a*c,y=o*l,b=o*u,E=o*c,T=n[0],S=n[1],k=n[2];return r[0]=(1-(g+p))*T,r[1]=(h+E)*T,r[2]=(f-b)*T,r[3]=0,r[4]=(h-E)*S,r[5]=(1-(d+p))*S,r[6]=(v+y)*S,r[7]=0,r[8]=(f+b)*k,r[9]=(v-y)*k,r[10]=(1-(d+g))*k,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Va(r,e,t,n,i){var s=e[0],a=e[1],o=e[2],l=e[3],u=s+s,c=a+a,d=o+o,h=s*u,f=s*c,g=s*d,v=a*c,p=a*d,y=o*d,b=l*u,E=l*c,T=l*d,S=n[0],k=n[1],A=n[2],O=i[0],C=i[1],P=i[2],L=(1-(v+y))*S,R=(f+T)*S,z=(g-E)*S,Y=(f-T)*k,U=(1-(h+y))*k,V=(p+b)*k,W=(g+E)*A,F=(p-b)*A,K=(1-(h+v))*A;return r[0]=L,r[1]=R,r[2]=z,r[3]=0,r[4]=Y,r[5]=U,r[6]=V,r[7]=0,r[8]=W,r[9]=F,r[10]=K,r[11]=0,r[12]=t[0]+O-(L*O+Y*C+W*P),r[13]=t[1]+C-(R*O+U*C+F*P),r[14]=t[2]+P-(z*O+V*C+K*P),r[15]=1,r}function Nf(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,l=i+i,u=t*a,c=n*a,d=n*o,h=i*a,f=i*o,g=i*l,v=s*a,p=s*o,y=s*l;return r[0]=1-d-g,r[1]=c+y,r[2]=h-p,r[3]=0,r[4]=c-y,r[5]=1-u-g,r[6]=f+v,r[7]=0,r[8]=h+p,r[9]=f-v,r[10]=1-u-d,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ME(r,e,t,n,i,s,a){var o=1/(t-e),l=1/(i-n),u=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*l,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*l,r[10]=(a+s)*u,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*u,r[15]=0,r}function Ym(r,e,t,n,i){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=(i+n)*a,r[14]=2*i*n*a):(r[10]=-1,r[14]=-2*n),r}var SE=Ym;function TE(r,e,t,n,i){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(a=1/(n-i),r[10]=i*a,r[14]=i*n*a):(r[10]=-1,r[14]=-n),r}function OE(r,e,t,n){var i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(a+o),u=2/(i+s);return r[0]=l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=u,r[6]=0,r[7]=0,r[8]=-((a-o)*l*.5),r[9]=(i-s)*u*.5,r[10]=n/(t-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*t/(t-n),r[15]=0,r}function Vm(r,e,t,n,i,s,a){var o=1/(e-t),l=1/(n-i),u=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*u,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*l,r[14]=(a+s)*u,r[15]=1,r}var Um=Vm;function Hm(r,e,t,n,i,s,a){var o=1/(e-t),l=1/(n-i),u=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=u,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*l,r[14]=s*u,r[15]=1,r}function Xm(r,e,t,n){var i,s,a,o,l,u,c,d,h,f,g=e[0],v=e[1],p=e[2],y=n[0],b=n[1],E=n[2],T=t[0],S=t[1],k=t[2];return Math.abs(g-T)<bt&&Math.abs(v-S)<bt&&Math.abs(p-k)<bt?Wi(r):(c=g-T,d=v-S,h=p-k,f=1/Math.hypot(c,d,h),c*=f,d*=f,h*=f,i=b*h-E*d,s=E*c-y*h,a=y*d-b*c,f=Math.hypot(i,s,a),f?(f=1/f,i*=f,s*=f,a*=f):(i=0,s=0,a=0),o=d*a-h*s,l=h*i-c*a,u=c*s-d*i,f=Math.hypot(o,l,u),f?(f=1/f,o*=f,l*=f,u*=f):(o=0,l=0,u=0),r[0]=i,r[1]=o,r[2]=c,r[3]=0,r[4]=s,r[5]=l,r[6]=d,r[7]=0,r[8]=a,r[9]=u,r[10]=h,r[11]=0,r[12]=-(i*g+s*v+a*p),r[13]=-(o*g+l*v+u*p),r[14]=-(c*g+d*v+h*p),r[15]=1,r)}function kE(r,e,t,n){var i=e[0],s=e[1],a=e[2],o=n[0],l=n[1],u=n[2],c=i-t[0],d=s-t[1],h=a-t[2],f=c*c+d*d+h*h;f>0&&(f=1/Math.sqrt(f),c*=f,d*=f,h*=f);var g=l*h-u*d,v=u*c-o*h,p=o*d-l*c;return f=g*g+v*v+p*p,f>0&&(f=1/Math.sqrt(f),g*=f,v*=f,p*=f),r[0]=g,r[1]=v,r[2]=p,r[3]=0,r[4]=d*p-h*v,r[5]=h*g-c*p,r[6]=c*v-d*g,r[7]=0,r[8]=c,r[9]=d,r[10]=h,r[11]=0,r[12]=i,r[13]=s,r[14]=a,r[15]=1,r}function NE(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function AE(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function CE(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function qm(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function PE(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function _E(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r[9]=e[9]+t[9]*n,r[10]=e[10]+t[10]*n,r[11]=e[11]+t[11]*n,r[12]=e[12]+t[12]*n,r[13]=e[13]+t[13]*n,r[14]=e[14]+t[14]*n,r[15]=e[15]+t[15]*n,r}function wh(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function LE(r,e){var t=r[0],n=r[1],i=r[2],s=r[3],a=r[4],o=r[5],l=r[6],u=r[7],c=r[8],d=r[9],h=r[10],f=r[11],g=r[12],v=r[13],p=r[14],y=r[15],b=e[0],E=e[1],T=e[2],S=e[3],k=e[4],A=e[5],O=e[6],C=e[7],P=e[8],L=e[9],R=e[10],z=e[11],Y=e[12],U=e[13],V=e[14],W=e[15];return Math.abs(t-b)<=bt*Math.max(1,Math.abs(t),Math.abs(b))&&Math.abs(n-E)<=bt*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(i-T)<=bt*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(s-S)<=bt*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(a-k)<=bt*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(o-A)<=bt*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(l-O)<=bt*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(u-C)<=bt*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(c-P)<=bt*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(d-L)<=bt*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(h-R)<=bt*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(f-z)<=bt*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(g-Y)<=bt*Math.max(1,Math.abs(g),Math.abs(Y))&&Math.abs(v-U)<=bt*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(p-V)<=bt*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(y-W)<=bt*Math.max(1,Math.abs(y),Math.abs(W))}var Zm=Mn,DE=qm;const IE=Object.freeze(Object.defineProperty({__proto__:null,add:CE,adjoint:yE,clone:Lm,copy:oa,create:ut,determinant:Rm,equals:LE,exactEquals:wh,frob:AE,fromQuat:Nf,fromQuat2:xE,fromRotation:Fm,fromRotationTranslation:Gm,fromRotationTranslationScale:EE,fromRotationTranslationScaleOrigin:Va,fromScaling:us,fromTranslation:Oi,fromValues:Dm,fromXRotation:$m,fromYRotation:Wm,fromZRotation:bh,frustum:ME,getRotation:Ul,getScaling:la,getTranslation:Vl,identity:Wi,invert:Rr,lookAt:Xm,mul:Zm,multiply:Mn,multiplyScalar:PE,multiplyScalarAndAdd:_E,ortho:Um,orthoNO:Vm,orthoZO:Hm,perspective:SE,perspectiveFromFieldOfView:OE,perspectiveNO:Ym,perspectiveZO:TE,rotate:bE,rotateX:Bm,rotateY:zm,rotateZ:wE,scale:jm,set:yh,str:NE,sub:DE,subtract:qm,targetTo:kE,translate:ta,transpose:Im},Symbol.toStringTag,{value:"Module"}));function Xe(){var r=new Ut(3);return Ut!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Jr(r){var e=new Ut(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function ti(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function ht(r,e,t){var n=new Ut(3);return n[0]=r,n[1]=e,n[2]=t,n}function jr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function En(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function ji(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function xh(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function RE(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function jE(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function BE(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function Hl(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function zE(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function ms(r,e){var t=e[0],n=e[1],i=e[2],s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function Br(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Il(r,e,t){var n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],l=t[2];return r[0]=i*l-s*o,r[1]=s*a-n*l,r[2]=n*o-i*a,r}function Eh(r,e,t,n){var i=e[0],s=e[1],a=e[2];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r[2]=a+n*(t[2]-a),r}function Sn(r,e,t){var n=e[0],i=e[1],s=e[2],a=t[3]*n+t[7]*i+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/a,r[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/a,r[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/a,r}function FE(r,e,t){var n=e[0],i=e[1],s=e[2];return r[0]=n*t[0]+i*t[3]+s*t[6],r[1]=n*t[1]+i*t[4]+s*t[7],r[2]=n*t[2]+i*t[5]+s*t[8],r}function $E(r,e,t){var n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],l=e[1],u=e[2],c=i*u-s*l,d=s*o-n*u,h=n*l-i*o,f=i*h-s*d,g=s*c-n*h,v=n*d-i*c,p=a*2;return c*=p,d*=p,h*=p,f*=2,g*=2,v*=2,r[0]=o+c+f,r[1]=l+d+g,r[2]=u+h+v,r}function Ta(r,e){var t=r[0],n=r[1],i=r[2],s=e[0],a=e[1],o=e[2];return Math.abs(t-s)<=bt*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-a)<=bt*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=bt*Math.max(1,Math.abs(i),Math.abs(o))}var WE=xh,Wg=zE,Km=ti;(function(){var r=Xe();return function(e,t,n,i,s,a){var o,l;for(t||(t=3),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();function zr(){var r=new Ut(4);return Ut!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function ja(r,e,t,n){var i=new Ut(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function GE(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function YE(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function VE(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=t*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function ai(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*a,r[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*a,r[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*a,r[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*a,r}(function(){var r=zr();return function(e,t,n,i,s,a){var o,l;for(t||(t=4),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();function qt(){var r=new Ut(4);return Ut!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Ni(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function Bi(r,e,t){var n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],l=t[1],u=t[2],c=t[3];return r[0]=n*c+a*o+i*u-s*l,r[1]=i*c+a*l+s*o-n*u,r[2]=s*c+a*u+n*l-i*o,r[3]=a*c-n*o-i*l-s*u,r}function Qc(r,e,t,n){var i=e[0],s=e[1],a=e[2],o=e[3],l=t[0],u=t[1],c=t[2],d=t[3],h,f,g,v,p;return f=i*l+s*u+a*c+o*d,f<0&&(f=-f,l=-l,u=-u,c=-c,d=-d),1-f>bt?(h=Math.acos(f),g=Math.sin(h),v=Math.sin((1-n)*h)/g,p=Math.sin(n*h)/g):(v=1-n,p=n),r[0]=v*i+p*l,r[1]=v*s+p*u,r[2]=v*a+p*c,r[3]=v*o+p*d,r}function Jc(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function UE(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[s*3+s]-e[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(e[s*3+a]-e[a*3+s])*n,r[s]=(e[s*3+i]+e[i*3+s])*n,r[a]=(e[a*3+i]+e[i*3+a])*n}return r}function zo(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var s=Math.sin(e),a=Math.cos(e),o=Math.sin(t),l=Math.cos(t),u=Math.sin(n),c=Math.cos(n);return r[0]=s*l*c-a*o*u,r[1]=a*o*c+s*l*u,r[2]=a*l*u-s*o*c,r[3]=a*l*c+s*o*u,r}var HE=ja,Fo=GE,Gg=YE,Yg=Bi,Xl=VE;(function(){var r=Xe(),e=ht(1,0,0),t=ht(0,1,0);return function(n,i,s){var a=Br(i,s);return a<-.999999?(Il(r,e,i),Km(r)<1e-6&&Il(r,t,i),ms(r,r),Ni(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Il(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,Xl(n,n))}})();(function(){var r=qt(),e=qt();return function(t,n,i,s,a,o){return Qc(r,n,a,o),Qc(e,i,s,o),Qc(t,r,e,2*o*(1-o)),t}})();(function(){var r=_m();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Xl(e,UE(e,r))}})();function Af(){var r=new Ut(2);return Ut!=Float32Array&&(r[0]=0,r[1]=0),r}function XE(r,e){return r[0]=e[0],r[1]=e[1],r}function qE(r,e,t){return r[0]=e,r[1]=t,r}function ZE(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function KE(r,e){return r[0]*e[0]+r[1]*e[1]}function QE(r,e){return r[0]===e[0]&&r[1]===e[1]}(function(){var r=Af();return function(e,t,n,i,s,a){var o,l;for(t||(t=2),n||(n=0),i?l=Math.min(i*t+n,e.length):l=e.length,o=n;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],s(r,r,a),e[o]=r[0],e[o+1]=r[1];return e}})();var Ja=function(r){return r!==null&&typeof r!="function"&&isFinite(r.length)},JE=function(r,e){return Ja(r)?r.indexOf(e)>-1:!1},e2=function(r,e){if(!Ja(r))return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];e(i,n)&&t.push(i)}return t},t2=function(r,e){return e===void 0&&(e=[]),e2(r,function(t){return!JE(e,t)})};function Ee(r){return typeof r=="function"}function Ae(r){return r==null}function nr(r){return Array.isArray(r)}const Bt=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function Qm(r,e){if(r){var t;if(nr(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(Bt(r)){for(var s in r)if(r.hasOwnProperty(s)&&(t=e(r[s],s),t===!1))break}}}var Mh=function(r){return typeof r=="object"&&r!==null},n2={}.toString,Jm=function(r,e){return n2.call(r)==="[object "+e+"]"},ua=function(r){if(!Mh(r)||!Jm(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e};function ql(r){if(!Array.isArray(r))return-1/0;var e=r.length;if(!e)return-1/0;for(var t=r[0],n=1;n<e;n++)t=Math.max(t,r[n]);return t}const Zl=function(r){if(nr(r))return r.reduce(function(e,t){return Math.min(e,t)},r[0])};var r2=function(r,e,t){if(!nr(r)&&!ua(r))return r;var n=t;return Qm(r,function(i,s){n=e(n,i,s)}),n};function Ke(r){return typeof r=="string"}function i2(r,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(r))for(var n=0,i=r.length;n<i;n++){var s=r[n];e.has(s)||(t.push(s),e.set(s,!0))}return t}var s2=Object.prototype.hasOwnProperty;function ku(r,e){if(!e||!nr(r))return{};for(var t={},n=Ee(e)?e:function(o){return o[e]},i,s=0;s<r.length;s++){var a=r[s];i=n(a),s2.call(t,i)?t[i].push(a):t[i]=[a]}return t}var At=function(r,e,t){return r<e?e:r>t?t:r};function ye(r){return typeof r=="number"}var a2=1e-5;function Ua(r,e,t){return t===void 0&&(t=a2),r===e||Math.abs(r-e)<t}const o2=function(r,e){if(nr(r)){for(var t,n=-1/0,i=0;i<r.length;i++){var s=r[i],a=Ee(e)?e(s):s[e];a>n&&(t=s,n=a)}return t}},l2=function(r,e){if(nr(r)){for(var t,n=1/0,i=0;i<r.length;i++){var s=r[i],a=Ee(e)?e(s):s[e];a<n&&(t=s,n=a)}return t}};var ey=function(r,e){return(r%e+e)%e};const ty=function(r){return Ae(r)?"":r.toString()};var u2=function(r){var e=ty(r);return e.charAt(0).toLowerCase()+e.substring(1)};function c2(r,e){return!r||!e?r:r.replace(/\\?\{([^{}]+)\}/g,function(t,n){return t.charAt(0)==="\\"?t.slice(1):e[n]===void 0?"":e[n]})}var Kl=function(r){var e=ty(r);return e.charAt(0).toUpperCase()+e.substring(1)},d2={}.toString,h2=function(r){return d2.call(r).replace(/^\[object /,"").replace(/]$/,"")},Ql=function(r){return Jm(r,"Boolean")};function f2(r){return r instanceof Date}function g2(r){return r===null}var p2=Object.prototype,v2=function(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||p2;return r===t},Ie=function(r){return r===void 0},Gi=function(r){if(typeof r!="object"||r===null)return r;var e;if(nr(r)){e=[];for(var t=0,n=r.length;t<n;t++)typeof r[t]=="object"&&r[t]!=null?e[t]=Gi(r[t]):e[t]=r[t]}else{e={};for(var i in r)typeof r[i]=="object"&&r[i]!=null?e[i]=Gi(r[i]):e[i]=r[i]}return e};function vo(r,e,t){var n;return function(){var i=this,s=arguments,a=function(){n=null,t||r.apply(i,s)},o=t&&!n;clearTimeout(n),n=setTimeout(a,e),o&&r.apply(i,s)}}function m2(r){var e,t,n,i=r||1;function s(o,l){++e>i&&(n=t,a(1),++e),t[o]=l}function a(o){e=0,t=Object.create(null),o||(n=Object.create(null))}return a(),{clear:a,has:function(o){return t[o]!==void 0||n[o]!==void 0},get:function(o){var l=t[o];if(l!==void 0)return l;if((l=n[o])!==void 0)return s(o,l),l},set:function(o,l){t[o]!==void 0?t[o]=l:s(o,l)}}}var ed=new Map;function Sh(r,e,t){t===void 0&&(t=128);var n=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var a=e?e.apply(this,i):i[0];ed.has(r)||ed.set(r,m2(t));var o=ed.get(r);if(o.has(a))return o.get(a);var l=r.apply(this,i);return o.set(a,l),l};return n}var y2=5;function b2(r,e){if(Object.hasOwn)return Object.hasOwn(r,e);if(r==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(r),e)}function ny(r,e,t,n){t=t||0,n=n||y2;for(var i in e)if(b2(e,i)){var s=e[i];s!==null&&ua(s)?(ua(r[i])||(r[i]={}),t<n?ny(r[i],s,t+1,n):r[i]=e[i]):nr(s)?(r[i]=[],r[i]=r[i].concat(s)):s!==void 0&&(r[i]=s)}}var Ln=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)ny(r,e[n]);return r},w2=Object.prototype.hasOwnProperty;function Ir(r){if(Ae(r))return!0;if(Ja(r))return!r.length;var e=h2(r);if(e==="Map"||e==="Set")return!r.size;if(v2(r))return!Object.keys(r).length;for(var t in r)if(w2.call(r,t))return!1;return!0}var Ct=function(r,e){if(r===e)return!0;if(!r||!e||Ke(r)||Ke(e))return!1;if(Ja(r)||Ja(e)){if(r.length!==e.length)return!1;for(var t=!0,n=0;n<r.length&&(t=Ct(r[n],e[n]),!!t);n++);return t}if(Mh(r)||Mh(e)){var i=Object.keys(r),s=Object.keys(e);if(i.length!==s.length)return!1;for(var t=!0,n=0;n<i.length&&(t=Ct(r[i[n]],e[i[n]]),!!t);n++);return t}return!1};const An=function(r,e,t){for(var n=0,i=Ke(e)?e.split("."):e;r&&n<i.length;)r=r[i[n++]];return r===void 0||n<i.length?t:r},eo=function(r,e,t){var n=r,i=Ke(e)?e.split("."):e;return i.forEach(function(s,a){a<i.length-1?(Bt(n[s])||(n[s]=ye(i[a+1])?[]:{}),n=n[s]):n[s]=t}),r};var x2=Object.prototype.hasOwnProperty;const xs=function(r,e){if(r===null||!ua(r))return{};var t={};return Qm(e,function(n){x2.call(r,n)&&(t[n]=r[n])}),t},Cf=function(r,e){return r2(r,function(t,n,i){return e.includes(i)||(t[i]=n),t},{})},ry=function(r,e,t){var n,i,s,a,o=0;t||(t={});var l=function(){o=t.leading===!1?0:Date.now(),n=null,a=r.apply(i,s),n||(i=s=null)},u=function(){var c=Date.now();!o&&t.leading===!1&&(o=c);var d=e-(c-o);return i=this,s=arguments,d<=0||d>e?(n&&(clearTimeout(n),n=null),o=c,a=r.apply(i,s),n||(i=s=null)):!n&&t.trailing!==!1&&(n=setTimeout(l,d)),a};return u.cancel=function(){clearTimeout(n),o=0,n=i=s=null},u};var $o={};const E2=function(r){return r=r||"g",$o[r]?$o[r]+=1:$o[r]=1,r+$o[r]},td=function(){},Th=function(r){return r};var Yi=function(){return Yi=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Yi.apply(this,arguments)};function iy(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function Ge(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})}function dr(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function M2(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n}function wn(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}var sy={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function S2(r,e,t){if(r[t].length>7){r[t].shift();for(var n=r[t],i=t;n.length;)e[t]="A",r.splice(i+=1,0,["C"].concat(n.splice(0,6)));r.splice(t,1)}}var Ha={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function ay(r){return Array.isArray(r)&&r.every(function(e){var t=e[0].toLowerCase();return Ha[t]===e.length-1&&"achlmqstvz".includes(t)})}function oy(r){return ay(r)&&r.every(function(e){var t=e[0];return t===t.toUpperCase()})}function ly(r){return oy(r)&&r.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}function Vg(r){for(var e=r.pathValue[r.segmentStart],t=e.toLowerCase(),n=r.data;n.length>=Ha[t]&&(t==="m"&&n.length>2?(r.segments.push([e].concat(n.splice(0,2))),t="l",e=e==="m"?"l":"L"):r.segments.push([e].concat(n.splice(0,Ha[t]))),!!Ha[t]););}function T2(r){var e=r.index,t=r.pathValue,n=t.charCodeAt(e);if(n===48){r.param=0,r.index+=1;return}if(n===49){r.param=1,r.index+=1;return}r.err='[path-util]: invalid Arc flag "'.concat(t[e],'", expecting 0 or 1 at index ').concat(e)}function O2(r){return r>=48&&r<=57||r===43||r===45||r===46}function Bs(r){return r>=48&&r<=57}function k2(r){var e=r.max,t=r.pathValue,n=r.index,i=n,s=!1,a=!1,o=!1,l=!1,u;if(i>=e){r.err="[path-util]: Invalid path value at index ".concat(i,', "pathValue" is missing param');return}if(u=t.charCodeAt(i),(u===43||u===45)&&(i+=1,u=t.charCodeAt(i)),!Bs(u)&&u!==46){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" is not a number');return}if(u!==46){if(s=u===48,i+=1,u=t.charCodeAt(i),s&&i<e&&u&&Bs(u)){r.err="[path-util]: Invalid path value at index ".concat(n,', "').concat(t[n],'" illegal number');return}for(;i<e&&Bs(t.charCodeAt(i));)i+=1,a=!0;u=t.charCodeAt(i)}if(u===46){for(l=!0,i+=1;Bs(t.charCodeAt(i));)i+=1,o=!0;u=t.charCodeAt(i)}if(u===101||u===69){if(l&&!a&&!o){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid float exponent');return}if(i+=1,u=t.charCodeAt(i),(u===43||u===45)&&(i+=1),i<e&&Bs(t.charCodeAt(i)))for(;i<e&&Bs(t.charCodeAt(i));)i+=1;else{r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid integer exponent');return}}r.index=i,r.param=+r.pathValue.slice(n,i)}function N2(r){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return r===10||r===13||r===8232||r===8233||r===32||r===9||r===11||r===12||r===160||r>=5760&&e.includes(r)}function Rl(r){for(var e=r.pathValue,t=r.max;r.index<t&&N2(e.charCodeAt(r.index));)r.index+=1}function A2(r){switch(r|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function C2(r){return(r|32)===97}function P2(r){var e=r.max,t=r.pathValue,n=r.index,i=t.charCodeAt(n),s=Ha[t[n].toLowerCase()];if(r.segmentStart=n,!A2(i)){r.err='[path-util]: Invalid path value "'.concat(t[n],'" is not a path command');return}if(r.index+=1,Rl(r),r.data=[],!s){Vg(r);return}for(;;){for(var a=s;a>0;a-=1){if(C2(i)&&(a===3||a===4)?T2(r):k2(r),r.err.length)return;r.data.push(r.param),Rl(r),r.index<e&&t.charCodeAt(r.index)===44&&(r.index+=1,Rl(r))}if(r.index>=r.max||!O2(t.charCodeAt(r.index)))break}Vg(r)}var _2=function(){function r(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return r}();function L2(r){if(ay(r))return[].concat(r);var e=new _2(r);for(Rl(e);e.index<e.max&&!e.err.length;)P2(e);return e.err?e.err:e.segments}function D2(r){if(oy(r))return[].concat(r);var e=L2(r),t=0,n=0,i=0,s=0;return e.map(function(a){var o=a.slice(1).map(Number),l=a[0],u=l.toUpperCase();if(l==="M")return t=o[0],n=o[1],i=t,s=n,["M",t,n];var c;if(l!==u)switch(u){case"A":c=[u,o[0],o[1],o[2],o[3],o[4],o[5]+t,o[6]+n];break;case"V":c=[u,o[0]+n];break;case"H":c=[u,o[0]+t];break;default:{var d=o.map(function(f,g){return f+(g%2?n:t)});c=[u].concat(d)}}else c=[u].concat(o);var h=c.length;switch(u){case"Z":t=i,n=s;break;case"H":t=c[1];break;case"V":n=c[1];break;default:t=c[h-2],n=c[h-1],u==="M"&&(i=t,s=n)}return c})}function I2(r,e){var t=r[0],n=e.x1,i=e.y1,s=e.x2,a=e.y2,o=r.slice(1).map(Number),l=r;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")l=["L",r[1],i];else if(t==="V")l=["L",n,r[1]];else if(t==="S"){var u=n*2-s,c=i*2-a;e.x1=u,e.y1=c,l=["C",u,c].concat(o)}else if(t==="T"){var d=n*2-e.qx,h=i*2-e.qy;e.qx=d,e.qy=h,l=["Q",d,h].concat(o)}else if(t==="Q"){var f=o[0],g=o[1];e.qx=f,e.qy=g}return l}function Jl(r){if(ly(r))return[].concat(r);for(var e=D2(r),t=Yi({},sy),n=0;n<e.length;n+=1){e[n]=I2(e[n],t);var i=e[n],s=i.length;t.x1=+i[s-2],t.y1=+i[s-1],t.x2=+i[s-4]||t.x1,t.y2=+i[s-3]||t.y1}return e}function R2(r){return ly(r)&&r.every(function(e){var t=e[0];return"MC".includes(t)})}function Wo(r,e,t){var n=r*Math.cos(t)-e*Math.sin(t),i=r*Math.sin(t)+e*Math.cos(t);return{x:n,y:i}}function Pf(r,e,t,n,i,s,a,o,l,u){var c=r,d=e,h=t,f=n,g=o,v=l,p=Math.PI*120/180,y=Math.PI/180*(+i||0),b=[],E,T,S,k,A;if(u)T=u[0],S=u[1],k=u[2],A=u[3];else{E=Wo(c,d,-y),c=E.x,d=E.y,E=Wo(g,v,-y),g=E.x,v=E.y;var O=(c-g)/2,C=(d-v)/2,P=O*O/(h*h)+C*C/(f*f);P>1&&(P=Math.sqrt(P),h*=P,f*=P);var L=h*h,R=f*f,z=(s===a?-1:1)*Math.sqrt(Math.abs((L*R-L*C*C-R*O*O)/(L*C*C+R*O*O)));k=z*h*C/f+(c+g)/2,A=z*-f*O/h+(d+v)/2,T=Math.asin(((d-A)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),S=Math.asin(((v-A)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),T=c<k?Math.PI-T:T,S=g<k?Math.PI-S:S,T<0&&(T=Math.PI*2+T),S<0&&(S=Math.PI*2+S),a&&T>S&&(T-=Math.PI*2),!a&&S>T&&(S-=Math.PI*2)}var Y=S-T;if(Math.abs(Y)>p){var U=S,V=g,W=v;S=T+p*(a&&S>T?1:-1),g=k+h*Math.cos(S),v=A+f*Math.sin(S),b=Pf(g,v,h,f,i,0,a,V,W,[S,U,k,A])}Y=S-T;var F=Math.cos(T),K=Math.sin(T),re=Math.cos(S),se=Math.sin(S),ae=Math.tan(Y/4),Ce=4/3*h*ae,Te=4/3*f*ae,J=[c,d],Oe=[c+Ce*K,d-Te*F],_e=[g+Ce*se,v-Te*re],Ve=[g,v];if(Oe[0]=2*J[0]-Oe[0],Oe[1]=2*J[1]-Oe[1],u)return Oe.concat(_e,Ve,b);b=Oe.concat(_e,Ve,b);for(var Qe=[],zt=0,Xr=b.length;zt<Xr;zt+=1)Qe[zt]=zt%2?Wo(b[zt-1],b[zt],y).y:Wo(b[zt],b[zt+1],y).x;return Qe}function j2(r,e,t,n,i,s){var a=.3333333333333333,o=2/3;return[a*r+o*t,a*e+o*n,a*i+o*t,a*s+o*n,i,s]}function Si(r,e,t){var n=r[0],i=r[1],s=e[0],a=e[1];return[n+(s-n)*t,i+(a-i)*t]}var Ug=function(r,e,t,n){var i=.5,s=Si([r,e],[t,n],i);return wn(wn([],s,!0),[t,n,t,n],!1)};function B2(r,e){var t=r[0],n=r.slice(1).map(Number),i=n[0],s=n[1],a,o=e.x1,l=e.y1,u=e.x,c=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=s,r;case"A":return a=[o,l].concat(n),["C"].concat(Pf(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9]));case"Q":return e.qx=i,e.qy=s,a=[o,l].concat(n),["C"].concat(j2(a[0],a[1],a[2],a[3],a[4],a[5]));case"L":return["C"].concat(Ug(o,l,i,s));case"Z":return o===u&&l===c?["C",o,l,u,c,u,c]:["C"].concat(Ug(o,l,u,c))}return r}function Oh(r,e){if(e===void 0&&(e=!1),R2(r)){var t=[].concat(r);return e?[t,[]]:t}for(var n=Jl(r),i=Yi({},sy),s=[],a="",o=n.length,l,u,c=[],d=0;d<o;d+=1){n[d]&&(a=n[d][0]),s[d]=a;var h=B2(n[d],i);n[d]=h,S2(n,s,d),o=n.length,a==="Z"&&c.push(d),l=n[d],u=l.length,i.x1=+l[u-2],i.y1=+l[u-1],i.x2=+l[u-4]||i.x1,i.y2=+l[u-3]||i.y1}return e?[n,c]:n}function z2(r){return r.map(function(e){return Array.isArray(e)?[].concat(e):e})}function F2(r){var e=r.slice(1).map(function(t,n,i){return n?i[n-1].slice(-2).concat(t.slice(1)):r[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(n,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function zn(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}function kh(r,e,t,n,i){var s=zn([r,e],[t,n]),a={x:0,y:0};if(typeof i=="number")if(i<=0)a={x:r,y:e};else if(i>=s)a={x:t,y:n};else{var o=Si([r,e],[t,n],i/s),l=o[0],u=o[1];a={x:l,y:u}}return{length:s,point:a,min:{x:Math.min(r,t),y:Math.min(e,n)},max:{x:Math.max(r,t),y:Math.max(e,n)}}}function Hg(r,e){var t=r.x,n=r.y,i=e.x,s=e.y,a=t*i+n*s,o=Math.sqrt((Math.pow(t,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(s,2))),l=t*s-n*i<0?-1:1,u=l*Math.acos(a/o);return u}function $2(r,e,t,n,i,s,a,o,l,u){var c=Math.abs,d=Math.sin,h=Math.cos,f=Math.sqrt,g=Math.PI,v=c(t),p=c(n),y=(i%360+360)%360,b=y*(g/180);if(r===o&&e===l)return{x:r,y:e};if(v===0||p===0)return kh(r,e,o,l,u).point;var E=(r-o)/2,T=(e-l)/2,S={x:h(b)*E+d(b)*T,y:-d(b)*E+h(b)*T},k=Math.pow(S.x,2)/Math.pow(v,2)+Math.pow(S.y,2)/Math.pow(p,2);k>1&&(v*=f(k),p*=f(k));var A=Math.pow(v,2)*Math.pow(p,2)-Math.pow(v,2)*Math.pow(S.y,2)-Math.pow(p,2)*Math.pow(S.x,2),O=Math.pow(v,2)*Math.pow(S.y,2)+Math.pow(p,2)*Math.pow(S.x,2),C=A/O;C=C<0?0:C;var P=(s!==a?1:-1)*f(C),L={x:P*(v*S.y/p),y:P*(-(p*S.x)/v)},R={x:h(b)*L.x-d(b)*L.y+(r+o)/2,y:d(b)*L.x+h(b)*L.y+(e+l)/2},z={x:(S.x-L.x)/v,y:(S.y-L.y)/p},Y=Hg({x:1,y:0},z),U={x:(-S.x-L.x)/v,y:(-S.y-L.y)/p},V=Hg(z,U);!a&&V>0?V-=2*g:a&&V<0&&(V+=2*g),V%=2*g;var W=Y+V*u,F=v*h(W),K=p*d(W),re={x:h(b)*F-d(b)*K+R.x,y:d(b)*F+h(b)*K+R.y};return re}function W2(r,e,t,n,i,s,a,o,l,u,c){var d,h=c.bbox,f=h===void 0?!0:h,g=c.length,v=g===void 0?!0:g,p=c.sampleSize,y=p===void 0?30:p,b=typeof u=="number",E=r,T=e,S=0,k=[E,T,S],A=[E,T],O=0,C={x:0,y:0},P=[{x:E,y:T}];b&&u<=0&&(C={x:E,y:T});for(var L=0;L<=y;L+=1){if(O=L/y,d=$2(r,e,t,n,i,s,a,o,l,O),E=d.x,T=d.y,f&&P.push({x:E,y:T}),v&&(S+=zn(A,[E,T])),A=[E,T],b&&S>=u&&u>k[2]){var R=(S-u)/(S-k[2]);C={x:A[0]*(1-R)+k[0]*R,y:A[1]*(1-R)+k[1]*R}}k=[E,T,S]}return b&&u>=S&&(C={x:o,y:l}),{length:S,point:C,min:{x:Math.min.apply(null,P.map(function(z){return z.x})),y:Math.min.apply(null,P.map(function(z){return z.y}))},max:{x:Math.max.apply(null,P.map(function(z){return z.x})),y:Math.max.apply(null,P.map(function(z){return z.y}))}}}function G2(r,e,t,n,i,s,a,o,l){var u=1-l;return{x:Math.pow(u,3)*r+3*Math.pow(u,2)*l*t+3*u*Math.pow(l,2)*i+Math.pow(l,3)*a,y:Math.pow(u,3)*e+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*s+Math.pow(l,3)*o}}function uy(r,e,t,n,i,s,a,o,l,u){var c,d=u.bbox,h=d===void 0?!0:d,f=u.length,g=f===void 0?!0:f,v=u.sampleSize,p=v===void 0?10:v,y=typeof l=="number",b=r,E=e,T=0,S=[b,E,T],k=[b,E],A=0,O={x:0,y:0},C=[{x:b,y:E}];y&&l<=0&&(O={x:b,y:E});for(var P=0;P<=p;P+=1){if(A=P/p,c=G2(r,e,t,n,i,s,a,o,A),b=c.x,E=c.y,h&&C.push({x:b,y:E}),g&&(T+=zn(k,[b,E])),k=[b,E],y&&T>=l&&l>S[2]){var L=(T-l)/(T-S[2]);O={x:k[0]*(1-L)+S[0]*L,y:k[1]*(1-L)+S[1]*L}}S=[b,E,T]}return y&&l>=T&&(O={x:a,y:o}),{length:T,point:O,min:{x:Math.min.apply(null,C.map(function(R){return R.x})),y:Math.min.apply(null,C.map(function(R){return R.y}))},max:{x:Math.max.apply(null,C.map(function(R){return R.x})),y:Math.max.apply(null,C.map(function(R){return R.y}))}}}function Y2(r,e,t,n,i,s,a){var o=1-a;return{x:Math.pow(o,2)*r+2*o*a*t+Math.pow(a,2)*i,y:Math.pow(o,2)*e+2*o*a*n+Math.pow(a,2)*s}}function V2(r,e,t,n,i,s,a,o){var l,u=o.bbox,c=u===void 0?!0:u,d=o.length,h=d===void 0?!0:d,f=o.sampleSize,g=f===void 0?10:f,v=typeof a=="number",p=r,y=e,b=0,E=[p,y,b],T=[p,y],S=0,k={x:0,y:0},A=[{x:p,y}];v&&a<=0&&(k={x:p,y});for(var O=0;O<=g;O+=1){if(S=O/g,l=Y2(r,e,t,n,i,s,S),p=l.x,y=l.y,c&&A.push({x:p,y}),h&&(b+=zn(T,[p,y])),T=[p,y],v&&b>=a&&a>E[2]){var C=(b-a)/(b-E[2]);k={x:T[0]*(1-C)+E[0]*C,y:T[1]*(1-C)+E[1]*C}}E=[p,y,b]}return v&&a>=b&&(k={x:i,y:s}),{length:b,point:k,min:{x:Math.min.apply(null,A.map(function(P){return P.x})),y:Math.min.apply(null,A.map(function(P){return P.y}))},max:{x:Math.max.apply(null,A.map(function(P){return P.x})),y:Math.max.apply(null,A.map(function(P){return P.y}))}}}function cy(r,e,t){for(var n,i,s,a,o,l,u=Jl(r),c=typeof e=="number",d,h=[],f,g=0,v=0,p=0,y=0,b,E=[],T=[],S=0,k={x:0,y:0},A=k,O=k,C=k,P=0,L=0,R=u.length;L<R;L+=1)b=u[L],f=b[0],d=f==="M",h=d?h:[g,v].concat(b.slice(1)),d?(p=b[1],y=b[2],k={x:p,y},A=k,S=0,c&&e<.001&&(C=k)):f==="L"?(n=kh(h[0],h[1],h[2],h[3],(e||0)-P),S=n.length,k=n.min,A=n.max,O=n.point):f==="A"?(i=W2(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],(e||0)-P,t||{}),S=i.length,k=i.min,A=i.max,O=i.point):f==="C"?(s=uy(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],(e||0)-P,t||{}),S=s.length,k=s.min,A=s.max,O=s.point):f==="Q"?(a=V2(h[0],h[1],h[2],h[3],h[4],h[5],(e||0)-P,t||{}),S=a.length,k=a.min,A=a.max,O=a.point):f==="Z"&&(h=[g,v,p,y],o=kh(h[0],h[1],h[2],h[3],(e||0)-P),S=o.length,k=o.min,A=o.max,O=o.point),c&&P<e&&P+S>=e&&(C=O),T.push(A),E.push(k),P+=S,l=f!=="Z"?b.slice(-2):[p,y],g=l[0],v=l[1];return c&&e>=P&&(C={x:g,y:v}),{length:P,point:C,min:{x:Math.min.apply(null,E.map(function(z){return z.x})),y:Math.min.apply(null,E.map(function(z){return z.y}))},max:{x:Math.max.apply(null,T.map(function(z){return z.x})),y:Math.max.apply(null,T.map(function(z){return z.y}))}}}function U2(r,e){return cy(r,void 0,Yi(Yi({},e),{bbox:!1,length:!0})).length}function H2(r){var e=r.length,t=e-1;return r.map(function(n,i){return r.map(function(s,a){var o=i+a,l;return a===0||r[o]&&r[o][0]==="M"?(l=r[o],["M"].concat(l.slice(-2))):(o>=e&&(o-=t),r[o])})})}function X2(r,e){var t=r.length-1,n=[],i=0,s=0,a=H2(r);return a.forEach(function(o,l){r.slice(1).forEach(function(u,c){s+=zn(r[(l+c)%t].slice(-2),e[c%t].slice(-2))}),n[l]=s,s=0}),i=n.indexOf(Math.min.apply(null,n)),a[i]}function q2(r,e,t,n,i,s,a,o){return 3*((o-e)*(t+i)-(a-r)*(n+s)+n*(r-i)-t*(e-s)+o*(i+r/3)-a*(s+e/3))/20}function Z2(r){var e=0,t=0,n=0;return Oh(r).map(function(i){var s;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var a=i.slice(1),o=a[0],l=a[1],u=a[2],c=a[3],d=a[4],h=a[5];return n=q2(e,t,o,l,u,c,d,h),s=i.slice(-2),e=s[0],t=s[1],n}}).reduce(function(i,s){return i+s},0)}function Xg(r){return Z2(r)>=0}function K2(r,e,t){return cy(r,e,Yi(Yi({},t),{bbox:!1,length:!0})).point}function Q2(r,e){e===void 0&&(e=.5);var t=r.slice(0,2),n=r.slice(2,4),i=r.slice(4,6),s=r.slice(6,8),a=Si(t,n,e),o=Si(n,i,e),l=Si(i,s,e),u=Si(a,o,e),c=Si(o,l,e),d=Si(u,c,e);return[["C"].concat(a,u,d),["C"].concat(c,l,s)]}function qg(r){return r.map(function(e,t,n){var i=t&&n[t-1].slice(-2).concat(e.slice(1)),s=t?uy(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,a;return t?a=s?Q2(i):[e,e]:a=[e],{s:e,ss:a,l:s}})}function dy(r,e,t){var n=qg(r),i=qg(e),s=n.length,a=i.length,o=n.filter(function(p){return p.l}).length,l=i.filter(function(p){return p.l}).length,u=n.filter(function(p){return p.l}).reduce(function(p,y){var b=y.l;return p+b},0)/o||0,c=i.filter(function(p){return p.l}).reduce(function(p,y){var b=y.l;return p+b},0)/l||0,d=t||Math.max(s,a),h=[u,c],f=[d-s,d-a],g=0,v=[n,i].map(function(p,y){return p.l===d?p.map(function(b){return b.s}):p.map(function(b,E){return g=E&&f[y]&&b.l>=h[y],f[y]-=g?1:0,g?b.ss:[b.s]}).flat()});return v[0].length===v[1].length?v:dy(v[0],v[1],d)}function Nh(r){var e=document.createElement("div");e.innerHTML=r;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function J2(r,e){for(;!{}.hasOwnProperty.call(r,e)&&(r=aa(r))!==null;);return r}function Ah(){return Ah=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,t){var n=J2(r,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?r:t):i.value}},Ah.apply(null,arguments)}function Zg(r,e,t,n){var i=Ah(aa(r.prototype),e,t);return typeof i=="function"?function(s){return i.apply(t,s)}:i}function li(r,e,t,n){var i=r-t,s=e-n;return Math.sqrt(i*i+s*s)}function hy(r,e){var t=Math.min.apply(Math,wn([],dr(r),!1)),n=Math.min.apply(Math,wn([],dr(e),!1)),i=Math.max.apply(Math,wn([],dr(r),!1)),s=Math.max.apply(Math,wn([],dr(e),!1));return{x:t,y:n,width:i-t,height:s-n}}function eM(r,e,t){return Math.atan(-e/r*Math.tan(t))}function tM(r,e,t){return Math.atan(e/(r*Math.tan(t)))}function nM(r,e,t,n,i,s){return t*Math.cos(i)*Math.cos(s)-n*Math.sin(i)*Math.sin(s)+r}function rM(r,e,t,n,i,s){return t*Math.sin(i)*Math.cos(s)+n*Math.cos(i)*Math.sin(s)+e}function iM(r,e,t,n,i,s,a){for(var o=eM(t,n,i),l=1/0,u=-1/0,c=[s,a],d=-Math.PI*2;d<=Math.PI*2;d+=Math.PI){var h=o+d;s<a?s<h&&h<a&&c.push(h):a<h&&h<s&&c.push(h)}for(var d=0;d<c.length;d++){var f=nM(r,e,t,n,i,c[d]);f<l&&(l=f),f>u&&(u=f)}for(var g=tM(t,n,i),v=1/0,p=-1/0,y=[s,a],d=-Math.PI*2;d<=Math.PI*2;d+=Math.PI){var b=g+d;s<a?s<b&&b<a&&y.push(b):a<b&&b<s&&y.push(b)}for(var d=0;d<y.length;d++){var E=rM(r,e,t,n,i,y[d]);E<v&&(v=E),E>p&&(p=E)}return{x:l,y:v,width:u-l,height:p-v}}var sM=1e-4;function fy(r,e,t,n,i,s){var a=-1,o=1/0,l=[t,n],u=20;s&&s>200&&(u=s/10);for(var c=1/u,d=c/10,h=0;h<=u;h++){var f=h*c,g=[i.apply(void 0,wn([],dr(r.concat([f])),!1)),i.apply(void 0,wn([],dr(e.concat([f])),!1))],v=li(l[0],l[1],g[0],g[1]);v<o&&(a=f,o=v)}if(a===0)return{x:r[0],y:e[0]};if(a===1){var p=r.length;return{x:r[p-1],y:e[p-1]}}o=1/0;for(var h=0;h<32&&!(d<sM);h++){var y=a-d,b=a+d,g=[i.apply(void 0,wn([],dr(r.concat([y])),!1)),i.apply(void 0,wn([],dr(e.concat([y])),!1))],v=li(l[0],l[1],g[0],g[1]);if(y>=0&&v<o)a=y,o=v;else{var E=[i.apply(void 0,wn([],dr(r.concat([b])),!1)),i.apply(void 0,wn([],dr(e.concat([b])),!1))],T=li(l[0],l[1],E[0],E[1]);b<=1&&T<o?(a=b,o=T):d*=.5}}return{x:i.apply(void 0,wn([],dr(r.concat([a])),!1)),y:i.apply(void 0,wn([],dr(e.concat([a])),!1))}}function gy(r,e,t,n){return li(r,e,t,n)}function py(r,e,t,n,i){return{x:(1-i)*r+i*t,y:(1-i)*e+i*n}}function aM(r,e,t,n,i,s){var a=[t-r,n-e];if(QE(a,[0,0]))return Math.sqrt((i-r)*(i-r)+(s-e)*(s-e));var o=[-a[1],a[0]];ZE(o,o);var l=[i-r,s-e];return Math.abs(KE(l,o))}function Ch(r,e,t,n,i){var s=1-i;return s*s*s*r+3*e*i*s*s+3*t*i*i*s+n*i*i*i}function Kg(r,e,t,n){var i=-3*r+9*e-9*t+3*n,s=6*r-12*e+6*t,a=3*e-3*r,o=[],l,u,c;if(Ua(i,0))Ua(s,0)||(l=-a/s,l>=0&&l<=1&&o.push(l));else{var d=s*s-4*i*a;Ua(d,0)?o.push(-s/(2*i)):d>0&&(c=Math.sqrt(d),l=(-s+c)/(2*i),u=(-s-c)/(2*i),l>=0&&l<=1&&o.push(l),u>=0&&u<=1&&o.push(u))}return o}function oM(r,e,t,n,i,s,a,o){for(var l=[r,a],u=[e,o],c=Kg(r,t,i,a),d=Kg(e,n,s,o),h=0;h<c.length;h++)l.push(Ch(r,t,i,a,c[h]));for(var h=0;h<d.length;h++)u.push(Ch(e,n,s,o,d[h]));return hy(l,u)}function lM(r,e,t,n,i,s,a,o,l,u,c){return fy([r,t,i,a],[e,n,s,o],l,u,Ch,c)}function Qg(r,e,t,n,i,s,a,o,l,u,c){var d=lM(r,e,t,n,i,s,a,o,l,u,c);return li(d.x,d.y,l,u)}function uM(r){if(r.length<2)return 0;for(var e=0,t=0;t<r.length-1;t++){var n=r[t],i=r[t+1];e+=li(n[0],n[1],i[0],i[1])}return e}function cM(r){return uM(r)}function Ph(r,e,t,n){var i=1-n;return i*i*r+2*n*i*e+n*n*t}function Jg(r,e,t){var n=r+t-2*e;if(Ua(n,0))return[.5];var i=(r-e)/n;return i<=1&&i>=0?[i]:[]}function dM(r,e,t,n,i,s){var a=Jg(r,t,i)[0],o=Jg(e,n,s)[0],l=[r,i],u=[e,s];return a!==void 0&&l.push(Ph(r,t,i,a)),o!==void 0&&u.push(Ph(e,n,s,o)),hy(l,u)}function hM(r,e,t,n,i,s,a,o){return fy([r,t,i],[e,n,s],a,o,Ph)}function fM(r,e,t,n,i,s,a,o){var l=hM(r,e,t,n,i,s,a,o);return li(l.x,l.y,a,o)}function gn(){gn=function(){return e};var r,e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(V,W,F){V[W]=F.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(V,W,F){return Object.defineProperty(V,W,{value:F,enumerable:!0,configurable:!0,writable:!0}),V[W]}try{u({},"")}catch{u=function(F,K,re){return F[K]=re}}function c(V,W,F,K){var re=W&&W.prototype instanceof y?W:y,se=Object.create(re.prototype),ae=new Y(K||[]);return i(se,"_invoke",{value:P(V,F,ae)}),se}function d(V,W,F){try{return{type:"normal",arg:V.call(W,F)}}catch(K){return{type:"throw",arg:K}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",g="executing",v="completed",p={};function y(){}function b(){}function E(){}var T={};u(T,a,function(){return this});var S=Object.getPrototypeOf,k=S&&S(S(U([])));k&&k!==t&&n.call(k,a)&&(T=k);var A=E.prototype=y.prototype=Object.create(T);function O(V){["next","throw","return"].forEach(function(W){u(V,W,function(F){return this._invoke(W,F)})})}function C(V,W){function F(re,se,ae,Ce){var Te=d(V[re],V,se);if(Te.type!=="throw"){var J=Te.arg,Oe=J.value;return Oe&&$i(Oe)=="object"&&n.call(Oe,"__await")?W.resolve(Oe.__await).then(function(_e){F("next",_e,ae,Ce)},function(_e){F("throw",_e,ae,Ce)}):W.resolve(Oe).then(function(_e){J.value=_e,ae(J)},function(_e){return F("throw",_e,ae,Ce)})}Ce(Te.arg)}var K;i(this,"_invoke",{value:function(se,ae){function Ce(){return new W(function(Te,J){F(se,ae,Te,J)})}return K=K?K.then(Ce,Ce):Ce()}})}function P(V,W,F){var K=h;return function(re,se){if(K===g)throw Error("Generator is already running");if(K===v){if(re==="throw")throw se;return{value:r,done:!0}}for(F.method=re,F.arg=se;;){var ae=F.delegate;if(ae){var Ce=L(ae,F);if(Ce){if(Ce===p)continue;return Ce}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(K===h)throw K=v,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);K=g;var Te=d(V,W,F);if(Te.type==="normal"){if(K=F.done?v:f,Te.arg===p)continue;return{value:Te.arg,done:F.done}}Te.type==="throw"&&(K=v,F.method="throw",F.arg=Te.arg)}}}function L(V,W){var F=W.method,K=V.iterator[F];if(K===r)return W.delegate=null,F==="throw"&&V.iterator.return&&(W.method="return",W.arg=r,L(V,W),W.method==="throw")||F!=="return"&&(W.method="throw",W.arg=new TypeError("The iterator does not provide a '"+F+"' method")),p;var re=d(K,V.iterator,W.arg);if(re.type==="throw")return W.method="throw",W.arg=re.arg,W.delegate=null,p;var se=re.arg;return se?se.done?(W[V.resultName]=se.value,W.next=V.nextLoc,W.method!=="return"&&(W.method="next",W.arg=r),W.delegate=null,p):se:(W.method="throw",W.arg=new TypeError("iterator result is not an object"),W.delegate=null,p)}function R(V){var W={tryLoc:V[0]};1 in V&&(W.catchLoc=V[1]),2 in V&&(W.finallyLoc=V[2],W.afterLoc=V[3]),this.tryEntries.push(W)}function z(V){var W=V.completion||{};W.type="normal",delete W.arg,V.completion=W}function Y(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(R,this),this.reset(!0)}function U(V){if(V||V===""){var W=V[a];if(W)return W.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var F=-1,K=function re(){for(;++F<V.length;)if(n.call(V,F))return re.value=V[F],re.done=!1,re;return re.value=r,re.done=!0,re};return K.next=K}}throw new TypeError($i(V)+" is not iterable")}return b.prototype=E,i(A,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:b,configurable:!0}),b.displayName=u(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(V){var W=typeof V=="function"&&V.constructor;return!!W&&(W===b||(W.displayName||W.name)==="GeneratorFunction")},e.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,E):(V.__proto__=E,u(V,l,"GeneratorFunction")),V.prototype=Object.create(A),V},e.awrap=function(V){return{__await:V}},O(C.prototype),u(C.prototype,o,function(){return this}),e.AsyncIterator=C,e.async=function(V,W,F,K,re){re===void 0&&(re=Promise);var se=new C(c(V,W,F,K),re);return e.isGeneratorFunction(W)?se:se.next().then(function(ae){return ae.done?ae.value:se.next()})},O(A),u(A,l,"Generator"),u(A,a,function(){return this}),u(A,"toString",function(){return"[object Generator]"}),e.keys=function(V){var W=Object(V),F=[];for(var K in W)F.push(K);return F.reverse(),function re(){for(;F.length;){var se=F.pop();if(se in W)return re.value=se,re.done=!1,re}return re.done=!0,re}},e.values=U,Y.prototype={constructor:Y,reset:function(W){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(z),!W)for(var F in this)F.charAt(0)==="t"&&n.call(this,F)&&!isNaN(+F.slice(1))&&(this[F]=r)},stop:function(){this.done=!0;var W=this.tryEntries[0].completion;if(W.type==="throw")throw W.arg;return this.rval},dispatchException:function(W){if(this.done)throw W;var F=this;function K(J,Oe){return ae.type="throw",ae.arg=W,F.next=J,Oe&&(F.method="next",F.arg=r),!!Oe}for(var re=this.tryEntries.length-1;re>=0;--re){var se=this.tryEntries[re],ae=se.completion;if(se.tryLoc==="root")return K("end");if(se.tryLoc<=this.prev){var Ce=n.call(se,"catchLoc"),Te=n.call(se,"finallyLoc");if(Ce&&Te){if(this.prev<se.catchLoc)return K(se.catchLoc,!0);if(this.prev<se.finallyLoc)return K(se.finallyLoc)}else if(Ce){if(this.prev<se.catchLoc)return K(se.catchLoc,!0)}else{if(!Te)throw Error("try statement without catch or finally");if(this.prev<se.finallyLoc)return K(se.finallyLoc)}}}},abrupt:function(W,F){for(var K=this.tryEntries.length-1;K>=0;--K){var re=this.tryEntries[K];if(re.tryLoc<=this.prev&&n.call(re,"finallyLoc")&&this.prev<re.finallyLoc){var se=re;break}}se&&(W==="break"||W==="continue")&&se.tryLoc<=F&&F<=se.finallyLoc&&(se=null);var ae=se?se.completion:{};return ae.type=W,ae.arg=F,se?(this.method="next",this.next=se.finallyLoc,p):this.complete(ae)},complete:function(W,F){if(W.type==="throw")throw W.arg;return W.type==="break"||W.type==="continue"?this.next=W.arg:W.type==="return"?(this.rval=this.arg=W.arg,this.method="return",this.next="end"):W.type==="normal"&&F&&(this.next=F),p},finish:function(W){for(var F=this.tryEntries.length-1;F>=0;--F){var K=this.tryEntries[F];if(K.finallyLoc===W)return this.complete(K.completion,K.afterLoc),z(K),p}},catch:function(W){for(var F=this.tryEntries.length-1;F>=0;--F){var K=this.tryEntries[F];if(K.tryLoc===W){var re=K.completion;if(re.type==="throw"){var se=re.arg;z(K)}return se}}throw Error("illegal catch attempt")},delegateYield:function(W,F,K){return this.delegate={iterator:U(W),resultName:F,nextLoc:K},this.method==="next"&&(this.arg=r),p}},e}function ep(r,e,t,n,i,s,a){try{var o=r[s](a),l=o.value}catch(u){return void t(u)}o.done?e(l):Promise.resolve(l).then(n,i)}function Vi(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function a(l){ep(s,n,i,a,o,"next",l)}function o(l){ep(s,n,i,a,o,"throw",l)}a(void 0)})}}function cs(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=Of(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(u){throw u},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var u=t.next();return a=u.done,u},e:function(u){o=!0,s=u},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function gM(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}function As(r,e){if(r==null)return{};var t,n,i=gM(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.includes(t)||{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.2.9
 * @date 11/27/2024, 2:16:03 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var pM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},vy={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(pM,function(){function t(S,k,A,O,C){n(S,k,A||0,O||S.length-1,C||s)}function n(S,k,A,O,C){for(;O>A;){if(O-A>600){var P=O-A+1,L=k-A+1,R=Math.log(P),z=.5*Math.exp(2*R/3),Y=.5*Math.sqrt(R*z*(P-z)/P)*(L-P/2<0?-1:1),U=Math.max(A,Math.floor(k-L*z/P+Y)),V=Math.min(O,Math.floor(k+(P-L)*z/P+Y));n(S,k,U,V,C)}var W=S[k],F=A,K=O;for(i(S,A,k),C(S[O],W)>0&&i(S,A,O);F<K;){for(i(S,F,K),F++,K--;C(S[F],W)<0;)F++;for(;C(S[K],W)>0;)K--}C(S[A],W)===0?i(S,A,K):(K++,i(S,K,O)),K<=k&&(A=K+1),k<=K&&(O=K-1)}}function i(S,k,A){var O=S[k];S[k]=S[A],S[A]=O}function s(S,k){return S<k?-1:S>k?1:0}var a=function(k){k===void 0&&(k=9),this._maxEntries=Math.max(4,k),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(k){var A=this.data,O=[];if(!b(k,A))return O;for(var C=this.toBBox,P=[];A;){for(var L=0;L<A.children.length;L++){var R=A.children[L],z=A.leaf?C(R):R;b(k,z)&&(A.leaf?O.push(R):y(k,z)?this._all(R,O):P.push(R))}A=P.pop()}return O},a.prototype.collides=function(k){var A=this.data;if(!b(k,A))return!1;for(var O=[];A;){for(var C=0;C<A.children.length;C++){var P=A.children[C],L=A.leaf?this.toBBox(P):P;if(b(k,L)){if(A.leaf||y(k,L))return!0;O.push(P)}}A=O.pop()}return!1},a.prototype.load=function(k){if(!(k&&k.length))return this;if(k.length<this._minEntries){for(var A=0;A<k.length;A++)this.insert(k[A]);return this}var O=this._build(k.slice(),0,k.length-1,0);if(!this.data.children.length)this.data=O;else if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var C=this.data;this.data=O,O=C}this._insert(O,this.data.height-O.height-1,!0)}return this},a.prototype.insert=function(k){return k&&this._insert(k,this.data.height-1),this},a.prototype.clear=function(){return this.data=E([]),this},a.prototype.remove=function(k,A){if(!k)return this;for(var O=this.data,C=this.toBBox(k),P=[],L=[],R,z,Y;O||P.length;){if(O||(O=P.pop(),z=P[P.length-1],R=L.pop(),Y=!0),O.leaf){var U=o(k,O.children,A);if(U!==-1)return O.children.splice(U,1),P.push(O),this._condense(P),this}!Y&&!O.leaf&&y(O,C)?(P.push(O),L.push(R),R=0,z=O,O=O.children[0]):z?(R++,O=z.children[R],Y=!1):O=null}return this},a.prototype.toBBox=function(k){return k},a.prototype.compareMinX=function(k,A){return k.minX-A.minX},a.prototype.compareMinY=function(k,A){return k.minY-A.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(k){return this.data=k,this},a.prototype._all=function(k,A){for(var O=[];k;)k.leaf?A.push.apply(A,k.children):O.push.apply(O,k.children),k=O.pop();return A},a.prototype._build=function(k,A,O,C){var P=O-A+1,L=this._maxEntries,R;if(P<=L)return R=E(k.slice(A,O+1)),l(R,this.toBBox),R;C||(C=Math.ceil(Math.log(P)/Math.log(L)),L=Math.ceil(P/Math.pow(L,C-1))),R=E([]),R.leaf=!1,R.height=C;var z=Math.ceil(P/L),Y=z*Math.ceil(Math.sqrt(L));T(k,A,O,Y,this.compareMinX);for(var U=A;U<=O;U+=Y){var V=Math.min(U+Y-1,O);T(k,U,V,z,this.compareMinY);for(var W=U;W<=V;W+=z){var F=Math.min(W+z-1,V);R.children.push(this._build(k,W,F,C-1))}}return l(R,this.toBBox),R},a.prototype._chooseSubtree=function(k,A,O,C){for(;C.push(A),!(A.leaf||C.length-1===O);){for(var P=1/0,L=1/0,R=void 0,z=0;z<A.children.length;z++){var Y=A.children[z],U=f(Y),V=v(k,Y)-U;V<L?(L=V,P=U<P?U:P,R=Y):V===L&&U<P&&(P=U,R=Y)}A=R||A.children[0]}return A},a.prototype._insert=function(k,A,O){var C=O?k:this.toBBox(k),P=[],L=this._chooseSubtree(C,this.data,A,P);for(L.children.push(k),c(L,C);A>=0&&P[A].children.length>this._maxEntries;)this._split(P,A),A--;this._adjustParentBBoxes(C,P,A)},a.prototype._split=function(k,A){var O=k[A],C=O.children.length,P=this._minEntries;this._chooseSplitAxis(O,P,C);var L=this._chooseSplitIndex(O,P,C),R=E(O.children.splice(L,O.children.length-L));R.height=O.height,R.leaf=O.leaf,l(O,this.toBBox),l(R,this.toBBox),A?k[A-1].children.push(R):this._splitRoot(O,R)},a.prototype._splitRoot=function(k,A){this.data=E([k,A]),this.data.height=k.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(k,A,O){for(var C,P=1/0,L=1/0,R=A;R<=O-A;R++){var z=u(k,0,R,this.toBBox),Y=u(k,R,O,this.toBBox),U=p(z,Y),V=f(z)+f(Y);U<P?(P=U,C=R,L=V<L?V:L):U===P&&V<L&&(L=V,C=R)}return C||O-A},a.prototype._chooseSplitAxis=function(k,A,O){var C=k.leaf?this.compareMinX:d,P=k.leaf?this.compareMinY:h,L=this._allDistMargin(k,A,O,C),R=this._allDistMargin(k,A,O,P);L<R&&k.children.sort(C)},a.prototype._allDistMargin=function(k,A,O,C){k.children.sort(C);for(var P=this.toBBox,L=u(k,0,A,P),R=u(k,O-A,O,P),z=g(L)+g(R),Y=A;Y<O-A;Y++){var U=k.children[Y];c(L,k.leaf?P(U):U),z+=g(L)}for(var V=O-A-1;V>=A;V--){var W=k.children[V];c(R,k.leaf?P(W):W),z+=g(R)}return z},a.prototype._adjustParentBBoxes=function(k,A,O){for(var C=O;C>=0;C--)c(A[C],k)},a.prototype._condense=function(k){for(var A=k.length-1,O=void 0;A>=0;A--)k[A].children.length===0?A>0?(O=k[A-1].children,O.splice(O.indexOf(k[A]),1)):this.clear():l(k[A],this.toBBox)};function o(S,k,A){if(!A)return k.indexOf(S);for(var O=0;O<k.length;O++)if(A(S,k[O]))return O;return-1}function l(S,k){u(S,0,S.children.length,k,S)}function u(S,k,A,O,C){C||(C=E(null)),C.minX=1/0,C.minY=1/0,C.maxX=-1/0,C.maxY=-1/0;for(var P=k;P<A;P++){var L=S.children[P];c(C,S.leaf?O(L):L)}return C}function c(S,k){return S.minX=Math.min(S.minX,k.minX),S.minY=Math.min(S.minY,k.minY),S.maxX=Math.max(S.maxX,k.maxX),S.maxY=Math.max(S.maxY,k.maxY),S}function d(S,k){return S.minX-k.minX}function h(S,k){return S.minY-k.minY}function f(S){return(S.maxX-S.minX)*(S.maxY-S.minY)}function g(S){return S.maxX-S.minX+(S.maxY-S.minY)}function v(S,k){return(Math.max(k.maxX,S.maxX)-Math.min(k.minX,S.minX))*(Math.max(k.maxY,S.maxY)-Math.min(k.minY,S.minY))}function p(S,k){var A=Math.max(S.minX,k.minX),O=Math.max(S.minY,k.minY),C=Math.min(S.maxX,k.maxX),P=Math.min(S.maxY,k.maxY);return Math.max(0,C-A)*Math.max(0,P-O)}function y(S,k){return S.minX<=k.minX&&S.minY<=k.minY&&k.maxX<=S.maxX&&k.maxY<=S.maxY}function b(S,k){return k.minX<=S.maxX&&k.minY<=S.maxY&&k.maxX>=S.minX&&k.maxY>=S.minY}function E(S){return{children:S,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(S,k,A,O,C){for(var P=[k,A];P.length;)if(A=P.pop(),k=P.pop(),!(A-k<=O)){var L=k+Math.ceil((A-k)/O/2)*O;t(S,L,k,A,C),P.push(k,L,L,A)}}return a})})(vy);var vM=vy.exports,ee=function(r){return r.GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r}({}),jl=function(r){return r[r.ZERO=0]="ZERO",r[r.NEGATIVE_ONE=1]="NEGATIVE_ONE",r}({}),Xi=function(){function r(){oe(this,r),this.plugins=[]}return le(r,[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(n){var i=t.context.renderingPlugins.indexOf(n);i>=0&&t.context.renderingPlugins.splice(i,1)})}}])}(),mM=function(){function r(e){oe(this,r),this.clipSpaceNearZ=jl.NEGATIVE_ONE,this.plugins=[],this.config=We({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}return le(r,[{key:"registerPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n===-1&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n>-1&&this.plugins.splice(n,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find(function(n){return n.name===t})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),nd=ji,zs=jr,yM=BE,bM=jE,tp=Hl,rd=WE,ct=function(){function r(){oe(this,r),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return le(r,[{key:"update",value:function(t,n){zs(this.center,t),zs(this.halfExtents,n),rd(this.min,this.center,this.halfExtents),nd(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,n){nd(this.center,n,t),tp(this.center,this.center,.5),rd(this.halfExtents,n,t),tp(this.halfExtents,this.halfExtents,.5),zs(this.min,t),zs(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){if(!r.isEmpty(t)){if(r.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,i=n[0],s=n[1],a=n[2],o=this.halfExtents,l=o[0],u=o[1],c=o[2],d=i-l,h=i+l,f=s-u,g=s+u,v=a-c,p=a+c,y=t.center,b=y[0],E=y[1],T=y[2],S=t.halfExtents,k=S[0],A=S[1],O=S[2],C=b-k,P=b+k,L=E-A,R=E+A,z=T-O,Y=T+O;C<d&&(d=C),P>h&&(h=P),L<f&&(f=L),R>g&&(g=R),z<v&&(v=z),Y>p&&(p=Y),n[0]=(d+h)*.5,n[1]=(f+g)*.5,n[2]=(v+p)*.5,o[0]=(h-d)*.5,o[1]=(g-f)*.5,o[2]=(p-v)*.5,this.min[0]=d,this.min[1]=f,this.min[2]=v,this.max[0]=h,this.max[1]=g,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(t,n){var i=this.center,s=this.halfExtents,a=t.center,o=t.halfExtents,l=n[0],u=n[4],c=n[8],d=n[1],h=n[5],f=n[9],g=n[2],v=n[6],p=n[10],y=Math.abs(l),b=Math.abs(u),E=Math.abs(c),T=Math.abs(d),S=Math.abs(h),k=Math.abs(f),A=Math.abs(g),O=Math.abs(v),C=Math.abs(p);i[0]=n[12]+l*a[0]+u*a[1]+c*a[2],i[1]=n[13]+d*a[0]+h*a[1]+f*a[2],i[2]=n[14]+g*a[0]+v*a[1]+p*a[2],s[0]=y*o[0]+b*o[1]+E*o[2],s[1]=T*o[0]+S*o[1]+k*o[2],s[2]=A*o[0]+O*o[1]+C*o[2],rd(this.min,i,s),nd(this.max,i,s)}},{key:"intersects",value:function(t){var n=this.getMax(),i=this.getMin(),s=t.getMax(),a=t.getMin();return i[0]<=s[0]&&n[0]>=a[0]&&i[1]<=s[1]&&n[1]>=a[1]&&i[2]<=s[2]&&n[2]>=a[2]}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new r,i=yM([0,0,0],this.getMin(),t.getMin()),s=bM([0,0,0],this.getMax(),t.getMax());return n.setMinMax(i,s),n}},{key:"getNegativeFarPoint",value:function(t){return t.pnVertexFlag===273?zs([0,0,0],this.min):t.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:t.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return t.pnVertexFlag===273?zs([0,0,0],this.max):t.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:t.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||t.halfExtents[0]===0&&t.halfExtents[1]===0&&t.halfExtents[2]===0}}])}(),wM=function(){function r(e,t){oe(this,r),this.distance=e||0,this.normal=t||ht(0,1,0),this.updatePNVertexFlag()}return le(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return Br(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/Km(this.normal);Hl(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,n,i){var s=this.distanceToPoint(t),a=this.distanceToPoint(n),o=s/(s-a),l=o>=0&&o<=1;return l&&i&&Eh(i,t,n,o),l}}])}(),Fs=function(r){return r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE",r}({}),xM=function(){function r(e){if(oe(this,r),this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new wM)}return le(r,[{key:"extractFromVPMatrix",value:function(t){var n=Be(t,16),i=n[0],s=n[1],a=n[2],o=n[3],l=n[4],u=n[5],c=n[6],d=n[7],h=n[8],f=n[9],g=n[10],v=n[11],p=n[12],y=n[13],b=n[14],E=n[15];En(this.planes[0].normal,o-i,d-l,v-h),this.planes[0].distance=E-p,En(this.planes[1].normal,o+i,d+l,v+h),this.planes[1].distance=E+p,En(this.planes[2].normal,o+s,d+u,v+f),this.planes[2].distance=E+y,En(this.planes[3].normal,o-s,d-u,v-f),this.planes[3].distance=E-y,En(this.planes[4].normal,o-a,d-c,v-g),this.planes[4].distance=E-b,En(this.planes[5].normal,o+a,d+c,v+g),this.planes[5].distance=E+b,this.planes.forEach(function(T){T.normalize(),T.updatePNVertexFlag()})}}])}(),hn=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;oe(this,r),this.x=0,this.y=0,this.x=e,this.y=t}return le(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),ca=function(){function r(e,t,n,i){oe(this,r),this.x=e,this.y=t,this.width=n,this.height=i,this.left=e,this.right=e+n,this.top=t,this.bottom=t+i}return le(r,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new r(t.x,t.y,t.width,t.height)}},{key:"applyTransform",value:function(t,n){var i=ja(t.x,t.y,0,1),s=ja(t.x+t.width,t.y,0,1),a=ja(t.x,t.y+t.height,0,1),o=ja(t.x+t.width,t.y+t.height,0,1),l=zr(),u=zr(),c=zr(),d=zr();ai(l,i,n),ai(u,s,n),ai(c,a,n),ai(d,o,n);var h=Math.min(l[0],u[0],c[0],d[0]),f=Math.min(l[1],u[1],c[1],d[1]),g=Math.max(l[0],u[0],c[0],d[0]),v=Math.max(l[1],u[1],c[1],d[1]);return r.fromRect({x:h,y:f,width:g-h,height:v-f})}}])}(),tt="Method not implemented.",$s="Use document.documentElement instead.",EM="Cannot append a destroyed element.";function na(r){return r===void 0?0:r>360||r<-360?r%360:r}var id=Xe();function kn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(r)&&r.length===3?n?Jr(r):jr(id,r):ye(r)?n?ht(r,e,t):En(id,r,e,t):n?ht(r[0],r[1]||e,r[2]||t):En(id,r[0],r[1]||e,r[2]||t)}var MM=Math.PI/180;function nt(r){return r*MM}var SM=180/Math.PI;function Fn(r){return r*SM}function TM(r){return 360*r}var eu=Math.PI/2;function OM(r,e){var t=e[0],n=e[1],i=e[2],s=e[3],a=t*t,o=n*n,l=i*i,u=s*s,c=a+o+l+u,d=t*s-n*i;return d>.499995*c?(r[0]=eu,r[1]=2*Math.atan2(n,t),r[2]=0):d<-.499995*c?(r[0]=-eu,r[1]=2*Math.atan2(n,t),r[2]=0):(r[0]=Math.asin(2*(t*i-s*n)),r[1]=Math.atan2(2*(t*s+n*i),1-2*(l+u)),r[2]=Math.atan2(2*(t*n+i*s),1-2*(o+l))),r}function kM(r,e){var t,n,i=la(Xe(),e),s=Be(i,3),a=s[0],o=s[1],l=s[2],u=Math.asin(-e[2]/a);return u<eu?u>-eu?(t=Math.atan2(e[6]/o,e[10]/l),n=Math.atan2(e[1]/a,e[0]/a)):(n=0,t=-Math.atan2(e[4]/o,e[5]/o)):(n=0,t=Math.atan2(e[4]/o,e[5]/o)),r[0]=t,r[1]=u,r[2]=n,r}function sd(r,e){return e.length===16?kM(r,e):OM(r,e)}function NM(r,e,t,n,i){var s=Math.cos(r),a=Math.sin(r);return mE(n*s,i*a,0,-n*a,i*s,0,e,t,1)}function AM(r,e,t,n,i,s,a){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,l=2*s,u=t-e,c=n-i,d=l/u,h=l/c,f=(t+e)/u,g=(n+i)/c,v,p,y=a-s,b=a*s;return o?(v=-a/y,p=-b/y):(v=-(a+s)/y,p=-2*b/y),r[0]=d,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=f,r[9]=g,r[10]=v,r[11]=-1,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r}function np(r){var e=r[0],t=r[1],n=r[3],i=r[4],s=Math.sqrt(e*e+t*t),a=Math.sqrt(n*n+i*i),o=e*i-t*n;if(o<0&&(e<i?s=-s:a=-a),s){var l=1/s;e*=l,t*=l}if(a){var u=1/a;n*=u,i*=u}var c=Math.atan2(t,e),d=Fn(c);return[r[6],r[7],s,a,d]}var Pr=ut(),mr=ut(),Oa=zr(),Le=[Xe(),Xe(),Xe()],rp=Xe();function CM(r,e,t,n,i,s){if(!PM(Pr,r)||(oa(mr,Pr),mr[3]=0,mr[7]=0,mr[11]=0,mr[15]=1,Math.abs(Rm(mr))<1e-8))return!1;var a=Pr[3],o=Pr[7],l=Pr[11],u=Pr[12],c=Pr[13],d=Pr[14],h=Pr[15];if(a!==0||o!==0||l!==0){Oa[0]=a,Oa[1]=o,Oa[2]=l,Oa[3]=h;var f=Rr(mr,mr);if(!f)return!1;Im(mr,mr),ai(i,Oa,mr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=c,e[2]=d,_M(Le,Pr),t[0]=ti(Le[0]),ms(Le[0],Le[0]),n[0]=Br(Le[0],Le[1]),ad(Le[1],Le[1],Le[0],1,-n[0]),t[1]=ti(Le[1]),ms(Le[1],Le[1]),n[0]/=t[1],n[1]=Br(Le[0],Le[2]),ad(Le[2],Le[2],Le[0],1,-n[1]),n[2]=Br(Le[1],Le[2]),ad(Le[2],Le[2],Le[1],1,-n[2]),t[2]=ti(Le[2]),ms(Le[2],Le[2]),n[1]/=t[2],n[2]/=t[2],Il(rp,Le[1],Le[2]),Br(Le[0],rp)<0)for(var g=0;g<3;g++)t[g]*=-1,Le[g][0]*=-1,Le[g][1]*=-1,Le[g][2]*=-1;return s[0]=.5*Math.sqrt(Math.max(1+Le[0][0]-Le[1][1]-Le[2][2],0)),s[1]=.5*Math.sqrt(Math.max(1-Le[0][0]+Le[1][1]-Le[2][2],0)),s[2]=.5*Math.sqrt(Math.max(1-Le[0][0]-Le[1][1]+Le[2][2],0)),s[3]=.5*Math.sqrt(Math.max(1+Le[0][0]+Le[1][1]+Le[2][2],0)),Le[2][1]>Le[1][2]&&(s[0]=-s[0]),Le[0][2]>Le[2][0]&&(s[1]=-s[1]),Le[1][0]>Le[0][1]&&(s[2]=-s[2]),!0}function PM(r,e){var t=e[15];if(t===0)return!1;for(var n=1/t,i=0;i<16;i++)r[i]=e[i]*n;return!0}function _M(r,e){r[0][0]=e[0],r[0][1]=e[1],r[0][2]=e[2],r[1][0]=e[4],r[1][1]=e[5],r[1][2]=e[6],r[2][0]=e[8],r[2][1]=e[9],r[2][2]=e[10]}function ad(r,e,t,n,i){r[0]=e[0]*n+t[0]*i,r[1]=e[1]*n+t[1]*i,r[2]=e[2]*n+t[2]*i}var et=function(r){return r[r.ORBITING=0]="ORBITING",r[r.EXPLORING=1]="EXPLORING",r[r.TRACKING=2]="TRACKING",r}({}),_h=function(r){return r[r.DEFAULT=0]="DEFAULT",r[r.ROTATIONAL=1]="ROTATIONAL",r[r.TRANSLATIONAL=2]="TRANSLATIONAL",r[r.CINEMATIC=3]="CINEMATIC",r}({}),ur=function(r){return r[r.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",r[r.PERSPECTIVE=1]="PERSPECTIVE",r}({}),my={UPDATED:"updated"},ip=2e-4,yy=function(){function r(){oe(this,r),this.clipSpaceNearZ=jl.NEGATIVE_ONE,this.eventEmitter=new kf,this.matrix=ut(),this.right=ht(1,0,0),this.up=ht(0,1,0),this.forward=ht(0,0,1),this.position=ht(0,0,1),this.focalPoint=ht(0,0,0),this.distanceVector=ht(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=ut(),this.projectionMatrixInverse=ut(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=et.EXPLORING,this.trackingMode=_h.DEFAULT,this.projectionMode=ur.PERSPECTIVE,this.frustum=new xM,this.orthoMatrix=ut()}return le(r,[{key:"isOrtho",value:function(){return this.projectionMode===ur.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,n){return this.type=t,this.type===et.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===et.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==et.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return Rr(ut(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,n){var i=Oi(ut(),[t,n,0]);this.jitteredProjectionMatrix=Mn(ut(),i,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===ur.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===ur.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,n,i,s,a,o){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=s,this.view.width=a,this.view.height=o,this.projectionMode===ur.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===ur.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===ur.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===ur.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,n){var i=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),s=i.x,a=i.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(s,a),this.setFocalPoint(s,a),this.setZoom(t),this.rotate(0,0,o);var l=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),u=l.x,c=l.y,d=ht(u-s,c-a,0),h=Br(d,this.right)/ti(this.right),f=Br(d,this.up)/ti(this.up),g=this.getPosition(),v=Be(g,2),p=v[0],y=v[1],b=this.getFocalPoint(),E=Be(b,2),T=E[0],S=E[1];return this.setPosition(p-h,y-f),this.setFocalPoint(T-h,S-f),this}},{key:"setPerspective",value:function(t,n,i,s){var a;this.projectionMode=ur.PERSPECTIVE,this.fov=i,this.near=t,this.far=n,this.aspect=s;var o=this.near*Math.tan(nt(.5*this.fov))/this.zoom,l=2*o,u=this.aspect*l,c=-.5*u;if((a=this.view)!==null&&a!==void 0&&a.enabled){var d=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*u/d,o-=this.view.offsetY*l/h,u*=this.view.width/d,l*=this.view.height/h}return AM(this.projectionMatrix,c,c+u,o-l,o,t,this.far,this.clipSpaceNearZ===jl.ZERO),Rr(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,n,i,s,a,o){var l;this.projectionMode=ur.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=i,this.bottom=s,this.near=a,this.far=o;var u=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=d-u,g=d+u,v=h+c,p=h-c;if((l=this.view)!==null&&l!==void 0&&l.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=y*this.view.offsetX,g=f+y*this.view.width,v-=b*this.view.offsetY,p=v-b*this.view.height}return this.clipSpaceNearZ===jl.NEGATIVE_ONE?Um(this.projectionMatrix,f,g,v,p,a,o):Hm(this.projectionMatrix,f,g,v,p,a,o),Rr(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],s=kn(t,n,i);return this._setPosition(s),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],s=ht(0,1,0);if(this.focalPoint=kn(t,n,i),this.trackingMode===_h.CINEMATIC){var a=xh(Xe(),this.focalPoint,this.position);t=a[0],n=a[1],i=a[2];var o=ti(a),l=Fn(Math.asin(n/o)),u=90+Fn(Math.atan2(i,t)),c=ut();zm(c,c,nt(u)),Bm(c,c,nt(l)),s=Sn(Xe(),[0,1,0],c)}return Rr(this.matrix,Xm(ut(),this.position,this.focalPoint,s)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<ip&&(this.distance=ip),this.dollyingStep=this.distance/100;var n=Xe();t=this.distance;var i=this.forward,s=this.focalPoint;return n[0]=t*i[0]+s[0],n[1]=t*i[1]+s[1],n[2]=t*i[2]+s[2],this._setPosition(n),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=na(t),this.computeMatrix(),this._getAxes(),this.type===et.ORBITING||this.type===et.EXPLORING?this._getPosition():this.type===et.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=na(t),this.computeMatrix(),this._getAxes(),this.type===et.ORBITING||this.type===et.EXPLORING?this._getPosition():this.type===et.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=na(t),this.computeMatrix(),this._getAxes(),this.type===et.ORBITING||this.type===et.EXPLORING?this._getPosition():this.type===et.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Ni(qt(),[0,0,1],nt(this.roll));Wi(this.matrix);var n=Ni(qt(),[1,0,0],nt((this.rotateWorld&&this.type!==et.TRACKING||this.type===et.TRACKING?1:-1)*this.elevation)),i=Ni(qt(),[0,1,0],nt((this.rotateWorld&&this.type!==et.TRACKING||this.type===et.TRACKING?1:-1)*this.azimuth)),s=Bi(qt(),i,n);s=Bi(qt(),s,t);var a=Nf(ut(),s);this.type===et.ORBITING||this.type===et.EXPLORING?(ta(this.matrix,this.matrix,this.focalPoint),Mn(this.matrix,this.matrix,a),ta(this.matrix,this.matrix,[0,0,this.distance])):this.type===et.TRACKING&&(ta(this.matrix,this.matrix,this.position),Mn(this.matrix,this.matrix,a))}},{key:"_setPosition",value:function(t,n,i){this.position=kn(t,n,i);var s=this.matrix;s[12]=this.position[0],s[13]=this.position[1],s[14]=this.position[2],s[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){jr(this.right,kn(ai(zr(),[1,0,0,0],this.matrix))),jr(this.up,kn(ai(zr(),[0,1,0,0],this.matrix))),jr(this.forward,kn(ai(zr(),[0,0,1,0],this.matrix))),ms(this.right,this.right),ms(this.up,this.up),ms(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],s=ti(this.distanceVector);if(s===0){this.elevation=0,this.azimuth=0;return}this.type===et.TRACKING?(this.elevation=Fn(Math.asin(n/s)),this.azimuth=Fn(Math.atan2(-t,-i))):this.rotateWorld?(this.elevation=Fn(Math.asin(n/s)),this.azimuth=Fn(Math.atan2(-t,-i))):(this.elevation=-Fn(Math.asin(n/s)),this.azimuth=-Fn(Math.atan2(-t,-i)))}},{key:"_getPosition",value:function(){jr(this.position,kn(ai(zr(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){FE(this.distanceVector,[0,0,-this.distance],vE(_m(),this.matrix)),ji(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=xh(Xe(),this.focalPoint,this.position),this.distance=ti(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===ur.ORTHOGRAPHIC){var t=this.position,n=Ni(qt(),[0,0,1],-this.roll*Math.PI/180);Va(this.orthoMatrix,n,ht((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),ht(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),n=Mn(ut(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(my.UPDATED)}}},{key:"rotate",value:function(t,n,i){throw new Error(tt)}},{key:"pan",value:function(t,n){throw new Error(tt)}},{key:"dolly",value:function(t){throw new Error(tt)}},{key:"createLandmark",value:function(t,n){throw new Error(tt)}},{key:"gotoLandmark",value:function(t,n){throw new Error(tt)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(tt)}}])}(),LM=function(r){return r[r.Standard=0]="Standard",r}({}),tu=function(r){return r[r.ADDED=0]="ADDED",r[r.REMOVED=1]="REMOVED",r[r.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",r}({}),by={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ca(0,0,0,0)},ve=function(r){return r.COORDINATE="<coordinate>",r.COLOR="<color>",r.PAINT="<paint>",r.NUMBER="<number>",r.ANGLE="<angle>",r.OPACITY_VALUE="<opacity-value>",r.SHADOW_BLUR="<shadow-blur>",r.LENGTH="<length>",r.PERCENTAGE="<percentage>",r.LENGTH_PERCENTAGE="<length> | <percentage>",r.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",r.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",r.LIST_OF_POINTS="<list-of-points>",r.PATH="<path>",r.FILTER="<filter>",r.Z_INDEX="<z-index>",r.OFFSET_DISTANCE="<offset-distance>",r.DEFINED_PATH="<defined-path>",r.MARKER="<marker>",r.TRANSFORM="<transform>",r.TRANSFORM_ORIGIN="<transform-origin>",r.TEXT="<text>",r.TEXT_TRANSFORM="<text-transform>",r}({});function Dn(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];var o=e?e.apply(this,s):s[0],l=t.cache;if(l.has(o))return l.get(o);var u=r.apply(this,s);return t.cache=l.set(o,u)||l,u};return t.cache=new(Dn.Cache||Map),t}Dn.Cache=Map;var me=function(r){return r[r.kUnknown=0]="kUnknown",r[r.kNumber=1]="kNumber",r[r.kPercentage=2]="kPercentage",r[r.kEms=3]="kEms",r[r.kPixels=4]="kPixels",r[r.kRems=5]="kRems",r[r.kDegrees=6]="kDegrees",r[r.kRadians=7]="kRadians",r[r.kGradians=8]="kGradians",r[r.kTurns=9]="kTurns",r[r.kMilliseconds=10]="kMilliseconds",r[r.kSeconds=11]="kSeconds",r[r.kInteger=12]="kInteger",r}({}),wr=function(r){return r[r.kUNumber=0]="kUNumber",r[r.kUPercent=1]="kUPercent",r[r.kULength=2]="kULength",r[r.kUAngle=3]="kUAngle",r[r.kUTime=4]="kUTime",r[r.kUOther=5]="kUOther",r}({}),DM=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),IM=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),RM=[{name:"em",unit_type:me.kEms},{name:"px",unit_type:me.kPixels},{name:"deg",unit_type:me.kDegrees},{name:"rad",unit_type:me.kRadians},{name:"grad",unit_type:me.kGradians},{name:"ms",unit_type:me.kMilliseconds},{name:"s",unit_type:me.kSeconds},{name:"rem",unit_type:me.kRems},{name:"turn",unit_type:me.kTurns}],da=function(r){return r[r.kUnknownType=0]="kUnknownType",r[r.kUnparsedType=1]="kUnparsedType",r[r.kKeywordType=2]="kKeywordType",r[r.kUnitType=3]="kUnitType",r[r.kSumType=4]="kSumType",r[r.kProductType=5]="kProductType",r[r.kNegateType=6]="kNegateType",r[r.kInvertType=7]="kInvertType",r[r.kMinType=8]="kMinType",r[r.kMaxType=9]="kMaxType",r[r.kClampType=10]="kClampType",r[r.kTransformType=11]="kTransformType",r[r.kPositionType=12]="kPositionType",r[r.kURLImageType=13]="kURLImageType",r[r.kColorType=14]="kColorType",r[r.kUnsupportedColorType=15]="kUnsupportedColorType",r}({}),jM=function(e){return RM.find(function(t){return t.name===e}).unit_type},BM=function(e){return e?e==="number"?me.kNumber:e==="percent"||e==="%"?me.kPercentage:jM(e):me.kUnknown},zM=function(e){switch(e){case me.kNumber:case me.kInteger:return wr.kUNumber;case me.kPercentage:return wr.kUPercent;case me.kPixels:return wr.kULength;case me.kMilliseconds:case me.kSeconds:return wr.kUTime;case me.kDegrees:case me.kRadians:case me.kGradians:case me.kTurns:return wr.kUAngle;default:return wr.kUOther}},FM=function(e){switch(e){case wr.kUNumber:return me.kNumber;case wr.kULength:return me.kPixels;case wr.kUPercent:return me.kPercentage;case wr.kUTime:return me.kSeconds;case wr.kUAngle:return me.kDegrees;default:return me.kUnknown}},sp=function(e){var t=1;switch(e){case me.kPixels:case me.kDegrees:case me.kSeconds:break;case me.kMilliseconds:t=.001;break;case me.kRadians:t=180/Math.PI;break;case me.kGradians:t=.9;break;case me.kTurns:t=360;break}return t},Lh=function(e){switch(e){case me.kNumber:case me.kInteger:return"";case me.kPercentage:return"%";case me.kEms:return"em";case me.kRems:return"rem";case me.kPixels:return"px";case me.kDegrees:return"deg";case me.kRadians:return"rad";case me.kGradians:return"grad";case me.kMilliseconds:return"ms";case me.kSeconds:return"s";case me.kTurns:return"turn"}return""},Nu=function(){function r(){oe(this,r)}return le(r,[{key:"toString",value:function(){return this.buildCSSText(DM.kNo,IM.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=da.kUnitType&&this.getType()<=da.kClampType}}],[{key:"isAngle",value:function(t){return t===me.kDegrees||t===me.kRadians||t===me.kGradians||t===me.kTurns}},{key:"isLength",value:function(t){return t>=me.kEms&&t<me.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===me.kPercentage||t===me.kEms||t===me.kRems}},{key:"isTime",value:function(t){return t===me.kSeconds||t===me.kMilliseconds}}])}(),$M=function(r){function e(t){var n;return oe(this,e),n=Fe(this,e),n.colorSpace=t,n}return $e(e,r),le(e,[{key:"getType",value:function(){return da.kColorType}},{key:"to",value:function(n){return this}}])}(Nu),Ai=function(r){return r[r.Constant=0]="Constant",r[r.LinearGradient=1]="LinearGradient",r[r.RadialGradient=2]="RadialGradient",r}({}),Go=function(r){function e(t,n){var i;return oe(this,e),i=Fe(this,e),i.type=t,i.value=n,i}return $e(e,r),le(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(n,i,s){return s}},{key:"getType",value:function(){return da.kColorType}}])}(Nu),gr=function(r){function e(t){var n;return oe(this,e),n=Fe(this,e),n.value=t,n}return $e(e,r),le(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return da.kKeywordType}},{key:"buildCSSText",value:function(n,i,s){return s+this.value}}])}(Nu),WM=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n="";return Number.isFinite(e)?n="NaN":e>0?n="infinity":n="-infinity",n+=t},Dh=function(e){return FM(zM(e))},sn=function(r){function e(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:me.kNumber;oe(this,e),n=Fe(this,e);var s;return typeof i=="string"?s=BM(i):s=i,n.unit=s,n.value=t,n}return $e(e,r),le(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(n){var i=n;return this.value===i.value&&this.unit===i.unit}},{key:"getType",value:function(){return da.kUnitType}},{key:"convertTo",value:function(n){if(this.unit===n)return new e(this.value,this.unit);var i=Dh(this.unit);if(i!==Dh(n)||i===me.kUnknown)return null;var s=sp(this.unit)/sp(n);return new e(this.value*s,n)}},{key:"buildCSSText",value:function(n,i,s){var a;switch(this.unit){case me.kUnknown:break;case me.kInteger:a=Number(this.value).toFixed(0);break;case me.kNumber:case me.kPercentage:case me.kEms:case me.kRems:case me.kPixels:case me.kDegrees:case me.kRadians:case me.kGradians:case me.kMilliseconds:case me.kSeconds:case me.kTurns:{var o=-999999,l=999999,u=this.value,c=Lh(this.unit);if(u<o||u>l){var d=Lh(this.unit);!Number.isFinite(u)||Number.isNaN(u)?a=WM(u,d):a=u+(d||"")}else a="".concat(u).concat(c)}}return s+=a,s}}])}(Nu),yr=new sn(0,"px");new sn(1,"px");var Es=new sn(0,"deg"),_f=function(r){function e(t,n,i){var s,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return oe(this,e),s=Fe(this,e,["rgb"]),s.r=t,s.g=n,s.b=i,s.alpha=a,s.isNone=o,s}return $e(e,r),le(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(n,i,s){return"".concat(s,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}($M),ap=new gr("unset"),GM=new gr("initial"),YM=new gr("inherit"),od={"":ap,unset:ap,initial:GM,inherit:YM},VM=function(e){return od[e]||(od[e]=new gr(e)),od[e]},wy=new _f(0,0,0,0,!0),xy=new _f(0,0,0,0),UM=Dn(function(r,e,t,n){return new _f(r,e,t,n)},function(r,e,t,n){return"rgba(".concat(r,",").concat(e,",").concat(t,",").concat(n,")")}),xt=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:me.kNumber;return new sn(e,t)};new sn(50,"%");function HM(r){var e=r.type,t=r.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var XM=function(){var r={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(W){throw new Error("".concat(e,": ").concat(W))}function n(){var W=i();return e.length>0&&t("Invalid input not EOF"),W}function i(){return E(s)}function s(){return a("linear-gradient",r.linearGradient,l)||a("repeating-linear-gradient",r.repeatingLinearGradient,l)||a("radial-gradient",r.radialGradient,d)||a("repeating-radial-gradient",r.repeatingRadialGradient,d)||a("conic-gradient",r.conicGradient,d)}function a(W,F,K){return o(F,function(re){var se=K();return se&&(U(r.comma)||t("Missing comma before color stops")),{type:W,orientation:se,colorStops:E(T)}})}function o(W,F){var K=U(W);if(K){U(r.startCall)||t("Missing (");var re=F(K);return U(r.endCall)||t("Missing )"),re}}function l(){return u()||c()}function u(){return Y("directional",r.sideOrCorner,1)}function c(){return Y("angular",r.angleValue,1)}function d(){var W,F=h(),K;return F&&(W=[],W.push(F),K=e,U(r.comma)&&(F=h(),F?W.push(F):e=K)),W}function h(){var W=f()||g();if(W)W.at=p();else{var F=v();if(F){W=F;var K=p();K&&(W.at=K)}else{var re=y();re&&(W={type:"default-radial",at:re})}}return W}function f(){var W=Y("shape",/^(circle)/i,0);return W&&(W.style=z()||v()),W}function g(){var W=Y("shape",/^(ellipse)/i,0);return W&&(W.style=L()||v()),W}function v(){return Y("extent-keyword",r.extentKeywords,1)}function p(){if(Y("position",/^at/,0)){var W=y();return W||t("Missing positioning value"),W}}function y(){var W=b();if(W.x||W.y)return{type:"position",value:W}}function b(){return{x:L(),y:L()}}function E(W){var F=W(),K=[];if(F)for(K.push(F);U(r.comma);)F=W(),F?K.push(F):t("One extra comma");return K}function T(){var W=S();return W||t("Expected color definition"),W.length=L(),W}function S(){return A()||C()||O()||k()}function k(){return Y("literal",r.literalColor,0)}function A(){return Y("hex",r.hexColor,1)}function O(){return o(r.rgbColor,function(){return{type:"rgb",value:E(P)}})}function C(){return o(r.rgbaColor,function(){return{type:"rgba",value:E(P)}})}function P(){return U(r.number)[1]}function L(){return Y("%",r.percentageValue,1)||R()||z()}function R(){return Y("position-keyword",r.positionKeywords,1)}function z(){return Y("px",r.pixelValue,1)||Y("em",r.emValue,1)}function Y(W,F,K){var re=U(F);if(re)return{type:W,value:re[K]}}function U(W){var F=/^[\n\r\t\s]+/.exec(e);F&&V(F[0].length);var K=W.exec(e);return K&&V(K[0].length),K}function V(W){e=e.substring(W)}return function(W){return e=W,n()}}();function qM(r,e,t,n){var i=nt(n.value),s=0,a=0,o=s+e/2,l=a+t/2,u=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),c=r[0]+o-Math.cos(i)*u/2,d=r[1]+l-Math.sin(i)*u/2,h=r[0]+o+Math.cos(i)*u/2,f=r[1]+l+Math.sin(i)*u/2;return{x1:c,y1:d,x2:h,y2:f}}function ZM(r,e,t,n,i,s){var a=n.value,o=i.value;n.unit===me.kPercentage&&(a=n.value/100*e),i.unit===me.kPercentage&&(o=i.value/100*t);var l=Math.max(zn([0,0],[a,o]),zn([0,t],[a,o]),zn([e,t],[a,o]),zn([e,0],[a,o]));return s&&(s instanceof sn?l=s.value:s instanceof gr&&(s.value==="closest-side"?l=Math.min(a,e-a,o,t-o):s.value==="farthest-side"?l=Math.max(a,e-a,o,t-o):s.value==="closest-corner"&&(l=Math.min(zn([0,0],[a,o]),zn([0,t],[a,o]),zn([e,t],[a,o]),zn([e,0],[a,o]))))),{x:a+r[0],y:o+r[1],r:l}}var KM=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,QM=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,JM=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Ey=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function eS(r){var e,t=r.length;if(r[t-1].length=(e=r[t-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},t>1){var n;r[0].length=(n=r[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"}}for(var i=0,s=Number(r[0].length.value),a=1;a<t;a++){var o,l=(o=r[a].length)===null||o===void 0?void 0:o.value;if(!Ae(l)&&!Ae(s)){for(var u=1;u<a-i;u++)r[i+u].length={type:"%",value:"".concat(s+(Number(l)-s)*u/(a-i))};i=a,s=Number(l)}}}var tS={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},nS=Dn(function(r){var e;return r.type==="angular"?e=Number(r.value):e=tS[r.value]||0,xt(e,"deg")}),rS=Dn(function(r){var e=50,t=50,n="%",i="%";if((r==null?void 0:r.type)==="position"){var s=r.value,a=s.x,o=s.y;(a==null?void 0:a.type)==="position-keyword"&&(a.value==="left"?e=0:a.value==="center"?e=50:a.value==="right"?e=100:a.value==="top"?t=0:a.value==="bottom"&&(t=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?t=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),((a==null?void 0:a.type)==="px"||(a==null?void 0:a.type)==="%"||(a==null?void 0:a.type)==="em")&&(n=a==null?void 0:a.type,e=Number(a.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,t=Number(o.value))}return{cx:xt(e,n),cy:xt(t,i)}}),iS=Dn(function(r){if(r.indexOf("linear")>-1||r.indexOf("radial")>-1){var e=XM(r);return e.map(function(o){var l=o.type,u=o.orientation,c=o.colorStops;eS(c);var d=c.map(function(E){return{offset:xt(Number(E.length.value),"%"),color:HM(E)}});if(l==="linear-gradient")return new Go(Ai.LinearGradient,{angle:u?nS(u):Es,steps:d});if(l==="radial-gradient"&&(u||(u=[{type:"shape",value:"circle"}]),u[0].type==="shape"&&u[0].value==="circle")){var h=rS(u[0].at),f=h.cx,g=h.cy,v;if(u[0].style){var p=u[0].style,y=p.type,b=p.value;y==="extent-keyword"?v=VM(b):v=xt(b,y)}return new Go(Ai.RadialGradient,{cx:f,cy:g,size:v,steps:d})}})}var t=r[0];if(r[1]==="("||r[2]==="("){if(t==="l"){var n=KM.exec(r);if(n){var i,s=((i=n[2].match(Ey))===null||i===void 0?void 0:i.map(function(o){return o.split(":")}))||[];return[new Go(Ai.LinearGradient,{angle:xt(parseFloat(n[1]),"deg"),steps:s.map(function(o){var l=Be(o,2),u=l[0],c=l[1];return{offset:xt(Number(u)*100,"%"),color:c}})})]}}else if(t==="r"){var a=sS(r);if(a)if(Ke(a))r=a;else return[new Go(Ai.RadialGradient,a)]}else if(t==="p")return aS(r)}});function sS(r){var e=QM.exec(r);if(e){var t,n=((t=e[4].match(Ey))===null||t===void 0?void 0:t.map(function(i){return i.split(":")}))||[];return{cx:xt(50,"%"),cy:xt(50,"%"),steps:n.map(function(i){var s=Be(i,2),a=s[0],o=s[1];return{offset:xt(Number(a)*100,"%"),color:o}})}}return null}function aS(r){var e=JM.exec(r);if(e){var t=e[1],n=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:n,repetition:t}}return null}function Ms(r){return r&&!!r.image}function nu(r){return r&&!Ae(r.r)&&!Ae(r.g)&&!Ae(r.b)}var Xa=Dn(function(r){if(Ms(r))return We({repetition:"repeat"},r);if(Ae(r)&&(r=""),r==="transparent")return xy;if(r==="currentColor")r="black";else if(r==="none")return wy;var e=iS(r);if(e)return e;var t=fx(r),n=[0,0,0,0];return t!==null&&(n[0]=t.r||0,n[1]=t.g||0,n[2]=t.b||0,n[3]=t.opacity),UM.apply(void 0,n)});function oS(r,e){if(!(!nu(r)||!nu(e)))return[[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var n=t.slice();if(n[3])for(var i=0;i<3;i++)n[i]=Math.round(At(n[i],0,255));return n[3]=At(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function mo(r,e){if(Ae(e))return xt(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(r)>=0)return xt(Number(e),"px");if("deg".search(r)>=0)return xt(Number(e),"deg")}var t=[];e=e.replace(r,function(i){return t.push(i),"U".concat(i)});var n="U(".concat(r.source,")");return t.map(function(i){return xt(Number(e.replace(new RegExp("U".concat(i),"g"),"").replace(new RegExp(n,"g"),"*0")),i)})[0]}var My=function(e){return mo(new RegExp("px","g"),e)},lS=Dn(My),uS=function(e){return mo(new RegExp("%","g"),e)};Dn(uS);var Sy=function(e){return ye(e)||isFinite(Number(e))?xt(Number(e)||0,"px"):mo(new RegExp("px|%|em|rem","g"),e)},Ih=Dn(Sy),Ty=function(e){return mo(new RegExp("deg|rad|grad|turn","g"),e)},cS=Dn(Ty);function dS(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,s="",a=r.value||0,o=e.value||0,l=Dh(r.unit),u=r.convertTo(l),c=e.convertTo(l);return u&&c?(a=u.value,o=c.value,s=Lh(r.unit)):(sn.isLength(r.unit)||sn.isLength(e.unit))&&(a=Xn(r,i,t),o=Xn(e,i,t),s="px"),[a,o,function(d){return d+s}]}function $n(r){var e=0;return r.unit===me.kDegrees?e=r.value:r.unit===me.kRadians?e=Fn(Number(r.value)):r.unit===me.kTurns?e=TM(Number(r.value)):r.value&&(e=r.value),e}function op(r,e){var t;return Array.isArray(r)?t=r.map(function(n){return Number(n)}):Ke(r)?t=r.split(" ").map(function(n){return Number(n)}):ye(r)&&(t=[r]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function Xn(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.unit===me.kPixels)return Number(r.value);if(r.unit===me.kPercentage&&t){var i=t.nodeName===ee.GROUP?t.getLocalBounds():t.getGeometryBounds();return(n?i.min[e]:0)+r.value/100*i.halfExtents[e]*2}return 0}var hS=function(e){return mo(/deg|rad|grad|turn|px|%/g,e)},fS=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function gS(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(r=r.toLowerCase().trim(),r==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],n,i=0;n=e.exec(r);){if(n.index!==i)return[];if(i=n.index+n[0].length,fS.indexOf(n[1])>-1&&t.push({name:n[1],params:n[2].split(" ").map(function(s){return hS(s)||Xa(s)})}),e.lastIndex===r.length)return t}return[]}function Oy(r){return r.toString()}var ky=function(e){return typeof e=="number"?xt(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?xt(Number(e)):xt(0)},Rh=Dn(ky);Dn(function(r){return Ke(r)?r.split(" ").map(Rh):r.map(Rh)});function Lf(r,e){return[r,e,Oy]}function Df(r,e){return function(t,n){return[t,n,function(i){return Oy(At(i,r,e))}]}}function Ny(r,e){if(r.length===e.length)return[r,e,function(t){return t}]}function jh(r){return r.parsedStyle.d.totalLength===0&&(r.parsedStyle.d.totalLength=U2(r.parsedStyle.d.absolutePath)),r.parsedStyle.d.totalLength}function pS(r){return r.parsedStyle.points.totalLength===0&&(r.parsedStyle.points.totalLength=cM(r.parsedStyle.points.points)),r.parsedStyle.points.totalLength}function vS(r){for(var e=0;e<r.length;e++){var t=r[e-1],n=r[e],i=n[0];if(i==="M"&&t){var s=t[0],a=[n[1],n[2]],o=void 0;s==="L"||s==="M"?o=[t[1],t[2]]:(s==="C"||s==="A"||s==="Q")&&(o=[t[t.length-2],t[t.length-1]]),o&&ru(a,o)&&(r.splice(e,1),e--)}}}function mS(r){for(var e=!1,t=r.length,n=0;n<t;n++){var i=r[n],s=i[0];if(s==="C"||s==="A"||s==="Q"){e=!0;break}}return e}function yS(r){for(var e=[],t=[],n=[],i=0;i<r.length;i++){var s=r[i],a=s[0];a==="M"?(n.length&&(t.push(n),n=[]),n.push([s[1],s[2]])):a==="Z"?n.length&&(e.push(n),n=[]):n.push([s[1],s[2]])}return n.length>0&&t.push(n),{polygons:e,polylines:t}}function ru(r,e){return r[0]===e[0]&&r[1]===e[1]}function bS(r,e){for(var t=[],n=[],i=[],s=0;s<r.length;s++){var a=r[s],o=a.currentPoint,l=a.params,u=a.prePoint,c=void 0;switch(a.command){case"Q":c=dM(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":c=oM(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var d=a.arcParams;c=iM(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:t.push(o[0]),n.push(o[1]);break}c&&(a.box=c,t.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height))}t=t.filter(function(T){return!Number.isNaN(T)&&T!==1/0&&T!==-1/0}),n=n.filter(function(T){return!Number.isNaN(T)&&T!==1/0&&T!==-1/0});var h=Zl(t),f=Zl(n),g=ql(t),v=ql(n);if(i.length===0)return{x:h,y:f,width:g-h,height:v-f};for(var p=0;p<i.length;p++){var y=i[p],b=y.currentPoint,E=void 0;b[0]===h?(E=Yo(y,e),h-=E.xExtra):b[0]===g&&(E=Yo(y,e),g+=E.xExtra),b[1]===f?(E=Yo(y,e),f-=E.yExtra):b[1]===v&&(E=Yo(y,e),v+=E.yExtra)}return{x:h,y:f,width:g-h,height:v-f}}function Yo(r,e){var t=r.prePoint,n=r.currentPoint,i=r.nextPoint,s=Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2),a=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),o=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((s+a-o)/(2*Math.sqrt(s)*Math.sqrt(a)));if(!l||Math.sin(l)===0||Ua(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),c=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));u=u>Math.PI/2?Math.PI-u:u,c=c>Math.PI/2?Math.PI-c:c;var d={xExtra:Math.cos(l/2-u)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(c-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return d}function lp(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}var up=function(e,t){var n=e.x*t.x+e.y*t.y,i=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2))),s=e.x*t.y-e.y*t.x<0?-1:1,a=s*Math.acos(n/i);return a},cp=function(e,t,n,i,s,a,o,l){t=Math.abs(t),n=Math.abs(n),i=ey(i,360);var u=nt(i);if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(e.x-o.x)/2,d=(e.y-o.y)/2,h={x:Math.cos(u)*c+Math.sin(u)*d,y:-Math.sin(u)*c+Math.cos(u)*d},f=Math.pow(h.x,2)/Math.pow(t,2)+Math.pow(h.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2),v=Math.pow(t,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2),p=g/v;p=p<0?0:p;var y=(s!==a?1:-1)*Math.sqrt(p),b={x:y*(t*h.y/n),y:y*(-(n*h.x)/t)},E={x:Math.cos(u)*b.x-Math.sin(u)*b.y+(e.x+o.x)/2,y:Math.sin(u)*b.x+Math.cos(u)*b.y+(e.y+o.y)/2},T={x:(h.x-b.x)/t,y:(h.y-b.y)/n},S=up({x:1,y:0},T),k={x:(-h.x-b.x)/t,y:(-h.y-b.y)/n},A=up(T,k);!a&&A>0?A-=2*Math.PI:a&&A<0&&(A+=2*Math.PI),A%=2*Math.PI;var O=S+A*l,C=t*Math.cos(O),P=n*Math.sin(O),L={x:Math.cos(u)*C-Math.sin(u)*P+E.x,y:Math.sin(u)*C+Math.cos(u)*P+E.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+A,ellipticalArcAngle:O,ellipticalArcCenter:E,resultantRx:t,resultantRy:n};return L};function wS(r){for(var e=[],t=null,n=null,i=null,s=0,a=r.length,o=0;o<a;o++){var l=r[o];n=r[o+1];var u=l[0],c={command:u,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],s=o;break;case"A":var d=xS(t,l);c.arcParams=d;break}if(u==="Z")t=i,n=r[s+1];else{var h=l.length;t=[l[h-2],l[h-1]]}n&&n[0]==="Z"&&(n=r[s],e[s]&&(e[s].prePoint=t)),c.currentPoint=t,e[s]&&ru(t,e[s].currentPoint)&&(e[s].prePoint=c.prePoint);var f=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=f;var g=c.prePoint;if(["L","H","V"].includes(u))c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]];else if(u==="Q"){var v=[l[1],l[2]];c.startTangent=[g[0]-v[0],g[1]-v[1]],c.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(u==="T"){var p=e[o-1],y=lp(p.currentPoint,g);p.command==="Q"?(c.command="Q",c.startTangent=[g[0]-y[0],g[1]-y[1]],c.endTangent=[t[0]-y[0],t[1]-y[1]]):(c.command="TL",c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]])}else if(u==="C"){var b=[l[1],l[2]],E=[l[3],l[4]];c.startTangent=[g[0]-b[0],g[1]-b[1]],c.endTangent=[t[0]-E[0],t[1]-E[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[b[0]-E[0],b[1]-E[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[E[0]-b[0],E[1]-b[1]])}else if(u==="S"){var T=e[o-1],S=lp(T.currentPoint,g),k=[l[1],l[2]];T.command==="C"?(c.command="C",c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[t[0]-k[0],t[1]-k[1]]):(c.command="SQ",c.startTangent=[g[0]-k[0],g[1]-k[1]],c.endTangent=[t[0]-k[0],t[1]-k[1]])}else if(u==="A"){var A=dp(c,0),O=A.x,C=A.y,P=dp(c,1,!1),L=P.x,R=P.y;c.startTangent=[O,C],c.endTangent=[L,R]}e.push(c)}return e}function dp(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=r.arcParams,i=n.rx,s=i===void 0?0:i,a=n.ry,o=a===void 0?0:a,l=n.xRotation,u=n.arcFlag,c=n.sweepFlag,d=cp({x:r.prePoint[0],y:r.prePoint[1]},s,o,l,!!u,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},e),h=cp({x:r.prePoint[0],y:r.prePoint[1]},s,o,l,!!u,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},t?e+.005:e-.005),f=h.x-d.x,g=h.y-d.y,v=Math.sqrt(f*f+g*g);return{x:-f/v,y:-g/v}}function Vo(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Bh(r,e){return Vo(r)*Vo(e)?(r[0]*e[0]+r[1]*e[1])/(Vo(r)*Vo(e)):1}function hp(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(Bh(r,e))}function xS(r,e){var t=e[1],n=e[2],i=ey(nt(e[3]),Math.PI*2),s=e[4],a=e[5],o=r[0],l=r[1],u=e[6],c=e[7],d=Math.cos(i)*(o-u)/2+Math.sin(i)*(l-c)/2,h=-1*Math.sin(i)*(o-u)/2+Math.cos(i)*(l-c)/2,f=d*d/(t*t)+h*h/(n*n);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=t*t*(h*h)+n*n*(d*d),v=g?Math.sqrt((t*t*(n*n)-g)/g):1;s===a&&(v*=-1),isNaN(v)&&(v=0);var p=n?v*t*h/n:0,y=t?v*-n*d/t:0,b=(o+u)/2+Math.cos(i)*p-Math.sin(i)*y,E=(l+c)/2+Math.sin(i)*p+Math.cos(i)*y,T=[(d-p)/t,(h-y)/n],S=[(-1*d-p)/t,(-1*h-y)/n],k=hp([1,0],T),A=hp(T,S);return Bh(T,S)<=-1&&(A=Math.PI),Bh(T,S)>=1&&(A=0),a===0&&A>0&&(A-=2*Math.PI),a===1&&A<0&&(A+=2*Math.PI),{cx:b,cy:E,rx:ru(r,[u,c])?0:t,ry:ru(r,[u,c])?0:n,startAngle:k,endAngle:k+A,xRotation:i,arcFlag:s,sweepFlag:a}}var Ay=function(e){if(e===""||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=Jl(e)}catch{t=Jl(""),console.error("[g]: Invalid SVG Path definition: ".concat(e))}vS(t);var n=mS(t),i=yS(t),s=i.polygons,a=i.polylines,o=wS(t),l=bS(o,0),u=l.x,c=l.y,d=l.width,h=l.height;return{absolutePath:t,hasArc:n,segments:o,polygons:s,polylines:a,totalLength:0,rect:{x:Number.isFinite(u)?u:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(d)?d:0,height:Number.isFinite(h)?h:0}}},ES=Dn(Ay);function Cy(r){return Ke(r)?ES(r):Ay(r)}function MS(r,e,t){var n=r.curve,i=e.curve;(!n||n.length===0)&&(n=Oh(r.absolutePath,!1),r.curve=n),(!i||i.length===0)&&(i=Oh(e.absolutePath,!1),e.curve=i);var s=[n,i];n.length!==i.length&&(s=dy(n,i));var a=Xg(s[0])!==Xg(s[1])?F2(s[0]):z2(s[0]);return[a,X2(s[1],a),function(o){return o}]}function SS(r,e){var t;return Ke(r)?t=r.split(" ").map(function(n){var i=n.split(","),s=Be(i,2),a=s[0],o=s[1];return[Number(a),Number(o)]}):t=r,{points:t,totalLength:0,segments:[]}}function TS(r,e){return[r.points,e.points,function(t){return t}]}var kt=null,ra=/\s*(\w+)\(([^)]*)\)/g;function Rn(r){return function(e){var t=0;return r.map(function(n){return n===kt?e[t++]:n})}}function rs(r){return r}var to={matrix:["NNNNNN",[kt,kt,0,0,kt,kt,0,0,0,0,1,0,kt,kt,0,1],rs],matrix3d:["NNNNNNNNNNNNNNNN",rs],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Rn([kt,kt,new sn(1)]),rs],scaleX:["N",Rn([kt,new sn(1),new sn(1)]),Rn([kt,new sn(1)])],scaleY:["N",Rn([new sn(1),kt,new sn(1)]),Rn([new sn(1),kt])],scaleZ:["N",Rn([new sn(1),new sn(1),kt])],scale3d:["NNN",rs],skew:["Aa",null,rs],skewX:["A",null,Rn([kt,Es])],skewY:["A",null,Rn([Es,kt])],translate:["Tt",Rn([kt,kt,yr]),rs],translateX:["T",Rn([kt,yr,yr]),Rn([kt,yr])],translateY:["T",Rn([yr,kt,yr]),Rn([yr,kt])],translateZ:["L",Rn([yr,yr,kt])],translate3d:["TTL",rs]};function Py(r){for(var e=[],t=r.length,n=0;n<t;n++){var i=r[n],s=i[0],a=i.slice(1);s==="translate"||s==="skew"?a.length===1&&a.push(0):s==="scale"&&a.length===1&&a.push(a[0]);var o=to[s];if(!o)return[];var l=a.map(function(u){return xt(u)});e.push({t:s,d:l})}return e}function _y(r){if(Array.isArray(r))return Py(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(ra.lastIndex=0;t=ra.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],s=to[i];if(!s)return[];var a=t[2].split(","),o=s[0];if(o.length<a.length)return[];for(var l=[],u=0;u<o.length;u++){var c=a[u],d=o[u],h=void 0;if(c?h={A:function(g){return g.trim()==="0"?Es:cS(g)},N:Rh,T:Ih,L:lS}[d.toUpperCase()](c):h={a:Es,n:l[0],t:yr}[d],h===void 0)return[];l.push(h)}if(e.push({t:i,d:l}),ra.lastIndex===r.length)return e}return[]}function OS(r){if(Array.isArray(r))return Py(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(ra.lastIndex=0;t=ra.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],s=to[i];if(!s)return[];var a=t[2].split(","),o=s[0];if(o.length<a.length)return[];for(var l=[],u=0;u<o.length;u++){var c=a[u],d=o[u],h=void 0;if(c?h={A:function(g){return g.trim()==="0"?Es:Ty(g)},N:ky,T:Sy,L:My}[d.toUpperCase()](c):h={a:Es,n:l[0],t:yr}[d],h===void 0)return[];l.push(h)}if(e.push({t:i,d:l}),ra.lastIndex===r.length)return e}return[]}function kS(r){var e,t,n,i;switch(r.t){case"rotateX":return i=nt($n(r.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=nt($n(r.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=nt($n(r.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=r.d[0].value,t=r.d[1].value,n=r.d[2].value,i=nt($n(r.d[3]));var s=e*e+t*t+n*n;if(s===0)e=1,t=0,n=0;else if(s!==1){var a=Math.sqrt(s);e/=a,t/=a,n/=a}var o=Math.sin(i/2),l=o*Math.cos(i/2),u=o*o;return[1-2*(t*t+n*n)*u,2*(e*t*u+n*l),2*(e*n*u-t*l),0,2*(e*t*u-n*l),1-2*(e*e+n*n)*u,2*(t*n*u+e*l),0,2*(e*n*u+t*l),2*(t*n*u-e*l),1-2*(e*e+t*t)*u,0,0,0,0,1];case"scale":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[r.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,r.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,r.d[0].value,0,0,0,0,1];case"scale3d":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,r.d[2].value,0,0,0,0,1];case"skew":var c=nt($n(r.d[0])),d=nt($n(r.d[1]));return[1,Math.tan(d),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=nt($n(r.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=nt($n(r.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=Xn(r.d[0],0,null)||0,t=Xn(r.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translateX":return e=Xn(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translateY":return t=Xn(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translateZ":return n=Xn(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return e=Xn(r.d[0],0,null)||0,t=Xn(r.d[1],0,null)||0,n=Xn(r.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1];case"perspective":var h=Xn(r.d[0],0,null)||0,f=h?-1/h:0;return[1,0,0,0,0,1,0,0,0,0,1,f,0,0,0,1];case"matrix":return[r.d[0].value,r.d[1].value,0,0,r.d[2].value,r.d[3].value,0,0,0,0,1,0,r.d[4].value,r.d[5].value,0,1];case"matrix3d":return r.d.map(function(g){return g.value})}}function NS(r,e){return[r[0]*e[0]+r[4]*e[1]+r[8]*e[2]+r[12]*e[3],r[1]*e[0]+r[5]*e[1]+r[9]*e[2]+r[13]*e[3],r[2]*e[0]+r[6]*e[1]+r[10]*e[2]+r[14]*e[3],r[3]*e[0]+r[7]*e[1]+r[11]*e[2]+r[15]*e[3],r[0]*e[4]+r[4]*e[5]+r[8]*e[6]+r[12]*e[7],r[1]*e[4]+r[5]*e[5]+r[9]*e[6]+r[13]*e[7],r[2]*e[4]+r[6]*e[5]+r[10]*e[6]+r[14]*e[7],r[3]*e[4]+r[7]*e[5]+r[11]*e[6]+r[15]*e[7],r[0]*e[8]+r[4]*e[9]+r[8]*e[10]+r[12]*e[11],r[1]*e[8]+r[5]*e[9]+r[9]*e[10]+r[13]*e[11],r[2]*e[8]+r[6]*e[9]+r[10]*e[10]+r[14]*e[11],r[3]*e[8]+r[7]*e[9]+r[11]*e[10]+r[15]*e[11],r[0]*e[12]+r[4]*e[13]+r[8]*e[14]+r[12]*e[15],r[1]*e[12]+r[5]*e[13]+r[9]*e[14]+r[13]*e[15],r[2]*e[12]+r[6]*e[13]+r[10]*e[14]+r[14]*e[15],r[3]*e[12]+r[7]*e[13]+r[11]*e[14]+r[15]*e[15]]}function AS(r){return r.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:r.map(kS).reduce(NS)}function fp(r){var e=[0,0,0],t=[1,1,1],n=[0,0,0],i=[0,0,0,1],s=[0,0,0,1];return CM(AS(r),e,t,n,i,s),[[e,t,n,s,i]]}var CS=function(){function r(n,i){for(var s=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],a=0;a<4;a++)for(var o=0;o<4;o++)for(var l=0;l<4;l++)s[a][o]+=i[a][l]*n[l][o];return s}function e(n){return n[0][2]===0&&n[0][3]===0&&n[1][2]===0&&n[1][3]===0&&n[2][0]===0&&n[2][1]===0&&n[2][2]===1&&n[2][3]===0&&n[3][2]===0&&n[3][3]===1}function t(n,i,s,a,o){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],u=0;u<4;u++)l[u][3]=o[u];for(var c=0;c<3;c++)for(var d=0;d<3;d++)l[3][c]+=n[d]*l[d][c];var h=a[0],f=a[1],g=a[2],v=a[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(f*f+g*g),p[0][1]=2*(h*f-g*v),p[0][2]=2*(h*g+f*v),p[1][0]=2*(h*f+g*v),p[1][1]=1-2*(h*h+g*g),p[1][2]=2*(f*g-h*v),p[2][0]=2*(h*g-f*v),p[2][1]=2*(f*g+h*v),p[2][2]=1-2*(h*h+f*f),l=r(l,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];s[2]&&(y[2][1]=s[2],l=r(l,y)),s[1]&&(y[2][1]=0,y[2][0]=s[0],l=r(l,y)),s[0]&&(y[2][0]=0,y[1][0]=s[0],l=r(l,y));for(var b=0;b<3;b++)for(var E=0;E<3;E++)l[b][E]*=i[b];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function PS(r){return r.toFixed(6).replace(".000000","")}function ld(r,e){var t,n;return r.decompositionPair!==e&&(r.decompositionPair=e,t=fp(r)),e.decompositionPair!==r&&(e.decompositionPair=r,n=fp(e)),t[0]===null||n[0]===null?[[!1],[!0],function(i){return i?e[0].d:r[0].d}]:(t[0].push(0),n[0].push(1),[t,n,function(i){var s=LS(t[0][3],n[0][3],i[5]),a=CS(i[0],i[1],i[2],s,i[4]),o=a.map(PS).join(",");return o}])}function _S(r,e){for(var t=0,n=0;n<r.length;n++)t+=r[n]*e[n];return t}function LS(r,e,t){var n=_S(r,e);n=At(n,-1,1);var i=[];if(n===1)i=r;else for(var s=Math.acos(n),a=Math.sin(t*s)*1/Math.sqrt(1-n*n),o=0;o<4;o++)i.push(r[o]*(Math.cos(t*s)-n*a)+e[o]*a);return i}function ud(r){return r.replace(/[XY]/,"")}function cd(r){return r.replace(/(X|Y|Z|3d)?$/,"3d")}var DS=function(e,t){return e==="perspective"&&t==="perspective"||(e==="matrix"||e==="matrix3d")&&(t==="matrix"||t==="matrix3d")};function IS(r,e,t){var n=!1;if(!r.length||!e.length){r.length||(n=!0,r=e,e=[]);for(var i=function(){var L=r[s],R=L.t,z=L.d,Y=R.substring(0,5)==="scale"?1:0;e.push({t:R,d:z.map(function(U){return typeof U=="number"?xt(Y):xt(Y,U.unit)})})},s=0;s<r.length;s++)i()}var a=[],o=[],l=[];if(r.length!==e.length){var u=ld(r,e);a=[u[0]],o=[u[1]],l=[["matrix",[u[2]]]]}else for(var c=0;c<r.length;c++){var d=r[c].t,h=e[c].t,f=r[c].d,g=e[c].d,v=to[d],p=to[h],y=void 0;if(DS(d,h)){var b=ld([r[c]],[e[c]]);a.push(b[0]),o.push(b[1]),l.push(["matrix",[b[2]]]);continue}else if(d===h)y=d;else if(v[2]&&p[2]&&ud(d)===ud(h))y=ud(d),f=v[2](f),g=p[2](g);else if(v[1]&&p[1]&&cd(d)===cd(h))y=cd(d),f=v[1](f),g=p[1](g);else{var E=ld(r,e);a=[E[0]],o=[E[1]],l=[["matrix",[E[2]]]];break}for(var T=[],S=[],k=[],A=0;A<f.length;A++){var O=dS(f[A],g[A],t,!1,A);T[A]=O[0],S[A]=O[1],k.push(O[2])}a.push(T),o.push(S),l.push([y,k])}if(n){var C=a;a=o,o=C}return[a,o,function(P){return P.map(function(L,R){var z=L.map(function(Y,U){return l[R][1][U](Y)}).join(",");return l[R][0]==="matrix"&&z.split(",").length===16&&(l[R][0]="matrix3d"),l[R][0]==="matrix3d"&&z.split(",").length===6&&(l[R][0]="matrix"),"".concat(l[R][0],"(").concat(z,")")}).join(" ")}]}var RS=Dn(function(r){if(Ke(r)){if(r==="text-anchor")return[xt(0,"px"),xt(0,"px")];var e=r.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Ih(gp(e[0])),Ih(gp(e[1]))]}return[xt(r[0]||0,"px"),xt(r[1]||0,"px")]});function gp(r){return r==="center"?"50%":r==="left"||r==="top"?"0%":r==="right"||r==="bottom"?"100%":r}var If=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:ve.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:ve.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:ve.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:ve.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:ve.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:ve.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:ve.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:ve.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:ve.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:ve.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:ve.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:ve.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:ve.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:ve.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:ve.FILTER},{n:"clipPath",syntax:ve.DEFINED_PATH},{n:"textPath",syntax:ve.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:ve.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:ve.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:ve.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:ve.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:ve.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:ve.COORDINATE},{n:"y1",int:!0,l:!0,syntax:ve.COORDINATE},{n:"z1",int:!0,l:!0,syntax:ve.COORDINATE},{n:"x2",int:!0,l:!0,syntax:ve.COORDINATE},{n:"y2",int:!0,l:!0,syntax:ve.COORDINATE},{n:"z2",int:!0,l:!0,syntax:ve.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:ve.PATH,p:50},{n:"points",int:!0,l:!0,syntax:ve.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:ve.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:ve.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:ve.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:ve.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:ve.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:ve.NUMBER,d:function(e){return e===ee.PATH||e===ee.POLYGON||e===ee.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:ve.MARKER},{n:"markerEnd",syntax:ve.MARKER},{n:"markerMid",syntax:ve.MARKER},{n:"markerStartOffset",syntax:ve.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:ve.LENGTH,l:!0,int:!0,d:"0"}],jS=new Set(If.filter(function(r){return!!r.l}).map(function(r){return r.n})),Ly={},BS=function(){function r(e){var t=this;oe(this,r),this.runtime=e,If.forEach(function(n){t.registerMetadata(n)})}return le(r,[{key:"registerMetadata",value:function(t){[t.n].concat(wt(t.a||[])).forEach(function(n){Ly[n]=t})}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{forceUpdateGeometry:!1};Object.assign(t.attributes,n);var s=t.parsedStyle.clipPath,a=t.parsedStyle.offsetPath;zS(t,n);var o=!!i.forceUpdateGeometry;if(!o){for(var l in n)if(jS.has(l)){o=!0;break}}var u=Dy(t);u.has("fill")&&n.fill&&(t.parsedStyle.fill=Xa(n.fill)),u.has("stroke")&&n.stroke&&(t.parsedStyle.stroke=Xa(n.stroke)),u.has("shadowColor")&&n.shadowColor&&(t.parsedStyle.shadowColor=Xa(n.shadowColor)),u.has("filter")&&n.filter&&(t.parsedStyle.filter=gS(n.filter)),u.has("radius")&&!Ae(n.radius)&&(t.parsedStyle.radius=op(n.radius,4)),u.has("lineDash")&&!Ae(n.lineDash)&&(t.parsedStyle.lineDash=op(n.lineDash,2)),u.has("points")&&n.points&&(t.parsedStyle.points=SS(n.points)),u.has("d")&&n.d===""&&(t.parsedStyle.d=We({},by)),u.has("d")&&n.d&&(t.parsedStyle.d=Cy(n.d)),u.has("textTransform")&&n.textTransform&&this.runtime.CSSPropertySyntaxFactory[ve.TEXT_TRANSFORM].calculator(null,null,{value:n.textTransform},t,null),u.has("clipPath")&&!Ie(n.clipPath)&&this.runtime.CSSPropertySyntaxFactory[ve.DEFINED_PATH].calculator("clipPath",s,n.clipPath,t,this.runtime),u.has("offsetPath")&&n.offsetPath&&this.runtime.CSSPropertySyntaxFactory[ve.DEFINED_PATH].calculator("offsetPath",a,n.offsetPath,t,this.runtime),u.has("transform")&&n.transform&&(t.parsedStyle.transform=_y(n.transform)),u.has("transformOrigin")&&n.transformOrigin&&(t.parsedStyle.transformOrigin=RS(n.transformOrigin)),u.has("markerStart")&&n.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[ve.MARKER].calculator(null,n.markerStart,n.markerStart,null,null)),u.has("markerEnd")&&n.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[ve.MARKER].calculator(null,n.markerEnd,n.markerEnd,null,null)),u.has("markerMid")&&n.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[ve.MARKER].calculator("",n.markerMid,n.markerMid,null,null)),u.has("zIndex")&&!Ae(n.zIndex)&&this.runtime.CSSPropertySyntaxFactory[ve.Z_INDEX].postProcessor(t),u.has("offsetDistance")&&!Ae(n.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[ve.OFFSET_DISTANCE].postProcessor(t),u.has("transform")&&n.transform&&this.runtime.CSSPropertySyntaxFactory[ve.TRANSFORM].postProcessor(t),u.has("transformOrigin")&&n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[ve.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,i.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var n=t.nodeName,i=this.runtime.geometryUpdaterFactory[n];if(i){var s=t.geometry;s.contentBounds||(s.contentBounds=new ct),s.renderBounds||(s.renderBounds=new ct);var a=t.parsedStyle,o=i.update(a,t),l=o.cx,u=l===void 0?0:l,c=o.cy,d=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,g=o.hwidth,v=g===void 0?0:g,p=o.hheight,y=p===void 0?0:p,b=o.hdepth,E=b===void 0?0:b,T=[Math.abs(v),Math.abs(y),E],S=a.stroke,k=a.lineWidth,A=k===void 0?1:k,O=a.increasedLineWidthForHitTesting,C=O===void 0?0:O,P=a.shadowType,L=P===void 0?"outer":P,R=a.shadowColor,z=a.filter,Y=z===void 0?[]:z,U=a.transformOrigin,V=[u,d,f];s.contentBounds.update(V,T);var W=n===ee.POLYLINE||n===ee.POLYGON||n===ee.PATH?Math.SQRT2:.5,F=S&&!S.isNone;if(F){var K=((A||0)+(C||0))*W;T[0]+=K,T[1]+=K}if(s.renderBounds.update(V,T),R&&L&&L!=="inner"){var re=s.renderBounds,se=re.min,ae=re.max,Ce=a.shadowBlur,Te=a.shadowOffsetX,J=a.shadowOffsetY,Oe=Ce||0,_e=Te||0,Ve=J||0,Qe=se[0]-Oe+_e,zt=ae[0]+Oe+_e,Xr=se[1]-Oe+Ve,Gn=ae[1]+Oe+Ve;se[0]=Math.min(se[0],Qe),ae[0]=Math.max(ae[0],zt),se[1]=Math.min(se[1],Xr),ae[1]=Math.max(ae[1],Gn),s.renderBounds.setMinMax(se,ae)}Y.forEach(function(Lo){var Ma=Lo.name,tn=Lo.params;if(Ma==="blur"){var Do=tn[0].value;s.renderBounds.update(s.renderBounds.center,ji(s.renderBounds.halfExtents,s.renderBounds.halfExtents,[Do,Do,0]))}else if(Ma==="drop-shadow"){var ns=tn[0].value,ir=tn[1].value,vi=tn[2].value,Zr=s.renderBounds,Kr=Zr.min,Ar=Zr.max,Is=Kr[0]-vi+ns,Fc=Ar[0]+vi+ns,$c=Kr[1]-vi+ir,Wc=Ar[1]+vi+ir;Kr[0]=Math.min(Kr[0],Is),Ar[0]=Math.max(Ar[0],Fc),Kr[1]=Math.min(Kr[1],$c),Ar[1]=Math.max(Ar[1],Wc),s.renderBounds.setMinMax(Kr,Ar)}}),t.geometry.dirty=!1;var qr=v<0,zc=y<0,ts=(qr?-1:1)*(U?Xn(U[0],0,t,!0):0),_o=(zc?-1:1)*(U?Xn(U[1],1,t,!0):0);(ts||_o)&&t.setOrigin(ts,_o)}}},{key:"updateSizeAttenuation",value:function(t,n){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/n,t.nodeName===ee.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/n)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===ee.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function zS(r,e){var t=Dy(r);for(var n in e)t.has(n)&&(r.parsedStyle[n]=e[n])}function Dy(r){return r.constructor.PARSED_STYLE_LIST}var FS=function(){function r(){oe(this,r),this.mixer=Lf}return le(r,[{key:"calculator",value:function(t,n,i,s){return $n(i)}}])}(),$S=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i,s,a){return i instanceof gr&&(i=null),a.sceneGraphService.updateDisplayObjectDependency(t,n,i,s),t==="clipPath"&&s.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),i}}])}(),WS=function(){function r(){oe(this,r),this.parser=Xa,this.mixer=oS}return le(r,[{key:"calculator",value:function(t,n,i,s){return i instanceof gr?i.value==="none"?wy:xy:i}}])}(),GS=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i){return i instanceof gr?[]:i}}])}();function pp(r){var e=r.parsedStyle,t=e.fontSize;return Ae(t)?null:t}var zh=function(){function r(){oe(this,r),this.mixer=Lf}return le(r,[{key:"calculator",value:function(t,n,i,s,a){if(ye(i))return i;if(sn.isRelativeUnit(i.unit)){if(i.unit===me.kPercentage)return 0;if(i.unit===me.kEms){if(s.parentNode){var o=pp(s.parentNode);if(o)return o*=i.value,o}return 0}if(i.unit===me.kRems){var l;if(s!=null&&(l=s.ownerDocument)!==null&&l!==void 0&&l.documentElement){var u=pp(s.ownerDocument.documentElement);if(u)return u*=i.value,u}return 0}}else return i.value}}])}(),YS=function(){function r(){oe(this,r),this.mixer=Ny}return le(r,[{key:"calculator",value:function(t,n,i){return i.map(function(s){return s.value})}}])}(),VS=function(){function r(){oe(this,r),this.mixer=Ny}return le(r,[{key:"calculator",value:function(t,n,i){return i.map(function(s){return s.value})}}])}(),US=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i,s){var a;i instanceof gr&&(i=null);var o=(a=i)===null||a===void 0?void 0:a.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])}(),HS=function(){function r(){oe(this,r),this.mixer=Lf}return le(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),XS=function(){function r(){oe(this,r),this.mixer=Df(0,1)}return le(r,[{key:"calculator",value:function(t,n,i){return i.value}},{key:"postProcessor",value:function(t){var n=t.parsedStyle,i=n.offsetPath,s=n.offsetDistance;if(i){var a=i.nodeName;if(a===ee.LINE||a===ee.PATH||a===ee.POLYLINE){var o=i.getPoint(s);o&&t.setLocalPosition(o.x,o.y)}}}}])}(),qS=function(){function r(){oe(this,r),this.mixer=Df(0,1)}return le(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),ZS=function(){function r(){oe(this,r),this.parser=Cy,this.mixer=MS}return le(r,[{key:"calculator",value:function(t,n,i){return i instanceof gr&&i.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ca(0,0,0,0)}:i}}])}(),KS=le(function r(){oe(this,r),this.mixer=TS}),QS=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.mixer=Df(0,1/0),t}return $e(e,r),le(e)}(zh),JS=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i,s){return i instanceof gr?i.value==="unset"?"":i.value:"".concat(i)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),eT=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i,s){var a=s.getAttribute("text");if(a){var o=a;i.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):i.value==="lowercase"?o=a.toLowerCase():i.value==="uppercase"&&(o=a.toUpperCase()),s.parsedStyle.text=o}return i.value}}])}(),dd=new WeakMap;function tT(r,e,t){if(r){var n=typeof r=="string"?document.getElementById(r):r;dd.has(n)&&dd.get(n).destroy(t),dd.set(n,e)}}var yo=typeof window<"u"&&typeof window.document<"u";function nT(r){return!!r.getAttribute}function rT(r,e){for(var t=0,n=r.length;t<n;){var i=t+n>>>1;Iy(r[i],e)<0?t=i+1:n=i}return t}function Iy(r,e){var t=Number(r.parsedStyle.zIndex||0),n=Number(e.parsedStyle.zIndex||0);if(t===n){var i=r.parentNode;if(i){var s=i.childNodes||[];return s.indexOf(r)-s.indexOf(e)}}return t-n}function Ry(r){var e=r;do{var t,n=(t=e.parsedStyle)===null||t===void 0?void 0:t.clipPath;if(n)return e;e=e.parentElement}while(e!==null);return null}var vp="px";function iT(r,e,t){yo&&r.style&&(r.style.width=e+vp,r.style.height=t+vp)}function jy(r,e){if(yo)return document.defaultView.getComputedStyle(r,null).getPropertyValue(e)}function sT(r){var e=jy(r,"width");return e==="auto"?r.offsetWidth:parseFloat(e)}function aT(r){var e=jy(r,"height");return e==="auto"?r.offsetHeight:parseFloat(e)}var oT=1,lT={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Fh=typeof performance=="object"&&performance.now?performance:Date;function iu(r){return r.nodeName===ee.FRAGMENT?!0:r.getRootNode().nodeName===ee.FRAGMENT}function Cs(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=!1,i=!1,s=!!e&&!e.isNone,a=!!t&&!t.isNone;return r==="visiblepainted"||r==="painted"||r==="auto"?(n=s,i=a):r==="visiblefill"||r==="fill"?n=!0:r==="visiblestroke"||r==="stroke"?i=!0:(r==="visible"||r==="all")&&(n=!0,i=!0),[n,i]}var uT=1,cT=function(){return uT++},Fr=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:{},dT=Date.now(),hT=function(){return Fr.performance&&typeof Fr.performance.now=="function"?Fr.performance.now():Date.now()-dT},Ba={},mp=Date.now(),fT=function(e){if(typeof e!="function")throw new TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-mp,i=n>16?0:16-n,s=cT();return Ba[s]=e,Object.keys(Ba).length>1||setTimeout(function(){mp=t;var a=Ba;Ba={},Object.keys(a).forEach(function(o){return a[o](hT())})},i),s},gT=function(e){delete Ba[e]},pT=["","webkit","moz","ms","o"],By=function(e){return typeof e!="string"?fT:e===""?Fr.requestAnimationFrame:Fr["".concat(e,"RequestAnimationFrame")]},vT=function(e){return typeof e!="string"?gT:e===""?Fr.cancelAnimationFrame:Fr["".concat(e,"CancelAnimationFrame")]||Fr["".concat(e,"CancelRequestAnimationFrame")]},mT=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n+=1}},zy=mT(pT,function(r){return!!By(r)}),Rf=By(zy),Fy=vT(zy);Fr.requestAnimationFrame=Rf;Fr.cancelAnimationFrame=Fy;var yT=function(){function r(){oe(this,r),this.callbacks=[]}return le(r,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Promise.all(this.callbacks.map(function(s){return s.apply(void 0,n)}))}}])}(),bT=function(){function r(){oe(this,r),this.callbacks=[]}return le(r,[{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){var e=Vi(gn().mark(function n(){var i,s,a,o,l=arguments;return gn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this.callbacks.length){c.next=14;break}return c.next=3,(i=this.callbacks)[0].apply(i,l);case 3:s=c.sent,a=0;case 5:if(!(a<this.callbacks.length-1)){c.next=13;break}return o=this.callbacks[a],c.next=9,o(s);case 9:s=c.sent;case 10:a++,c.next=5;break;case 13:return c.abrupt("return",s);case 14:return c.abrupt("return",null);case 15:case"end":return c.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),On=function(){function r(){oe(this,r),this.callbacks=[]}return le(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=arguments;this.callbacks.forEach(function(a){a.apply(void 0,s)})}}])}(),hd=function(){function r(){oe(this,r),this.callbacks=[]}return le(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(this.callbacks.length){for(var s=arguments,a=this.callbacks[0].apply(void 0,s),o=0;o<this.callbacks.length-1;o++){var l=this.callbacks[o];a=l(a)}return a}return null}}])}(),wT=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],xT=/([\"\'])[^\'\"]+\1/;function ET(r){for(var e=r.fontSize,t=e===void 0?16:e,n=r.fontFamily,i=n===void 0?"sans-serif":n,s=r.fontStyle,a=s===void 0?"normal":s,o=r.fontVariant,l=o===void 0?"normal":o,u=r.fontWeight,c=u===void 0?"normal":u,d=ye(t)&&"".concat(t,"px")||"16px",h=i.split(","),f=h.length-1;f>=0;f--){var g=h[f].trim();!xT.test(g)&&wT.indexOf(g)<0&&(g='"'.concat(g,'"')),h[f]=g}return"".concat(a," ").concat(l," ").concat(c," ").concat(d," ").concat(h.join(","))}function fd(r,e,t){return Wi(r),r[4]=Math.tan(e),r[1]=Math.tan(t),r}var It=ut(),MT=ut(),ST={scale:function(e){us(It,[e[0].value,e[1].value,1])},scaleX:function(e){us(It,[e[0].value,1,1])},scaleY:function(e){us(It,[1,e[0].value,1])},scaleZ:function(e){us(It,[1,1,e[0].value])},scale3d:function(e){us(It,[e[0].value,e[1].value,e[2].value])},translate:function(e){Oi(It,[e[0].value,e[1].value,0])},translateX:function(e){Oi(It,[e[0].value,0,0])},translateY:function(e){Oi(It,[0,e[0].value,0])},translateZ:function(e){Oi(It,[0,0,e[0].value])},translate3d:function(e){Oi(It,[e[0].value,e[1].value,e[2].value])},rotate:function(e){bh(It,nt($n(e[0])))},rotateX:function(e){$m(It,nt($n(e[0])))},rotateY:function(e){Wm(It,nt($n(e[0])))},rotateZ:function(e){bh(It,nt($n(e[0])))},rotate3d:function(e){Fm(It,nt($n(e[3])),[e[0].value,e[1].value,e[2].value])},skew:function(e){fd(It,nt(e[0].value),nt(e[1].value))},skewX:function(e){fd(It,nt(e[0].value),0)},skewY:function(e){fd(It,0,nt(e[0].value))},matrix:function(e){yh(It,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1)},matrix3d:function(e){yh.apply(IE,[It].concat(wt(e.map(function(t){return t.value}))))}},TT=ht(1,1,1),OT=Xe(),yp={translate:function(e,t){ce.sceneGraphService.setLocalScale(e,TT,!1),ce.sceneGraphService.setLocalEulerAngles(e,OT,void 0,void 0,!1),ce.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),ce.sceneGraphService.dirtifyLocal(e,e.transformable)}};function $y(r,e){if(r.length){if(r.length===1&&yp[r[0].t]){yp[r[0].t](e,r[0].d);return}for(var t=Wi(MT),n=0;n<r.length;n++){var i=r[n],s=i.t,a=i.d,o=ST[s];o&&(o(a),Zm(t,t,It))}e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var kT=function(){function r(){oe(this,r),this.parser=OS,this.mixer=IS}return le(r,[{key:"calculator",value:function(t,n,i,s){return i instanceof gr?[]:i}},{key:"postProcessor",value:function(t){$y(t.parsedStyle.transform,t)}}])}(),NT=function(){function r(){oe(this,r)}return le(r,[{key:"postProcessor",value:function(t){var n=t.parsedStyle.transformOrigin;n[0].unit===me.kPixels&&n[1].unit===me.kPixels?t.setOrigin(n[0].value,n[1].value):t.getGeometryBounds()}}])}(),AT=function(){function r(){oe(this,r)}return le(r,[{key:"calculator",value:function(t,n,i,s){return i.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var n=t.parentNode,i=n.renderable,s=n.sortable;i&&(i.dirty=!0),s&&(s.dirty=!0,s.dirtyReason=tu.Z_INDEX_CHANGED)}}}])}(),CT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t,n){var i=t.cx,s=i===void 0?0:i,a=t.cy,o=a===void 0?0:a,l=t.r,u=l===void 0?0:l;return{cx:s,cy:o,hwidth:u,hheight:u}}}])}(),PT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t,n){var i=t.cx,s=i===void 0?0:i,a=t.cy,o=a===void 0?0:a,l=t.rx,u=l===void 0?0:l,c=t.ry,d=c===void 0?0:c;return{cx:s,cy:o,hwidth:u,hheight:d}}}])}(),_T=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t){var n=t.x1,i=t.y1,s=t.x2,a=t.y2,o=Math.min(n,s),l=Math.max(n,s),u=Math.min(i,a),c=Math.max(i,a),d=l-o,h=c-u,f=d/2,g=h/2;return{cx:o+f,cy:u+g,hwidth:f,hheight:g}}}])}(),LT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t){var n=t.d,i=n.rect,s=i.x,a=i.y,o=i.width,l=i.height,u=o/2,c=l/2;return{cx:s+u,cy:a+c,hwidth:u,hheight:c}}}])}(),DT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t){if(t.points&&nr(t.points.points)){var n=t.points.points,i=Math.min.apply(Math,wt(n.map(function(h){return h[0]}))),s=Math.max.apply(Math,wt(n.map(function(h){return h[0]}))),a=Math.min.apply(Math,wt(n.map(function(h){return h[1]}))),o=Math.max.apply(Math,wt(n.map(function(h){return h[1]}))),l=s-i,u=o-a,c=l/2,d=u/2;return{cx:i+c,cy:a+d,hwidth:c,hheight:d}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),IT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t,n){var i=t.x,s=i===void 0?0:i,a=t.y,o=a===void 0?0:a,l=t.src,u=t.width,c=u===void 0?0:u,d=t.height,h=d===void 0?0:d,f=c,g=h;return l&&!Ke(l)&&(f||(f=l.width,t.width=f),g||(g=l.height,t.height=g)),{cx:s+f/2,cy:o+g/2,hwidth:f/2,hheight:g/2}}}])}(),RT=function(){function r(e){oe(this,r),this.globalRuntime=e}return le(r,[{key:"isReadyToMeasure",value:function(t,n){var i=t.text;return i}},{key:"update",value:function(t,n){var i,s=t.text,a=t.textAlign,o=a===void 0?"start":a,l=t.lineWidth,u=l===void 0?1:l,c=t.textBaseline,d=c===void 0?"alphabetic":c,h=t.dx,f=h===void 0?0:h,g=t.dy,v=g===void 0?0:g,p=t.x,y=p===void 0?0:p,b=t.y,E=b===void 0?0:b;if(!this.isReadyToMeasure(t,n))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var T=(n==null||(i=n.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0?void 0:i.getConfig())||{},S=T.offscreenCanvas,k=this.globalRuntime.textService.measureText(s,t,S);t.metrics=k;var A=k.width,O=k.height,C=A/2,P=O/2,L=y+C;o==="center"||o==="middle"?L+=u/2-C:(o==="right"||o==="end")&&(L+=u-C*2);var R=E-P;return d==="middle"?R+=P:d==="top"||d==="hanging"?R+=P*2:d==="alphabetic"||(d==="bottom"||d==="ideographic")&&(R+=0),f&&(L+=f),v&&(R+=v),{cx:L,cy:R,hwidth:C,hheight:P}}}])}(),jT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t,n){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),BT=function(){function r(){oe(this,r)}return le(r,[{key:"update",value:function(t,n){var i=t.x,s=i===void 0?0:i,a=t.y,o=a===void 0?0:a,l=t.width,u=l===void 0?0:l,c=t.height,d=c===void 0?0:c;return{cx:s+u/2,cy:o+d/2,hwidth:u/2,hheight:d/2}}}])}(),Au=function(){function r(e){oe(this,r),this.eventPhase=r.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new hn,this.page=new hn,this.canvas=new hn,this.viewport=new hn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return le(r,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(tt)}}])}(),Wy=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.client=new hn,t.movement=new hn,t.offset=new hn,t.global=new hn,t.screen=new hn,t}return $e(e,r),le(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)}},{key:"initMouseEvent",value:function(){throw new Error(tt)}}])}(Au),su=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.width=0,t.height=0,t.isPrimary=!1,t}return $e(e,r),le(e,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(Wy),$h=function(r){function e(){return oe(this,e),Fe(this,e,arguments)}return $e(e,r),le(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(Wy),Wt=function(r){function e(t,n){var i;return oe(this,e),i=Fe(this,e,[null]),i.type=t,i.detail=n,Object.assign(i,n),i}return $e(e,r),le(e)}(Au),bp=new WeakMap,Gy=function(){function r(){oe(this,r),this.emitter=new kf}return le(r,[{key:"on",value:function(t,n,i){return this.addEventListener(t,n,i),this}},{key:"addEventListener",value:function(t,n,i){var s=!1,a=!1;if(Ql(i))s=i;else if(i){var o=i.capture;s=o===void 0?!1:o;var l=i.once;a=l===void 0?!1:l}s&&(t+="capture"),n=Ee(n)?n:n.handleEvent;var u=Ee(n)?void 0:n;return a?this.emitter.once(t,n,u):this.emitter.on(t,n,u),this}},{key:"off",value:function(t,n,i){return t?this.removeEventListener(t,n,i):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;(t=this.emitter)===null||t===void 0||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,n,i){var s;if(!this.emitter)return this;var a=Ql(i)?i:i==null?void 0:i.capture;a&&(t+="capture"),n=Ee(n)?n:(s=n)===null||s===void 0?void 0:s.handleEvent;var o=Ee(n)?void 0:n;return this.emitter.off(t,n,o),this}},{key:"emit",value:function(t,n){this.dispatchEvent(new Wt(t,n))}},{key:"dispatchEvent",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=bp.get(this);if(!i){var s;this.document?i=this:this.defaultView?i=this.defaultView:i=(s=this.ownerDocument)===null||s===void 0?void 0:s.defaultView,i&&bp.set(this,i)}if(i){if(t.manager=i.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),Tt=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return $e(e,r),le(e,[{key:"textContent",get:function(){var n="";this.nodeName===ee.TEXT&&(n+=this.style.text);var i=cs(this.childNodes),s;try{for(i.s();!(s=i.n()).done;){var a=s.value;a.nodeName===ee.TEXT?n+=a.nodeValue:n+=a.textContent}}catch(o){i.e(o)}finally{i.f()}return n},set:function(n){var i=this;this.childNodes.slice().forEach(function(s){i.removeChild(s)}),this.nodeName===ee.TEXT&&(this.style.text="".concat(n))}},{key:"getRootNode",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(n){throw new Error(tt)}},{key:"lookupNamespaceURI",value:function(n){throw new Error(tt)}},{key:"lookupPrefix",value:function(n){throw new Error(tt)}},{key:"normalize",value:function(){throw new Error(tt)}},{key:"isEqualNode",value:function(n){return this===n}},{key:"isSameNode",value:function(n){return this.isEqualNode(n)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(n){if(n===this)return 0;for(var i=n,s=this,a=[i],o=[s];(l=i.parentNode)!==null&&l!==void 0?l:s.parentNode;){var l;i=i.parentNode?(a.push(i.parentNode),i.parentNode):i,s=s.parentNode?(o.push(s.parentNode),s.parentNode):s}if(i!==s)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var u=a.length>o.length?a:o,c=u===a?o:a;if(u[u.length-c.length]===c[0])return u===a?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var d=u.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],g=u[d+h];if(g!==f){var v=f.parentNode.childNodes;return v.indexOf(f)<v.indexOf(g)?c===a?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:u===a?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(n){return this.contains(n)}},{key:"contains",value:function(n){for(var i=n;i&&this!==i;)i=i.parentNode;return!!i}},{key:"getAncestor",value:function(n){for(var i=this;n>0&&i;)i=i.parentNode,n--;return i}},{key:"forEach",value:function(n){for(var i=[this];i.length>0;){var s=i.pop(),a=n(s);if(a===!1)break;for(var o=s.childNodes.length-1;o>=0;o--)i.push(s.childNodes[o])}}}],[{key:"isNode",value:function(n){return!!n.childNodes}}])}(Gy);Tt.DOCUMENT_POSITION_DISCONNECTED=1;Tt.DOCUMENT_POSITION_PRECEDING=2;Tt.DOCUMENT_POSITION_FOLLOWING=4;Tt.DOCUMENT_POSITION_CONTAINS=8;Tt.DOCUMENT_POSITION_CONTAINED_BY=16;Tt.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var zT=2048,FT=function(){function r(e,t){var n=this;oe(this,r),this.emitter=new kf,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=ut(),this.tmpVec3=Xe(),this.onPointerDown=function(i){var s=n.createPointerEvent(i);if(n.dispatchEvent(s,"pointerdown"),s.pointerType==="touch")n.dispatchEvent(s,"touchstart");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;n.dispatchEvent(s,a?"rightdown":"mousedown")}var o=n.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=s.composedPath(),n.freeEvent(s)},this.onPointerUp=function(i){var s=Fh.now(),a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(a,"pointerup"),a.pointerType==="touch")n.dispatchEvent(a,"touchend");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;n.dispatchEvent(a,o?"rightup":"mouseup")}var l=n.trackingData(i.pointerId),u=n.findMountedTarget(l.pressTargetsByButton[i.button]),c=u;if(u&&!a.composedPath().includes(u)){for(var d=u;d&&!a.composedPath().includes(d);){if(a.currentTarget=d,n.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch")n.notifyTarget(a,"touchendoutside");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var h=a.button===2;n.notifyTarget(a,h?"rightupoutside":"mouseupoutside")}Tt.isNode(d)&&(d=d.parentNode)}delete l.pressTargetsByButton[i.button],c=d}if(c){var f,g=n.clonePointerEvent(a,"click");g.target=c,g.path=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:g.target,timeStamp:s});var v=n.context.renderingContext.root.ownerDocument.defaultView,p=l.clicksByButton[i.button];p.target===g.target&&s-p.timeStamp<v.dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=g.target,p.timeStamp=s,g.detail=p.clickCount,(f=a.detail)!==null&&f!==void 0&&f.preventClick||(!n.context.config.useNativeClickEvent&&(g.pointerType==="mouse"||g.pointerType==="touch")&&n.dispatchEvent(g,"click"),n.dispatchEvent(g,"pointertap")),n.freeEvent(g)}n.freeEvent(a)},this.onPointerMove=function(i){var s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),a=s.pointerType==="mouse"||s.pointerType==="pen",o=n.trackingData(i.pointerId),l=n.findMountedTarget(o.overTargets);if(o.overTargets&&l!==s.target){var u=i.type==="mousemove"?"mouseout":"pointerout",c=n.createPointerEvent(i,u,l||void 0);if(n.dispatchEvent(c,"pointerout"),a&&n.dispatchEvent(c,"mouseout"),!s.composedPath().includes(l)){var d=n.createPointerEvent(i,"pointerleave",l||void 0);for(d.eventPhase=d.AT_TARGET;d.target&&!s.composedPath().includes(d.target);)d.currentTarget=d.target,n.notifyTarget(d),a&&n.notifyTarget(d,"mouseleave"),Tt.isNode(d.target)&&(d.target=d.target.parentNode);n.freeEvent(d)}n.freeEvent(c)}if(l!==s.target){var h=i.type==="mousemove"?"mouseover":"pointerover",f=n.clonePointerEvent(s,h);n.dispatchEvent(f,"pointerover"),a&&n.dispatchEvent(f,"mouseover");for(var g=l&&Tt.isNode(l)&&l.parentNode;g&&g!==(Tt.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&g!==s.target;)g=g.parentNode;var v=!g||g===(Tt.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(v){var p=n.clonePointerEvent(s,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==l&&p.target!==(Tt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)p.currentTarget=p.target,n.notifyTarget(p),a&&n.notifyTarget(p,"mouseenter"),Tt.isNode(p.target)&&(p.target=p.target.parentNode);n.freeEvent(p)}n.freeEvent(f)}n.dispatchEvent(s,"pointermove"),s.pointerType==="touch"&&n.dispatchEvent(s,"touchmove"),a&&(n.dispatchEvent(s,"mousemove"),n.cursor=n.getCursor(s.target)),o.overTargets=s.composedPath(),n.freeEvent(s)},this.onPointerOut=function(i){var s=n.trackingData(i.pointerId);if(s.overTargets){var a=i.pointerType==="mouse"||i.pointerType==="pen",o=n.findMountedTarget(s.overTargets),l=n.createPointerEvent(i,"pointerout",o||void 0);n.dispatchEvent(l),a&&n.dispatchEvent(l,"mouseout");var u=n.createPointerEvent(i,"pointerleave",o||void 0);for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(Tt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)u.currentTarget=u.target,n.notifyTarget(u),a&&n.notifyTarget(u,"mouseleave"),Tt.isNode(u.target)&&(u.target=u.target.parentNode);s.overTargets=null,n.freeEvent(l),n.freeEvent(u)}n.cursor=null},this.onPointerOver=function(i){var s=n.trackingData(i.pointerId),a=n.createPointerEvent(i),o=a.pointerType==="mouse"||a.pointerType==="pen";n.dispatchEvent(a,"pointerover"),o&&n.dispatchEvent(a,"mouseover"),a.pointerType==="mouse"&&(n.cursor=n.getCursor(a.target));var l=n.clonePointerEvent(a,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Tt.isNode(n.rootTarget)&&n.rootTarget.parentNode);)l.currentTarget=l.target,n.notifyTarget(l),o&&n.notifyTarget(l,"mouseenter"),Tt.isNode(l.target)&&(l.target=l.target.parentNode);s.overTargets=a.composedPath(),n.freeEvent(a),n.freeEvent(l)},this.onPointerUpOutside=function(i){var s=n.trackingData(i.pointerId),a=n.findMountedTarget(s.pressTargetsByButton[i.button]),o=n.createPointerEvent(i);if(a){for(var l=a;l;)o.currentTarget=l,n.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&n.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),Tt.isNode(l)&&(l=l.parentNode);delete s.pressTargetsByButton[i.button]}n.freeEvent(o)},this.onWheel=function(i){var s=n.createWheelEvent(i);n.dispatchEvent(s),n.freeEvent(s)},this.onClick=function(i){if(n.context.config.useNativeClickEvent){var s=n.createPointerEvent(i);n.dispatchEvent(s),n.freeEvent(s)}},this.onPointerCancel=function(i){var s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(s),n.freeEvent(s)},this.globalRuntime=e,this.context=t}return le(r,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),n=1,i=1,s=this.context.contextService.getDomElement();if(s&&t){var a=s.offsetWidth,o=s.offsetHeight;a&&o&&(n=t.width/a,i=t.height/o)}return{scaleX:n,scaleY:i,bbox:t}}},{key:"client2Viewport",value:function(t){var n=this.getScale(),i=n.scaleX,s=n.scaleY,a=n.bbox;return new hn((t.x-((a==null?void 0:a.left)||0))/i,(t.y-((a==null?void 0:a.top)||0))/s)}},{key:"viewport2Client",value:function(t){var n=this.getScale(),i=n.scaleX,s=n.scaleY,a=n.bbox;return new hn((t.x+((a==null?void 0:a.left)||0))*i,(t.y+((a==null?void 0:a.top)||0))*s)}},{key:"viewport2Canvas",value:function(t){var n=t.x,i=t.y,s=this.rootTarget.defaultView,a=s.getCamera(),o=this.context.config,l=o.width,u=o.height,c=a.getPerspectiveInverse(),d=a.getWorldTransform(),h=Mn(this.tmpMatrix,d,c),f=En(this.tmpVec3,n/l*2-1,(1-i/u)*2-1,0);return Sn(f,f,h),new hn(f[0],f[1])}},{key:"canvas2Viewport",value:function(t){var n=this.rootTarget.defaultView,i=n.getCamera(),s=i.getPerspective(),a=i.getViewTransform(),o=Mn(this.tmpMatrix,s,a),l=En(this.tmpVec3,t.x,t.y,0);Sn(this.tmpVec3,this.tmpVec3,o);var u=this.context.config,c=u.width,d=u.height;return new hn((l[0]+1)/2*c,(1-(l[1]+1)/2)*d)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,n){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:n,priority:0}),this.mappingTable[t].sort(function(i,s){return i.priority-s.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var n=this.mappingTable[t.type];if(n)for(var i=0,s=n.length;i<s;i++)n[i].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,n,i){if(!i)t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,n);else{t.eventPhase=t.AT_TARGET;var s=this.rootTarget.defaultView||null;t.currentTarget=s,this.notifyListeners(t,n)}this.emitter.emit(n||t.type,t)}},{key:"propagate",value:function(t,n){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var s=i.length-1;s>=1;s--)if(t.currentTarget=i[s],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,n),!(t.propagationStopped||t.propagationImmediatelyStopped)){var a=i.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=a+1;o<i.length;o++)if(t.currentTarget=i[o],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var n=[t],i=this.rootTarget.defaultView||null;if(i&&i===t)return n.unshift(i.document),n;for(var s=0;s<zT&&t!==this.rootTarget;s++)Tt.isNode(t)&&t.parentNode&&(n.push(t.parentNode),t=t.parentNode);return i&&n.push(i),n}},{key:"hitTest",value:function(t){var n=t.viewportX,i=t.viewportY,s=this.context.config,a=s.width,o=s.height,l=s.disableHitTesting;return n<0||i<0||n>a||i>o?null:!l&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,n){var i,s=n==null?void 0:n.target;if((i=s)!==null&&i!==void 0&&i.shadowRoot&&(s=n.composedPath()[0]),s){if(s===t)return!0;if(t&&t.contains)return t.contains(s)}return n!=null&&n.composedPath?n.composedPath().indexOf(t)>-1:!1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var n=0,i=t.nativeEvent.composedPath();n<i.length;n++){var s=i[n],a=this.nativeHTMLMap.get(s);if(a)return a}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,n,i,s){var a=this.allocateEvent(su);this.copyPointerData(t,a),this.copyMouseData(t,a),this.copyData(t,a),a.nativeEvent=t.nativeEvent,a.originalEvent=t;var o=this.getExistedHTML(a),l=this.context.contextService.getDomElement();return a.target=i??(o||this.isNativeEventFromCanvas(l,a.nativeEvent)&&this.pickTarget(a)||s),typeof n=="string"&&(a.type=n),a}},{key:"createWheelEvent",value:function(t){var n=this.allocateEvent($h);this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t;var i=this.getExistedHTML(n),s=this.context.contextService.getDomElement();return n.target=i||this.isNativeEventFromCanvas(s,n.nativeEvent)&&this.pickTarget(n),n}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var n=this.allocateEvent($h);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=t.type,n}},{key:"clonePointerEvent",value:function(t,n){var i=this.allocateEvent(su);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=n??i.type,i}},{key:"copyPointerData",value:function(t,n){n.pointerId=t.pointerId,n.width=t.width,n.height=t.height,n.isPrimary=t.isPrimary,n.pointerType=t.pointerType,n.pressure=t.pressure,n.tangentialPressure=t.tangentialPressure,n.tiltX=t.tiltX,n.tiltY=t.tiltY,n.twist=t.twist}},{key:"copyMouseData",value:function(t,n){n.altKey=t.altKey,n.button=t.button,n.buttons=t.buttons,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.client.copyFrom(t.client),n.movement.copyFrom(t.movement),n.canvas.copyFrom(t.canvas),n.screen.copyFrom(t.screen),n.global.copyFrom(t.global),n.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,n){n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,n){n.isTrusted=t.isTrusted,n.timeStamp=Fh.now(),n.type=t.type,n.detail=t.detail,n.view=t.view,n.page.copyFrom(t.page),n.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var n=this.eventPool.get(t).pop()||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(t)}},{key:"notifyTarget",value:function(t,n){var i;n=(i=n)!==null&&i!==void 0?i:t.type;var s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,n)}},{key:"notifyListeners",value:function(t,n){var i=t.currentTarget.emitter,s=i._events[n];if(s)if("fn"in s)s.once&&i.removeListener(n,s.fn,void 0,!0),s.fn.call(t.currentTarget||s.context,t);else for(var a=0;a<s.length&&!t.propagationImmediatelyStopped;a++)s[a].once&&i.removeListener(n,s[a].fn,void 0,!0),s[a].fn.call(t.currentTarget||s[a].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var n=t[t.length-1],i=t.length-2;i>=0;i--){var s=t[i];if(s===this.rootTarget||Tt.isNode(s)&&s.parentNode===n)n=t[i];else break}return n}},{key:"getCursor",value:function(t){for(var n=t;n;){var i=nT(n)&&n.getAttribute("cursor");if(i)return i;n=Tt.isNode(n)&&n.parentNode}}}])}(),jf=function(){function r(){oe(this,r)}return le(r,[{key:"getOrCreateCanvas",value:function(t,n){if(this.canvas)return this.canvas;if(t||ce.offscreenCanvas)this.canvas=t||ce.offscreenCanvas,this.context=this.canvas.getContext("2d",We({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",We({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",We({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,n){return this.context?this.context:(this.getOrCreateCanvas(t,n),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement("canvas")}catch{}return null}}])}(),ia=function(r){return r[r.CAMERA_CHANGED=0]="CAMERA_CHANGED",r[r.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",r[r.NONE=2]="NONE",r}({}),$T=function(){function r(e,t){oe(this,r),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new On,initAsync:new yT,dirtycheck:new hd,cull:new hd,beginFrame:new On,beforeRender:new On,render:new On,afterRender:new On,endFrame:new On,destroy:new On,pick:new bT,pickSync:new hd,pointerDown:new On,pointerUp:new On,pointerMove:new On,pointerOut:new On,pointerOver:new On,pointerWheel:new On,pointerCancel:new On,click:new On},this.globalRuntime=e,this.context=t}return le(r,[{key:"init",value:function(t){var n=this,i=We(We({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(s){s.apply(i,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){n.inited=!0,t()}).catch(function(s){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var t=this.context.config.renderer,n=t.getConfig(),i=n.enableDirtyRectangleRendering;return!i||this.context.renderingContext.renderReasons.has(ia.CAMERA_CHANGED)}},{key:"render",value:function(t,n,i){var s=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(ia.CAMERA_CHANGED),l=!t.disableRenderHooks||!(t.disableRenderHooks&&o);l&&this.renderDisplayObject(a.root,t,a),this.hooks.beginFrame.call(n),l&&a.renderListCurrentFrame.forEach(function(u){s.hooks.beforeRender.call(u),s.hooks.render.call(u),s.hooks.afterRender.call(u)}),this.hooks.endFrame.call(n),a.renderListCurrentFrame=[],a.renderReasons.clear(),i()}}},{key:"renderDisplayObject",value:function(t,n,i){var s=this,a=n.renderer.getConfig(),o=a.enableDirtyCheck,l=a.enableCulling;function u(g){var v=g.renderable,p=g.sortable,y=o?v.dirty||i.dirtyRectangleRenderingDisabled?g:null:g;if(y){var b=l?s.hooks.cull.call(y,s.context.camera):y;b&&(s.stats.rendered+=1,i.renderListCurrentFrame.push(b))}v.dirty=!1,p.renderOrder=s.zIndexCounter,s.zIndexCounter+=1,s.stats.total+=1,p.dirty&&(s.sort(g,p),p.dirty=!1,p.dirtyChildren=[],p.dirtyReason=void 0)}for(var c=[t];c.length>0;){var d=c.pop();u(d);for(var h=d.sortable.sorted||d.childNodes,f=h.length-1;f>=0;f--)c.push(h[f])}}},{key:"sort",value:function(t,n){n.sorted&&n.dirtyReason!==tu.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(i){var s=t.childNodes.indexOf(i);if(s===-1){var a=n.sorted.indexOf(i);a>=0&&n.sorted.splice(a,1)}else if(n.sorted.length===0)n.sorted.push(i);else{var o=rT(n.sorted,i);n.sorted.splice(o,0,i)}}):n.sorted=t.childNodes.slice().sort(Iy)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(ia.DISPLAY_OBJECT_CHANGED)}}])}(),WT=/\[\s*(.*)=(.*)\s*\]/,GT=function(){function r(){oe(this,r)}return le(r,[{key:"selectOne",value:function(t,n){var i=this;if(t.startsWith("."))return n.find(function(l){return((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.find(function(l){return l.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var s=this.getAttribute(t),a=s.name,o=s.value;return a?n.find(function(l){return n!==l&&(a==="name"?l.name===o:i.attributeToString(l,a)===o)}):null}return n.find(function(l){return n!==l&&l.nodeName===t})}},{key:"selectAll",value:function(t,n){var i=this;if(t.startsWith("."))return n.findAll(function(l){return n!==l&&((l==null?void 0:l.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.findAll(function(l){return n!==l&&l.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var s=this.getAttribute(t),a=s.name,o=s.value;return a?n.findAll(function(l){return n!==l&&(a==="name"?l.name===o:i.attributeToString(l,a)===o)}):[]}return n.findAll(function(l){return n!==l&&l.nodeName===t})}},{key:"is",value:function(t,n){if(t.startsWith("."))return n.className===this.getIdOrClassname(t);if(t.startsWith("#"))return n.id===this.getIdOrClassname(t);if(t.startsWith("[")){var i=this.getAttribute(t),s=i.name,a=i.value;return s==="name"?n.name===a:this.attributeToString(n,s)===a}return n.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var n=t.match(WT),i="",s="";return n&&n.length>2&&(i=n[1].replace(/"/g,""),s=n[2].replace(/"/g,"")),{name:i,value:s}}},{key:"attributeToString",value:function(t,n){if(!t.getAttribute)return"";var i=t.getAttribute(n);return Ae(i)?"":i.toString?i.toString():""}}])}(),Ue=function(r){return r.REPARENT="reparent",r.DESTROY="destroy",r.ATTR_MODIFIED="DOMAttrModified",r.INSERTED="DOMNodeInserted",r.REMOVED="removed",r.MOUNTED="DOMNodeInsertedIntoDocument",r.UNMOUNTED="DOMNodeRemovedFromDocument",r.BOUNDS_CHANGED="bounds-changed",r.CULLED="culled",r}({}),Wr=function(r){function e(t,n,i,s,a,o,l,u){var c;return oe(this,e),c=Fe(this,e,[null]),c.relatedNode=n,c.prevValue=i,c.newValue=s,c.attrName=a,c.attrChange=o,c.prevParsedValue=l,c.newParsedValue=u,c.type=t,c}return $e(e,r),le(e)}(Au);Wr.ADDITION=2;Wr.MODIFICATION=1;Wr.REMOVAL=3;function wp(r){var e=r.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var YT=new Wr(Ue.REPARENT,null,"","","",0,"",""),VT=Af(),Uo=Xe(),UT=ht(1,1,1),HT=ut(),XT=Af(),mi=Xe(),Ws=ut(),yi=qt(),qT=Xe(),ZT=qt(),KT=Xe(),ka=Xe(),is=Xe(),Ho=ut(),xp=qt(),Ep=qt(),Xo=qt(),gd={affectChildren:!0},QT=function(){function r(e){oe(this,r),this.pendingEvents=new Map,this.boundsChangedEvent=new Wt(Ue.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}return le(r,[{key:"matches",value:function(t,n){return this.runtime.sceneGraphSelector.is(t,n)}},{key:"querySelector",value:function(t,n){return this.runtime.sceneGraphSelector.selectOne(t,n)}},{key:"querySelectorAll",value:function(t,n){return this.runtime.sceneGraphSelector.selectAll(t,n)}},{key:"attach",value:function(t,n,i){var s,a=!1;t.parentNode&&(a=t.parentNode!==n,this.detach(t));var o=t.nodeName===ee.FRAGMENT,l=iu(n);t.parentNode=n;var u=o?t.childNodes:[t];ye(i)?u.forEach(function(f){n.childNodes.splice(i,0,f),f.parentNode=n}):u.forEach(function(f){n.childNodes.push(f),f.parentNode=n});var c=n,d=c.sortable;if((d!=null&&(s=d.sorted)!==null&&s!==void 0&&s.length||t.parsedStyle.zIndex)&&(d.dirtyChildren.indexOf(t)===-1&&d.dirtyChildren.push(t),d.dirty=!0,d.dirtyReason=tu.ADDED),!l){if(o)this.dirtifyFragment(t);else{var h=t.transformable;h&&this.dirtifyWorld(t,h)}a&&t.dispatchEvent(YT)}}},{key:"detach",value:function(t){if(t.parentNode){var n,i,s=t.transformable,a=t.parentNode,o=a.sortable;(o!=null&&(n=o.sorted)!==null&&n!==void 0&&n.length||(i=t.style)!==null&&i!==void 0&&i.zIndex)&&(o.dirtyChildren.indexOf(t)===-1&&o.dirtyChildren.push(t),o.dirty=!0,o.dirtyReason=tu.REMOVED);var l=t.parentNode.childNodes.indexOf(t);l>-1&&t.parentNode.childNodes.splice(l,1),s&&this.dirtifyWorld(t,s),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=[n,i,s]);var a=t.transformable;if(!(n[0]===a.origin[0]&&n[1]===a.origin[1]&&n[2]===a.origin[2])){var o=a.origin;o[0]=n[0],o[1]=n[1],o[2]=n[2]||0,this.dirtifyLocal(t,a)}}},{key:"rotate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=ht(n,i,s));var a=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.rotateLocal(t,n);else{var o=yi;zo(o,n[0],n[1],n[2]);var l=this.getRotation(t),u=this.getRotation(t.parentNode);Fo(Xo,u),Jc(Xo,Xo),Bi(o,Xo,o),Bi(a.localRotation,o,l),Xl(a.localRotation,a.localRotation),this.dirtifyLocal(t,a)}}},{key:"rotateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=ht(n,i,s));var a=t.transformable;zo(Ep,n[0],n[1],n[2]),Yg(a.localRotation,a.localRotation,Ep),this.dirtifyLocal(t,a)}},{key:"setEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=ht(n,i,s));var a=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.setLocalEulerAngles(t,n);else{zo(a.localRotation,n[0],n[1],n[2]);var o=this.getRotation(t.parentNode);Fo(xp,Jc(yi,o)),Yg(a.localRotation,a.localRotation,xp),this.dirtifyLocal(t,a)}}},{key:"setLocalEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof n=="number"&&(n=ht(n,i,s));var o=t.transformable;zo(o.localRotation,n[0],n[1],n[2]),a&&this.dirtifyLocal(t,o)}},{key:"translateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=ht(n,i,s));var a=t.transformable;Ta(n,Uo)||($E(n,n,a.localRotation),ji(a.localPosition,a.localPosition,n),this.dirtifyLocal(t,a))}},{key:"setPosition",value:function(t,n){var i,s=t.transformable;if(is[0]=n[0],is[1]=n[1],is[2]=(i=n[2])!==null&&i!==void 0?i:0,!Ta(this.getPosition(t),is)){if(jr(s.position,is),t.parentNode===null||!t.parentNode.transformable)jr(s.localPosition,is);else{var a=t.parentNode.transformable;oa(Ho,a.worldTransform),Rr(Ho,Ho),Sn(s.localPosition,is,Ho)}this.dirtifyLocal(t,s)}}},{key:"setLocalPosition",value:function(t,n){var i,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=t.transformable;ka[0]=n[0],ka[1]=n[1],ka[2]=(i=n[2])!==null&&i!==void 0?i:0,!Ta(a.localPosition,ka)&&(jr(a.localPosition,ka),s&&this.dirtifyLocal(t,a))}},{key:"scaleLocal",value:function(t,n){var i,s=t.transformable;RE(s.localScale,s.localScale,En(mi,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:1)),this.dirtifyLocal(t,s)}},{key:"setLocalScale",value:function(t,n){var i,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=t.transformable;En(mi,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:a.localScale[2]),!Ta(mi,a.localScale)&&(jr(a.localScale,mi),s&&this.dirtifyLocal(t,a))}},{key:"translate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=En(mi,n,i,s)),!Ta(n,Uo)&&(ji(mi,this.getPosition(t),n),this.setPosition(t,mi))}},{key:"setRotation",value:function(t,n,i,s,a){var o=t.transformable;if(typeof n=="number"&&(n=HE(n,i,s,a)),t.parentNode===null||!t.parentNode.transformable)this.setLocalRotation(t,n);else{var l=this.getRotation(t.parentNode);Fo(yi,l),Jc(yi,yi),Bi(o.localRotation,yi,n),Xl(o.localRotation,o.localRotation),this.dirtifyLocal(t,o)}}},{key:"setLocalRotation",value:function(t,n,i,s,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof n=="number"&&(n=Gg(yi,n,i,s,a));var l=t.transformable;Fo(l.localRotation,n),o&&this.dirtifyLocal(t,l)}},{key:"setLocalSkew",value:function(t,n,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof n=="number"&&(n=qE(XT,n,i));var a=t.transformable;XE(a.localSkew,n),s&&this.dirtifyLocal(t,a)}},{key:"dirtifyLocal",value:function(t,n){iu(t)||n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(t,n))}},{key:"dirtifyWorld",value:function(t,n){n.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,n),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var n=t.transformable;n&&(n.frozen=!1,n.dirtyFlag=!0,n.localDirtyFlag=!0);var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0);for(var s=t.childNodes.length,a=0;a<s;a++)this.dirtifyFragment(t.childNodes[a]);t.nodeName===ee.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,n=new Set,i=function(a,o){!a.isConnected||n.has(a)||a.nodeName===ee.FRAGMENT||(t.boundsChangedEvent.detail=o,t.boundsChangedEvent.target=a,a.isMutationObserved?a.dispatchEvent(t.boundsChangedEvent):a.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),n.add(a))};this.pendingEvents.forEach(function(s,a){a.nodeName!==ee.FRAGMENT&&(gd.affectChildren=s,s?a.forEach(function(o){i(o,gd)}):i(a,gd))}),n.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t;for(i.renderable&&(i.renderable.dirty=!0);i;)wp(i),i=i.parentNode;n&&t.forEach(function(s){wp(s)}),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"updateDisplayObjectDependency",value:function(t,n,i,s){if(n&&n!==i){var a=this.displayObjectDependencyMap.get(n);if(a&&a[t]){var o=a[t].indexOf(s);a[t].splice(o,1)}}if(i){var l=this.displayObjectDependencyMap.get(i);l||(this.displayObjectDependencyMap.set(i,{}),l=this.displayObjectDependencyMap.get(i)),l[t]||(l[t]=[]),l[t].push(s)}}},{key:"informDependentDisplayObjects",value:function(t){var n=this,i=this.displayObjectDependencyMap.get(t);i&&Object.keys(i).forEach(function(s){i[s].forEach(function(a){n.dirtifyToRoot(a,!0),a.dispatchEvent(new Wr(Ue.ATTR_MODIFIED,a,n,n,s,Wr.MODIFICATION,n,n)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(s,n,n)})})}},{key:"getPosition",value:function(t){var n=t.transformable;return Vl(n.position,this.getWorldTransform(t,n))}},{key:"getRotation",value:function(t){var n=t.transformable;return Ul(n.rotation,this.getWorldTransform(t,n))}},{key:"getScale",value:function(t){var n=t.transformable;return la(n.scaling,this.getWorldTransform(t,n))}},{key:"getWorldTransform",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.transformable;return!n.localDirtyFlag&&!n.dirtyFlag||(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,n)),n.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){var n=t.localSkew[0]!==0||t.localSkew[1]!==0;if(n){Va(t.localTransform,t.localRotation,t.localPosition,ht(1,1,1),t.origin),(t.localSkew[0]!==0||t.localSkew[1]!==0)&&(Wi(Ws),Ws[4]=Math.tan(t.localSkew[0]),Ws[1]=Math.tan(t.localSkew[1]),Mn(t.localTransform,t.localTransform,Ws));var i=Va(Ws,Gg(yi,0,0,0,1),En(mi,1,1,1),t.localScale,t.origin);Mn(t.localTransform,t.localTransform,i)}else{var s=t.localTransform,a=t.localPosition,o=t.localRotation,l=t.localScale,u=t.origin,c=a[0]!==0||a[1]!==0||a[2]!==0,d=o[3]!==1||o[0]!==0||o[1]!==0||o[2]!==0,h=l[0]!==1||l[1]!==1||l[2]!==1,f=u[0]!==0||u[1]!==0||u[2]!==0;!d&&!h&&!f?c?Oi(s,a):Wi(s):Va(s,o,a,l,u)}}},{key:"getLocalTransform",value:function(t){var n=t.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform}},{key:"setLocalTransform",value:function(t,n){var i=Vl(qT,n),s=Ul(ZT,n),a=la(KT,n);this.setLocalScale(t,a,!1),this.setLocalPosition(t,i,!1),this.setLocalRotation(t,s,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,UT,!1),this.setLocalPosition(t,Uo,!1),this.setLocalEulerAngles(t,Uo,void 0,void 0,!1),this.setLocalSkew(t,VT,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0,s=this.getGeometryBounds(t,n);if(!ct.isEmpty(s)){var a=i||new ct;return a.setFromTransformedAABB(s,this.getWorldTransform(t)),a}return null}},{key:"getGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t,s=i.geometry;s.dirty&&ce.styleValueRegistry.updateGeometry(t);var a=n?s.renderBounds:s.contentBounds||null;return a||new ct}},{key:"getBounds",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=t,a=s.renderable;if(!a.boundsDirty&&!i&&a.bounds)return a.bounds;if(!a.renderBoundsDirty&&i&&a.renderBounds)return a.renderBounds;var o=i?a.renderBounds:a.bounds,l=this.getTransformedGeometryBounds(t,i,o),u=t.childNodes;if(u.forEach(function(h){var f=n.getBounds(h,i);f&&(l?l.add(f):(l=o||new ct,l.update(f.center,f.halfExtents)))}),l||(l=new ct),i){var c=Ry(t);if(c){var d=c.parsedStyle.clipPath.getBounds(i);l?d&&(l=d.intersection(l)):l.update(d.center,d.halfExtents)}}return i?(a.renderBounds=l,a.renderBoundsDirty=!1):(a.bounds=l,a.boundsDirty=!1),l}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var n=HT;t.parentNode.transformable&&(n=Rr(Ws,this.getWorldTransform(t.parentNode)));var i=this.getBounds(t);if(!ct.isEmpty(i)){var s=new ct;return s.setFromTransformedAABB(i,n),s}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var n,i,s=this.getGeometryBounds(t);ct.isEmpty(s)||(i=new ct,i.setFromTransformedAABB(s,this.getWorldTransform(t)));var a=(n=t.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(i){var o=i.getMin(),l=Be(o,2),u=l[0],c=l[1],d=i.getMax(),h=Be(d,2),f=h[0],g=h[1];return new ca(u+((a==null?void 0:a.left)||0),c+((a==null?void 0:a.top)||0),f-u,g-c)}return new ca((a==null?void 0:a.left)||0,(a==null?void 0:a.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,n){var i=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,t.childNodes.forEach(function(o){var l=o.transformable;l.dirtyFlag||i.dirtifyWorldInternal(o,l)});var s=t,a=s.renderable;a&&(a.renderBoundsDirty=!0,a.boundsDirty=!0,a.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var n=t.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(t,n);for(var i=t.childNodes,s=0;s<i.length;s++)this.syncHierarchy(i[s])}}},{key:"sync",value:function(t,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var i=t.parentNode,s=i&&i.transformable;i===null||!s?oa(n.worldTransform,n.localTransform):Mn(n.worldTransform,s.worldTransform,n.localTransform),n.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var n=t.parentNode;n;){var i=n.transformable;i&&(i.frozen=!1),n=n.parentNode}}}])}(),ss={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Mp=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,JT=/[!%),.:;?\]}'""]/,eO=/[$('"]/,tO=/[!),.:;?\]}'""]/,nO=/[([{'"]/,rO=/[)\]'"?!:;,.]/,iO=/[(['"...]/,sO=/[!%),.:;?\]}'"]/,aO=/[$([{'"#]/,oO=new RegExp("".concat(JT.source,"|").concat(tO.source,"|").concat(rO.source,"|").concat(sO.source)),lO=new RegExp("".concat(eO.source,"|").concat(nO.source,"|").concat(iO.source,"|").concat(aO.source)),uO=function(){function r(e){var t=this;oe(this,r),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,i){return t.isBreakingSpace(i)?!1:!!(n&&(lO.exec(i)||oO.exec(n)))},this.trimByKinsokuShorui=function(n){var i=wt(n),s=i[i.length-2];if(!s)return n;var a=s[s.length-1];return i[i.length-2]=s.slice(0,-1),i[i.length-1]=a+i[i.length-1],i},this.runtime=e}return le(r,[{key:"measureFont",value:function(t,n){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var i={ascent:0,descent:0,fontSize:0},s=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});a.font=t;var o=ss.MetricsString+ss.BaselineSymbol,l=Math.ceil(a.measureText(o).width),u=Math.ceil(a.measureText(ss.BaselineSymbol).width),c=ss.HeightMultiplier*u;u=u*ss.BaselineMultiplier|0,s.width=l,s.height=c,a.fillStyle="#f00",a.fillRect(0,0,l,c),a.font=t,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,u);var d=a.getImageData(0,0,l||1,c||1).data,h=d.length,f=l*4,g=0,v=0,p=!1;for(g=0;g<u;++g){for(var y=0;y<f;y+=4)if(d[v+y]!==255){p=!0;break}if(!p)v+=f;else break}for(i.ascent=u-g,v=h-f,p=!1,g=c;g>u;--g){for(var b=0;b<f;b+=4)if(d[v+b]!==255){p=!0;break}if(!p)v-=f;else break}return i.descent=g-u,i.fontSize=i.ascent+i.descent,this.fontMetricsCache[t]=i,i}},{key:"measureText",value:function(t,n,i){var s=n.fontSize,a=s===void 0?16:s,o=n.wordWrap,l=o===void 0?!1:o,u=n.lineHeight,c=n.lineWidth,d=c===void 0?1:c,h=n.textBaseline,f=h===void 0?"alphabetic":h,g=n.textAlign,v=g===void 0?"start":g,p=n.letterSpacing,y=p===void 0?0:p,b=n.textPath;n.textPathSide,n.textPathStartOffset;var E=n.leading,T=E===void 0?0:E,S=ET(n),k=this.measureFont(S,i);k.fontSize===0&&(k.fontSize=a,k.ascent=a);var A=this.runtime.offscreenCanvasCreator.getOrCreateContext(i);A.font=S,n.isOverflowing=!1;var O=l?this.wordWrap(t,n,i):t,C=O.split(/(?:\r\n|\r|\n)/),P=new Array(C.length),L=0;if(b){b.getTotalLength();for(var R=0;R<C.length;R++)A.measureText(C[R]).width+(C[R].length-1)*y}else{for(var z=0;z<C.length;z++){var Y=A.measureText(C[z]).width+(C[z].length-1)*y;P[z]=Y,L=Math.max(L,Y)}var U=L+d,V=u||k.fontSize+d,W=Math.max(V,k.fontSize+d)+(C.length-1)*(V+T);V+=T;var F=0;return f==="middle"?F=-W/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?F=-W:(f==="top"||f==="hanging")&&(F=0),{font:S,width:U,height:W,lines:C,lineWidths:P,lineHeight:V,maxLineWidth:L,fontProperties:k,lineMetrics:P.map(function(K,re){var se=0;return v==="center"||v==="middle"?se-=K/2:(v==="right"||v==="end")&&(se-=K),new ca(se-d/2,F+re*V,K+d,V)})}}}},{key:"wordWrap",value:function(t,n,i){var s=this,a=n.wordWrapWidth,o=a===void 0?0:a,l=n.letterSpacing,u=l===void 0?0:l,c=n.maxLines,d=c===void 0?1/0:c,h=n.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(i),g=o+u,v="";h==="ellipsis"?v="...":h&&h!=="clip"&&(v=h);var p=[],y=0,b=0,E={},T=function(Y){return s.getFromCache(Y,u,E,f)},S=Array.from(v).reduce(function(z,Y){return z+T(Y)},0);function k(z){if(!(S<=0||S>g)){for(var Y=p[z].length,U=0,V=Y,W=0;W<Y;W++){var F=T(p[z][W]);if(U+F+S>g){V=W;break}U+=F}p[z]=(p[z]||"").slice(0,V)+v}}for(var A=Array.from(t),O=0;O<A.length;O++){var C=A[O],P=t[O-1],L=t[O+1],R=T(C);if(this.isNewline(C)){if(y++,y>=d){n.isOverflowing=!0,O<A.length-1&&k(y-1);break}b=0,p[y]="";continue}if(b>0&&b+R>g){if(y+1>=d){n.isOverflowing=!0,k(y);break}if(y++,b=0,p[y]="",this.isBreakingSpace(C))continue;this.canBreakInLastChar(C)||(p=this.trimToBreakable(p),b=this.sumTextWidthByCache(p[y]||"",E)),this.shouldBreakByKinsokuShorui(C,L)&&(p=this.trimByKinsokuShorui(p),b+=T(P||""))}b+=R,p[y]=(p[y]||"")+C}return p.join(`
`)}},{key:"isBreakingSpace",value:function(t){return typeof t!="string"?!1:ss.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return typeof t!="string"?!1:ss.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var n=wt(t),i=n[n.length-2],s=this.findBreakableIndex(i);if(s===-1||!i)return n;var a=i.slice(s,s+1),o=this.isBreakingSpace(a),l=s+1,u=s+(o?0:1);return n[n.length-1]+=i.slice(l,i.length),n[n.length-2]=i.slice(0,u),n}},{key:"canBreakInLastChar",value:function(t){return!(t&&Mp.test(t))}},{key:"sumTextWidthByCache",value:function(t,n){return t.split("").reduce(function(i,s){if(!n[s])throw Error("cannot count the word without cache");return i+n[s]},0)}},{key:"findBreakableIndex",value:function(t){for(var n=t.length-1;n>=0;n--)if(!Mp.test(t[n]))return n;return-1}},{key:"getFromCache",value:function(t,n,i,s){var a=i[t];if(typeof a!="number"){var o=t.length*n;a=s.measureText(t).width+o,i[t]=a}return a}}])}(),ce={},cO=function(r){var e=new IT,t=new DT;return r={},be(be(be(be(be(be(be(be(be(be(r,ee.FRAGMENT,null),ee.CIRCLE,new CT),ee.ELLIPSE,new PT),ee.RECT,e),ee.IMAGE,e),ee.GROUP,new jT),ee.LINE,new _T),ee.TEXT,new RT(ce)),ee.POLYLINE,t),ee.POLYGON,t),be(be(be(r,ee.PATH,new LT),ee.HTML,new BT),ee.MESH,null)}(),dO=function(r){var e=new WS,t=new zh;return r={},be(be(be(be(be(be(be(be(be(be(r,ve.PERCENTAGE,null),ve.NUMBER,new HS),ve.ANGLE,new FS),ve.DEFINED_PATH,new $S),ve.PAINT,e),ve.COLOR,e),ve.FILTER,new GS),ve.LENGTH,t),ve.LENGTH_PERCENTAGE,t),ve.LENGTH_PERCENTAGE_12,new YS),be(be(be(be(be(be(be(be(be(be(r,ve.LENGTH_PERCENTAGE_14,new VS),ve.COORDINATE,new zh),ve.OFFSET_DISTANCE,new XS),ve.OPACITY_VALUE,new qS),ve.PATH,new ZS),ve.LIST_OF_POINTS,new KS),ve.SHADOW_BLUR,new QS),ve.TEXT,new JS),ve.TEXT_TRANSFORM,new eT),ve.TRANSFORM,new kT),be(be(be(r,ve.TRANSFORM_ORIGIN,new NT),ve.Z_INDEX,new AT),ve.MARKER,new US)}(),hO=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};ce.CameraContribution=yy;ce.AnimationTimeline=null;ce.EasingFunction=null;ce.offscreenCanvasCreator=new jf;ce.sceneGraphSelector=new GT;ce.sceneGraphService=new QT(ce);ce.textService=new uO(ce);ce.geometryUpdaterFactory=cO;ce.CSSPropertySyntaxFactory=dO;ce.styleValueRegistry=new BS(ce);ce.layoutRegistry=null;ce.globalThis=hO();ce.enableStyleSyntax=!0;ce.enableSizeAttenuation=!1;var fO=0,Wh=new Wr(Ue.INSERTED,null,"","","",0,"",""),Gh=new Wr(Ue.REMOVED,null,"","","",0,"",""),Yy=new Wt(Ue.DESTROY),gO=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.entity=fO++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:LM.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return $e(e,r),le(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(n){return n!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null}},{key:"cloneNode",value:function(n){throw new Error(tt)}},{key:"appendChild",value:function(n,i){var s;if(n.destroyed)throw new Error(EM);return ce.sceneGraphService.attach(n,this,i),(s=this.ownerDocument)!==null&&s!==void 0&&s.defaultView&&(!iu(this)&&n.nodeName===ee.FRAGMENT?this.ownerDocument.defaultView.mountFragment(n):this.ownerDocument.defaultView.mountChildren(n)),this.isMutationObserved&&(Wh.relatedNode=this,n.dispatchEvent(Wh)),n}},{key:"insertBefore",value:function(n,i){if(!i)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var s=this.childNodes.indexOf(i);s===-1?this.appendChild(n):this.appendChild(n,s)}return n}},{key:"replaceChild",value:function(n,i){var s=this.childNodes.indexOf(i);return this.removeChild(i),this.appendChild(n,s),i}},{key:"removeChild",value:function(n){var i;return Gh.relatedNode=this,n.dispatchEvent(Gh),(i=n.ownerDocument)!==null&&i!==void 0&&i.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),ce.sceneGraphService.detach(n),n}},{key:"removeChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];this.removeChild(i)}}},{key:"destroyChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];i.childNodes.length>0&&i.destroyChildren(),i.destroy()}}},{key:"matches",value:function(n){return ce.sceneGraphService.matches(n,this)}},{key:"getElementById",value:function(n){return ce.sceneGraphService.querySelector("#".concat(n),this)}},{key:"getElementsByName",value:function(n){return ce.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)}},{key:"getElementsByClassName",value:function(n){return ce.sceneGraphService.querySelectorAll(".".concat(n),this)}},{key:"getElementsByTagName",value:function(n){return ce.sceneGraphService.querySelectorAll(n,this)}},{key:"querySelector",value:function(n){return ce.sceneGraphService.querySelector(n,this)}},{key:"querySelectorAll",value:function(n){return ce.sceneGraphService.querySelectorAll(n,this)}},{key:"closest",value:function(n){var i=this;do{if(ce.sceneGraphService.matches(n,i))return i;i=i.parentElement}while(i!==null);return null}},{key:"find",value:function(n){var i=this,s=null;return this.forEach(function(a){return a!==i&&n(a)?(s=a,!1):!0}),s}},{key:"findAll",value:function(n){var i=this,s=[];return this.forEach(function(a){a!==i&&n(a)&&s.push(a)}),s}},{key:"after",value:function(){var n=this;if(this.parentNode){for(var i=this.parentNode.childNodes.indexOf(this),s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];a.forEach(function(l,u){var c;return(c=n.parentNode)===null||c===void 0?void 0:c.appendChild(l,i+u+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var n,i=this.parentNode.childNodes.indexOf(this),s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];var l=a[0],u=a.slice(1);this.parentNode.appendChild(l,i),(n=l).after.apply(n,wt(u))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var n=this,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];s.forEach(function(o){return n.appendChild(o)})}},{key:"prepend",value:function(){for(var n=this,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];s.forEach(function(o,l){return n.appendChild(o,l)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(Yy),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return ce.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return ce.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return ce.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return ce.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return ce.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(n){if(typeof n!="symbol"){var i=this.attributes[n];return i}}},{key:"hasAttribute",value:function(n){return this.getAttributeNames().includes(n)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(n){this.setAttribute(n,null),delete this.attributes[n]}},{key:"setAttribute",value:function(n,i,s,a){this.attributes[n]=i}},{key:"getAttributeNS",value:function(n,i){throw new Error(tt)}},{key:"getAttributeNode",value:function(n){throw new Error(tt)}},{key:"getAttributeNodeNS",value:function(n,i){throw new Error(tt)}},{key:"hasAttributeNS",value:function(n,i){throw new Error(tt)}},{key:"removeAttributeNS",value:function(n,i){throw new Error(tt)}},{key:"removeAttributeNode",value:function(n){throw new Error(tt)}},{key:"setAttributeNS",value:function(n,i,s){throw new Error(tt)}},{key:"setAttributeNode",value:function(n){throw new Error(tt)}},{key:"setAttributeNodeNS",value:function(n){throw new Error(tt)}},{key:"toggleAttribute",value:function(n,i){throw new Error(tt)}}])}(Tt);function Ze(r){return!!(r!=null&&r.nodeName)}var pO=ce.globalThis.Proxy?ce.globalThis.Proxy:function(){},Dr=new Wr(Ue.ATTR_MODIFIED,null,null,null,null,Wr.MODIFICATION,null,null),Na=Xe(),vO=qt(),gt=function(r){function e(t){var n;return oe(this,e),n=Fe(this,e),n.isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||ee.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),ce.enableStyleSyntax&&(n.style=new pO({setProperty:function(s,a){n.setAttribute(s,a)},getPropertyValue:function(s){return n.getAttribute(s)},removeProperty:function(s){n.removeAttribute(s)},item:function(){return""}},{get:function(s,a){return s[a]!==void 0?s[a]:n.getAttribute(a)},set:function(s,a,o){return n.setAttribute(a,o),!0}})),n}return $e(e,r),le(e,[{key:"destroy",value:function(){Zg(e,"destroy",this)([]),this.getAnimations().forEach(function(n){n.cancel()})}},{key:"cloneNode",value:function(n,i){var s=We({},this.attributes);for(var a in s){var o=s[a];Ze(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(s[a]=o.cloneNode(n)),i&&(s[a]=i(a,o))}var l=new this.constructor(We(We({},this.config),{},{style:s}));return l.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(u){if(!u.style.isMarker){var c=u.cloneNode(n);l.appendChild(c)}}),l}},{key:"initAttributes",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={forceUpdateGeometry:!0};ce.styleValueRegistry.processProperties(this,n,i),this.renderable.dirty=!0}},{key:"setAttribute",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Ie(i)||(s||i!==this.attributes[n])&&(this.internalSetAttribute(n,i,{memoize:a}),Zg(e,"setAttribute",this)([n,i]))}},{key:"internalSetAttribute",value:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=this.renderable,o=this.attributes[n],l=this.parsedStyle[n];ce.styleValueRegistry.processProperties(this,be({},n,i),s),a.dirty=!0;var u=this.parsedStyle[n];if(this.isConnected&&(Dr.relatedNode=this,Dr.prevValue=o,Dr.newValue=i,Dr.attrName=n,Dr.prevParsedValue=l,Dr.newParsedValue=u,this.isMutationObserved?this.dispatchEvent(Dr):(Dr.target=this,this.ownerDocument.defaultView.dispatchEvent(Dr,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var c,d;(c=(d=this).attributeChangedCallback)===null||c===void 0||c.call(d,n,o,i,l,u)}}},{key:"getBBox",value:function(){var n=this.getBounds(),i=n.getMin(),s=Be(i,2),a=s[0],o=s[1],l=n.getMax(),u=Be(l,2),c=u[0],d=u[1];return new ca(a,o,c-a,d-o)}},{key:"setOrigin",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ce.sceneGraphService.setOrigin(this,kn(n,i,s,!1)),this}},{key:"getOrigin",value:function(){return ce.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ce.sceneGraphService.setPosition(this,kn(n,i,s,!1)),this}},{key:"setLocalPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ce.sceneGraphService.setLocalPosition(this,kn(n,i,s,!1)),this}},{key:"translate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ce.sceneGraphService.translate(this,kn(n,i,s,!1)),this}},{key:"translateLocal",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return ce.sceneGraphService.translateLocal(this,kn(n,i,s,!1)),this}},{key:"getPosition",value:function(){return ce.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return ce.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(n,i,s){return this.scaleLocal(n,i,s)}},{key:"scaleLocal",value:function(n,i,s){return typeof n=="number"&&(i=i||n,s=s||n,n=kn(n,i,s,!1)),ce.sceneGraphService.scaleLocal(this,n),this}},{key:"setLocalScale",value:function(n,i,s){return typeof n=="number"&&(i=i||n,s=s||n,n=kn(n,i,s,!1)),ce.sceneGraphService.setLocalScale(this,n),this}},{key:"getLocalScale",value:function(){return ce.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return ce.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var n=sd(Na,ce.sceneGraphService.getWorldTransform(this)),i=Be(n,3),s=i[2];return Fn(s)}},{key:"getLocalEulerAngles",value:function(){var n=sd(Na,ce.sceneGraphService.getLocalRotation(this)),i=Be(n,3),s=i[2];return Fn(s)}},{key:"setEulerAngles",value:function(n){return ce.sceneGraphService.setEulerAngles(this,0,0,n),this}},{key:"setLocalEulerAngles",value:function(n){return ce.sceneGraphService.setLocalEulerAngles(this,0,0,n),this}},{key:"rotateLocal",value:function(n,i,s){return Ae(i)&&Ae(s)?ce.sceneGraphService.rotateLocal(this,0,0,n):ce.sceneGraphService.rotateLocal(this,n,i,s),this}},{key:"rotate",value:function(n,i,s){return Ae(i)&&Ae(s)?ce.sceneGraphService.rotate(this,0,0,n):ce.sceneGraphService.rotate(this,n,i,s),this}},{key:"setRotation",value:function(n,i,s,a){return ce.sceneGraphService.setRotation(this,n,i,s,a),this}},{key:"setLocalRotation",value:function(n,i,s,a){return ce.sceneGraphService.setLocalRotation(this,n,i,s,a),this}},{key:"setLocalSkew",value:function(n,i){return ce.sceneGraphService.setLocalSkew(this,n,i),this}},{key:"getRotation",value:function(){return ce.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return ce.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return ce.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return ce.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return ce.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(n){return ce.sceneGraphService.setLocalTransform(this,n),this}},{key:"resetLocalTransform",value:function(){ce.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(n,i){var s,a=(s=this.ownerDocument)===null||s===void 0?void 0:s.timeline;return a?a.play(this,n,i):null}},{key:"isVisible",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"}},{key:"isInteractive",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,wt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,wt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var n=this,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];var o=s[0],l=s[1];return o?Bt(o)?(Object.keys(o).forEach(function(u){n.setAttribute(u,o[u])}),this):s.length===2?(this.setAttribute(o,l),this):this.attributes[o]:this.attributes}},{key:"getMatrix",value:function(n){var i=n||this.getWorldTransform(),s=Vl(Na,i),a=Be(s,2),o=a[0],l=a[1],u=la(Na,i),c=Be(u,2),d=c[0],h=c[1],f=Ul(vO,i),g=sd(Na,f),v=Be(g,3),p=v[0],y=v[2];return NM(p||y,o,l,d,h)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(n){var i=np(n),s=Be(i,5),a=s[0],o=s[1],l=s[2],u=s[3],c=s[4];this.setEulerAngles(c).setPosition(a,o).setLocalScale(l,u)}},{key:"setLocalMatrix",value:function(n){var i=np(n),s=Be(i,5),a=s[0],o=s[1],l=s[2],u=s[3],c=s[4];this.setLocalEulerAngles(c).setLocalPosition(a,o).setLocalScale(l,u)}},{key:"show",value:function(){this.forEach(function(n){n.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(n){n.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(n){return this.children[n]||null}},{key:"add",value:function(n,i){return this.appendChild(n,i)}},{key:"set",value:function(n,i){this.config[n]=i}},{key:"get",value:function(n){return this.config[n]}},{key:"moveTo",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,s),this}},{key:"move",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,s),this}},{key:"setZIndex",value:function(n){return this.style.zIndex=n,this}}])}(gO);gt.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var pi=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),Fe(this,e,[We({type:ee.CIRCLE},t)])}return $e(e,r),le(e)}(gt);pi.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var mO=["style"],Bf=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,s=As(n,mO);return oe(this,e),t=Fe(this,e,[We({style:i},s)]),t.isCustomElement=!0,t}return $e(e,r),le(e)}(gt);Bf.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var bo=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),Fe(this,e,[We({type:ee.ELLIPSE},t)])}return $e(e,r),le(e)}(gt);bo.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var yO=function(r){function e(){return oe(this,e),Fe(this,e,[{type:ee.FRAGMENT}])}return $e(e,r),le(e)}(gt);yO.PARSED_STYLE_LIST=new Set(["class","className"]);var Jt=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),Fe(this,e,[We({type:ee.GROUP},t)])}return $e(e,r),le(e)}(gt);Jt.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var bO=["style"],wo=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,s=As(n,bO);return oe(this,e),t=Fe(this,e,[We({type:ee.HTML,style:i},s)]),t.cullable.enable=!1,t}return $e(e,r),le(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var n=Rr(ut(),this.parentNode.getWorldTransform()),i=this.getBounds();if(!ct.isEmpty(i)){var s=new ct;return s.setFromTransformedAABB(i,n),s}}return this.getBounds()}}])}(gt);wo.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var xo=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),Fe(this,e,[We({type:ee.IMAGE},t)])}return $e(e,r),le(e)}(gt);xo.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var wO=["style"],Ss=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,s=As(n,wO);oe(this,e),t=Fe(this,e,[We({type:ee.LINE,style:We({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},s)]),t.markerStartAngle=0,t.markerEndAngle=0;var a=t.parsedStyle,o=a.markerStart,l=a.markerEnd;return o&&Ze(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&Ze(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return $e(e,r),le(e,[{key:"attributeChangedCallback",value:function(n,i,s,a,o){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"&&(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,s=i.markerStart,a=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=i.x1,c=i.x2,d=i.y1,h=i.y2,f=n?s:a;if(!(!f||!Ze(f))){var g=0,v,p,y,b,E,T;n?(y=u,b=d,v=c-u,p=h-d,E=o||0,T=this.markerStartAngle):(y=c,b=h,v=u-c,p=d-h,E=l||0,T=this.markerEndAngle),g=Math.atan2(p,v),f.setLocalEulerAngles(g*180/Math.PI+T),f.setLocalPosition(y+Math.cos(g)*E,b+Math.sin(g)*E)}}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.parsedStyle,a=s.x1,o=s.y1,l=s.x2,u=s.y2,c=py(a,o,l,u,n),d=c.x,h=c.y,f=Sn(Xe(),ht(d,h,0),i?this.getWorldTransform():this.getLocalTransform());return new hn(f[0],f[1])}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getTotalLength",value:function(){var n=this.parsedStyle,i=n.x1,s=n.y1,a=n.x2,o=n.y2;return gy(i,s,a,o)}}])}(gt);Ss.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var xO=["style"],Kn=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,s=As(n,xO);oe(this,e),t=Fe(this,e,[We({type:ee.PATH,style:i,initialParsedStyle:{miterLimit:4,d:We({},by)}},s)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,l=a.markerEnd,u=a.markerMid;return o&&Ze(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&Ze(u)&&t.placeMarkerMid(u),l&&Ze(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return $e(e,r),le(e,[{key:"attributeChangedCallback",value:function(n,i,s,a,o){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,s=i.markerStart,a=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=n?s:a;if(!(!u||!Ze(u))){var c=0,d,h,f,g,v,p;if(n){var y=this.getStartTangent(),b=Be(y,2),E=b[0],T=b[1];f=T[0],g=T[1],d=E[0]-T[0],h=E[1]-T[1],v=o||0,p=this.markerStartAngle}else{var S=this.getEndTangent(),k=Be(S,2),A=k[0],O=k[1];f=O[0],g=O[1],d=A[0]-O[0],h=A[1]-O[1],v=l||0,p=this.markerEndAngle}c=Math.atan2(h,d),u.setLocalEulerAngles(c*180/Math.PI+p),u.setLocalPosition(f+Math.cos(c)*v,g+Math.sin(c)*v)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),n&&Ze(n))for(var s=1;s<i.length-1;s++){var a=Be(i[s].currentPoint,2),o=a[0],l=a[1],u=s===1?n:n.cloneNode(!0);this.markerMidList.push(u),this.appendChild(u),u.setLocalPosition(o,l)}}},{key:"getTotalLength",value:function(){return jh(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.parsedStyle.d.absolutePath,a=K2(s,n),o=a.x,l=a.y,u=Sn(Xe(),ht(o,l,0),i?this.getWorldTransform():this.getLocalTransform());return new hn(u[0],u[1])}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(n*jh(this),i)}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.d.segments,i=[];if(n.length>1){var s=n[0].currentPoint,a=n[1].currentPoint,o=n[1].startTangent;i=[],o?(i.push([s[0]-o[0],s[1]-o[1]]),i.push([s[0],s[1]])):(i.push([a[0],a[1]]),i.push([s[0],s[1]]))}return i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.d.segments,i=n.length,s=[];if(i>1){var a=n[i-2].currentPoint,o=n[i-1].currentPoint,l=n[i-1].endTangent;s=[],l?(s.push([o[0]-l[0],o[1]-l[1]]),s.push([o[0],o[1]])):(s.push([a[0],a[1]]),s.push([o[0],o[1]]))}return s}}])}(gt);Kn.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var EO=["style"],Ps=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,s=As(n,EO);oe(this,e),t=Fe(this,e,[We({type:ee.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},s)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var a=t.parsedStyle,o=a.markerStart,l=a.markerEnd,u=a.markerMid;return o&&Ze(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&Ze(u)&&t.placeMarkerMid(u),l&&Ze(l)&&(t.markerEndAngle=l.getLocalEulerAngles(),t.appendChild(l)),t.transformMarker(!0),t.transformMarker(!1),t}return $e(e,r),le(e,[{key:"attributeChangedCallback",value:function(n,i,s,a,o){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,s=i.markerStart,a=i.markerEnd,o=i.markerStartOffset,l=i.markerEndOffset,u=i.points,c=u||{},d=c.points,h=n?s:a;if(!(!h||!Ze(h)||!d)){var f=0,g,v,p,y,b,E;if(p=d[0][0],y=d[0][1],n)g=d[1][0]-d[0][0],v=d[1][1]-d[0][1],b=o||0,E=this.markerStartAngle;else{var T=d.length;this.parsedStyle.isClosed?(g=d[T-1][0]-d[0][0],v=d[T-1][1]-d[0][1]):(p=d[T-1][0],y=d[T-1][1],g=d[T-2][0]-d[T-1][0],v=d[T-2][1]-d[T-1][1]),b=l||0,E=this.markerEndAngle}f=Math.atan2(v,g),h.setLocalEulerAngles(f*180/Math.PI+E),h.setLocalPosition(p+Math.cos(f)*b,y+Math.sin(f)*b)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.points,s=i||{},a=s.points;if(this.markerMidList.forEach(function(d){d.remove()}),this.markerMidList=[],n&&Ze(n)&&a)for(var o=1;o<(this.parsedStyle.isClosed?a.length:a.length-1);o++){var l=a[o][0],u=a[o][1],c=o===1?n:n.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(l,u)}}}])}(gt);Ps.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var MO=["style"],Cu=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=As(t,MO);return oe(this,e),Fe(this,e,[We({type:ee.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return $e(e,r),le(e,[{key:"getTotalLength",value:function(){return pS(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,l,u,c=this.getTotalLength();s.forEach(function(y,b){s[b+1]&&(l=[0,0],l[0]=o/c,u=gy(y[0],y[1],s[b+1][0],s[b+1][1]),o+=u,l[1]=o/c,a.push(l))}),this.parsedStyle.points.segments=a}var d=0,h=0;this.parsedStyle.points.segments.forEach(function(y,b){n>=y[0]&&n<=y[1]&&(d=(n-y[0])/(y[1]-y[0]),h=b)});var f=py(s[h][0],s[h][1],s[h+1][0],s[h+1][1],d),g=f.x,v=f.y,p=Sn(Xe(),ht(g,v,0),i?this.getWorldTransform():this.getLocalTransform());return new hn(p[0],p[1])}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.points.points,i=[];return i.push([n[1][0],n[1][1]]),i.push([n[0][0],n[0][1]]),i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.points.points,i=n.length-1,s=[];return s.push([n[i-1][0],n[i-1][1]]),s.push([n[i][0],n[i][1]]),s}}])}(Ps);Cu.PARSED_STYLE_LIST=new Set([].concat(wt(Ps.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var pn=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),Fe(this,e,[We({type:ee.RECT},t)])}return $e(e,r),le(e)}(gt);pn.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var SO=["style"],_s=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=As(t,SO);return oe(this,e),Fe(this,e,[We({type:ee.TEXT,style:We({fill:"black"},n)},i)])}return $e(e,r),le(e,[{key:"getComputedTextLength",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(gt);_s.PARSED_STYLE_LIST=new Set([].concat(wt(gt.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var TO=function(){function r(){oe(this,r),this.registry={},this.define(ee.CIRCLE,pi),this.define(ee.ELLIPSE,bo),this.define(ee.RECT,pn),this.define(ee.IMAGE,xo),this.define(ee.LINE,Ss),this.define(ee.GROUP,Jt),this.define(ee.PATH,Kn),this.define(ee.POLYGON,Ps),this.define(ee.POLYLINE,Cu),this.define(ee.TEXT,_s),this.define(ee.HTML,wo)}return le(r,[{key:"define",value:function(t,n){this.registry[t]=n}},{key:"get",value:function(t){return this.registry[t]}}])}(),Vy=function(r){function e(){var t;oe(this,e),t=Fe(this,e),t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new ce.AnimationTimeline(t)}catch{}var n={};return If.forEach(function(i){var s=i.n,a=i.inh,o=i.d;a&&o&&(n[s]=Ee(o)?o(ee.GROUP):o)}),t.documentElement=new Jt({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return $e(e,r),le(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(n,i){if(n==="svg")return this.documentElement;var s=this.defaultView.customElements.get(n);s||(console.warn("Unsupported tagName: ",n),s=n==="tspan"?_s:Jt);var a=new s(i);return a.ownerDocument=this,a}},{key:"createElementNS",value:function(n,i,s){return this.createElement(i,s)}},{key:"cloneNode",value:function(n){throw new Error(tt)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:"elementsFromBBox",value:function(n,i,s,a){var o=this.defaultView.context.rBushRoot,l=o.search({minX:n,minY:i,maxX:s,maxY:a}),u=[];return l.forEach(function(c){var d=c.displayObject,h=d.parsedStyle.pointerEvents,f=h===void 0?"auto":h,g=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!g||g&&d.isVisible())&&!d.isCulled()&&d.isInteractive()&&u.push(d)}),u.sort(function(c,d){return d.sortable.renderOrder-c.sortable.renderOrder}),u}},{key:"elementFromPointSync",value:function(n,i){var s=this.defaultView.canvas2Viewport({x:n,y:i}),a=s.x,o=s.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(a<0||o<0||a>u||o>c)return null;var d=this.defaultView.viewport2Client({x:a,y:o}),h=d.x,f=d.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:i,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}),v=g.picked;return v&&v[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var t=Vi(gn().mark(function i(s,a){var o,l,u,c,d,h,f,g,v,p,y;return gn().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(o=this.defaultView.canvas2Viewport({x:s,y:a}),l=o.x,u=o.y,c=this.defaultView.getConfig(),d=c.width,h=c.height,!(l<0||u<0||l>d||u>h)){E.next=4;break}return E.abrupt("return",null);case 4:return f=this.defaultView.viewport2Client({x:l,y:u}),g=f.x,v=f.y,E.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:s,y:a,viewportX:l,viewportY:u,clientX:g,clientY:v},picked:[]});case 7:return p=E.sent,y=p.picked,E.abrupt("return",y&&y[0]||this.documentElement);case 10:case"end":return E.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"elementsFromPointSync",value:function(n,i){var s=this.defaultView.canvas2Viewport({x:n,y:i}),a=s.x,o=s.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(a<0||o<0||a>u||o>c)return[];var d=this.defaultView.viewport2Client({x:a,y:o}),h=d.x,f=d.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:i,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}),v=g.picked;return v[v.length-1]!==this.documentElement&&v.push(this.documentElement),v}},{key:"elementsFromPoint",value:function(){var t=Vi(gn().mark(function i(s,a){var o,l,u,c,d,h,f,g,v,p,y;return gn().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(o=this.defaultView.canvas2Viewport({x:s,y:a}),l=o.x,u=o.y,c=this.defaultView.getConfig(),d=c.width,h=c.height,!(l<0||u<0||l>d||u>h)){E.next=4;break}return E.abrupt("return",[]);case 4:return f=this.defaultView.viewport2Client({x:l,y:u}),g=f.x,v=f.y,E.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:s,y:a,viewportX:l,viewportY:u,clientX:g,clientY:v},picked:[]});case 7:return p=E.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),E.abrupt("return",y);case 11:case"end":return E.stop()}},i,this)}));function n(i,s){return t.apply(this,arguments)}return n}()},{key:"appendChild",value:function(n,i){throw new Error($s)}},{key:"insertBefore",value:function(n,i){throw new Error($s)}},{key:"removeChild",value:function(n,i){throw new Error($s)}},{key:"replaceChild",value:function(n,i,s){throw new Error($s)}},{key:"append",value:function(){throw new Error($s)}},{key:"prepend",value:function(){throw new Error($s)}},{key:"getElementById",value:function(n){return this.documentElement.getElementById(n)}},{key:"getElementsByName",value:function(n){return this.documentElement.getElementsByName(n)}},{key:"getElementsByTagName",value:function(n){return this.documentElement.getElementsByTagName(n)}},{key:"getElementsByClassName",value:function(n){return this.documentElement.getElementsByClassName(n)}},{key:"querySelector",value:function(n){return this.documentElement.querySelector(n)}},{key:"querySelectorAll",value:function(n){return this.documentElement.querySelectorAll(n)}},{key:"find",value:function(n){return this.documentElement.find(n)}},{key:"findAll",value:function(n){return this.documentElement.findAll(n)}}])}(Tt),Uy=function(){function r(e){oe(this,r),this.strategies=e}return le(r,[{key:"apply",value:function(t){var n=t.camera,i=t.renderingService,s=t.renderingContext,a=this.strategies;i.hooks.cull.tap(r.tag,function(o){if(o){var l=o.cullable;return a.length===0?l.visible=s.unculledEntities.indexOf(o.entity)>-1:l.visible=a.every(function(u){return u.isVisible(n,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Wt(Ue.CULLED)),null)}return o}),i.hooks.afterRender.tap(r.tag,function(o){o.cullable.visibilityPlaneMask=-1})}}])}();Uy.tag="Culling";var Hy=function(){function r(){var e=this;oe(this,r),this.autoPreventDefault=!1,this.rootPointerEvent=new su(null),this.rootWheelEvent=new $h(null),this.onPointerMove=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView;if(!(i.supportsTouchEvents&&t.pointerType==="touch")){var s=e.normalizeToPointerEvent(t,i),a=cs(s),o;try{for(a.s();!(o=a.n()).done;){var l=o.value,u=e.bootstrapEvent(e.rootPointerEvent,l,i,t);e.context.eventService.mapEvent(u)}}catch(c){a.e(c)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView,s=e.normalizeToPointerEvent(t,i),a=cs(s),o;try{for(a.s();!(o=a.n()).done;){var l=o.value,u=e.bootstrapEvent(e.rootPointerEvent,l,i,t);e.context.eventService.mapEvent(u)}}catch(c){a.e(c)}finally{a.f()}e.setCursor(e.context.eventService.cursor)}}return le(r,[{key:"apply",value:function(t){var n=this;this.context=t;var i=t.renderingService,s=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=n.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}),l=o.picked;return l[0]||null}),i.hooks.pointerWheel.tap(r.tag,function(a){var o=n.normalizeWheelEvent(a);n.context.eventService.mapEvent(o)}),i.hooks.pointerDown.tap(r.tag,function(a){if(!(s.supportsTouchEvents&&a.pointerType==="touch")){var o=n.normalizeToPointerEvent(a,s);if(n.autoPreventDefault&&o[0].isNormalized){var l=a.cancelable||!("cancelable"in a);l&&a.preventDefault()}var u=cs(o),c;try{for(u.s();!(c=u.n()).done;){var d=c.value,h=n.bootstrapEvent(n.rootPointerEvent,d,s,a);n.context.eventService.mapEvent(h)}}catch(f){u.e(f)}finally{u.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerUp.tap(r.tag,function(a){if(!(s.supportsTouchEvents&&a.pointerType==="touch")){var o=n.context.contextService.getDomElement(),l=n.context.eventService.isNativeEventFromCanvas(o,a),u=l?"":"outside",c=n.normalizeToPointerEvent(a,s),d=cs(c),h;try{for(d.s();!(h=d.n()).done;){var f=h.value,g=n.bootstrapEvent(n.rootPointerEvent,f,s,a);g.type+=u,n.context.eventService.mapEvent(g)}}catch(v){d.e(v)}finally{d.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerMove.tap(r.tag,this.onPointerMove),i.hooks.pointerOver.tap(r.tag,this.onPointerMove),i.hooks.pointerOut.tap(r.tag,this.onPointerMove),i.hooks.click.tap(r.tag,this.onClick),i.hooks.pointerCancel.tap(r.tag,function(a){var o=n.normalizeToPointerEvent(a,s),l=cs(o),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,d=n.bootstrapEvent(n.rootPointerEvent,c,s,a);n.context.eventService.mapEvent(d)}}catch(h){l.e(h)}finally{l.f()}n.setCursor(n.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(t,n,i,s){t.view=i,t.originalEvent=null,t.nativeEvent=s,t.pointerId=n.pointerId,t.width=n.width,t.height=n.height,t.isPrimary=n.isPrimary,t.pointerType=n.pointerType,t.pressure=n.pressure,t.tangentialPressure=n.tangentialPressure,t.tiltX=n.tiltX,t.tiltY=n.tiltY,t.twist=n.twist,this.transferMouseData(t,n);var a=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),o=a.x,l=a.y;t.viewport.x=o,t.viewport.y=l;var u=this.context.eventService.viewport2Canvas(t.viewport),c=u.x,d=u.y;return t.canvas.x=c,t.canvas.y=d,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=s.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=lT[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var n=this.rootWheelEvent;this.transferMouseData(n,t),n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ;var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),s=i.x,a=i.y;n.viewport.x=s,n.viewport.y=a;var o=this.context.eventService.viewport2Canvas(n.viewport),l=o.x,u=o.y;return n.canvas.x=l,n.canvas.y=u,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=t,n.type=t.type,n}},{key:"transferMouseData",value:function(t,n){t.isTrusted=n.isTrusted,t.srcElement=n.srcElement,t.timeStamp=Fh.now(),t.type=n.type,t.altKey=n.altKey,t.metaKey=n.metaKey,t.shiftKey=n.shiftKey,t.ctrlKey=n.ctrlKey,t.button=n.button,t.buttons=n.buttons,t.client.x=n.clientX,t.client.y=n.clientY,t.movement.x=n.movementX,t.movement.y=n.movementY,t.page.x=n.pageX,t.page.y=n.pageY,t.screen.x=n.screenX,t.screen.y=n.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,n){var i=[];if(n.isTouchEvent(t))for(var s=0;s<t.changedTouches.length;s++){var a=t.changedTouches[s];Ie(a.button)&&(a.button=0),Ie(a.buttons)&&(a.buttons=1),Ie(a.isPrimary)&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),Ie(a.width)&&(a.width=a.radiusX||1),Ie(a.height)&&(a.height=a.radiusY||1),Ie(a.tiltX)&&(a.tiltX=0),Ie(a.tiltY)&&(a.tiltY=0),Ie(a.pointerType)&&(a.pointerType="touch"),Ie(a.pointerId)&&(a.pointerId=a.identifier||0),Ie(a.pressure)&&(a.pressure=a.force||.5),Ie(a.twist)&&(a.twist=0),Ie(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=t.type,i.push(a)}else if(n.isMouseEvent(t)){var o=t;Ie(o.isPrimary)&&(o.isPrimary=!0),Ie(o.width)&&(o.width=1),Ie(o.height)&&(o.height=1),Ie(o.tiltX)&&(o.tiltX=0),Ie(o.tiltY)&&(o.tiltY=0),Ie(o.pointerType)&&(o.pointerType="mouse"),Ie(o.pointerId)&&(o.pointerId=oT),Ie(o.pressure)&&(o.pressure=.5),Ie(o.twist)&&(o.twist=0),Ie(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,i.push(o)}else i.push(t);return i}}])}();Hy.tag="Event";var OO=[ee.CIRCLE,ee.ELLIPSE,ee.IMAGE,ee.RECT,ee.LINE,ee.POLYLINE,ee.POLYGON,ee.TEXT,ee.PATH,ee.HTML],kO=function(){function r(){oe(this,r)}return le(r,[{key:"isVisible",value:function(t,n){var i,s=n.cullable;if(!s.enable)return!0;var a=n.getRenderBounds();if(ct.isEmpty(a))return!1;var o=t.getFrustum(),l=(i=n.parentNode)===null||i===void 0||(i=i.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return s.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,a,l||Fs.INDETERMINATE,o.planes),s.visible=s.visibilityPlaneMask!==Fs.OUTSIDE,s.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,n,i,s){if(i===Fs.OUTSIDE||i===Fs.INSIDE)return i;for(var a=Fs.INSIDE,o=OO.indexOf(t.nodeName)>-1,l=0,u=s.length;l<u;++l){var c=1<<l;if((i&c)!==0&&!(o&&(l===4||l===5))){var d=s[l],h=d.normal,f=d.distance;if(Br(h,n.getPositiveFarPoint(s[l]))+f<0)return Fs.OUTSIDE;Br(h,n.getNegativeFarPoint(s[l]))+f<0&&(a|=c)}}return a}}])}(),Xy=function(){function r(){oe(this,r),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return le(r,[{key:"apply",value:function(t){var n=this,i,s=t.renderingService,a=t.renderingContext,o=t.rBushRoot,l=a.root.ownerDocument.defaultView;this.rBush=o;var u=function(v){var p=v.target;p.renderable.dirty=!0,s.dirtify()},c=function(v){n.syncTasks.set(v.target,v.detail.affectChildren),s.dirtify()},d=function(v){var p=v.target;ce.enableSizeAttenuation&&ce.styleValueRegistry.updateSizeAttenuation(p,l.getCamera().getZoom())},h=function(v){var p=v.target,y=p.rBushNode;y.aabb&&n.rBush.remove(y.aabb),n.syncTasks.delete(p),ce.sceneGraphService.dirtifyToRoot(p),s.dirtify()};s.hooks.init.tap(r.tag,function(){l.addEventListener(Ue.MOUNTED,d),l.addEventListener(Ue.UNMOUNTED,h),l.addEventListener(Ue.ATTR_MODIFIED,u),l.addEventListener(Ue.BOUNDS_CHANGED,c)}),s.hooks.destroy.tap(r.tag,function(){l.removeEventListener(Ue.MOUNTED,d),l.removeEventListener(Ue.UNMOUNTED,h),l.removeEventListener(Ue.ATTR_MODIFIED,u),l.removeEventListener(Ue.BOUNDS_CHANGED,c),n.syncTasks.clear()});var f=(i=ce.globalThis.requestIdleCallback)!==null&&i!==void 0?i:Rf.bind(ce.globalThis);s.hooks.endFrame.tap(r.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,f(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})}},{key:"syncNode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.isConnected){var i=t.rBushNode;i.aabb&&this.rBush.remove(i.aabb);var s=t.getRenderBounds();if(s){var a=t.renderable;n&&(a.dirtyRenderBounds||(a.dirtyRenderBounds=new ct),a.dirtyRenderBounds.update(s.center,s.halfExtents));var o=s.getMin(),l=Be(o,2),u=l[0],c=l[1],d=s.getMax(),h=Be(d,2),f=h[0],g=h[1];i.aabb||(i.aabb={}),i.aabb.displayObject=t,i.aabb.minX=u,i.aabb.minY=c,i.aabb.maxX=f,i.aabb.maxY=g}if(i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY))return i.aabb}}},{key:"syncRTree",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!n&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var i=[],s=new Set,a=function(l){if(!s.has(l)&&l.renderable){var u=t.syncNode(l,n);u&&(i.push(u),s.add(l))}};this.syncTasks.forEach(function(o,l){o&&l.forEach(a);for(var u=l;u;)a(u),u=u.parentElement}),this.rBush.load(i),i.length=0,this.syncing=!1}}}])}();Xy.tag="Prepare";var qn=function(r){return r.READY="ready",r.BEFORE_RENDER="beforerender",r.RERENDER="rerender",r.AFTER_RENDER="afterrender",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.RESIZE="resize",r.DIRTY_RECTANGLE="dirtyrectangle",r.RENDERER_CHANGED="rendererchanged",r}({}),Sp=500,NO=.1,AO=1e3,qo=new Wt(Ue.MOUNTED),Zo=new Wt(Ue.UNMOUNTED),pd=new Wt(qn.BEFORE_RENDER),Tp=new Wt(qn.RERENDER),vd=new Wt(qn.AFTER_RENDER),Yh=function(r){function e(t){var n;oe(this,e),n=Fe(this,e),n.Element=gt,n.inited=!1,n.context={},n.document=new Vy,n.document.defaultView=n,n.customElements=new TO;var i=t.container,s=t.canvas,a=t.offscreenCanvas,o=t.width,l=t.height,u=t.devicePixelRatio,c=t.renderer,d=t.background,h=t.cursor,f=t.document,g=t.requestAnimationFrame,v=t.cancelAnimationFrame,p=t.createImage,y=t.enableLargeImageOptimization,b=t.supportsPointerEvents,E=t.supportsTouchEvents,T=t.supportsCSSTransform,S=t.cleanUpOnDestroy,k=S===void 0?!0:S,A=t.supportsMutipleCanvasesInOneContainer,O=t.useNativeClickEvent,C=t.alwaysTriggerPointerEventOnCanvas,P=t.isTouchEvent,L=t.isMouseEvent,R=t.dblClickSpeed;A||tT(i,n,k);var z=o,Y=l,U=u;return s&&(U=u||yo&&window.devicePixelRatio||1,U=U>=1?Math.ceil(U):1,z=o||sT(s)||s.width/U,Y=l||aT(s)||s.height/U),a&&(ce.offscreenCanvas=a),n.devicePixelRatio=U,n.requestAnimationFrame=g??Rf.bind(ce.globalThis),n.cancelAnimationFrame=v??Fy.bind(ce.globalThis),n.supportsTouchEvents=E??"ontouchstart"in ce.globalThis,n.supportsPointerEvents=b??!!ce.globalThis.PointerEvent,n.isTouchEvent=P??function(V){return n.supportsTouchEvents&&V instanceof ce.globalThis.TouchEvent},n.isMouseEvent=L??function(V){return!ce.globalThis.MouseEvent||V instanceof ce.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(V instanceof ce.globalThis.PointerEvent))},n.dblClickSpeed=R??200,n.initRenderingContext({container:i,canvas:s,width:z,height:Y,renderer:c,offscreenCanvas:a,devicePixelRatio:U,cursor:h||"default",background:d||"transparent",createImage:p,enableLargeImageOptimization:y,document:f,supportsCSSTransform:T,useNativeClickEvent:O,cleanUpOnDestroy:k,alwaysTriggerPointerEventOnCanvas:C}),n.initDefaultCamera(z,Y,c.clipSpaceNearZ),n.initRenderer(c,!0),n}return $e(e,r),le(e,[{key:"initRenderingContext",value:function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(n,i,s){var a=this,o=new ce.CameraContribution;o.clipSpaceNearZ=s,o.setType(et.EXPLORING,_h.DEFAULT).setPosition(n/2,i/2,Sp).setFocalPoint(n/2,i/2,0).setOrthographic(n/-2,n/2,i/2,i/-2,NO,AO),o.canvas=this,o.eventEmitter.on(my.UPDATED,function(){a.context.renderingContext.renderReasons.add(ia.CAMERA_CHANGED),ce.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o}},{key:"updateSizeAttenuation",value:function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(i){ce.styleValueRegistry.updateSizeAttenuation(i,n)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(i){n.resolveReadyPromise=function(){i(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;i||this.dispatchEvent(new Wt(qn.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var s=this.getRoot();n&&(this.unmountChildren(s),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),i||this.dispatchEvent(new Wt(qn.AFTER_DESTROY));var a=function(l){l.currentTarget=null,l.manager=null,l.target=null,l.relatedNode=null};a(qo),a(Zo),a(pd),a(Tp),a(vd),a(Dr),a(Wh),a(Gh),a(Yy)}},{key:"changeSize",value:function(n,i){this.resize(n,i)}},{key:"resize",value:function(n,i){var s=this.context.config;s.width=n,s.height=i,this.getContextService().resize(n,i);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(n/2,i/2,Sp).setFocalPoint(n/2,i/2,0),o===ur.ORTHOGRAPHIC?a.setOrthographic(n/-2,n/2,i/2,i/-2,a.getNear(),a.getFar()):a.setAspect(n/i),this.dispatchEvent(new Wt(qn.RESIZE,{width:n,height:i}))}},{key:"appendChild",value:function(n,i){return this.document.documentElement.appendChild(n,i)}},{key:"insertBefore",value:function(n,i){return this.document.documentElement.insertBefore(n,i)}},{key:"removeChild",value:function(n){return this.document.documentElement.removeChild(n)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(n){var i=this;n&&(pd.detail=n,vd.detail=n),this.dispatchEvent(pd);var s=this.getRenderingService();s.render(this.getConfig(),n,function(){i.dispatchEvent(Tp)}),this.dispatchEvent(vd)}},{key:"run",value:function(){var n=this,i=function(a,o){n.render(o),n.frameId=n.requestAnimationFrame(i)};i()}},{key:"initRenderer",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new vM,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Hy,new Xy,new Uy([new kO])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService(We(We({},ce),this.context)),this.context.renderingService=new $T(ce,this.context),this.context.eventService=new FT(ce,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,s,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,s)})}},{key:"initRenderingService",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){i.inited=!0,s?a?i.requestAnimationFrame(function(){i.dispatchEvent(new Wt(qn.READY))}):i.dispatchEvent(new Wt(qn.READY)):i.dispatchEvent(new Wt(qn.RENDERER_CHANGED)),i.readyPromise&&i.resolveReadyPromise(),s||i.getRoot().forEach(function(o){var l=o,u=l.renderable;u&&(u.renderBoundsDirty=!0,u.boundsDirty=!0,u.dirty=!0)}),i.mountChildren(i.getRoot()),n.getConfig().enableAutoRendering&&i.run()})}},{key:"loadRendererContainerModule",value:function(n){var i=this,s=n.getPlugins();s.forEach(function(a){a.context=i.context,a.init(ce)})}},{key:"setRenderer",value:function(n){var i=this.getConfig();if(i.renderer!==n){var s=i.renderer;i.renderer=n,this.destroy(!1,!0),wt((s==null?void 0:s.getPlugins())||[]).reverse().forEach(function(a){a.destroy(ce)}),this.initRenderer(n)}}},{key:"setCursor",value:function(n){var i=this.getConfig();i.cursor=n,this.getContextService().applyCursorStyle(n)}},{key:"unmountChildren",value:function(n){var i=this;n.childNodes.forEach(function(s){i.unmountChildren(s)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Zo):(Zo.target=n,this.dispatchEvent(Zo,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()}},{key:"mountChildren",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iu(n);this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,s||(n.isMutationObserved?n.dispatchEvent(qo):(qo.target=n,this.dispatchEvent(qo,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(a){i.mountChildren(a,s)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()}},{key:"mountFragment",value:function(n){this.mountChildren(n,!1)}},{key:"client2Viewport",value:function(n){return this.getEventService().client2Viewport(n)}},{key:"viewport2Client",value:function(n){return this.getEventService().viewport2Client(n)}},{key:"viewport2Canvas",value:function(n){return this.getEventService().viewport2Canvas(n)}},{key:"canvas2Viewport",value:function(n){return this.getEventService().canvas2Viewport(n)}},{key:"getPointByClient",value:function(n,i){return this.client2Viewport({x:n,y:i})}},{key:"getClientByPoint",value:function(n,i){return this.viewport2Client({x:n,y:i})}}])}(Gy);/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.28
 * @date 11/27/2024, 2:16:19 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var CO=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.landmarks=[],t}return $e(e,r),le(e,[{key:"rotate",value:function(n,i,s){if(this.relElevation=na(i),this.relAzimuth=na(n),this.relRoll=na(s),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===et.EXPLORING){var a=Ni(qt(),[1,0,0],nt((this.rotateWorld?1:-1)*this.relElevation)),o=Ni(qt(),[0,1,0],nt((this.rotateWorld?1:-1)*this.relAzimuth)),l=Ni(qt(),[0,0,1],nt(this.relRoll)),u=Bi(qt(),o,a);u=Bi(qt(),u,l);var c=Nf(ut(),u);ta(this.matrix,this.matrix,[0,0,-this.distance]),Mn(this.matrix,this.matrix,c),ta(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===et.ORBITING||this.type===et.EXPLORING?this._getPosition():this.type===et.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,i){var s=kn(n,i,0),a=Jr(this.position);return ji(a,a,Hl(Xe(),this.right,s[0])),ji(a,a,Hl(Xe(),this.up,s[1])),this._setPosition(a),this.triggerUpdate(),this}},{key:"dolly",value:function(n){var i=this.forward,s=Jr(this.position),a=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,s[0]+=a*i[0],s[1]+=a*i[1],s[2]+=a*i[2],this._setPosition(s),this.type===et.ORBITING||this.type===et.EXPLORING?this._getDistance():this.type===et.TRACKING&&ji(this.focalPoint,s,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(n){var i,s,a,o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=l.position,c=u===void 0?this.position:u,d=l.focalPoint,h=d===void 0?this.focalPoint:d,f=l.roll,g=l.zoom,v=new ce.CameraContribution;v.setType(this.type,void 0),v.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(s=c[2])!==null&&s!==void 0?s:this.position[2]),v.setFocalPoint(h[0],(a=h[1])!==null&&a!==void 0?a:this.focalPoint[1],(o=h[2])!==null&&o!==void 0?o:this.focalPoint[2]),v.setRoll(f??this.roll),v.setZoom(g??this.zoom);var p={name:n,matrix:Lm(v.getWorldTransform()),right:Jr(v.right),up:Jr(v.up),forward:Jr(v.forward),position:Jr(v.getPosition()),focalPoint:Jr(v.getFocalPoint()),distanceVector:Jr(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(p),p}},{key:"gotoLandmark",value:function(n){var i=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=Ke(n)?this.landmarks.find(function(L){return L.name===n}):n;if(a){var o=ye(s)?{duration:s}:s,l=o.easing,u=l===void 0?"linear":l,c=o.duration,d=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,g=o.onfinish,v=g===void 0?void 0:g,p=o.onframe,y=p===void 0?void 0:p,b=.01;this.cancelLandmarkAnimation();var E=a.position,T=a.focalPoint,S=a.zoom,k=a.roll,A=f||ce.EasingFunction(u),O,C=function(){i.setFocalPoint(T),i.setPosition(E),i.setRoll(k),i.setZoom(S),i.computeMatrix(),i.triggerUpdate(),v==null||v()};if(d===0)return C();var P=function(R){O===void 0&&(O=R);var z=R-O;if(z>=d){C();return}var Y=A(z/d),U=Xe(),V=Xe(),W=1,F=0;Eh(U,i.focalPoint,T,Y),Eh(V,i.position,E,Y),F=i.roll*(1-Y)+k*Y,W=i.zoom*(1-Y)+S*Y,i.setFocalPoint(U),i.setPosition(V),i.setRoll(F),i.setZoom(W);var K=Wg(U,T)+Wg(V,E);if(K<=b&&S===void 0&&k===void 0)return C();i.computeMatrix(),i.triggerUpdate(),z<d&&(y==null||y(Y),i.landmarkAnimationID=i.canvas.requestAnimationFrame(P))};this.canvas.requestAnimationFrame(P)}}}])}(yy);ce.CameraContribution=CO;/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.14
 * @date 11/27/2024, 2:18:02 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var md=function(r){function e(t,n,i,s){var a;return oe(this,e),a=Fe(this,e,[t]),a.currentTime=i,a.timelineTime=s,a.target=n,a.type="finish",a.bubbles=!1,a.currentTarget=n,a.defaultPrevented=!1,a.eventPhase=a.AT_TARGET,a.timeStamp=Date.now(),a.currentTime=i,a.timelineTime=s,a}return $e(e,r),le(e)}(Au),PO=0,_O=function(){function r(e,t){var n;oe(this,r),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(PO++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return le(r,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,i){t.resolveReadyPromise=function(){n(t)},t.rejectReadyPromise=function(){i(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,i){t.resolveFinishedPromise=function(){n(t)},t.rejectFinishedPromise=function(){i(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var n;this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-t/this.playbackRate}this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(t!==null){if(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=t,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):t==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():t==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new md(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(n)})}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),t!==null&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t,n=(t=this.effect)===null||t===void 0?void 0:t.target;return n.getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();t.indexOf(this)===-1&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),n=t.indexOf(this);n!==-1&&t.splice(n,1)}},{key:"tick",value:function(t,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(tt)}},{key:"addEventListener",value:function(t,n,i){throw new Error(tt)}},{key:"removeEventListener",value:function(t,n,i){throw new Error(tt)}},{key:"dispatchEvent",value:function(t){throw new Error(tt)}},{key:"commitStyles",value:function(){throw new Error(tt)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var t;this._inEffect=!!((t=this.effect)!==null&&t!==void 0&&t.update(-1))}else{var n;this._inEffect=!!((n=this.effect)!==null&&n!==void 0&&n.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,n){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new md(null,this,this.currentTime,t);setTimeout(function(){n.onfinish&&n.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var s=new md(null,this,this.currentTime,t);this.onframe(s)}this._finishedFlag=!1}}}])}(),LO=4,DO=.001,IO=1e-7,RO=10,za=11,Ko=1/(za-1),jO=typeof Float32Array=="function",qy=function(e,t){return 1-3*t+3*e},Zy=function(e,t){return 3*t-6*e},Ky=function(e){return 3*e},au=function(e,t,n){return((qy(t,n)*e+Zy(t,n))*e+Ky(t))*e},Qy=function(e,t,n){return 3*qy(t,n)*e*e+2*Zy(t,n)*e+Ky(t)},BO=function(e,t,n,i,s){var a,o,l=0;do o=t+(n-t)/2,a=au(o,i,s)-e,a>0?n=o:t=o;while(Math.abs(a)>IO&&++l<RO);return o},zO=function(e,t,n,i){for(var s=0;s<LO;++s){var a=Qy(t,n,i);if(a===0)return t;var o=au(t,n,i)-e;t-=o/a}return t},zf=function(e,t,n,i){if(!(e>=0&&e<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===i)return function(l){return l};for(var s=jO?new Float32Array(za):new Array(za),a=0;a<za;++a)s[a]=au(a*Ko,e,n);var o=function(u){for(var c=0,d=1,h=za-1;d!==h&&s[d]<=u;++d)c+=Ko;--d;var f=(u-s[d])/(s[d+1]-s[d]),g=c+f*Ko,v=Qy(g,e,n);return v>=DO?zO(u,g,e,n):v===0?g:BO(u,c,c+Ko,e,n)};return function(l){return l===0||l===1?l:au(o(l),t,i)}},FO=function(e){return e=e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},Qo=function(e){return Math.pow(e,2)},Jo=function(e){return Math.pow(e,3)},el=function(e){return Math.pow(e,4)},tl=function(e){return Math.pow(e,5)},nl=function(e){return Math.pow(e,6)},rl=function(e){return 1-Math.cos(e*Math.PI/2)},il=function(e){return 1-Math.sqrt(1-e*e)},sl=function(e){return e*e*(3*e-2)},al=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)},ol=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=Be(t,2),i=n[0],s=i===void 0?1:i,a=n[1],o=a===void 0?.5:a,l=At(Number(s),1,10),u=At(Number(o),.1,2);return e===0||e===1?e:-l*Math.pow(2,10*(e-1))*Math.sin((e-1-u/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/u)},Aa=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=Be(t,4),s=i[0],a=s===void 0?1:s,o=i[1],l=o===void 0?100:o,u=i[2],c=u===void 0?10:u,d=i[3],h=d===void 0?0:d;a=At(a,.1,1e3),l=At(l,.1,1e3),c=At(c,.1,1e3),h=At(h,.1,1e3);var f=Math.sqrt(l/a),g=c/(2*Math.sqrt(l*a)),v=g<1?f*Math.sqrt(1-g*g):0,p=1,y=g<1?(g*f+-h)/v:-h+f,b=n?n*e/1e3:e;return g<1?b=Math.exp(-b*g*f)*(p*Math.cos(v*b)+y*Math.sin(v*b)):b=(p+y*b)*Math.exp(-b*f),e===0||e===1?e:1-b},yd=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=t,i=Be(n,2),s=i[0],a=s===void 0?10:s,o=i[1],l=o==="start"?Math.ceil:Math.floor;return l(At(e,0,1)*a)/a},Op=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=Be(t,4),i=n[0],s=n[1],a=n[2],o=n[3];return zf(i,s,a,o)(e)},ll=zf(.42,0,1,1),sr=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return 1-e(1-t,n,i)}},ar=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?e(t*2,n,i)/2:1-e(t*-2+2,n,i)/2}},or=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?(1-e(1-t*2,n,i))/2:(e(t*2-1,n,i)+1)/2}},kp={steps:yd,"step-start":function(e){return yd(e,[1,"start"])},"step-end":function(e){return yd(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":Op,ease:function(e){return Op(e,[.25,.1,.25,1])},in:ll,out:sr(ll),"in-out":ar(ll),"out-in":or(ll),"in-quad":Qo,"out-quad":sr(Qo),"in-out-quad":ar(Qo),"out-in-quad":or(Qo),"in-cubic":Jo,"out-cubic":sr(Jo),"in-out-cubic":ar(Jo),"out-in-cubic":or(Jo),"in-quart":el,"out-quart":sr(el),"in-out-quart":ar(el),"out-in-quart":or(el),"in-quint":tl,"out-quint":sr(tl),"in-out-quint":ar(tl),"out-in-quint":or(tl),"in-expo":nl,"out-expo":sr(nl),"in-out-expo":ar(nl),"out-in-expo":or(nl),"in-sine":rl,"out-sine":sr(rl),"in-out-sine":ar(rl),"out-in-sine":or(rl),"in-circ":il,"out-circ":sr(il),"in-out-circ":ar(il),"out-in-circ":or(il),"in-back":sl,"out-back":sr(sl),"in-out-back":ar(sl),"out-in-back":or(sl),"in-bounce":al,"out-bounce":sr(al),"in-out-bounce":ar(al),"out-in-bounce":or(al),"in-elastic":ol,"out-elastic":sr(ol),"in-out-elastic":ar(ol),"out-in-elastic":or(ol),spring:Aa,"spring-in":Aa,"spring-out":sr(Aa),"spring-in-out":ar(Aa),"spring-out-in":or(Aa)},$O=function(e){return FO(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},WO=function(e){return kp[$O(e)]||kp.linear},GO=function(e){return e},YO=1,VO=.5,Np=0;function Ap(r,e){return function(t){if(t>=1)return 1;var n=1/r;return t+=e*n,t-t%n}}var ul="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",UO=new RegExp("cubic-bezier\\(".concat(ul,",").concat(ul,",").concat(ul,",").concat(ul,"\\)")),HO=/steps\(\s*(\d+)\s*\)/,XO=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Ff(r){var e=UO.exec(r);if(e)return zf.apply(void 0,wt(e.slice(1).map(Number)));var t=HO.exec(r);if(t)return Ap(Number(t[1]),Np);var n=XO.exec(r);return n?Ap(Number(n[1]),{start:YO,middle:VO,end:Np}[n[2]]):WO(r)}function qO(r){return Math.abs(ZO(r)/(r.playbackRate||1))}function ZO(r){var e;return r.duration===0||r.iterations===0?0:(r.duration==="auto"?0:Number(r.duration))*((e=r.iterations)!==null&&e!==void 0?e:1)}var Jy=0,$f=1,Pu=2,e1=3;function KO(r,e,t){if(e===null)return Jy;var n=t.endTime;return e<Math.min(t.delay,n)?$f:e>=Math.min(t.delay+r+t.endDelay,n)?Pu:e1}function QO(r,e,t,n,i){switch(n){case $f:return e==="backwards"||e==="both"?0:null;case e1:return t-i;case Pu:return e==="forwards"||e==="both"?r:null;case Jy:return null}}function JO(r,e,t,n,i){var s=i;return r===0?e!==$f&&(s+=t):s+=n/r,s}function ek(r,e,t,n,i,s){var a=r===1/0?e%1:r%1;return a===0&&t===Pu&&n!==0&&(i!==0||s===0)&&(a=1),a}function tk(r,e,t,n){return r===Pu&&e===1/0?1/0:t===1?Math.floor(n)-1:Math.floor(n)}function nk(r,e,t){var n=r;if(r!=="normal"&&r!=="reverse"){var i=e;r==="alternate-reverse"&&(i+=1),n="normal",i!==1/0&&i%2!==0&&(n="reverse")}return n==="normal"?t:1-t}function rk(r,e,t){var n=KO(r,e,t),i=QO(r,t.fill,e,n,t.delay);if(i===null)return null;var s=t.duration==="auto"?0:t.duration,a=JO(s,n,t.iterations,i,t.iterationStart),o=ek(a,t.iterationStart,n,t.iterations,i,s),l=tk(n,t.iterations,o,a),u=nk(t.direction,l,o);return t.currentIteration=l,t.progress=u,t.easingFunction(u)}function ik(r,e,t){var n=sk(r,e),i=ak(n,t);return function(s,a){if(a!==null)i.filter(function(l){return a>=l.applyFrom&&a<l.applyTo}).forEach(function(l){var u=a-l.startOffset,c=l.endOffset-l.startOffset,d=c===0?0:u/c;s.setAttribute(l.property,l.interpolation(d),!1,!1)});else for(var o in n)t1(o)&&s.setAttribute(o,null)}}function t1(r){return r!=="offset"&&r!=="easing"&&r!=="composite"&&r!=="computedOffset"}function sk(r,e){for(var t={},n=0;n<r.length;n++)for(var i in r[n])if(t1(i)){var s={offset:r[n].offset,computedOffset:r[n].computedOffset,easing:r[n].easing,easingFunction:Ff(r[n].easing)||e.easingFunction,value:r[n][i]};t[i]=t[i]||[],t[i].push(s)}return t}function ak(r,e){var t=[];for(var n in r)for(var i=r[n],s=0;s<i.length-1;s++){var a=s,o=s+1,l=i[a].computedOffset,u=i[o].computedOffset,c=l,d=u;s===0&&(c=-1/0,u===0&&(o=a)),s===i.length-2&&(d=1/0,l===1&&(a=o)),t.push({applyFrom:c,applyTo:d,startOffset:i[a].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[a].easingFunction,property:n,interpolation:ok(n,i[a].value,i[o].value,e)})}return t.sort(function(h,f){return h.startOffset-f.startOffset}),t}var Cp=function(e,t,n){return function(i){var s=n1(e,t,i);return ye(s)?s:n(s)}};function ok(r,e,t,n){var i=Ly[r];if(i&&i.syntax&&i.int){var s=ce.styleValueRegistry.getPropertySyntax(i.syntax);if(s){var a=s.parser,o=a?a(e,n):e,l=a?a(t,n):t,u=s.mixer(o,l,n);if(u){var c=Cp.apply(void 0,wt(u));return function(d){return d===0?e:d===1?t:c(d)}}}}return Cp(!1,!0,function(d){return d?t:e})}function n1(r,e,t){if(typeof r=="number"&&typeof e=="number")return r*(1-t)+e*t;if(typeof r=="boolean"&&typeof e=="boolean"||typeof r=="string"&&typeof e=="string")return t<.5?r:e;if(Array.isArray(r)&&Array.isArray(e)){for(var n=r.length,i=e.length,s=Math.max(n,i),a=[],o=0;o<s;o++)a.push(n1(r[o<n?o:n-1],e[o<i?o:i-1],t));return a}throw new Error("Mismatched interpolation arguments ".concat(r,":").concat(e))}var lk=function(){function r(){oe(this,r),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=GO,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return le(r,[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=Ff(t),this._easing=t}}])}();function uk(r){var e=[];for(var t in r)if(!(t in["easing","offset","composite"])){var n=r[t];Array.isArray(n)||(n=[n]);for(var i=n.length,s=0;s<i;s++){if(!e[s]){var a={};"offset"in r&&(a.offset=Number(r.offset)),"easing"in r&&(a.easing=r.easing),"composite"in r&&(a.composite=r.composite),e[s]=a}n[s]!==void 0&&n[s]!==null&&(e[s][t]=n[s])}}return e.sort(function(o,l){return(o.computedOffset||0)-(l.computedOffset||0)}),e}function Pp(r,e){if(r===null)return[];Array.isArray(r)||(r=uk(r));for(var t=r.map(function(l){var u={};e!=null&&e.composite&&(u.composite="auto");for(var c in l){var d=l[c];if(c==="offset"){if(d!==null){if(d=Number(d),!isFinite(d))throw new Error("Keyframe offsets must be numbers.");if(d<0||d>1)throw new Error("Keyframe offsets must be between 0 and 1.");u.computedOffset=d}}else if(c==="composite"&&["replace","add","accumulate","auto"].indexOf(d)===-1)throw new Error("".concat(d," compositing is not supported"));u[c]=d}return u.offset===void 0&&(u.offset=null),u.easing===void 0&&(u.easing=(e==null?void 0:e.easing)||"linear"),u.composite===void 0&&(u.composite="auto"),u}),n=!0,i=-1/0,s=0;s<t.length;s++){var a=t[s].offset;if(Ae(a))n=!1;else{if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function o(){var l,u=t,c=u.length;if(t[c-1].computedOffset=Number((l=t[c-1].offset)!==null&&l!==void 0?l:1),c>1){var d;t[0].computedOffset=Number((d=t[0].offset)!==null&&d!==void 0?d:0)}for(var h=0,f=Number(t[0].computedOffset),g=1;g<c;g++){var v=t[g].computedOffset;if(!Ae(v)&&!Ae(f)){for(var p=1;p<g-h;p++)t[h+p].computedOffset=f+(Number(v)-f)*p/(g-h);h=g,f=Number(v)}}}return n||o(),t}var ck="backwards|forwards|both|none".split("|"),dk="reverse|alternate|alternate-reverse".split("|");function hk(r,e){var t=new lk;return typeof r=="number"&&!isNaN(r)?t.duration=r:r!==void 0&&Object.keys(r).forEach(function(n){if(r[n]!==void 0&&r[n]!==null&&r[n]!=="auto"){if((typeof t[n]=="number"||n==="duration")&&(typeof r[n]!="number"||isNaN(r[n]))||n==="fill"&&ck.indexOf(r[n])===-1||n==="direction"&&dk.indexOf(r[n])===-1)return;t[n]=r[n]}}),t}function fk(r,e){var t;return r=gk((t=r)!==null&&t!==void 0?t:{duration:"auto"}),hk(r)}function gk(r){return typeof r=="number"&&(isNaN(r)?r={duration:"auto"}:r={duration:r}),r}var pk=function(){function r(e,t,n){var i=this;oe(this,r),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=fk(n),this.timing.effect=this,this.timing.activeDuration=qO(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Pp(t,this.timing),this.interpolations=ik(this.normalizedKeyframes,this.timing,this.target);var s=ce.globalThis.Proxy;this.computedTiming=s?new s(this.timing,{get:function(o,l){return l==="duration"?o.duration==="auto"?0:o.duration:l==="fill"?o.fill==="auto"?"none":o.fill:l==="localTime"?i.animation&&i.animation.currentTime||null:l==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:l==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[l]},set:function(){return!0}}):this.timing}return le(r,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return t===null?!1:(this.timeFraction=rk(this.timing.activeDuration,t,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=Pp(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var n=this;Object.keys(t||{}).forEach(function(i){n.timing[i]=t[i]})}}])}();function _p(r,e){return Number(r.id)-Number(e.id)}var vk=function(){function r(e){var t=this;oe(this,r),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){t.currentTime=n,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(n){var i=t.rafCallbacks;t.rafCallbacks=[],n<Number(t.currentTime)&&(n=Number(t.currentTime)),t.animations.sort(_p),t.animations=t.tick(n,!0,t.animations)[0],i.forEach(function(s){s[1](n)}),t.applyPendingEffects()},this.document=e}return le(r,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,n,i){var s=new pk(t,n,i),a=new _O(s,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a}},{key:"applyDirtiedAnimation",value:function(t){var n=this;if(!this.inTick){t.markTarget();var i=t.targetAnimations();i.sort(_p);var s=this.tick(Number(this.currentTime),!1,i.slice())[1];s.forEach(function(a){var o=n.animations.indexOf(a);o!==-1&&n.animations.splice(o,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){t==null||t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return t.playState!=="finished"&&t.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,t]),n}},{key:"requestAnimationFrame",value:function(t){var n=this;return this.rAF(function(i){n.updateAnimationsPromises(),t(i),n.updateAnimationsPromises()})}},{key:"tick",value:function(t,n,i){var s=this,a,o;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var l=[],u=[],c=[],d=[];return i.forEach(function(h){h.tick(t,n),h._inEffect?(u.push(h.effect),h.markTarget()):(l.push(h.effect),h.unmarkTarget()),h._needsTick&&(s.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):d.push(h)}),(a=this.pendingEffects).push.apply(a,l),(o=this.pendingEffects).push.apply(o,u),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,d]}}])}();ce.EasingFunction=Ff;ce.AnimationTimeline=vk;const mk={duration:500},yk={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var yt;(function(r){r.NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved"})(yt||(yt={}));var Bn;(function(r){r.DRAW="draw",r.COLLAPSE="collapse",r.EXPAND="expand",r.TRANSFORM="transform"})(Bn||(Bn={}));var ci;(function(r){r.CLICK="canvas:click",r.DBLCLICK="canvas:dblclick",r.POINTER_OVER="canvas:pointerover",r.POINTER_LEAVE="canvas:pointerleave",r.POINTER_ENTER="canvas:pointerenter",r.POINTER_MOVE="canvas:pointermove",r.POINTER_OUT="canvas:pointerout",r.POINTER_DOWN="canvas:pointerdown",r.POINTER_UP="canvas:pointerup",r.CONTEXT_MENU="canvas:contextmenu",r.DRAG_START="canvas:dragstart",r.DRAG="canvas:drag",r.DRAG_END="canvas:dragend",r.DRAG_ENTER="canvas:dragenter",r.DRAG_OVER="canvas:dragover",r.DRAG_LEAVE="canvas:dragleave",r.DROP="canvas:drop",r.WHEEL="canvas:wheel"})(ci||(ci={}));var hs;(function(r){r.CLICK="combo:click",r.DBLCLICK="combo:dblclick",r.POINTER_OVER="combo:pointerover",r.POINTER_LEAVE="combo:pointerleave",r.POINTER_ENTER="combo:pointerenter",r.POINTER_MOVE="combo:pointermove",r.POINTER_OUT="combo:pointerout",r.POINTER_DOWN="combo:pointerdown",r.POINTER_UP="combo:pointerup",r.CONTEXT_MENU="combo:contextmenu",r.DRAG_START="combo:dragstart",r.DRAG="combo:drag",r.DRAG_END="combo:dragend",r.DRAG_ENTER="combo:dragenter",r.DRAG_OVER="combo:dragover",r.DRAG_LEAVE="combo:dragleave",r.DROP="combo:drop"})(hs||(hs={}));var te;(function(r){r.CLICK="click",r.DBLCLICK="dblclick",r.POINTER_OVER="pointerover",r.POINTER_LEAVE="pointerleave",r.POINTER_ENTER="pointerenter",r.POINTER_MOVE="pointermove",r.POINTER_OUT="pointerout",r.POINTER_DOWN="pointerdown",r.POINTER_UP="pointerup",r.CONTEXT_MENU="contextmenu",r.DRAG_START="dragstart",r.DRAG="drag",r.DRAG_END="dragend",r.DRAG_ENTER="dragenter",r.DRAG_OVER="dragover",r.DRAG_LEAVE="dragleave",r.DROP="drop",r.KEY_DOWN="keydown",r.KEY_UP="keyup",r.WHEEL="wheel",r.PINCH="pinch"})(te||(te={}));var Qs;(function(r){r.KEY_DOWN="keydown",r.KEY_UP="keyup"})(Qs||(Qs={}));var ou;(function(r){r.CLICK="edge:click",r.DBLCLICK="edge:dblclick",r.POINTER_OVER="edge:pointerover",r.POINTER_LEAVE="edge:pointerleave",r.POINTER_ENTER="edge:pointerenter",r.POINTER_MOVE="edge:pointermove",r.POINTER_OUT="edge:pointerout",r.POINTER_DOWN="edge:pointerdown",r.POINTER_UP="edge:pointerup",r.CONTEXT_MENU="edge:contextmenu",r.DRAG_ENTER="edge:dragenter",r.DRAG_OVER="edge:dragover",r.DRAG_LEAVE="edge:dragleave",r.DROP="edge:drop"})(ou||(ou={}));var fe;(function(r){r.BEFORE_CANVAS_INIT="beforecanvasinit",r.AFTER_CANVAS_INIT="aftercanvasinit",r.BEFORE_SIZE_CHANGE="beforesizechange",r.AFTER_SIZE_CHANGE="aftersizechange",r.BEFORE_ELEMENT_CREATE="beforeelementcreate",r.AFTER_ELEMENT_CREATE="afterelementcreate",r.BEFORE_ELEMENT_UPDATE="beforeelementupdate",r.AFTER_ELEMENT_UPDATE="afterelementupdate",r.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",r.AFTER_ELEMENT_DESTROY="afterelementdestroy",r.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",r.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",r.BEFORE_DRAW="beforedraw",r.AFTER_DRAW="afterdraw",r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_ANIMATE="beforeanimate",r.AFTER_ANIMATE="afteranimate",r.BEFORE_LAYOUT="beforelayout",r.AFTER_LAYOUT="afterlayout",r.BEFORE_STAGE_LAYOUT="beforestagelayout",r.AFTER_STAGE_LAYOUT="afterstagelayout",r.BEFORE_TRANSFORM="beforetransform",r.AFTER_TRANSFORM="aftertransform",r.BATCH_START="batchstart",r.BATCH_END="batchend",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.BEFORE_RENDERER_CHANGE="beforerendererchange",r.AFTER_RENDERER_CHANGE="afterrendererchange"})(fe||(fe={}));var Ti;(function(r){r.UNDO="undo",r.REDO="redo",r.CANCEL="cancel",r.ADD="add",r.CLEAR="clear",r.CHANGE="change"})(Ti||(Ti={}));var hr;(function(r){r.CLICK="node:click",r.DBLCLICK="node:dblclick",r.POINTER_OVER="node:pointerover",r.POINTER_LEAVE="node:pointerleave",r.POINTER_ENTER="node:pointerenter",r.POINTER_MOVE="node:pointermove",r.POINTER_OUT="node:pointerout",r.POINTER_DOWN="node:pointerdown",r.POINTER_UP="node:pointerup",r.CONTEXT_MENU="node:contextmenu",r.DRAG_START="node:dragstart",r.DRAG="node:drag",r.DRAG_END="node:dragend",r.DRAG_ENTER="node:dragenter",r.DRAG_OVER="node:dragover",r.DRAG_LEAVE="node:dragleave",r.DROP="node:drop"})(hr||(hr={}));const st="combo",Zn="tree";var no;(function(r){r.NODE="node",r.EDGE="edge",r.COMBO="combo",r.THEME="theme",r.PALETTE="palette",r.LAYOUT="layout",r.BEHAVIOR="behavior",r.PLUGIN="plugin",r.ANIMATION="animation",r.TRANSFORM="transform",r.SHAPE="shape"})(no||(no={}));const Vh={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function di(r,e){var t;const n=(t=Vh[r])===null||t===void 0?void 0:t[e];if(n)return n}const bk="5.0.44",wk="G6";function oi(r){return`[${wk} v${bk}] ${r}`}const Yr={mute:!1,debug:r=>{console.debug(oi(r))},info:r=>{console.info(oi(r))},warn:r=>{console.warn(oi(r))},error:r=>{console.error(oi(r))}};function r1(r){const{theme:e}=r;if(!e)return{};const t=di(no.THEME,e);return t||(Yr.warn(`The theme of ${e} is not registered.`),{})}function Wf(r,e){if(Array.isArray(r)&&r.length===0)return null;const t=Array.isArray(r)?r[0]:r,n=Array.isArray(r)?r.slice(1):e||[];return new Proxy(t,{get(i,s){return typeof i[s]=="function"&&!["onframe","onfinish"].includes(s)?(...a)=>{i[s](...a),n.forEach(o=>{var l;return(l=o[s])===null||l===void 0?void 0:l.call(o,...a)})}:s==="finished"?Promise.all([t.finished,...n.map(a=>a.finished)]):Reflect.get(i,s)},set(i,s,a){return["onframe","onfinish"].includes(s)||n.forEach(o=>{o[s]=a}),Reflect.set(i,s,a)}})}function Uh(r){const e=r.reduce((n,i)=>(Object.entries(i).forEach(([s,a])=>{n[s]===void 0?n[s]=[a]:n[s].push(a)}),n),{});Object.entries(e).forEach(([n,i])=>{(i.length!==r.length||i.some(s=>Ae(s))||i.every(s=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Ct(s,i[0])))&&delete e[n]});const t=Object.entries(e).reduce((n,[i,s])=>(s.forEach((a,o)=>{n[o]?n[o][i]=a:n[o]={[i]:a}}),n),[]);return r.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function ro(r){switch(r){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function i1(r,e){const{animation:t}=r;if(t===!1||e===!1)return!1;const n=Object.assign({},mk);return Bt(t)&&Object.assign(n,t),Bt(e)&&Object.assign(n,e),n}function xk(r){if(typeof r=="string"){const e=di(no.ANIMATION,r);return e||(Yr.warn(`The animation of ${r} is not registered.`),[])}return r}function Ek(r,e,t,n){var i,s;const{animation:a}=r;if(a===!1||n===!1)return[];const o=(i=r==null?void 0:r[e])===null||i===void 0?void 0:i.animation;if(o===!1)return[];const l=o==null?void 0:o[t];if(l===!1)return[];const u=(s=r1(r)[e])===null||s===void 0?void 0:s.animation,c=(h=[])=>xk(h).map(f=>Object.assign(Object.assign(Object.assign(Object.assign({},yk),Bt(a)&&a),f),Bt(n)&&n));if(l)return c(l);if(!u)return[];const d=u[t];return d===!1?[]:c(d)}function s1(r,e,t,n=[]){if(!n&&r===0&&e===0&&t===0)return null;if(Array.isArray(n)){let s=-1;const a=[];for(let o=0;o<n.length;o++){const l=n[o];if(l[0]==="translate"){if(l[1]===r&&l[2]===e)return null;s=o,a.push(["translate",r,e])}else if(l[0]==="translate3d"){if(l[1]===r&&l[2]===e&&l[3]===t)return null;s=o,a.push(["translate3d",r,e,t??0])}else a.push(l)}return s===-1&&a.splice(0,0,ye(t)?["translate3d",r,e,t??0]:["translate",r,e]),a.length===0?null:a}const i=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${r}, ${e})${i}`:`translate3d(${r}, ${e}, ${t})${i}`}var Mk=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const Sk=(r,e,t)=>{if(!t.length)return null;const[n,i]=e,s=u=>{var c;if(u){const d=r.getShape(u);if(!d)return null;const h=`get${Kl(u)}Style`,f=((c=r==null?void 0:r[h])===null||c===void 0?void 0:c.bind(r))||(p=>p),g=(f==null?void 0:f(n))||{},v=(f==null?void 0:f(i))||{};return{shape:d,fromStyle:g,toStyle:v}}else return{shape:r,fromStyle:n,toStyle:i}};let a;const o=t.map(u=>{var{fields:c,shape:d,states:h}=u,f=Mk(u,["fields","shape","states"]);const g=s(d);if(!g)return null;const{shape:v,fromStyle:p,toStyle:y}=g,b=[{},{}];if(c.forEach(T=>{var S,k;Object.assign(b[0],{[T]:(S=p[T])!==null&&S!==void 0?S:ro(T)}),Object.assign(b[1],{[T]:(k=y[T])!==null&&k!==void 0?k:ro(T)})}),b.some(T=>Object.keys(T).some(S=>["x","y","z"].includes(S)))){const{x:T=0,y:S=0,z:k,transform:A=""}=v.attributes||{};b.forEach(O=>{var C,P,L;O.transform=s1((C=O.x)!==null&&C!==void 0?C:T,(P=O.y)!==null&&P!==void 0?P:S,(L=O.z)!==null&&L!==void 0?L:k,A)})}const E=v.animate(Uh(b),f);return d===void 0&&(a=E),E}).filter(Boolean),l=a||(o==null?void 0:o[0]);return l?Wf(l,o.filter(u=>u!==u)):null},Tk=[{fields:["opacity"]}],Ok=[{fields:["x","y"]}],a1=[{fields:["x","y"]}],kk=a1,o1=[{fields:["sourceNode","targetNode"]}],Nk=o1,l1=[{fields:["childrenNode","x","y"]}],Ak=l1;function Ck(r){return"source"in r&&"target"in r}function Pk(r){return r.length===2}function ha(r){return r instanceof Float32Array?!0:Array.isArray(r)&&(r.length===2||r.length===3)?r.every(e=>typeof e=="number"):!1}function Gr(r,e,t){return r>=e&&r<=t}function Vr(r=0){if(Array.isArray(r)){const[e=0,t=e,n=e,i=t]=r;return[e,t,n,i]}return[r,r,r,r]}function _k(r=0){const e=Vr(r);return e[0]+e[2]}function Ur(r){return r.max[0]-r.min[0]}function Hr(r){return r.max[1]-r.min[1]}function qi(r){return[Ur(r),Hr(r)]}function Ci(r,e){const t=ha(r)?Gf(r):r.getShape("key").getBounds();return e?Zi(t,e):t}function Gf(r){const[e,t,n=0]=r,i=new ct;return i.setMinMax([e,t,n],[e,t,n]),i}function Zi(r,e){const[t,n,i,s]=Vr(e),[a,o,l]=r.min,[u,c,d]=r.max,h=new ct;return h.setMinMax([a-s,o-t,l],[u+n,c+i,d]),h}function Eo(r){if(r.length===0)return new ct;if(r.length===1)return r[0];const e=new ct;e.setMinMax(r[0].min,r[0].max);for(let t=1;t<r.length;t++){const n=r[t];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function Lk(r,e){const[t,n]=r.min,[i,s]=r.max,[a,o]=e.min,[l,u]=e.max;return t>=a&&i<=l&&n>=o&&s<=u}function Sr(r,e){return Gr(r[0],e.min[0],e.max[0])&&Gr(r[1],e.min[1],e.max[1])}function u1(r,e,t=!1){const{min:[n,i],max:[s,a]}=e,o=(r[1]===i||r[1]===a)&&(t||Gr(r[0],n,s)),l=(r[0]===n||r[0]===s)&&(t||Gr(r[1],i,a));return o||l}function Dk(r,e){return!Sr(r,e)}function lu(r,e){const{center:t}=e;return r[0]===t[0]&&r[1]===t[1]}function qa(r,e){const[t,n]=r,[i,s]=e.min,[a,o]=e.max,l=t-i,u=a-t,c=n-s,d=o-n,h=Math.min(l,u,c,d);return h===l?"left":h===u?"right":h===c?"top":h===d?"bottom":"left"}function ys(r,e){const t=Gi(r);if(Sr(r,e))switch(qa(r,e)){case"left":t[0]=e.min[0];break;case"right":t[0]=e.max[0];break;case"top":t[1]=e.min[1];break;case"bottom":t[1]=e.max[1];break}else{const[n,i]=r,[s,a]=e.min,[o,l]=e.max;t[0]=Gr(n,s,o)?n:n<s?s:o,t[1]=Gr(i,a,l)?i:i<a?a:l}return t}function Ik(r,e){const{center:t}=r,[n,i]=qi(r),s=e==="up"||e==="down"?t[0]:e==="right"?t[0]-n/6:t[0]+n/6,a=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[s,a]}function Rk(r,e){let[t,n]=qi(r);return[t,n]=e==="up"||e==="down"?[t,n]:[n,t],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(t/2,2)+Math.pow(n,2))-t/2,2))/(2*n)}function jk(r){const{min:[e,t],max:[n,i]}=r,s=[e,i],a=[n,i],o=[n,t],l=[e,t];return[[s,a],[a,o],[o,l],[l,s]]}var Bk=function(e,t){return e===t},Lp=function(){function r(e,t){t===void 0&&(t=null),this.value=e,this.next=t}return r.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},r}(),zk=function(){function r(e){e===void 0&&(e=Bk),this.head=null,this.tail=null,this.compare=e}return r.prototype.prepend=function(e){var t=new Lp(e,this.head);return this.head=t,this.tail||(this.tail=t),this},r.prototype.append=function(e){var t=new Lp(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},r.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},r.prototype.find=function(e){var t=e.value,n=t===void 0?void 0:t,i=e.callback,s=i===void 0?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(s&&s(a.value)||n!==void 0&&this.compare(a.value,n))return a;a=a.next}return null},r.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},r.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},r.prototype.fromArray=function(e){var t=this;return e.forEach(function(n){return t.append(n)}),this},r.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},r.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},r.prototype.toString=function(e){return e===void 0&&(e=void 0),this.toArray().map(function(t){return t.toString(e)}).toString()},r}(),Fk=function(e,t,n){t===void 0&&(t=[]);var i=t.filter(function(l){return l.source===e||l.target===e});if(n==="target"){var s=function(u){return u.source===e};return i.filter(s).map(function(l){return l.target})}if(n==="source"){var a=function(u){return u.target===e};return i.filter(a).map(function(l){return l.source})}var o=function(u){return u.source===e?u.target:u.source};return i.map(o)},$k=function(e,t){return t.filter(function(n){return n.source===e})},Wk=function(e,t){return t.filter(function(n){return n.source===e||n.target===e})},Gk=function(e){var t={},n=e.nodes,i=n===void 0?[]:n,s=e.edges,a=s===void 0?[]:s;return i.forEach(function(o){t[o.id]={degree:0,inDegree:0,outDegree:0}}),a.forEach(function(o){t[o.source].degree++,t[o.source].outDegree++,t[o.target].degree++,t[o.target].inDegree++}),t},Yk={}.toString,Yf=function(r,e){return Yk.call(r)==="[object "+e+"]"};const c1=function(r){return Yf(r,"Function")},d1=function(r){return Array.isArray?Array.isArray(r):Yf(r,"Array")},Vk=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function Uk(r,e){if(r){var t;if(d1(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(Vk(r)){for(var s in r)if(r.hasOwnProperty(s)&&(t=e(r[s],s),t===!1))break}}}const Hk=function(r){return Yf(r,"String")};var Xk=Object.values?function(r){return Object.values(r)}:function(r){var e=[];return Uk(r,function(t,n){c1(r)&&n==="prototype"||e.push(t)}),e};const qk=function(r,e){if(!c1(r))throw new TypeError("Expected a function");var t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=e?e.apply(this,n):n[0],a=t.cache;if(a.has(s))return a.get(s);var o=r.apply(this,n);return a.set(s,o),o};return t.cache=new Map,t};var cl;qk(function(r,e){e===void 0&&(e={});var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,s=e.fontStyle,a=e.fontVariant;return cl||(cl=document.createElement("canvas").getContext("2d")),cl.font=[s,a,i,t+"px",n].join(" "),cl.measureText(Hk(r)?r:"").width},function(r,e){return e===void 0&&(e={}),M2([r],Xk(e)).join("")});var Zk=function(e,t,n){for(var i=1/0,s,a=0;a<t.length;a++){var o=t[a].id;!n[o]&&e[o]<=i&&(i=e[o],s=t[a])}return s},Kk=function(e,t,n,i){var s=e.nodes,a=s===void 0?[]:s,o=e.edges,l=o===void 0?[]:o,u={},c={},d={};a.forEach(function(b,E){var T=b.id;c[T]=1/0,T===t&&(c[T]=0)});for(var h=a.length,f=function(E){var T=Zk(c,a,u),S=T.id;if(u[S]=!0,c[S]===1/0)return"continue";var k=[];n?k=$k(S,l):k=Wk(S,l),k.forEach(function(A){var O=A.target,C=A.source,P=O===S?C:O,L=i&&A[i]?A[i]:1;c[P]>c[T.id]+L?(c[P]=c[T.id]+L,d[P]=[T.id]):c[P]===c[T.id]+L&&d[P].push(T.id)})},g=0;g<h;g++)f();d[t]=[t];var v={};for(var p in c)c[p]!==1/0&&h1(t,p,d,v);var y={};for(var p in v)y[p]=v[p][0];return{length:c,path:y,allPath:v}};function h1(r,e,t,n){if(r===e)return[r];if(n[e])return n[e];for(var i=[],s=0,a=t[e];s<a.length;s++){var o=a[s],l=h1(r,o,t,n);if(!l)return;for(var u=0,c=l;u<c.length;u++){var d=c[u];d1(d)?i.push(wn(wn([],d,!0),[e],!1)):i.push([d,e])}}return n[e]=i,n[e]}var f1=function(e,t,n,i,s){var a=Kk(e,t,i,s),o=a.length,l=a.path,u=a.allPath;return{length:o[n],path:l[n],allPath:u[n]}},Dp;(function(r){r.EuclideanDistance="euclideanDistance"})(Dp||(Dp={}));var Qk=function(e,t,n){typeof t!="number"&&(t=1e-6),typeof n!="number"&&(n=.85);for(var i=1,s=0,a=1e3,o=e.nodes,l=o===void 0?[]:o,u=e.edges,c=u===void 0?[]:u,d=l.length,h,f={},g={},v=0;v<d;++v){var p=l[v],y=p.id;f[y]=1/d,g[y]=1/d}for(var b=Gk(e);a>0&&i>t;){s=0;for(var v=0;v<d;++v){var p=l[v],y=p.id;if(h=0,b[p.id].inDegree===0)f[y]=0;else{for(var E=Fk(y,c,"source"),T=0;T<E.length;++T){var S=E[T],k=b[S].outDegree;k>0&&(h+=g[S]/k)}f[y]=n*h,s+=f[y]}}s=(1-s)/d,i=0;for(var v=0;v<d;++v){var p=l[v],y=p.id;h=f[y]+s,i+=Math.abs(h-g[y]),g[y]=h}a-=1}return g};(function(){function r(e){e===void 0&&(e=10),this.linkedList=new zk,this.maxStep=e}return Object.defineProperty(r.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},r.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},r.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},r.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},r.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value})},r.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},r})();function q(r){if(r.id!==void 0)return r.id;if(r.source!==void 0&&r.target!==void 0)return`${r.source}-${r.target}`;throw new Error(oi("The datum does not have available id."))}function dl(r){return r.combo}function g1(r,e){const t={nodes:(r.nodes||[]).map(q),edges:(r.edges||[]).map(q),combos:(r.combos||[]).map(q)};return e?Object.values(t).flat():t}const p1=(r,e,t)=>{var n;switch(t.type){case"degree":{const i=new Map;return(n=r.nodes)===null||n===void 0||n.forEach(s=>{const a=e(q(s),t.direction).length;i.set(q(s),a)}),i}case"betweenness":return Jk(r,t.directed,t.weightPropertyName);case"closeness":return eN(r,t.directed,t.weightPropertyName);case"eigenvector":return nN(r,t.directed);case"pagerank":return tN(r,t.epsilon,t.linkProb);default:return v1(r)}},v1=r=>{var e;const t=new Map;return(e=r.nodes)===null||e===void 0||e.forEach(n=>{t.set(q(n),0)}),t},Jk=(r,e,t)=>{const n=v1(r),{nodes:i=[]}=r;return i.forEach(s=>{i.forEach(a=>{if(s!==a){const{allPath:o}=f1(r,q(s),q(a),e,t),l=o.length;o.flat().forEach(u=>{u!==q(s)&&u!==q(a)&&n.set(u,n.get(u)+1/l)})}})}),n},eN=(r,e,t)=>{const n=new Map,{nodes:i=[]}=r;return i.forEach(s=>{const a=i.reduce((o,l)=>{if(s!==l){const{length:u}=f1(r,q(s),q(l),e,t);o+=u}return o},0);n.set(q(s),1/a)}),n},tN=(r,e,t)=>{var n;const i=new Map,s=Qk(r,e,t);return(n=r.nodes)===null||n===void 0||n.forEach(a=>{i.set(q(a),s[q(a)])}),i},nN=(r,e)=>{const{nodes:t=[]}=r,n=rN(r,e),i=iN(n,t.length),s=new Map;return t.forEach((a,o)=>{s.set(q(a),i[o])}),s},rN=(r,e)=>{const{nodes:t=[],edges:n=[]}=r,i=Array(t.length).fill(null).map(()=>Array(t.length).fill(0));return n.forEach(({source:s,target:a})=>{const o=t.findIndex(u=>q(u)===s),l=t.findIndex(u=>q(u)===a);e?i[o][l]=1:(i[o][l]=1,i[l][o]=1)}),i},iN=(r,e,t=100,n=1e-6)=>{let i=Array(e).fill(1),s=1/0;for(let a=0;a<t&&s>n;a++){const o=Array(e).fill(0);for(let u=0;u<e;u++)for(let c=0;c<e;c++)o[u]+=r[u][c]*i[c];const l=Math.sqrt(o.reduce((u,c)=>u+c*c,0));for(let u=0;u<e;u++)o[u]/=l;s=Math.sqrt(o.reduce((u,c,d)=>u+(c-i[d])*c,0)),i=o}return i};function zi(r,e,t,n=Ct){const i=new Map(r.map(h=>[t(h),h])),s=new Map(e.map(h=>[t(h),h])),a=new Set(i.keys()),o=new Set(s.keys()),l=[],u=[],c=[],d=[];return o.forEach(h=>{a.has(h)?n(i.get(h),s.get(h))?d.push(s.get(h)):u.push(s.get(h)):l.push(s.get(h))}),a.forEach(h=>{o.has(h)||c.push(i.get(h))}),{enter:l,exit:c,keep:d,update:u}}function Ts(r,e,t){const n=i=>{t&&!t(i)||(i.style.visibility=e)};r.forEach(i=>{n(i)})}function sN(r,e,t){const n={},i=s=>(s in n||(n[s]=0),`${e}-${s}-${n[s]++}`);return t.map(s=>typeof s=="string"?{type:s,key:i(s)}:typeof s=="function"?s.call(r):s.key?s:Object.assign(Object.assign({},s),{key:i(s.type)}))}class Vf{constructor(e){this.extensions=[],this.extensionMap={},this.context=e}setExtensions(e){const t=sN(this.context.graph,this.category,e),{enter:n,update:i,exit:s,keep:a}=zi(this.extensions,t,o=>o.key);this.createExtensions(n),this.updateExtensions([...i,...a]),this.destroyExtensions(s),this.extensions=t}createExtension(e){const{category:t}=this,{key:n,type:i}=e,s=di(t,i);if(!s)return Yr.warn(`The extension ${i} of ${t} is not registered.`);const a=new s(this.context,e);this.extensionMap[n]=a}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,n=this.extensionMap[t];n&&n.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class Uf{constructor(e,t){this.events=[],this.destroyed=!1,this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class rr extends Uf{}class _u extends rr{constructor(e,t){super(e,Object.assign({},_u.defaultOptions,t)),this.isOverlapping=(n,i)=>i.some(s=>n.intersects(s)),this.occupiedBounds=[],this.detectLabelCollision=n=>{const i=this.context.viewport,s={show:[],hide:[]};return this.occupiedBounds=[],n.forEach(a=>{const o=a.getShape("label").getRenderBounds();i.isInViewport(o,!0)&&!this.isOverlapping(o,this.occupiedBounds)?(s.show.push(a),this.occupiedBounds.push(Zi(o,this.options.padding))):s.hide.push(a)}),s},this.hideLabelIfExceedViewport=(n,i)=>{const{exit:s}=zi(n,i,a=>a.id);s==null||s.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(n,i)=>{const{model:s}=this.context,a=s.getData(),o=s.getRelatedEdgesData.bind(s);return n.map(u=>(this.nodeCentralities.has(u.id)||(this.nodeCentralities=p1(a,o,i)),{node:u,centrality:this.nodeCentralities.get(u.id)})).sort((u,c)=>c.centrality-u.centrality).map(u=>u.node)},this.sortLabelElementsInView=n=>{const{sort:i,sortNode:s,sortCombo:a,sortEdge:o}=this.options,{model:l}=this.context;if(Ee(i))return n.sort((v,p)=>i(l.getElementDataById(v.id),l.getElementDataById(p.id)));const{node:u=[],edge:c=[],combo:d=[]}=ku(n,v=>v.type),h=Ee(a)?d.sort((v,p)=>a(...l.getComboData([v.id,p.id]))):d,f=Ee(s)?u.sort((v,p)=>s(...l.getNodeData([v.id,p.id]))):this.sortNodesByCentrality(u,s),g=Ee(o)?c.sort((v,p)=>o(...l.getEdgeData([v.id,p.id]))):c;return[...h,...f,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=n=>{var i;if(((i=n.data)===null||i===void 0?void 0:i.stage)==="zIndex")return;if(!this.validate(n)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const s=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,s),this.labelElementsInView=s;const a=this.sortLabelElementsInView(this.labelElementsInView),{show:o,hide:l}=this.detectLabelCollision(a);for(let u=o.length-1;u>=0;u--)this.showLabel(o[u]);l.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=n=>{const i=n.getShape("label");i&&Ts(i,"hidden"),this.hiddenElements.set(n.id,n)},this.showLabel=n=>{const i=n.getShape("label");i&&Ts(i,"visible"),n.toFront(),this.hiddenElements.delete(n.id)},this.onTransform=ry(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=n=>{this.enableToggle&&this.onToggleVisibility(n)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=n=>{this.onToggleVisibility(n),this.enableToggle=!0},this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:e}=this.context.element,t=[];for(const n in e){const i=e[n];i.isVisible()&&i.getShape("label")&&t.push(i)}return t}getLabelElementsInView(){const e=this.context.viewport;return this.getLabelElements().filter(t=>e.isInViewport(t.getShape("key").getRenderBounds()))}bindEvents(){const{graph:e}=this.context;e.on(fe.BEFORE_RENDER,this.onBeforeRender),e.on(fe.AFTER_RENDER,this.onAfterRender),e.on(fe.AFTER_DRAW,this.toggle),e.on(fe.AFTER_LAYOUT,this.toggle),e.on(fe.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(fe.BEFORE_RENDER,this.onBeforeRender),e.off(fe.AFTER_RENDER,this.onAfterRender),e.off(fe.AFTER_DRAW,this.toggle),e.off(fe.AFTER_LAYOUT,this.toggle),e.off(fe.AFTER_TRANSFORM,this.onTransform)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}_u.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Ip=[0,0,0];function ze(r,e){return r.map((t,n)=>t+e[n])}function it(r,e){return r.map((t,n)=>t-e[n])}function ni(r,e){return typeof e=="number"?r.map(t=>t*e):r.map((t,n)=>t*e[n])}function Tr(r,e){return typeof e=="number"?r.map(t=>t/e):r.map((t,n)=>t/e[n])}function aN(r,e){return r.reduce((t,n,i)=>t+n*e[i],0)}function oN(r,e){const t=io(r),n=io(e);return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function Pi(r,e){return r.map(t=>t*e)}function ft(r,e){return Math.sqrt(r.reduce((t,n,i)=>t+Math.pow(n-e[i]||0,2),0))}function uu(r,e){return r.reduce((t,n,i)=>t+Math.abs(n-e[i]),0)}function ui(r){const e=r.reduce((t,n)=>t+Math.pow(n,2),0);return r.map(t=>t/Math.sqrt(e))}function Hf(r,e,t=!1){const n=r[0]*e[1]-r[1]*e[0];let i=Math.acos(ni(r,e).reduce((s,a)=>s+a,0)/(ft(r,Ip)*ft(e,Ip)));return t&&n<0&&(i=2*Math.PI-i),i}function Lu(r,e=!0){return e?[-r[1],r[0]]:[r[1],-r[0]]}function lN(r,e){return r.map(t=>t%e)}function Os(r){return[r[0],r[1]]}function io(r){return Pk(r)?[r[0],r[1],0]:r}function m1(r){const[e,t]=r;return!e&&!t?0:Math.atan2(t,e)}function y1(r,e){const[t,n]=r,[i,s]=e,a=it(t,n),o=it(i,s);return oN(a,o).every(l=>l===0)}function Xf(r,e,t=!1){if(y1(r,e))return;const[n,i]=r,[s,a]=e,o=((n[0]-s[0])*(s[1]-a[1])-(n[1]-s[1])*(s[0]-a[0]))/((n[0]-i[0])*(s[1]-a[1])-(n[1]-i[1])*(s[0]-a[0])),l=a[0]-s[0]?(n[0]-s[0]+o*(i[0]-n[0]))/(a[0]-s[0]):(n[1]-s[1]+o*(i[1]-n[1]))/(a[1]-s[1]);if(!(!t&&(!Gr(o,0,1)||!Gr(l,0,1))))return[n[0]+o*(i[0]-n[0]),n[1]+o*(i[1]-n[1])]}function b1(r){if(Array.isArray(r))return Gr(r[0],0,1)&&Gr(r[1],0,1)?r:[.5,.5];const e=r.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,n=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,n]}function Kt(r){const{x:e=0,y:t=0,z:n=0}=r.style||{};return[+e,+t,+n]}function uN(r){const{x:e,y:t,z:n}=r.style||{};return e!==void 0||t!==void 0||n!==void 0}function cN(r,e){const[t,n]=e,{min:i,max:s}=r;return[i[0]+t*(s[0]-i[0]),i[1]+n*(s[1]-i[1])]}function ri(r,e="center"){const t=b1(e);return cN(r,t)}function fn(r){var e;return[r.x,r.y,(e=r.z)!==null&&e!==void 0?e:0]}function xr(r){var e;return{x:r[0],y:r[1],z:(e=r[2])!==null&&e!==void 0?e:0}}function Ca(r,e=0){return r.map(t=>parseFloat(t.toFixed(e)))}function Fi(r,e,t,n=!1){if(Ct(r,e))return r;const i=n?it(r,e):it(e,r),s=ui(i),a=[s[0]*t,s[1]*t];return ze(Os(r),a)}function w1(r,e){return r[1]===e[1]}function dN(r,e){return r[0]===e[0]}function hN(r,e){return w1(r,e)||dN(r,e)}function x1(r,e,t){return y1([r,e],[e,t])}function E1(r,e){return[2*e[0]-r[0],2*e[1]-r[1]]}function M1(r,e,t,n=!0,i=!1){for(let s=0;s<t.length;s++){let a=t[s],o=t[(s+1)%t.length];n&&(a=ze(e,a),o=ze(e,o));const l=i?E1(r,e):r,u=Xf([e,l],[a,o]);if(u)return{point:u,line:[a,o]}}return{point:e,line:void 0}}function fN(r,e,t,n){const i=r[0],s=r[1];let a=!1;t===void 0&&(t=0),n===void 0&&(n=e.length);const o=n-t;for(let l=0,u=o-1;l<o;u=l++){const c=e[l+t][0],d=e[l+t][1],h=e[u+t][0],f=e[u+t][1];d>s!=f>s&&i<(h-c)*(s-d)/(f-d)+c&&(a=!a)}return a}function gN(r,e,t=!1){const n=ri(e,"center"),i=[ri(e,"left-top"),ri(e,"right-top"),ri(e,"right-bottom"),ri(e,"left-bottom")];return M1(r,n,i,!1,t).point}function Du(r,e,t=!1){const n=e.center,i=t?E1(r,n):r,s=it(i,e.center),a=Math.atan2(s[1],s[0]);if(isNaN(a))return n;const o=Ur(e)/2,l=Hr(e)/2,u=n[0]+o*Math.cos(a),c=n[1]+l*Math.sin(a);return[u,c]}function pN(r,e){let t=1/0,n=[r[0],e[0]];return r.forEach(i=>{e.forEach(s=>{const a=ft(i,s);a<t&&(t=a,n=[i,s])})}),n}function vN(r,e){let t=1/0,n=[[0,0],[0,0]];return e.forEach(i=>{const s=mN(r,i);s<t&&(t=s,n=i)}),n}function mN(r,e){const t=S1(r,e);return ft(r,t)}function S1(r,e){const[t,n]=e[0],[i,s]=e[1],[a,o]=r,l=i-t,u=s-n;if(l===0&&u===0)return[t,n];let c=((a-t)*l+(o-n)*u)/(l*l+u*u);c>1?c=1:c<0&&(c=0);const d=t+c*l,h=n+c*u;return[d,h]}function yN(r){const e=r.reduce((t,n)=>ze(t,n),[0,0]);return Tr(e,r.length)}function qf(r,e=!0){const t=yN(r);return r.sort(([n,i],[s,a])=>{const o=Math.atan2(i-t[1],n-t[0]),l=Math.atan2(a-t[1],s-t[0]);return e?l-o:o-l})}function Rp(r,e){return[r,[r[0],e[1]],e,[e[0],r[1]]]}class Rt{constructor(e,t,n){if(this.phase=t,this.pointerByTouch=[],this.initialDistance=null,this.emitter=e,Rt.instance)return Rt.callbacks[this.phase].push(n),Rt.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),Rt.instance=this,Rt.callbacks[this.phase].push(n)}bindEvents(){const{emitter:e}=this;e.on(te.POINTER_DOWN,this.onPointerDown),e.on(te.POINTER_MOVE,this.onPointerMove),e.on(te.POINTER_UP,this.onPointerUp)}updatePointerPosition(e,t,n){const i=this.pointerByTouch.findIndex(s=>s.pointerId===e);i>=0&&(this.pointerByTouch[i]={x:t,y:n,pointerId:e})}onPointerDown(e){const{x:t,y:n}=e.client||{};if(!(t===void 0||n===void 0)&&(this.pointerByTouch.push({x:t,y:n,pointerId:e.pointerId}),e.pointerType==="touch"&&this.pointerByTouch.length===2)){Rt.isPinching=!0;const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,s=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(i*i+s*s),Rt.callbacks.pinchstart.forEach(a=>a(e,{scale:0}))}}onPointerMove(e){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;const{x:t,y:n}=e.client||{};if(t===void 0||n===void 0)return;this.updatePointerPosition(e.pointerId,t,n);const i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,s=this.pointerByTouch[0].y-this.pointerByTouch[1].y,o=Math.sqrt(i*i+s*s)/this.initialDistance;Rt.callbacks.pinchmove.forEach(l=>l(e,{scale:(o-1)*5}))}onPointerUp(e){var t;Rt.callbacks.pinchend.forEach(n=>n(e,{scale:0})),Rt.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(t=Rt.instance)===null||t===void 0||t.tryDestroy()}destroy(){this.emitter.off(te.POINTER_DOWN,this.onPointerDown),this.emitter.off(te.POINTER_MOVE,this.onPointerMove),this.emitter.off(te.POINTER_UP,this.onPointerUp),Rt.instance=null}off(e,t){const n=Rt.callbacks[e].indexOf(t);n>-1&&Rt.callbacks[e].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(Rt.callbacks).every(e=>e.length===0)&&this.destroy()}}Rt.isPinching=!1;Rt.instance=null;Rt.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const jp=r=>r.map(e=>Ke(e)?e.toLocaleLowerCase():e);class va{constructor(e){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=t=>{t!=null&&t.key&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{t!=null&&t.key&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(te.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(te.DRAG,t)},this.handlePinch=(t,n)=>{this.triggerExtendKey(te.PINCH,Object.assign(Object.assign({},t),n))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&(e.includes(te.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new Rt(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(e,t))}unbind(e,t){this.map.forEach((n,i)=>{Ct(i,e)&&(!t||t===n)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=jp(Array.from(this.recordKey)).sort(),n=jp(e).sort();return Ct(t,n)}bindEvents(){var e;const{emitter:t}=this;t.on(te.KEY_DOWN,this.onKeyDown),t.on(te.KEY_UP,this.onKeyUp),t.on(te.WHEEL,this.onWheel),t.on(te.DRAG,this.onDrag),(e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"focus",this.onFocus)}trigger(e){this.map.forEach((t,n)=>{this.match(n)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((n,i)=>{i.includes(e)&&Ct(Array.from(this.recordKey),i.filter(s=>s!==e))&&n(t)})}destroy(){var e,t;this.unbindAll(),this.emitter.off(te.KEY_DOWN,this.onKeyDown),this.emitter.off(te.KEY_UP,this.onKeyUp),this.emitter.off(te.WHEEL,this.onWheel),this.emitter.off(te.DRAG,this.onDrag),(e=this.pinchHandler)===null||e===void 0||e.off("pinchmove",this.boundHandlePinch),(t=globalThis.removeEventListener)===null||t===void 0||t.call(globalThis,"blur",this.onFocus)}}class Mo extends rr{constructor(e,t){super(e,Ln({},Mo.defaultOptions,t)),this.shortcut=new va(e.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(e){if(!this.validate(e)||!this.isKeydown()||this.startPoint)return;const{canvas:t,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new pn({id:"g6-brush-select",style:i}),t.appendChild(this.rectShape),this.startPoint=[e.canvas.x,e.canvas.y]}onPointerMove(e){var t;if(!this.startPoint)return;const{immediately:n,mode:i}=this.options;this.endPoint=cu(e),(t=this.rectShape)===null||t===void 0||t.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&i==="default"&&this.updateElementsStates(Rp(this.startPoint,this.endPoint))}onPointerUp(e){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=cu(e),this.updateElementsStates(Rp(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:e}=this.context,t=Object.values(e.getData()).reduce((n,i)=>Object.assign({},n,i.reduce((s,a)=>(s[q(a)]=[],s),{})),{});e.setElementState(t,this.options.animation)}updateElementsStates(e){const{graph:t}=this.context,{enableElements:n,state:i,mode:s,onSelect:a}=this.options,o=this.selector(t,e,n);let l={};switch(s){case"union":o.forEach(u=>{l[u]=[...t.getElementState(u),i]});break;case"diff":o.forEach(u=>{const c=t.getElementState(u);l[u]=c.includes(i)?c.filter(d=>d!==i):[...c,i]});break;case"intersect":o.forEach(u=>{const c=t.getElementState(u);l[u]=c.includes(i)?[i]:[]});break;case"default":default:o.forEach(u=>{l[u]=[i]});break}Ee(a)&&(l=a(l)),t.setElementState(l,this.options.animation)}selector(e,t,n){if(!n||n.length===0)return[];const i=[],s=e.getData();if(n.forEach(a=>{s[`${a}s`].forEach(o=>{const l=q(o);e.getElementVisibility(l)!=="hidden"&&fN(e.getElementPosition(l),t)&&i.push(l)})}),n.includes("edge")){const a=s.edges;a==null||a.forEach(o=>{const{source:l,target:u}=o;i.includes(l)&&i.includes(u)&&i.push(q(o))})}return i}clearBrush(){var e;(e=this.rectShape)===null||e===void 0||e.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:e}=this.options,t=Array.isArray(e)?e:[e];return this.shortcut.match(t.filter(n=>n!=="drag"))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}bindEvents(){const{graph:e}=this.context;e.on(te.POINTER_DOWN,this.onPointerDown),e.on(te.POINTER_MOVE,this.onPointerMove),e.on(te.POINTER_UP,this.onPointerUp),e.on(ci.CLICK,this.clearStates)}unbindEvents(){const{graph:e}=this.context;e.off(te.POINTER_DOWN,this.onPointerDown),e.off(te.POINTER_MOVE,this.onPointerMove),e.off(te.POINTER_UP,this.onPointerUp),e.off(ci.CLICK,this.clearStates)}update(e){this.unbindEvents(),this.options=Ln(this.options,e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Mo.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const cu=r=>[r.canvas.x,r.canvas.y],hi=.8,ks=["node","edge","combo"];function sa(r,e,t,n,i=0){n==="TB"&&e(r,i);const s=t(r);if(s)for(const a of s)sa(a,e,t,n,i+1);n==="BT"&&e(r,i)}function bN(r,e,t){const n=[[r,0]];for(;n.length;){const[i,s]=n.shift();e(i,s);const a=t(i);if(a)for(const o of a)n.push([o,s+1])}}function T1(r,e,t,n,i="both"){if(e==="combo"||e==="node")return bd(r,t,n,i);const s=r.getEdgeData(t);if(!s)return[];const a=bd(r,s.source,n-1,i),o=bd(r,s.target,n-1,i);return Array.from(new Set([...a,...o,t]))}function bd(r,e,t,n="both"){const i=new Set,s=new Set,a=new Set;return bN(e,(o,l)=>{l>t||(a.add(o),r.getRelatedEdgesData(o,n).forEach(u=>{const c=q(u);!s.has(c)&&l<t&&(a.add(c),s.add(c))}))},o=>r.getRelatedEdgesData(o,n).map(l=>l.source===o?l.target:l.source).filter(l=>i.has(l)?!1:(i.add(l),!0))),Array.from(a)}function wd(r){return r.states||[]}var hl=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Iu extends rr{constructor(e,t){super(e,Object.assign({},Iu.defaultOptions,t)),this.onClickSelect=n=>hl(this,void 0,void 0,function*(){var i,s;this.validate(n)&&(yield this.updateState(n),(s=(i=this.options).onClick)===null||s===void 0||s.call(i,n))}),this.onClickCanvas=n=>hl(this,void 0,void 0,function*(){var i,s;this.validate(n)&&(yield this.clearState(),(s=(i=this.options).onClick)===null||s===void 0||s.call(i,n))}),this.shortcut=new va(e.graph),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),ks.forEach(t=>{e.on(`${t}:${te.CLICK}`,this.onClickSelect)}),e.on(ci.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:e,trigger:t}=this.options;return e&&this.shortcut.match(t)}getNeighborIds(e){const{target:t,targetType:n}=e,{graph:i}=this.context,{degree:s}=this.options;return T1(i,n,t.id,typeof s=="function"?s(e):s).filter(a=>a!==t.id)}updateState(e){return hl(this,void 0,void 0,function*(){const{state:t,unselectedState:n,neighborState:i,animation:s}=this.options;if(!t&&!i&&!n)return;const{target:a}=e,{graph:o}=this.context,l=o.getElementData(a.id),u=wd(l).includes(t)?"unselect":"select",c={},d=this.isMultipleSelect,h=[a.id],f=this.getNeighborIds(e);if(d)if(Object.assign(c,this.getDataStates()),u==="select"){const g=(v,p)=>{v.forEach(y=>{const b=new Set(o.getElementState(y));b.add(p),b.delete(n),c[y]=Array.from(b)})};g(h,t),g(f,i),n&&Object.keys(c).forEach(v=>{const p=c[v];!p.includes(t)&&!p.includes(i)&&!p.includes(n)&&c[v].push(n)})}else{const g=c[a.id];c[a.id]=g.filter(v=>v!==t&&v!==i),g.includes(n)||c[a.id].push(n),f.forEach(v=>{c[v]=c[v].filter(p=>p!==i),c[v].includes(t)||c[v].push(n)})}else if(u==="select"){Object.assign(c,this.getClearStates(!!n));const g=(v,p)=>{v.forEach(y=>{c[y]||(c[y]=o.getElementState(y)),c[y].push(p)})};g(h,t),g(f,i),n&&Object.keys(c).forEach(v=>{!h.includes(v)&&!f.includes(v)&&c[v].push(n)})}else Object.assign(c,this.getClearStates());yield o.setElementState(c,s)})}getDataStates(){const{graph:e}=this.context,{nodes:t,edges:n,combos:i}=e.getData(),s={};return[...t,...n,...i].forEach(a=>{s[q(a)]=wd(a)}),s}getClearStates(e=!1){const{graph:t}=this.context,{state:n,unselectedState:i,neighborState:s}=this.options,a=new Set([n,i,s]),{nodes:o,edges:l,combos:u}=t.getData(),c={};return[...o,...l,...u].forEach(d=>{const h=wd(d),f=h.filter(g=>!a.has(g));(e||f.length!==h.length)&&(c[q(d)]=f)}),c}clearState(){return hl(this,void 0,void 0,function*(){const{graph:e}=this.context;yield e.setElementState(this.getClearStates(),this.options.animation)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;ks.forEach(t=>{e.off(`${t}:${te.CLICK}`,this.onClickSelect)}),e.off(ci.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}Iu.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function Wn(r){var e;return!!(!((e=r.style)===null||e===void 0)&&e.collapsed)}function du(r,e){if(!r.startsWith(e))return!1;const t=r[e.length];return t>="A"&&t<="Z"}function wN(r,e){return`${e}${Kl(r)}`}function xN(r,e,t=!0){if(!e||!du(r,e))return r;const n=r.slice(e.length);return t?u2(n):n}function Yt(r,e){const t=Object.entries(r).reduce((n,[i,s])=>(i==="className"||i==="class"||du(i,e)&&Object.assign(n,{[xN(i,e)]:s}),n),{});if("opacity"in r){const n=wN("opacity",e),i=r.opacity;if(n in r){const s=r[n];Object.assign(t,{opacity:i*s})}else Object.assign(t,{opacity:i})}return t}function Hh(r,e){const t=e.length;return Object.keys(r).reduce((n,i)=>{if(i.startsWith(e)){const s=i.slice(t);n[s]=r[i]}return n},{})}function O1(r,e){const t=typeof e=="string"?[e]:e,n={};return Object.keys(r).forEach(i=>{t.find(s=>i.startsWith(s))||(n[i]=r[i])}),n}function er(r=0){if(typeof r=="number")return[r,r,r];const[e,t=e,n=e]=r;return[e,t,n]}var EN=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Bp(r,e){const{datum:t,graph:n}=e;return typeof r=="function"?r.call(n,t):Object.fromEntries(Object.entries(r).map(([i,s])=>typeof s=="function"?[i,s.call(n,t)]:[i,s]))}function ln(r,e){const t=(r==null?void 0:r.style)||{},n=(e==null?void 0:e.style)||{};for(const i in t)i in n||(n[i]=t[i]);return Object.assign({},r,e,{style:n})}function MN(r){const{x:e,y:t,z:n,class:i,className:s,transform:a,transformOrigin:o,zIndex:l,visibility:u}=r;return EN(r,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function SN(r,e){const t=er(r);let n={};return e.text&&!e.fontSize&&(n={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(n={width:t[0]*.5,height:t[1]*.5}),n}function zp(r){if(r)return typeof r=="string"||typeof r=="function"||Array.isArray(r)?{type:"group",field:e=>e.id,color:r,invert:!1}:r}function TN(r,e){if(!e)return{};const{type:t,color:n,field:i,invert:s}=e,a=l=>{const u=typeof n=="string"?di("palette",n):n;if(typeof u=="function"){const c={};return l.forEach(([d,h])=>{c[d]=u(s?1-h:h)}),c}else if(Array.isArray(u)){const c=s?[...u].reverse():u,d={};return l.forEach(([h,f])=>{d[h]=c[f%u.length]}),d}return{}},o=(l,u)=>{var c;return typeof l=="string"?(c=u.data)===null||c===void 0?void 0:c[l]:l==null?void 0:l(u)};if(t==="group"){const l=ku(r,h=>{if(!i)return"default";const f=o(i,h);return f?String(f):"default"}),u=Object.keys(l),c=a(u.map((h,f)=>[h,f])),d={};return Object.entries(l).forEach(([h,f])=>{f.forEach(g=>{d[q(g)]=c[h]})}),d}else if(t==="value"){const[l,u]=r.reduce(([d,h],f)=>{const g=o(i,f);if(typeof g!="number")throw new Error(oi(`Palette field ${i} is not a number`));return[Math.min(d,g),Math.max(h,g)]},[1/0,-1/0]),c=u-l;return a(r.map(d=>[d.id,(o(i,d)-l)/c]))}}function k1(r){const e=typeof r=="string"?di("palette",r):r;if(typeof e!="function")return e}function N1(r,e){let t=2*r;return typeof e=="string"?t=r*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*r),t}function A1(r,e,t=1,n=!1){const i=n?t:1,s=(r.max[0]-r.min[0])*i;return N1(s,e)}function ON(r,e,t=1){const n=ft(r[0],r[1])*t;return N1(n,e)}class So extends Bf{constructor(e){Fp(e.style),super(e),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(e,t,n,i,s){var a,o,l,u,c,d,h,f;const g=this.shapeMap[e];if(n===!1){g&&((a=s==null?void 0:s.beforeDestroy)===null||a===void 0||a.call(s,g),i.removeChild(g),delete this.shapeMap[e],(o=s==null?void 0:s.afterDestroy)===null||o===void 0||o.call(s,g));return}const v=typeof t=="string"?di(no.SHAPE,t):t;if(!v)throw new Error(oi(`Shape ${t} not found`));if(!g||g.destroyed||!(g instanceof v)){g&&((l=s==null?void 0:s.beforeDestroy)===null||l===void 0||l.call(s,g),g==null||g.destroy(),(u=s==null?void 0:s.afterDestroy)===null||u===void 0||u.call(s,g)),(c=s==null?void 0:s.beforeCreate)===null||c===void 0||c.call(s);const p=new v({className:e,style:n});return i.appendChild(p),this.shapeMap[e]=p,(d=s==null?void 0:s.afterCreate)===null||d===void 0||d.call(s,p),p}return(h=s==null?void 0:s.beforeUpdate)===null||h===void 0||h.call(s,g),tf(g,n),(f=s==null?void 0:s.afterUpdate)===null||f===void 0||f.call(s,g),g}update(e={}){const t=Object.assign({},this.attributes,e);Fp(t),xC(this,t),this.render(t,this),this.setVisibility()}bindEvents(){}getGraphicStyle(e){return MN(e)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(e,t){if(e.length===0)return null;const n=[];if(e[0].x!==void 0||e[0].y!==void 0||e[0].z!==void 0){const{x:s=0,y:a=0,z:o=0}=this.attributes;e.forEach(l=>{const{x:u=s,y:c=a,z:d=o}=l;Object.assign(l,{transform:d?[["translate3d",u,c,d]]:[["translate",u,c]]})})}const i=super.animate(e,t);if(i&&(xd(this,i),n.push(i)),Array.isArray(e)&&e.length>0){const s=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(e[0]).some(a=>!s.includes(a))){Object.entries(this.shapeMap).forEach(([o,l])=>{const u=`get${Kl(o)}Style`,c=this[u];if(Ee(c)){const d=e.map(f=>c.call(this,Object.assign(Object.assign({},this.attributes),f))),h=l.animate(Uh(d),t);h&&(xd(l,h),n.push(h))}});const a=(o,l)=>{if(!Ir(o)){const u=`get${Kl(l)}Style`,c=this[u];if(Ee(c)){const d=e.map(h=>c.call(this,Object.assign(Object.assign({},this.attributes),h)));Object.entries(d[0]).map(([h])=>{const f=d.map(v=>v[h]),g=o[h];if(g){const v=g.animate(Uh(f),t);v&&(xd(g,v),n.push(v))}})}}};this.compositeShapes.forEach(([o,l])=>{const u=Hh(this.shapeMap,l);a(u,o)})}}return Wf(n)}getShape(e){return this.shapeMap[e]}setVisibility(){const{visibility:e}=this.attributes;Ts(this,e)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function xd(r,e){e==null||e.finished.then(()=>{const t=r.activeAnimations.findIndex(n=>n===e);t>-1&&r.activeAnimations.splice(t,1)})}function Fp(r){if(!r)return{};if("x"in r||"y"in r||"z"in r){const{x:e=0,y:t=0,z:n,transform:i}=r,s=s1(e,t,n,i);s&&(r.transform=s)}return r}var kN=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Ki extends So{constructor(e){super(ln({style:Ki.defaultStyleProps},e))}isTextStyle(e){return du(e,"label")}isBackgroundStyle(e){return du(e,"background")}getTextStyle(e){const t=this.getGraphicStyle(e),{padding:n}=t,i=kN(t,["padding"]);return O1(i,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:n,wordWrapWidth:i,padding:s}=t,a=Yt(t,"background"),{min:[o,l],center:[u,c],halfExtents:[d,h]}=this.shapeMap.text.getGeometryBounds(),[f,g,v,p]=Vr(s),y=d*2+p+g,{width:b,height:E}=a;b&&E?Object.assign(a,{x:u-Number(b)/2,y:c-Number(E)/2}):Object.assign(a,{x:o-p,y:l-f,width:n?Math.min(y,i+p+g):y,height:h*2+f+v});const{radius:T}=a;if(typeof T=="string"&&T.endsWith("%")){const S=Number(T.replace("%",""))/100;a.radius=Math.min(+a.width,+a.height)*S}return a}render(e=this.parsedAttributes,t=this){this.upsert("text",_s,this.getTextStyle(e),t),this.upsert("background",pn,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}Ki.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class ma extends So{constructor(e){super(ln({style:ma.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",Ki,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}}ma.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function NN(r,e=!0){const t=[];return r.forEach((n,i)=>{t.push([i===0?"M":"L",...n])}),e&&t.push(["Z"]),t}const $p={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function AN(r){const e=r.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let n="",i={};for(;e.length>0;){let s=e.shift();s in $p?n=s:e.unshift(s),i={type:n},$p[n].forEach(l=>{s=e.shift(),i[l]=s}),n==="M"?n="L":n==="m"&&(n="l");const[a,...o]=Object.values(i);t.push([a,...o.map(Number)])}return t}function CN(r){const e=[];return(typeof r=="string"?AN(r):r).forEach(n=>{const i=n[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let s=1;s<n.length;s=s+2)e.push([n[s],n[s+1],0]);else{const s=n.length;e.push([n[s-2],n[s-1],0])}}),e}const C1=r=>{if(r.length<2)return[["M",0,0],["L",0,0]];const e=r[0],t=r[1],n=r[r.length-1],i=r[r.length-2];r.unshift(i,n),r.push(e,t);const s=[["M",n[0],n[1]]];for(let a=1;a<r.length-2;a+=1){const[o,l]=r[a-1],[u,c]=r[a],[d,h]=r[a+1],[f,g]=a!==r.length-2?r[a+2]:[d,h],v=u+(d-o)/6,p=c+(h-l)/6,y=d-(f-u)/6,b=h-(g-c)/6;s.push(["C",v,p,y,b,d,h])}return s};function PN(r,e,t,n,i,s,a){const[o,l]=ri(r,e),u={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:[["translate",o+t,l+n]]};if(e==="center"||!i)return u;const c=CN(s);if(!c||c.length<=3)return u;const d=c.map((g,v)=>{const p=g,y=c[(v+1)%c.length];return Ct(p,y)?null:[p,y]}).filter(Boolean),h=vN([o,l],d),f=S1([o,l],h);if(f&&h&&(u.transform=[["translate",f[0]+t,f[1]+n]],a)){const g=Math.atan((h[0][1]-h[1][1])/(h[0][0]-h[1][0]));u.transform.push(["rotate",g/Math.PI*180]),u.textAlign="center",(e==="right"||e==="left")&&(g>0?u.textBaseline=e==="right"?"bottom":"top":u.textBaseline=e==="right"?"top":"bottom")}return u}var _N=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class To extends So{constructor(e){super(ln({style:To.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const t=Yt(this.getGraphicStyle(e),"label"),{maxWidth:n,offsetX:i,offsetY:s,autoRotate:a,placement:o,closeToPath:l}=t,u=_N(t,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,d=c==null?void 0:c.getRenderBounds();return Object.assign(PN(d,o,i,s,l,e.d,a),{wordWrapWidth:A1(d,n)},u)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",Kn,this.getKeyStyle(e),t),this.upsert("label",Ki,this.getLabelStyle(e),t)}}To.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function LN(r){const e=[],t=n=>{n!=null&&n.children.length&&n.children.forEach(i=>{e.push(i),t(i)})};return t(r),e}function DN(r){const e=[];let t=r.parentNode;for(;t;)e.push(t),t=t.parentNode;return e}let Zf=class extends xo{constructor(e){super(e),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},qs=this,this.isMutationObserved=!0,this.addEventListener(Ue.MOUNTED,this.onMounted),this.addEventListener(Ue.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:e,clipPath:t,width:n=0,height:i=0}=this.attributes;if(e&&n&&i){const[s,a]=this.getBounds().min,o={x:s,y:a,radius:e,width:n,height:i};if(t)Object.assign(this.parsedStyle.clipPath.style,o);else{const l=new pn({style:o});this.style.clipPath=l}}else t&&(this.style.clipPath=null)}};const Xh=new WeakMap;let qs=null;const Kf=r=>{if(qs&&DN(qs).includes(r)){const e=Xh.get(r);e?e.includes(qs)||e.push(qs):Xh.set(r,[qs])}},Qf=r=>{const e=Xh.get(r);e&&e.forEach(t=>t.handleRadius())};class P1 extends So{constructor(e){super(e)}isImage(){const{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){const{width:t=0,height:n=0}=e,i=this.getGraphicStyle(e);return this.isImage()?Object.assign({x:-t/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(e=this.attributes,t=this){this.upsert("icon",this.isImage()?Zf:_s,this.getIconStyle(e),t)}}class _1 extends So{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const n=super.animate(e,t);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var fl=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Or extends _1{constructor(e){super(ln({style:Or.defaultStyleProps},e)),this.type="node"}getSize(e=this.attributes){const{size:t}=e;return er(t)}getKeyStyle(e){const t=this.getGraphicStyle(e);return Object.assign(O1(t,["label","halo","icon","badge","port"]))}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=Yt(this.getGraphicStyle(e),"label"),{placement:n,maxWidth:i,offsetX:s,offsetY:a}=t,o=fl(t,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(rv(l,n,s,a),{wordWrapWidth:A1(l,i)},o)}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),{fill:n}=t,i=fl(t,["fill"]),s=Yt(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),s)}getIconStyle(e){if(e.icon===!1||!e.iconText&&!e.iconSrc)return!1;const t=Yt(this.getGraphicStyle(e),"icon");return Object.assign(SN(e.size,t),t)}getBadgesStyle(e){var t;const n=Hh(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach(d=>{i[d]=!1}),e.badge===!1||!(!((t=e.badges)===null||t===void 0)&&t.length))return i;const{badges:s=[],badgePalette:a,opacity:o=1}=e,l=fl(e,["badges","badgePalette","opacity"]),u=k1(a),c=Yt(this.getGraphicStyle(l),"badge");return s.forEach((d,h)=>{i[h]=Object.assign(Object.assign({backgroundFill:u?u[h%(u==null?void 0:u.length)]:void 0,opacity:o},c),this.getBadgeStyle(d))}),i}getBadgeStyle(e){const t=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:s}=e,a=fl(e,["placement","offsetX","offsetY"]),o=rv(t.getLocalBounds(),n,i,s,!0);return Object.assign(Object.assign({},o),a)}getPortsStyle(e){var t;const n=this.getPorts(),i={};if(Object.keys(n).forEach(o=>{i[o]=!1}),e.port===!1||!(!((t=e.ports)===null||t===void 0)&&t.length))return i;const s=Yt(this.getGraphicStyle(e),"port"),{ports:a=[]}=e;return a.forEach((o,l)=>{const u=o.key||l,c=Object.assign(Object.assign({},s),o);if(J1(c))i[u]=!1;else{const[d,h]=this.getPortXY(e,o);i[u]=Object.assign({transform:[["translate",d,h]]},c)}}),i}getPortXY(e,t){const{placement:n="left"}=t,i=this.getShape("key");return rg(IN(this.context,i),n)}getPorts(){return Hh(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return gN(e,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e),i=this.getShape("key");this.upsert("halo",i.constructor,n,t)}drawIconShape(e,t){const n=this.getIconStyle(e);this.upsert("icon",P1,n,t),Kf(this)}drawBadgeShapes(e,t){const n=this.getBadgesStyle(e);Object.keys(n).forEach(i=>{const s=n[i];this.upsert(`badge-${i}`,ma,s,t)})}drawPortShapes(e,t){const n=this.getPortsStyle(e);Object.keys(n).forEach(i=>{const s=n[i],a=`port-${i}`;this.upsert(a,pi,s,t)})}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",Ki,n,t)}_drawKeyShape(e,t){return this.drawKeyShape(e,t)}render(e=this.parsedAttributes,t=this){this._drawKeyShape(e,t),this.getShape("key")&&(this.drawHaloShape(e,t),this.drawIconShape(e,t),this.drawBadgeShapes(e,t),this.drawLabelShape(e,t),this.drawPortShapes(e,t))}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&Qf(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Or.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function IN(r,e){if(!r)return e.getLocalBounds();const t=r.canvas.getLayer(),n=e.cloneNode();Ts(n,"hidden"),t.appendChild(n);const i=n.getLocalBounds();return n.destroy(),i}let Oo=class L1 extends Or{constructor(e){super(ln({style:L1.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",pi,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){const t=super.getIconStyle(e),{r:n}=this.getShape("key").attributes,i=n*2*hi;return t?Object.assign({width:i,height:i},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Du(e,n,t)}};Oo.defaultStyleProps={size:32};class Ru extends Or{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",Ps,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{points:this.getPoints(e)})}getIntersectPoint(e,t=!1){var n,i;const{points:s}=this.getShape("key").attributes,a=[+(((n=this.attributes)===null||n===void 0?void 0:n.x)||0),+(((i=this.attributes)===null||i===void 0?void 0:i.y)||0)];return M1(e,a,s,!0,t).point}}class RN extends Ru{constructor(e){super(e)}getPoints(e){const[t,n]=this.getSize(e);return bC(t,n)}}var jN=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ju extends Oo{constructor(e){super(ln({style:ju.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...er(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return Ke(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:n}=e;if(!(n!=null&&n.length))return;const i=n.map(d=>ye(d)?{value:d}:d),s=Yt(this.getGraphicStyle(e),"donut"),a=k1(e.donutPalette);if(!a)return;const o=i.reduce((d,h)=>{var f;return d+((f=h.value)!==null&&f!==void 0?f:0)},0),l=this.parseOuterR(),u=this.parseInnerR();let c=0;i.forEach((d,h)=>{const{value:f=0,color:g=a[h%a.length]}=d,v=jN(d,["value","color"]),p=(o===0?1/i.length:f/o)*360;this.upsert(`round${h}`,Kn,Object.assign(Object.assign(Object.assign({},s),{d:FN(l,u,c,c+p),fill:g}),v),t),c+=p})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}}ju.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const gl=(r,e,t,n)=>[r+Math.sin(n)*t,e-Math.cos(n)*t],BN=(r,e,t,n)=>n<=0||t<=n?[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"]]:[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"],["M",r+n,e],["A",n,n,0,1,0,r-n,e],["A",n,n,0,1,0,r+n,e],["Z"]],zN=(r,e,t,n,i,s)=>{const[a,o]=[i/360*2*Math.PI,s/360*2*Math.PI],l=[gl(r,e,n,a),gl(r,e,t,a),gl(r,e,t,o),gl(r,e,n,o)],u=o-a>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",t,t,0,u,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",n,n,0,u,0,l[0][0],l[0][1]],["Z"]]},FN=(r=0,e=0,t,n)=>{const[i,s]=[0,0];return Math.abs(t-n)%360<1e-6?BN(i,s,r,e):zN(i,s,r,e,t,n)};class Bu extends Or{constructor(e){super(ln({style:Bu.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",bo,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getSize(e);return Object.assign(Object.assign({},t),{rx:n/2,ry:i/2})}getIconStyle(e){const t=super.getIconStyle(e),{rx:n,ry:i}=this.getShape("key").attributes,s=Math.min(+n,+i)*2*hi;return t?Object.assign({width:s,height:s},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Du(e,n,t)}}Bu.defaultStyleProps={size:[45,35]};class $N extends Ru{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return EC(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getOuterR(e)*hi;return t?Object.assign({width:n,height:n},t):!1}}/*!
 * @antv/g-plugin-canvas-path-generator
 * @description A G plugin of path generator with Canvas2D API
 * @version 2.1.9
 * @date 11/27/2024, 2:17:06 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function WN(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,s=i===void 0?0:i,a=e.r;r.arc(n,s,a,0,Math.PI*2,!1)}function GN(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,s=i===void 0?0:i,a=e.rx,o=e.ry;if(r.ellipse)r.ellipse(n,s,a,o,0,0,Math.PI*2,!1);else{var l=a>o?a:o,u=a>o?1:a/o,c=a>o?o/a:1;r.save(),r.scale(u,c),r.arc(n,s,l,0,Math.PI*2)}}function YN(r,e){var t=e.x1,n=e.y1,i=e.x2,s=e.y2,a=e.markerStart,o=e.markerEnd,l=e.markerStartOffset,u=e.markerEndOffset,c=0,d=0,h=0,f=0,g=0,v,p;a&&Ze(a)&&l&&(v=i-t,p=s-n,g=Math.atan2(p,v),c=Math.cos(g)*(l||0),d=Math.sin(g)*(l||0)),o&&Ze(o)&&u&&(v=t-i,p=n-s,g=Math.atan2(p,v),h=Math.cos(g)*(u||0),f=Math.sin(g)*(u||0)),r.moveTo(t+c,n+d),r.lineTo(i+h,s+f)}function VN(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,a=e.d,o=a.absolutePath,l=a.segments,u=0,c=0,d=0,h=0,f=0,g,v;if(t&&Ze(t)&&i){var p=t.parentNode.getStartTangent(),y=Be(p,2),b=y[0],E=y[1];g=b[0]-E[0],v=b[1]-E[1],f=Math.atan2(v,g),u=Math.cos(f)*(i||0),c=Math.sin(f)*(i||0)}if(n&&Ze(n)&&s){var T=n.parentNode.getEndTangent(),S=Be(T,2),k=S[0],A=S[1];g=k[0]-A[0],v=k[1]-A[1],f=Math.atan2(v,g),d=Math.cos(f)*(s||0),h=Math.sin(f)*(s||0)}for(var O=0;O<o.length;O++){var C=o[O],P=C[0],L=o[O+1],R=O===0&&(u!==0||c!==0),z=(O===o.length-1||L&&(L[0]==="M"||L[0]==="Z"))&&d!==0&&h!==0,Y=R?[u,c]:[0,0],U=Be(Y,2),V=U[0],W=U[1],F=z?[d,h]:[0,0],K=Be(F,2),re=K[0],se=K[1];switch(P){case"M":r.moveTo(C[1]+V,C[2]+W);break;case"L":r.lineTo(C[1]+re,C[2]+se);break;case"Q":r.quadraticCurveTo(C[1],C[2],C[3]+re,C[4]+se);break;case"C":r.bezierCurveTo(C[1],C[2],C[3],C[4],C[5]+re,C[6]+se);break;case"A":{var ae=l[O].arcParams,Ce=ae.cx,Te=ae.cy,J=ae.rx,Oe=ae.ry,_e=ae.startAngle,Ve=ae.endAngle,Qe=ae.xRotation,zt=ae.sweepFlag;if(r.ellipse)r.ellipse(Ce,Te,J,Oe,Qe,_e,Ve,!!(1-zt));else{var Xr=J>Oe?J:Oe,Gn=J>Oe?1:J/Oe,qr=J>Oe?Oe/J:1;r.translate(Ce,Te),r.rotate(Qe),r.scale(Gn,qr),r.arc(0,0,Xr,_e,Ve,!!(1-zt)),r.scale(1/Gn,1/qr),r.rotate(-Qe),r.translate(-Ce,-Te)}z&&r.lineTo(C[6]+d,C[7]+h);break}case"Z":r.closePath();break}}}function UN(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,a=e.points.points,o=a.length,l=a[0][0],u=a[0][1],c=a[o-1][0],d=a[o-1][1],h=0,f=0,g=0,v=0,p=0,y,b;t&&Ze(t)&&i&&(y=a[1][0]-a[0][0],b=a[1][1]-a[0][1],p=Math.atan2(b,y),h=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&Ze(n)&&s&&(y=a[o-1][0]-a[0][0],b=a[o-1][1]-a[0][1],p=Math.atan2(b,y),g=Math.cos(p)*(s||0),v=Math.sin(p)*(s||0)),r.moveTo(l+(h||g),u+(f||v));for(var E=1;E<o-1;E++){var T=a[E];r.lineTo(T[0],T[1])}r.lineTo(c,d)}function HN(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,s=e.markerEndOffset,a=e.points.points,o=a.length,l=a[0][0],u=a[0][1],c=a[o-1][0],d=a[o-1][1],h=0,f=0,g=0,v=0,p=0,y,b;t&&Ze(t)&&i&&(y=a[1][0]-a[0][0],b=a[1][1]-a[0][1],p=Math.atan2(b,y),h=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&Ze(n)&&s&&(y=a[o-2][0]-a[o-1][0],b=a[o-2][1]-a[o-1][1],p=Math.atan2(b,y),g=Math.cos(p)*(s||0),v=Math.sin(p)*(s||0)),r.moveTo(l+h,u+f);for(var E=1;E<o-1;E++){var T=a[E];r.lineTo(T[0],T[1])}r.lineTo(c+g,d+v)}function XN(r,e){var t=e.x,n=t===void 0?0:t,i=e.y,s=i===void 0?0:i,a=e.radius,o=e.width,l=e.height,u=o,c=l,d=a&&a.some(function(S){return S!==0});if(!d)r.rect(n,s,u,c);else{var h=o>0?1:-1,f=l>0?1:-1,g=h+f===0,v=a.map(function(S){return At(S,0,Math.min(Math.abs(u)/2,Math.abs(c)/2))}),p=Be(v,4),y=p[0],b=p[1],E=p[2],T=p[3];r.moveTo(h*y+n,s),r.lineTo(u-h*b+n,s),b!==0&&r.arc(u-h*b+n,f*b+s,b,-f*Math.PI/2,h>0?0:Math.PI,g),r.lineTo(u+n,c-f*E+s),E!==0&&r.arc(u-h*E+n,c-f*E+s,E,h>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,g),r.lineTo(h*T+n,c+s),T!==0&&r.arc(h*T+n,c-f*T+s,T,f>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,g),r.lineTo(n,f*y+s),y!==0&&r.arc(h*y+n,f*y+s,y,h>0?Math.PI:0,f>0?Math.PI*1.5:Math.PI/2,g)}}var qN=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="canvas-path-generator",t}return $e(e,r),le(e,[{key:"init",value:function(){var n,i=(n={},be(be(be(be(be(be(be(be(be(be(n,ee.CIRCLE,WN),ee.ELLIPSE,GN),ee.RECT,XN),ee.LINE,YN),ee.POLYLINE,HN),ee.POLYGON,UN),ee.PATH,VN),ee.TEXT,void 0),ee.GROUP,void 0),ee.IMAGE,void 0),be(be(be(n,ee.HTML,void 0),ee.MESH,void 0),ee.FRAGMENT,void 0));this.context.pathGeneratorFactory=i}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(Xi);/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.11
 * @date 11/27/2024, 2:19:07 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var ZN=Xe(),KN=Xe(),QN=Xe(),JN=ut(),D1=function(){function r(){var e=this;oe(this,r),this.isHit=function(t,n,i,s){var a=e.context.pointInPathPickerFactory[t.nodeName];if(a){var o=Rr(JN,i),l=Sn(KN,En(QN,n[0],n[1],0),o);if(a(t,new hn(l[0],l[1]),s,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),s=e.context.pathGeneratorFactory[t.nodeName];return s&&(i.beginPath(),s(i,t.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return le(r,[{key:"apply",value:function(t,n){var i,s=this,a=t.renderingService,o=t.renderingContext;this.context=t,this.runtime=n;var l=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;a.hooks.pick.tapPromise(r.tag,function(){var u=Vi(gn().mark(function c(d){return gn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",s.pick(l,d));case 1:case"end":return f.stop()}},c)}));return function(c){return u.apply(this,arguments)}}()),a.hooks.pickSync.tap(r.tag,function(u){return s.pick(l,u)})}},{key:"pick",value:function(t,n){var i=n.topmost,s=n.position,a=s.x,o=s.y,l=En(ZN,a,o,0),u=t.elementsFromBBox(l[0],l[1],l[0],l[1]),c=[],d=cs(u),h;try{for(d.s();!(h=d.n()).done;){var f=h.value,g=f.getWorldTransform(),v=this.isHit(f,l,g,!1);if(v){var p=Ry(f);if(p){var y=p.parsedStyle.clipPath,b=this.isHit(y,l,y.getWorldTransform(),!0);if(b){if(i)return n.picked=[f],n;c.push(f)}}else{if(i)return n.picked=[f],n;c.push(f)}}}}catch(E){d.e(E)}finally{d.f()}return n.picked=c,n}}])}();D1.tag="CanvasPicker";function eA(r,e,t){var n=r.parsedStyle,i=n.cx,s=i===void 0?0:i,a=n.cy,o=a===void 0?0:a,l=n.r,u=n.fill,c=n.stroke,d=n.lineWidth,h=d===void 0?1:d,f=n.increasedLineWidthForHitTesting,g=f===void 0?0:f,v=n.pointerEvents,p=v===void 0?"auto":v,y=(h+g)/2,b=li(s,o,e.x,e.y),E=Cs(p,u,c),T=Be(E,2),S=T[0],k=T[1];return S&&k||t?b<=l+y:S?b<=l:k?b>=l-y&&b<=l+y:!1}function pl(r,e,t,n){return r/(t*t)+e/(n*n)}function tA(r,e,t){var n=r.parsedStyle,i=n.cx,s=i===void 0?0:i,a=n.cy,o=a===void 0?0:a,l=n.rx,u=n.ry,c=n.fill,d=n.stroke,h=n.lineWidth,f=h===void 0?1:h,g=n.increasedLineWidthForHitTesting,v=g===void 0?0:g,p=n.pointerEvents,y=p===void 0?"auto":p,b=e.x,E=e.y,T=Cs(y,c,d),S=Be(T,2),k=S[0],A=S[1],O=(f+v)/2,C=(b-s)*(b-s),P=(E-o)*(E-o);return k&&A||t?pl(C,P,l+O,u+O)<=1:k?pl(C,P,l,u)<=1:A?pl(C,P,l-O,u-O)>=1&&pl(C,P,l+O,u+O)<=1:!1}function fs(r,e,t,n,i,s){return i>=r&&i<=r+t&&s>=e&&s<=e+n}function nA(r,e,t,n,i,s,a){var o=i/2;return fs(r-o,e-o,t,i,s,a)||fs(r+t-o,e-o,i,n,s,a)||fs(r+o,e+n-o,t,i,s,a)||fs(r-o,e+o,i,n,s,a)}function vl(r,e,t,n,i,s,a,o){var l=(Math.atan2(o-e,a-r)+Math.PI*2)%(Math.PI*2),u={x:r+t*Math.cos(l),y:e+t*Math.sin(l)};return li(u.x,u.y,a,o)<=s/2}function _i(r,e,t,n,i,s,a){var o=Math.min(r,t),l=Math.max(r,t),u=Math.min(e,n),c=Math.max(e,n),d=i/2;return s>=o-d&&s<=l+d&&a>=u-d&&a<=c+d?aM(r,e,t,n,s,a)<=i/2:!1}function I1(r,e,t,n,i){var s=r.length;if(s<2)return!1;for(var a=0;a<s-1;a++){var o=r[a][0],l=r[a][1],u=r[a+1][0],c=r[a+1][1];if(_i(o,l,u,c,e,t,n))return!0}if(i){var d=r[0],h=r[s-1];if(_i(d[0],d[1],h[0],h[1],e,t,n))return!0}return!1}var rA=1e-6;function Ed(r){return Math.abs(r)<rA?0:r<0?-1:1}function iA(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function R1(r,e,t){var n=!1,i=r.length;if(i<=2)return!1;for(var s=0;s<i;s++){var a=r[s],o=r[(s+1)%i];if(iA(a,o,[e,t]))return!0;Ed(a[1]-t)>0!=Ed(o[1]-t)>0&&Ed(e-(t-a[1])*(a[0]-o[0])/(a[1]-o[1])-a[0])<0&&(n=!n)}return n}function Wp(r,e,t){for(var n=!1,i=0;i<r.length;i++){var s=r[i];if(n=R1(s,e,t),n)break}return n}function sA(r,e,t){var n=r.parsedStyle,i=n.x1,s=n.y1,a=n.x2,o=n.y2,l=n.lineWidth,u=l===void 0?1:l,c=n.increasedLineWidthForHitTesting,d=c===void 0?0:c,h=n.pointerEvents,f=h===void 0?"auto":h,g=n.fill,v=n.stroke,p=Cs(f,g,v),y=Be(p,2),b=y[1];return!b&&!t||!u?!1:_i(i,s,a,o,u+d,e.x,e.y)}function aA(r,e,t,n,i){for(var s=!1,a=e/2,o=0;o<r.length;o++){var l=r[o],u=l.currentPoint,c=l.params,d=l.prePoint,h=l.box;if(!(h&&!fs(h.x-a,h.y-a,h.width+e,h.height+e,t,n)))switch(l.command){case"L":case"Z":if(s=_i(d[0],d[1],u[0],u[1],e,t,n),s)return!0;break;case"Q":var f=fM(d[0],d[1],c[1],c[2],c[3],c[4],t,n);if(s=f<=e/2,s)return!0;break;case"C":var g=Qg(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],t,n,i);if(s=g<=e/2,s)return!0;break;case"A":l.cubicParams||(l.cubicParams=Pf(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var v=l.cubicParams,p=d,y=0;y<v.length;y+=6){var b=Qg(p[0],p[1],v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],t,n,i);if(p=[v[y+4],v[y+5]],s=b<=e/2,s)return!0}break}}return s}function oA(r,e,t,n,i,s){var a=r.parsedStyle,o=a.lineWidth,l=o===void 0?1:o,u=a.increasedLineWidthForHitTesting,c=u===void 0?0:u,d=a.stroke,h=a.fill,f=a.d,g=a.pointerEvents,v=g===void 0?"auto":g,p=f.segments,y=f.hasArc,b=f.polylines,E=f.polygons,T=Cs(v,(E==null?void 0:E.length)&&h,d),S=Be(T,2),k=S[0],A=S[1],O=jh(r),C=!1;return k||t?(y?C=n(r,e):C=Wp(E,e.x,e.y)||Wp(b,e.x,e.y),C):((A||t)&&(C=aA(p,l+c,e.x,e.y,O)),C)}function lA(r,e,t){var n=r.parsedStyle,i=n.stroke,s=n.fill,a=n.lineWidth,o=a===void 0?1:a,l=n.increasedLineWidthForHitTesting,u=l===void 0?0:l,c=n.points,d=n.pointerEvents,h=d===void 0?"auto":d,f=Cs(h,s,i),g=Be(f,2),v=g[0],p=g[1],y=!1;return(p||t)&&(y=I1(c.points,o+u,e.x,e.y,!0)),!y&&(v||t)&&(y=R1(c.points,e.x,e.y)),y}function uA(r,e,t){var n=r.parsedStyle,i=n.lineWidth,s=i===void 0?1:i,a=n.increasedLineWidthForHitTesting,o=a===void 0?0:a,l=n.points,u=n.pointerEvents,c=u===void 0?"auto":u,d=n.fill,h=n.stroke,f=Cs(c,d,h),g=Be(f,2),v=g[1];return!v&&!t||!s?!1:I1(l.points,s+o,e.x,e.y,!1)}function cA(r,e,t,n,i){var s=r.parsedStyle,a=s.radius,o=s.fill,l=s.stroke,u=s.lineWidth,c=u===void 0?1:u,d=s.increasedLineWidthForHitTesting,h=d===void 0?0:d,f=s.x,g=f===void 0?0:f,v=s.y,p=v===void 0?0:v,y=s.width,b=s.height,E=s.pointerEvents,T=E===void 0?"auto":E,S=Cs(T,o,l),k=Be(S,2),A=k[0],O=k[1],C=a&&a.some(function(z){return z!==0}),P=c+h;if(C){var R=!1;return(O||t)&&(R=dA(g,p,y,b,a.map(function(z){return At(z,0,Math.min(Math.abs(y)/2,Math.abs(b)/2))}),P,e.x,e.y)),!R&&(A||t)&&(R=n(r,e)),R}else{var L=P/2;if(A&&O||t)return fs(g-L,p-L,y+L,b+L,e.x,e.y);if(A)return fs(g,p,y,b,e.x,e.y);if(O)return nA(g,p,y,b,P,e.x,e.y)}return!1}function dA(r,e,t,n,i,s,a,o){var l=Be(i,4),u=l[0],c=l[1],d=l[2],h=l[3];return _i(r+u,e,r+t-c,e,s,a,o)||_i(r+t,e+c,r+t,e+n-d,s,a,o)||_i(r+t-d,e+n,r+h,e+n,s,a,o)||_i(r,e+n-h,r,e+u,s,a,o)||vl(r+t-c,e+c,c,1.5*Math.PI,2*Math.PI,s,a,o)||vl(r+t-d,e+n-d,d,0,.5*Math.PI,s,a,o)||vl(r+h,e+n-h,h,.5*Math.PI,Math.PI,s,a,o)||vl(r+u,e+u,u,Math.PI,1.5*Math.PI,s,a,o)}function hA(r,e,t,n,i,s){var a=r.parsedStyle,o=a.pointerEvents,l=o===void 0?"auto":o,u=a.x,c=u===void 0?0:u,d=a.y,h=d===void 0?0:d,f=a.width,g=a.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,p=s.offscreenCanvasCreator.getOrCreateCanvas(v),y=s.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});p.width=f,p.height=g,i.defaultStyleRendererFactory[ee.IMAGE].render(y,We(We({},r.parsedStyle),{},{x:0,y:0}),r,void 0,void 0,void 0);var b=y.getImageData(e.x-c,e.y-h,1,1).data;return b.every(function(E){return E!==0})}return!0}function fA(r,e,t,n){var i=r.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}var gA=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="canvas-picker",t}return $e(e,r),le(e,[{key:"init",value:function(){var n,i=(n={},be(be(be(be(be(be(be(be(be(be(n,ee.CIRCLE,eA),ee.ELLIPSE,tA),ee.RECT,cA),ee.LINE,sA),ee.POLYLINE,uA),ee.POLYGON,lA),ee.PATH,oA),ee.TEXT,fA),ee.GROUP,null),ee.IMAGE,hA),be(be(n,ee.HTML,null),ee.MESH,null));this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new D1)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(Xi);function _r(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var pA=0;function vA(r){return"__private_"+pA+++"_"+r}/*!
 * @antv/g-plugin-image-loader
 * @description A G plugin for loading image
 * @version 2.1.11
 * @date 11/27/2024, 2:17:32 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var mA=function(){function r(){oe(this,r),this.cacheStore=new Map}return le(r,[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,n,i){return this.cacheStore.has(t)?!1:(this.cacheStore.set(t,{value:n,counter:new Set([i])}),this.onRefAdded(i),!0)}},{key:"get",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.has(n)||(i.counter.add(n),this.onRefAdded(n)),i.value):null}},{key:"update",value:function(t,n,i){var s=this.cacheStore.get(t);return s?(s.value=We(We({},s.value),n),s.counter.has(i)||(s.counter.add(i),this.onRefAdded(i)),!0):!1}},{key:"release",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.delete(n),i.counter.size<=0&&this.cacheStore.delete(t),!0):!1}},{key:"releaseRef",value:function(t){var n=this;Array.from(this.cacheStore.keys()).forEach(function(i){n.release(i,t)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),Md=[],Sd=[],qh=function(){function r(){oe(this,r)}return le(r,null,[{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;r.rafId&&(t.cancelAnimationFrame(r.rafId),r.rafId=null)}},{key:"executeTask",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;Md.length<=0&&Sd.length<=0||(Sd.forEach(function(n){return n()}),Sd=Md.splice(0,r.TASK_NUM_PER_FRAME),r.rafId=t.requestAnimationFrame(function(){r.executeTask(t)}))}},{key:"sliceImage",value:function(t,n,i,s){for(var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r.api,l=t.naturalWidth||t.width,u=t.naturalHeight||t.height,c=n-a,d=i-a,h=Math.ceil(l/c),f=Math.ceil(u/d),g={tileSize:[n,i],gridSize:[f,h],tiles:Array(f).fill(null).map(function(){return Array(h).fill(null)})},v=function(b){for(var E=function(k){Md.push(function(){var A=k*c,O=b*d,C=[Math.min(n,l-A),Math.min(i,u-O)],P=C[0],L=C[1],R=o.createCanvas();R.width=n,R.height=i;var z=R.getContext("2d");z.drawImage(t,A,O,P,L,0,0,P,L),g.tiles[b][k]={x:A,y:O,tileX:k,tileY:b,data:R},s()})},T=0;T<h;T++)E(T)},p=0;p<f;p++)v(p);return r.stop(),r.executeTask(),g}}])}();qh.TASK_NUM_PER_FRAME=10;var Un=new mA;Un.onRefAdded=function(e){var t=this;e.addEventListener(Ue.DESTROY,function(){t.releaseRef(e)},{once:!0})};var Jf=function(){function r(e,t){oe(this,r),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=t}return le(r,[{key:"getImageSync",value:function(t,n,i){var s=Ke(t)?t:t.src;if(Un.has(s)){var a=Un.get(s,n);if(a.img.complete)return i==null||i(a),a}return this.getOrCreateImage(t,n).then(function(o){i==null||i(o)}).catch(function(){}),null}},{key:"getOrCreateImage",value:function(t,n){var i=Ke(t)?t:t.src;if(!Ke(t)&&!Un.has(i)){var s={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:ml(t)};Un.put(i,s,n)}if(Un.has(i)){var a=Un.get(i,n);return a.img.complete?Promise.resolve(a):new Promise(function(l,u){a.img.addEventListener("load",function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=ml(a.img),l(a)}),a.img.addEventListener("error",function(c){u(c)})})}var o=this.context.config.createImage;return new Promise(function(l,u){var c;if(o?c=o(i):yo&&(c=new window.Image),c){var d={img:c,size:[0,0],tileSize:ml(c)};Un.put(i,d,n),c.onload=function(){d.size=[c.naturalWidth||c.width,c.naturalHeight||c.height],d.tileSize=ml(d.img),l(d)},c.onerror=function(h){u(h)},c.crossOrigin="Anonymous",c.src=i}})}},{key:"createDownSampledImage",value:function(){var e=Vi(gn().mark(function n(i,s){var a,o,l,u,c,d,h,f,g,v,p,y,b,E;return gn().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.getOrCreateImage(i,s);case 2:if(a=S.sent,!(typeof a.downSamplingRate<"u")){S.next=5;break}return S.abrupt("return",a);case 5:if(o=this.context.config.enableLargeImageOptimization,l=typeof o=="boolean"?{}:o,u=l.maxDownSampledImageSize,c=u===void 0?2048:u,d=l.downSamplingRateThreshold,h=d===void 0?.5:d,f=this.runtime.globalThis.createImageBitmap,g=Be(a.size,2),v=g[0],p=g[1],y=a.img,b=Math.min((c+c)/(v+p),Math.max(.01,Math.min(h,.5))),E=We(We({},a),{},{downSamplingRate:b}),Un.update(a.img.src,E,s),!f){S.next=25;break}return S.prev=14,S.next=17,f(a.img,{resizeWidth:v*b,resizeHeight:p*b});case 17:y=S.sent,S.next=23;break;case 20:S.prev=20,S.t0=S.catch(14),b=1;case 23:S.next=26;break;case 25:b=1;case 26:return E=We(We({},this.getImageSync(i,s)),{},{downSampled:y,downSamplingRate:b}),Un.update(a.img.src,E,s),S.abrupt("return",E);case 29:case"end":return S.stop()}},n,this,[[14,20]])}));function t(n,i){return e.apply(this,arguments)}return t}()},{key:"createImageTiles",value:function(){var e=Vi(gn().mark(function n(i,s,a,o){var l,u,c,d,h;return gn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getOrCreateImage(i,o);case 2:return l=g.sent,u=o.ownerDocument.defaultView,c=u.requestAnimationFrame,d=u.cancelAnimationFrame,qh.api={requestAnimationFrame:c,cancelAnimationFrame:d,createCanvas:function(){return jf.createCanvas()}},h=We(We({},l),qh.sliceImage(l.img,l.tileSize[0],l.tileSize[0],a)),Un.update(l.img.src,h,o),g.abrupt("return",h);case 8:case"end":return g.stop()}},n,this)}));function t(n,i,s,a){return e.apply(this,arguments)}return t}()},{key:"releaseImage",value:function(t,n){Un.release(Ke(t)?t:t.src,n)}},{key:"releaseImageRef",value:function(t){Un.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,n,i,s,a,o,l){var u=this.generatePatternKey(n);if(u&&this.patternCache[u])return this.patternCache[u];var c=n.image,d=n.repetition,h=n.transform,f,g=!1;if(Ke(c)){var v=this.getImageSync(c,t,l);f=v==null?void 0:v.img}else s?(f=s,g=!0):f=c;var p=f&&i.createPattern(f,d);if(p){var y;h?y=$y(_y(h),new gt({})):y=Wi(ut()),g&&jm(y,y,[1/a,1/a,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+o[0],f:y[13]+o[1]})}return u&&p&&(this.patternCache[u]=p),p}},{key:"getOrCreateGradient",value:function(t,n){var i=this.generateGradientKey(t),s=t.type,a=t.steps,o=t.min,l=t.width,u=t.height,c=t.angle,d=t.cx,h=t.cy,f=t.size;if(this.gradientCache[i])return this.gradientCache[i];var g=null;if(s===Ai.LinearGradient){var v=qM(o,l,u,c),p=v.x1,y=v.y1,b=v.x2,E=v.y2;g=n.createLinearGradient(p,y,b,E)}else if(s===Ai.RadialGradient){var T=ZM(o,l,u,d,h,f),S=T.x,k=T.y,A=T.r;g=n.createRadialGradient(S,k,0,S,k,A)}return g&&(a.forEach(function(O){var C=O.offset,P=O.color;if(C.unit===me.kPercentage){var L;(L=g)===null||L===void 0||L.addColorStop(C.value/100,P.toString())}}),this.gradientCache[i]=g),this.gradientCache[i]}},{key:"generateGradientKey",value:function(t){var n=t.type,i=t.min,s=t.width,a=t.height,o=t.steps,l=t.angle,u=t.cx,c=t.cy,d=t.size;return"gradient-".concat(n,"-").concat((l==null?void 0:l.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((d==null?void 0:d.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(s,"-").concat(a,"-").concat(o.map(function(h){var f=h.offset,g=h.color;return"".concat(f).concat(g)}).join("-"))}},{key:"generatePatternKey",value:function(t){var n=t.image,i=t.repetition;if(Ke(n))return"pattern-".concat(n,"-").concat(i);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(i)}}])}();Jf.isSupportTile=!!jf.createCanvas();function ml(r){if(!r.complete)return[0,0];var e=r.naturalWidth||r.width,t=r.naturalHeight||r.height,n=256;return[256,512].forEach(function(i){var s=Math.ceil(t/i),a=Math.ceil(e/i);s*a<1e3&&(n=i)}),[n,n]}var j1=function(){function r(){oe(this,r)}return le(r,[{key:"apply",value:function(t){var n=t.renderingService,i=t.renderingContext,s=t.imagePool,a=i.root.ownerDocument.defaultView,o=function(d,h,f){var g=d.parsedStyle,v=g.width,p=g.height;v&&!p?d.setAttribute("height",f/h*v):!v&&p&&d.setAttribute("width",h/f*p)},l=function(d){var h=d.target,f=h.nodeName,g=h.attributes;if(f===ee.IMAGE){var v=g.src,p=g.keepAspectRatio;s.getImageSync(v,h,function(y){var b=y.img,E=b.width,T=b.height;p&&o(h,E,T),h.renderable.dirty=!0,n.dirtify()})}},u=function(d){var h=d.target,f=d.attrName,g=d.prevValue,v=d.newValue;h.nodeName!==ee.IMAGE||f!=="src"||(g!==v&&s.releaseImage(g,h),Ke(v)&&s.getOrCreateImage(v,h).then(function(p){var y=p.img,b=y.width,E=y.height;h.attributes.keepAspectRatio&&o(h,b,E),h.renderable.dirty=!0,n.dirtify()}).catch(function(){}))};n.hooks.init.tap(r.tag,function(){a.addEventListener(Ue.MOUNTED,l),a.addEventListener(Ue.ATTR_MODIFIED,u)}),n.hooks.destroy.tap(r.tag,function(){a.removeEventListener(Ue.MOUNTED,l),a.removeEventListener(Ue.ATTR_MODIFIED,u)})}}])}();j1.tag="LoadImage";var yA=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="image-loader",t}return $e(e,r),le(e,[{key:"init",value:function(n){this.context.imagePool=new Jf(this.context,n),this.addRenderingPlugin(new j1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Xi);/*!
 * @antv/g-plugin-canvas-renderer
 * @description A G plugin of renderer implementation with Canvas2D API
 * @version 2.2.11
 * @date 11/27/2024, 2:18:17 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Dt=vA("renderState"),B1=function(){function r(e){oe(this,r),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,Dt,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=ut(),this.dprMatrix=ut(),this.tmpMat4=ut(),this.vec3a=Xe(),this.vec3b=Xe(),this.vec3c=Xe(),this.vec3d=Xe(),this.canvasRendererPluginOptions=e}return le(r,[{key:"apply",value:function(t,n){var i=this;this.context=t;var s=this.context,a=s.config,o=s.camera,l=s.renderingService,u=s.renderingContext,c=s.rBushRoot,d=s.pathGeneratorFactory,h=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=c,this.pathGeneratorFactory=d;var f=t.contextService,g=u.root.ownerDocument.defaultView,v=function(E){var T=E.target,S=T.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)},p=function(E){var T=E.target,S=T.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)};l.hooks.init.tap(r.tag,function(){g.addEventListener(Ue.UNMOUNTED,v),g.addEventListener(Ue.CULLED,p);var b=f.getDPR(),E=a.width,T=a.height,S=f.getContext();i.clearRect(S,0,0,E*b,T*b,a.background)}),l.hooks.destroy.tap(r.tag,function(){g.removeEventListener(Ue.UNMOUNTED,v),g.removeEventListener(Ue.CULLED,p),i.renderQueue=[],i.removedRBushNodeAABBs=[],_r(i,Dt)[Dt]={restoreStack:[],prevObject:null,currentContext:null}}),l.hooks.beginFrame.tap(r.tag,function(){var b,E=f.getContext(),T=f.getDPR(),S=a.width,k=a.height,A=i.canvasRendererPluginOptions,O=A.dirtyObjectNumThreshold,C=A.dirtyObjectRatioThreshold,P=l.getStats(),L=P.total,R=P.rendered,z=R/L;i.clearFullScreen=i.clearFullScreenLastFrame||!((b=g.context.renderingPlugins[1])!==null&&b!==void 0&&b.isFirstTimeRenderingFinished)||l.disableDirtyRectangleRendering()||R>O&&z>C,E&&(typeof E.resetTransform=="function"?E.resetTransform():E.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(E,0,0,S*T,k*T,a.background))});var y=function(E,T){for(var S=[E];S.length>0;){var k=S.pop();k.isVisible()&&!k.isCulled()&&(h?i.renderDisplayObjectOptimized(k,T,i.context,_r(i,Dt)[Dt],n):i.renderDisplayObject(k,T,i.context,_r(i,Dt)[Dt],n));for(var A=k.sortable.sorted||k.childNodes,O=A.length-1;O>=0;O--)S.push(A[O])}};l.hooks.endFrame.tap(r.tag,function(){if(u.root.childNodes.length===0){i.clearFullScreenLastFrame=!0;return}h=a.renderer.getConfig().enableRenderingOptimization,_r(i,Dt)[Dt]={restoreStack:[],prevObject:null,currentContext:_r(i,Dt)[Dt].currentContext},_r(i,Dt)[Dt].currentContext.clear(),i.clearFullScreenLastFrame=!1;var b=f.getContext(),E=f.getDPR();if(us(i.dprMatrix,[E,E,1]),Mn(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)h?(b.save(),y(u.root,b),b.restore()):y(u.root,b),i.removedRBushNodeAABBs=[];else{var T=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(wt(i.removedRBushNodeAABBs.map(function(J){var Oe=J.minX,_e=J.minY,Ve=J.maxX,Qe=J.maxY,zt=new ct;return zt.setMinMax([Oe,_e,0],[Ve,Qe,0]),zt}))));if(i.removedRBushNodeAABBs=[],ct.isEmpty(T)){i.renderQueue=[];return}var S=i.convertAABB2Rect(T),k=S.x,A=S.y,O=S.width,C=S.height,P=Sn(i.vec3a,[k,A,0],i.vpMatrix),L=Sn(i.vec3b,[k+O,A,0],i.vpMatrix),R=Sn(i.vec3c,[k,A+C,0],i.vpMatrix),z=Sn(i.vec3d,[k+O,A+C,0],i.vpMatrix),Y=Math.min(P[0],L[0],z[0],R[0]),U=Math.min(P[1],L[1],z[1],R[1]),V=Math.max(P[0],L[0],z[0],R[0]),W=Math.max(P[1],L[1],z[1],R[1]),F=Math.floor(Y),K=Math.floor(U),re=Math.ceil(V-Y),se=Math.ceil(W-U);b.save(),i.clearRect(b,F,K,re,se,a.background),b.beginPath(),b.rect(F,K,re,se),b.clip(),b.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]);var ae=a.renderer.getConfig(),Ce=ae.enableDirtyRectangleRenderingDebug;Ce&&g.dispatchEvent(new Wt(qn.DIRTY_RECTANGLE,{dirtyRect:{x:F,y:K,width:re,height:se}}));var Te=i.searchDirtyObjects(T);Te.sort(function(J,Oe){return J.sortable.renderOrder-Oe.sortable.renderOrder}).forEach(function(J){J&&J.isVisible()&&!J.isCulled()&&i.renderDisplayObject(J,b,i.context,_r(i,Dt)[Dt],n)}),b.restore(),i.renderQueue.forEach(function(J){i.saveDirtyAABB(J)}),i.renderQueue=[]}_r(i,Dt)[Dt].restoreStack.forEach(function(){b.restore()}),_r(i,Dt)[Dt].restoreStack=[]}),l.hooks.render.tap(r.tag,function(b){i.clearFullScreen||i.renderQueue.push(b)})}},{key:"clearRect",value:function(t,n,i,s,a,o){t.clearRect(n,i,s,a),o&&(t.fillStyle=o,t.fillRect(n,i,s,a))}},{key:"renderDisplayObjectOptimized",value:function(t,n,i,s,a){var o=t.nodeName,l=!1,u=!1,c=this.context.styleRendererFactory[o],d=this.pathGeneratorFactory[o],h=t.parsedStyle.clipPath;if(h){l=!s.prevObject||!wh(h.getWorldTransform(),s.prevObject.getWorldTransform()),l&&(this.applyWorldTransform(n,h),s.prevObject=null);var f=this.pathGeneratorFactory[h.nodeName];f&&(n.save(),u=!0,n.beginPath(),f(n,h.parsedStyle),n.closePath(),n.clip())}if(c){l=!s.prevObject||!wh(t.getWorldTransform(),s.prevObject.getWorldTransform()),l&&this.applyWorldTransform(n,t);var g=!s.prevObject;if(!g){var v=s.prevObject.nodeName;o===ee.TEXT?g=v!==ee.TEXT:o===ee.IMAGE?g=v!==ee.IMAGE:g=v===ee.TEXT||v===ee.IMAGE}c.applyStyleToContext(n,t,g,s),s.prevObject=t}d&&(n.beginPath(),d(n,t.parsedStyle),o!==ee.LINE&&o!==ee.PATH&&o!==ee.POLYLINE&&n.closePath()),c&&c.drawToContext(n,t,_r(this,Dt)[Dt],this,a),u&&n.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,n,i,s,a){var o=t.nodeName,l=s.restoreStack[s.restoreStack.length-1];l&&!(t.compareDocumentPosition(l)&Tt.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),s.restoreStack.pop());var u=this.context.styleRendererFactory[o],c=this.pathGeneratorFactory[o],d=t.parsedStyle.clipPath;if(d){this.applyWorldTransform(n,d);var h=this.pathGeneratorFactory[d.nodeName];h&&(n.save(),s.restoreStack.push(t),n.beginPath(),h(n,d.parsedStyle),n.closePath(),n.clip())}u&&(this.applyWorldTransform(n,t),n.save(),this.applyAttributesToContext(n,t)),c&&(n.beginPath(),c(n,t.parsedStyle),o!==ee.LINE&&o!==ee.PATH&&o!==ee.POLYLINE&&n.closePath()),u&&(u.render(n,t.parsedStyle,t,i,this,a),n.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,n){var i=n.parsedStyle,s=i.stroke,a=i.fill,o=i.opacity,l=i.lineDash,u=i.lineDashOffset;l&&t.setLineDash(l),Ae(u)||(t.lineDashOffset=u),Ae(o)||(t.globalAlpha*=o),!Ae(s)&&!Array.isArray(s)&&!s.isNone&&(t.strokeStyle=n.attributes.stroke),!Ae(a)&&!Array.isArray(a)&&!a.isNone&&(t.fillStyle=n.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var n=t.getMin(),i=t.getMax(),s=Math.floor(n[0]),a=Math.floor(n[1]),o=Math.ceil(i[0]),l=Math.ceil(i[1]),u=o-s,c=l-a;return{x:s,y:a,width:u,height:c}}},{key:"mergeDirtyAABBs",value:function(t){var n=new ct;return t.forEach(function(i){var s=i.getRenderBounds();n.add(s);var a=i.renderable.dirtyRenderBounds;a&&n.add(a)}),n}},{key:"searchDirtyObjects",value:function(t){var n=t.getMin(),i=Be(n,2),s=i[0],a=i[1],o=t.getMax(),l=Be(o,2),u=l[0],c=l[1],d=this.rBush.search({minX:s,minY:a,maxX:u,maxY:c});return d.map(function(h){var f=h.displayObject;return f})}},{key:"saveDirtyAABB",value:function(t){var n=t.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new ct);var i=t.getRenderBounds();i&&n.dirtyRenderBounds.update(i.center,i.halfExtents)}},{key:"applyWorldTransform",value:function(t,n,i){i?(oa(this.tmpMat4,n.getLocalTransform()),Mn(this.tmpMat4,i,this.tmpMat4),Mn(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(oa(this.tmpMat4,n.getWorldTransform()),Mn(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new ct,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return i.forEach(function(a){t.add(a)}),t}}])}();B1.tag="CanvasRenderer";function hu(r,e,t,n,i,s,a){var o,l;if(r.image.nodeName==="rect"){var u=r.image.parsedStyle,c=u.width,d=u.height;l=n.contextService.getDPR();var h=n.config.offscreenCanvas;o=s.offscreenCanvasCreator.getOrCreateCanvas(h),o.width=c*l,o.height=d*l;var f=s.offscreenCanvasCreator.getOrCreateContext(h),g={restoreStack:[],prevObject:null,currentContext:new Map};r.image.forEach(function(p){i.renderDisplayObject(p,f,n,g,s)}),g.restoreStack.forEach(function(){f.restore()})}var v=a.getOrCreatePatternSync(e,r,t,o,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,n.renderingService.dirtify()});return v}function fu(r,e,t,n){var i;if(r.type===Ai.LinearGradient||r.type===Ai.RadialGradient){var s=e.getGeometryBounds(),a=s&&s.halfExtents[0]*2||1,o=s&&s.halfExtents[1]*2||1,l=s&&s.min||[0,0];i=n.getOrCreateGradient(We(We({type:r.type},r.value),{},{min:l,width:a,height:o}),t)}return i}var yl=["shadowBlur","shadowOffsetX","shadowOffsetY"],Gp=["lineCap","lineJoin","miterLimit"],Ft={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},Yp={};function Ot(r,e,t,n){var i=n.has(e)?n.get(e):Ft[e];return i!==t&&(e==="lineDash"?r.setLineDash(t):r[e]=t,n.set(e,t)),i}var bA=function(){function r(e){oe(this,r),this.imagePool=e}return le(r,[{key:"applyAttributesToContext",value:function(t,n){}},{key:"render",value:function(t,n,i,s,a,o){}},{key:"applyCommonStyleToContext",value:function(t,n,i,s){var a=i?Yp:s.prevObject.parsedStyle,o=n.parsedStyle;(i||o.opacity!==a.opacity)&&Ot(t,"globalAlpha",Ae(o.opacity)?Ft.globalAlpha:o.opacity,s.currentContext),(i||o.blend!==a.blend)&&Ot(t,"globalCompositeOperation",Ae(o.blend)?Ft.globalCompositeOperation:o.blend,s.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,n,i,s){var a=i?Yp:s.prevObject.parsedStyle,o=n.parsedStyle,l=o.lineWidth,u=l===void 0?Ft.lineWidth:l,c=o.fill&&!o.fill.isNone,d=o.stroke&&!o.stroke.isNone&&u>0;if(d){if(i||n.attributes.stroke!==s.prevObject.attributes.stroke){var h=!Ae(o.stroke)&&!Array.isArray(o.stroke)&&!o.stroke.isNone?n.attributes.stroke:Ft.strokeStyle;Ot(t,"strokeStyle",h,s.currentContext)}(i||o.lineWidth!==a.lineWidth)&&Ot(t,"lineWidth",Ae(o.lineWidth)?Ft.lineWidth:o.lineWidth,s.currentContext),(i||o.lineDash!==a.lineDash)&&Ot(t,"lineDash",o.lineDash||Ft.lineDash,s.currentContext),(i||o.lineDashOffset!==a.lineDashOffset)&&Ot(t,"lineDashOffset",Ae(o.lineDashOffset)?Ft.lineDashOffset:o.lineDashOffset,s.currentContext);for(var f=0;f<Gp.length;f++){var g=Gp[f];(i||o[g]!==a[g])&&Ot(t,g,Ae(o[g])?Ft[g]:o[g],s.currentContext)}}if(c&&(i||n.attributes.fill!==s.prevObject.attributes.fill)){var v=!Ae(o.fill)&&!Array.isArray(o.fill)&&!o.fill.isNone?n.attributes.fill:Ft.fillStyle;Ot(t,"fillStyle",v,s.currentContext)}}},{key:"applyStyleToContext",value:function(t,n,i,s){var a=n.nodeName;this.applyCommonStyleToContext(t,n,i,s),a===ee.IMAGE||this.applyStrokeFillStyleToContext(t,n,i,s)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,n,i,s){var a=n.parsedStyle;if(i){Ot(t,"shadowColor",a.shadowColor.toString(),s.currentContext);for(var o=0;o<yl.length;o++){var l=yl[o];Ot(t,l,a[l]||Ft[l],s.currentContext)}}a.filter&&a.filter.length&&Ot(t,"filter",n.attributes.filter,s.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,n,i,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(n){Ot(t,"shadowColor",Ft.shadowColor,s.currentContext);for(var o=0;o<yl.length;o++){var l=yl[o];Ot(t,l,Ft[l],s.currentContext)}}if(i)if(n&&a){var u=t.filter;!Ae(u)&&u.indexOf("drop-shadow")>-1&&Ot(t,"filter",u.replace(/drop-shadow\([^)]*\)/,"").trim()||Ft.filter,s.currentContext)}else Ot(t,"filter",Ft.filter,s.currentContext)}},{key:"fillToContext",value:function(t,n,i,s,a){var o=this,l=n.parsedStyle,u=l.fill,c=l.fillRule,d=null;if(Array.isArray(u)&&u.length>0)u.forEach(function(f){var g,v=Ot(t,"fillStyle",fu(f,n,t,o.imagePool),i.currentContext);d=(g=d)!==null&&g!==void 0?g:v,c?t.fill(c):t.fill()});else{if(Ms(u)){var h=hu(u,n,t,n.ownerDocument.defaultView.context,s,a,this.imagePool);h&&(t.fillStyle=h,d=!0)}c?t.fill(c):t.fill()}d!==null&&Ot(t,"fillStyle",d,i.currentContext)}},{key:"strokeToContext",value:function(t,n,i,s,a){var o=this,l=n.parsedStyle.stroke,u=null;if(Array.isArray(l)&&l.length>0)l.forEach(function(f){var g,v=Ot(t,"strokeStyle",fu(f,n,t,o.imagePool),i.currentContext);u=(g=u)!==null&&g!==void 0?g:v,t.stroke()});else{if(Ms(l)){var c=hu(l,n,t,n.ownerDocument.defaultView.context,s,a,this.imagePool);if(c){var d,h=Ot(t,"strokeStyle",c,i.currentContext);u=(d=u)!==null&&d!==void 0?d:h}}t.stroke()}u!==null&&Ot(t,"strokeStyle",u,i.currentContext)}},{key:"drawToContext",value:function(t,n,i,s,a){var o,l=n.nodeName,u=n.parsedStyle,c=u.opacity,d=c===void 0?Ft.globalAlpha:c,h=u.fillOpacity,f=h===void 0?Ft.fillOpacity:h,g=u.strokeOpacity,v=g===void 0?Ft.strokeOpacity:g,p=u.lineWidth,y=p===void 0?Ft.lineWidth:p,b=u.fill&&!u.fill.isNone,E=u.stroke&&!u.stroke.isNone&&y>0;if(!(!b&&!E)){var T=!Ae(u.shadowColor)&&u.shadowBlur>0,S=u.shadowType==="inner",k=((o=u.fill)===null||o===void 0?void 0:o.alpha)===0,A=!!(u.filter&&u.filter.length),O=T&&E&&(l===ee.PATH||l===ee.LINE||l===ee.POLYLINE||k||S),C=null;if(b){O||this.applyShadowAndFilterStyleToContext(t,n,T,i);var P=d*f;C=Ot(t,"globalAlpha",P,i.currentContext),this.fillToContext(t,n,i,s,a),O||this.clearShadowAndFilterStyleForContext(t,T,A,i)}if(E){var L=!1,R=d*v,z=Ot(t,"globalAlpha",R,i.currentContext);if(C=b?C:z,O&&(this.applyShadowAndFilterStyleToContext(t,n,T,i),L=!0,S)){var Y=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,n,i,s,a),t.globalCompositeOperation=Y,this.clearShadowAndFilterStyleForContext(t,T,A,i,!0)}this.strokeToContext(t,n,i,s,a),L&&this.clearShadowAndFilterStyleForContext(t,T,A,i)}C!==null&&Ot(t,"globalAlpha",C,i.currentContext)}}}])}(),eg=function(r){function e(){return oe(this,e),Fe(this,e,arguments)}return $e(e,r),le(e,[{key:"render",value:function(n,i,s,a,o,l){var u=i.fill,c=i.fillRule,d=i.opacity,h=d===void 0?1:d,f=i.fillOpacity,g=f===void 0?1:f,v=i.stroke,p=i.strokeOpacity,y=p===void 0?1:p,b=i.lineWidth,E=b===void 0?1:b,T=i.lineCap,S=i.lineJoin,k=i.shadowType,A=i.shadowColor,O=i.shadowBlur,C=i.filter,P=i.miterLimit,L=u&&!u.isNone,R=v&&!v.isNone&&E>0,z=(u==null?void 0:u.alpha)===0,Y=!!(C&&C.length),U=!Ae(A)&&O>0,V=s.nodeName,W=k==="inner",F=R&&U&&(V===ee.PATH||V===ee.LINE||V===ee.POLYLINE||z||W);L&&(n.globalAlpha=h*g,F||gu(s,n,U),z1(n,s,u,c,a,o,l,this.imagePool),F||this.clearShadowAndFilter(n,Y,U)),R&&(n.globalAlpha=h*y,n.lineWidth=E,Ae(P)||(n.miterLimit=P),Ae(T)||(n.lineCap=T),Ae(S)||(n.lineJoin=S),F&&(W&&(n.globalCompositeOperation="source-atop"),gu(s,n,!0),W&&(Zh(n,s,v,a,o,l,this.imagePool),n.globalCompositeOperation=Ft.globalCompositeOperation,this.clearShadowAndFilter(n,Y,!0))),Zh(n,s,v,a,o,l,this.imagePool))}},{key:"clearShadowAndFilter",value:function(n,i,s){if(s&&(n.shadowColor="transparent",n.shadowBlur=0),i){var a=n.filter;!Ae(a)&&a.indexOf("drop-shadow")>-1&&(n.filter=a.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(bA);function gu(r,e,t){var n=r.parsedStyle,i=n.filter,s=n.shadowColor,a=n.shadowBlur,o=n.shadowOffsetX,l=n.shadowOffsetY;i&&i.length&&(e.filter=r.style.filter),t&&(e.shadowColor=s.toString(),e.shadowBlur=a||0,e.shadowOffsetX=o||0,e.shadowOffsetY=l||0)}function z1(r,e,t,n,i,s,a,o){var l=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(t)?t.forEach(function(u){r.fillStyle=fu(u,e,r,o),l||(n?r.fill(n):r.fill())}):(Ms(t)&&(r.fillStyle=hu(t,e,r,i,s,a,o)),l||(n?r.fill(n):r.fill()))}function Zh(r,e,t,n,i,s,a){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(t)?t.forEach(function(l){r.strokeStyle=fu(l,e,r,a),o||r.stroke()}):(Ms(t)&&(r.strokeStyle=hu(t,e,r,n,i,s,a)),o||r.stroke())}function wA(r,e){var t=Be(r,4),n=t[0],i=t[1],s=t[2],a=t[3],o=Be(e,4),l=o[0],u=o[1],c=o[2],d=o[3],h=Math.max(n,l),f=Math.max(i,u),g=Math.min(n+s,l+c),v=Math.min(i+a,u+d);return g<=h||v<=f?null:[h,f,g-h,v-f]}function xA(r,e){var t=Sn(Xe(),[r[0],r[1],0],e),n=Sn(Xe(),[r[0]+r[2],r[1],0],e),i=Sn(Xe(),[r[0],r[1]+r[3],0],e),s=Sn(Xe(),[r[0]+r[2],r[1]+r[3],0],e);return[Math.min(t[0],n[0],i[0],s[0]),Math.min(t[1],n[1],i[1],s[1]),Math.max(t[0],n[0],i[0],s[0])-Math.min(t[0],n[0],i[0],s[0]),Math.max(t[1],n[1],i[1],s[1])-Math.min(t[1],n[1],i[1],s[1])]}var EA=function(r){function e(){return oe(this,e),Fe(this,e,arguments)}return $e(e,r),le(e,[{key:"renderDownSampled",value:function(n,i,s,a){var o=a.src,l=a.imageCache;if(!l.downSampled){this.imagePool.createDownSampledImage(o,s).then(function(u){s.renderable.dirty=!0,s.ownerDocument.defaultView.context.renderingService.dirtify()}).catch(function(){});return}n.drawImage(l.downSampled,Math.floor(a.drawRect[0]),Math.floor(a.drawRect[1]),Math.ceil(a.drawRect[2]),Math.ceil(a.drawRect[3]))}},{key:"renderTile",value:function(n,i,s,a){var o=a.src,l=a.imageCache,u=a.imageRect,c=a.drawRect,d=l.size,h=n.getTransform(),f=h.a,g=h.b,v=h.c,p=h.d,y=h.e,b=h.f;if(n.resetTransform(),!(l!=null&&l.gridSize)){this.imagePool.createImageTiles(o,[],function(){s.renderable.dirty=!0,s.ownerDocument.defaultView.context.renderingService.dirtify()},s).catch(function(){});return}for(var E=[d[0]/u[2],d[1]/u[3]],T=[l.tileSize[0]/E[0],l.tileSize[1]/E[1]],S=[Math.floor((c[0]-u[0])/T[0]),Math.ceil((c[0]+c[2]-u[0])/T[0])],k=S[0],A=S[1],O=[Math.floor((c[1]-u[1])/T[1]),Math.ceil((c[1]+c[3]-u[1])/T[1])],C=O[0],P=O[1],L=C;L<=P;L++)for(var R=k;R<=A;R++){var z=l.tiles[L][R];if(z){var Y=[Math.floor(u[0]+z.tileX*T[0]),Math.floor(u[1]+z.tileY*T[1]),Math.ceil(T[0]),Math.ceil(T[1])];n.drawImage(z.data,Y[0],Y[1],Y[2],Y[3])}}n.setTransform(f,g,v,p,y,b)}},{key:"render",value:function(n,i,s){var a=i.x,o=a===void 0?0:a,l=i.y,u=l===void 0?0:l,c=i.width,d=i.height,h=i.src,f=i.shadowColor,g=i.shadowBlur,v=this.imagePool.getImageSync(h,s),p=v==null?void 0:v.img,y=c,b=d;if(p){y||(y=p.width),b||(b=p.height);var E=!Ae(f)&&g>0;gu(s,n,E);try{var T=s.ownerDocument.defaultView.getContextService().getDomElement(),S=T.width,k=T.height,A=n.getTransform(),O=A.a,C=A.b,P=A.c,L=A.d,R=A.e,z=A.f,Y=Dm(O,P,0,0,C,L,0,0,0,0,1,0,R,z,0,1),U=xA([o,u,y,b],Y),V=wA([0,0,S,k],U);if(!V)return;if(!s.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){e.renderFull(n,i,s,{image:p,drawRect:[o,u,y,b]});return}var W=U[2]/v.size[0];if(W<(v.downSamplingRate||.5)){this.renderDownSampled(n,i,s,{src:h,imageCache:v,drawRect:[o,u,y,b]});return}if(!Jf.isSupportTile){e.renderFull(n,i,s,{image:p,drawRect:[o,u,y,b]});return}this.renderTile(n,i,s,{src:h,imageCache:v,imageRect:U,drawRect:V})}catch{}}}},{key:"drawToContext",value:function(n,i,s,a,o){this.render(n,i.parsedStyle,i)}}],[{key:"renderFull",value:function(n,i,s,a){n.drawImage(a.image,Math.floor(a.drawRect[0]),Math.floor(a.drawRect[1]),Math.ceil(a.drawRect[2]),Math.ceil(a.drawRect[3]))}}])}(eg),MA=function(r){function e(){return oe(this,e),Fe(this,e,arguments)}return $e(e,r),le(e,[{key:"render",value:function(n,i,s,a,o,l){s.getBounds();var u=i.lineWidth,c=u===void 0?1:u,d=i.textAlign,h=d===void 0?"start":d,f=i.textBaseline,g=f===void 0?"alphabetic":f,v=i.lineJoin,p=v===void 0?"miter":v,y=i.miterLimit,b=y===void 0?10:y,E=i.letterSpacing,T=E===void 0?0:E,S=i.stroke,k=i.fill,A=i.fillRule,O=i.fillOpacity,C=O===void 0?1:O,P=i.strokeOpacity,L=P===void 0?1:P,R=i.opacity,z=R===void 0?1:R,Y=i.metrics,U=i.x,V=U===void 0?0:U,W=i.y,F=W===void 0?0:W,K=i.dx,re=i.dy,se=i.shadowColor,ae=i.shadowBlur,Ce=Y.font,Te=Y.lines,J=Y.height,Oe=Y.lineHeight,_e=Y.lineMetrics;n.font=Ce,n.lineWidth=c,n.textAlign=h==="middle"?"center":h;var Ve=g;Ve==="alphabetic"&&(Ve="bottom"),n.lineJoin=p,Ae(b)||(n.miterLimit=b);var Qe=F;g==="middle"?Qe+=-J/2-Oe/2:g==="bottom"||g==="alphabetic"||g==="ideographic"?Qe+=-J:(g==="top"||g==="hanging")&&(Qe+=-Oe);var zt=V+(K||0);Qe+=re||0,Te.length===1&&(Ve==="bottom"?(Ve="middle",Qe-=.5*J):Ve==="top"&&(Ve="middle",Qe+=.5*J)),n.textBaseline=Ve;var Xr=!Ae(se)&&ae>0;gu(s,n,Xr);for(var Gn=0;Gn<Te.length;Gn++){var qr=c/2+zt;Qe+=Oe,!Ae(S)&&!S.isNone&&c&&this.drawLetterSpacing(n,s,Te[Gn],_e[Gn],h,qr,Qe,T,k,A,C,S,L,z,!0,a,o,l),Ae(k)||this.drawLetterSpacing(n,s,Te[Gn],_e[Gn],h,qr,Qe,T,k,A,C,S,L,z,!1,a,o,l)}}},{key:"drawLetterSpacing",value:function(n,i,s,a,o,l,u,c,d,h,f,g,v,p,y,b,E,T){if(c===0){y?this.strokeText(n,i,s,l,u,g,v,b,E,T):this.fillText(n,i,s,l,u,d,h,f,p,b,E,T);return}var S=n.textAlign;n.textAlign="left";var k=l;o==="center"||o==="middle"?k=l-a.width/2:(o==="right"||o==="end")&&(k=l-a.width);for(var A=Array.from(s),O=n.measureText(s).width,C=0,P=0;P<A.length;++P){var L=A[P];y?this.strokeText(n,i,L,k,u,g,v,b,E,T):this.fillText(n,i,L,k,u,d,h,f,p,b,E,T),C=n.measureText(s.substring(P+1)).width,k+=O-C+c,O=C}n.textAlign=S}},{key:"fillText",value:function(n,i,s,a,o,l,u,c,d,h,f,g){z1(n,i,l,u,h,f,g,this.imagePool,!0);var v,p=!Ae(c)&&c!==1;p&&(v=n.globalAlpha,n.globalAlpha=c*d),n.fillText(s,a,o),p&&(n.globalAlpha=v)}},{key:"strokeText",value:function(n,i,s,a,o,l,u,c,d,h){Zh(n,i,l,c,d,h,this.imagePool,!0);var f,g=!Ae(u)&&u!==1;g&&(f=n.globalAlpha,n.globalAlpha=u),n.strokeText(s,a,o),g&&(n.globalAlpha=f)}},{key:"drawToContext",value:function(n,i,s,a,o){this.render(n,i.parsedStyle,i,i.ownerDocument.defaultView.context,a,o)}}])}(eg),SA=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),t=Fe(this,e),t.name="canvas-renderer",t.options=n,t}return $e(e,r),le(e,[{key:"init",value:function(){var n,i=We({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),s=this.context.imagePool,a=new eg(s),o=(n={},be(be(be(be(be(be(be(be(be(be(n,ee.CIRCLE,a),ee.ELLIPSE,a),ee.RECT,a),ee.IMAGE,new EA(s)),ee.TEXT,new MA(s)),ee.LINE,a),ee.POLYLINE,a),ee.POLYGON,a),ee.PATH,a),ee.GROUP,void 0),be(be(be(n,ee.HTML,void 0),ee.MESH,void 0),ee.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new B1(i))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(Xi);/*!
 * @antv/g-plugin-dom-interaction
 * @description A G plugin
 * @version 2.1.14
 * @date 11/27/2024, 2:17:18 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var F1=function(){function r(){oe(this,r)}return le(r,[{key:"apply",value:function(t,n){var i=this,s=t.renderingService,a=t.renderingContext,o=t.config;this.context=t;var l=a.root.ownerDocument.defaultView,u=function(O){s.hooks.pointerMove.call(O)},c=function(O){s.hooks.pointerUp.call(O)},d=function(O){s.hooks.pointerDown.call(O)},h=function(O){s.hooks.pointerOver.call(O)},f=function(O){s.hooks.pointerOut.call(O)},g=function(O){s.hooks.pointerCancel.call(O)},v=function(O){s.hooks.pointerWheel.call(O)},p=function(O){s.hooks.click.call(O)},y=function(O){n.globalThis.document.addEventListener("pointermove",u,!0),O.addEventListener("pointerdown",d,!0),O.addEventListener("pointerleave",f,!0),O.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",g,!0)},b=function(O){O.addEventListener("touchstart",d,!0),O.addEventListener("touchend",c,!0),O.addEventListener("touchmove",u,!0),O.addEventListener("touchcancel",g,!0)},E=function(O){n.globalThis.document.addEventListener("mousemove",u,!0),O.addEventListener("mousedown",d,!0),O.addEventListener("mouseout",f,!0),O.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",c,!0)},T=function(O){n.globalThis.document.removeEventListener("pointermove",u,!0),O.removeEventListener("pointerdown",d,!0),O.removeEventListener("pointerleave",f,!0),O.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",g,!0)},S=function(O){O.removeEventListener("touchstart",d,!0),O.removeEventListener("touchend",c,!0),O.removeEventListener("touchmove",u,!0),O.removeEventListener("touchcancel",g,!0)},k=function(O){n.globalThis.document.removeEventListener("mousemove",u,!0),O.removeEventListener("mousedown",d,!0),O.removeEventListener("mouseout",f,!0),O.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",c,!0)};s.hooks.init.tap(r.tag,function(){var A=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(A.style.msContentZooming="none",A.style.msTouchAction="none"):l.supportsPointerEvents&&(A.style.touchAction="none"),l.supportsPointerEvents?y(A):E(A),l.supportsTouchEvents&&b(A),o.useNativeClickEvent&&A.addEventListener("click",p,!0),A.addEventListener("wheel",v,{passive:!0,capture:!0})}),s.hooks.destroy.tap(r.tag,function(){var A=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(A.style.msContentZooming="",A.style.msTouchAction=""):l.supportsPointerEvents&&(A.style.touchAction=""),l.supportsPointerEvents?T(A):k(A),l.supportsTouchEvents&&S(A),o.useNativeClickEvent&&A.removeEventListener("click",p,!0),A.removeEventListener("wheel",v,!0)})}}])}();F1.tag="DOMInteraction";var TA=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="dom-interaction",t}return $e(e,r),le(e,[{key:"init",value:function(){this.addRenderingPlugin(new F1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Xi);/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.14
 * @date 11/27/2024, 2:17:28 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var OA="g-canvas-camera",$1=function(){function r(){oe(this,r),this.displayObjectHTMLElementMap=new WeakMap}return le(r,[{key:"joinTransformMatrix",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+n[0],t[13]+n[1]].join(","),")")}},{key:"apply",value:function(t,n){var i=this,s=t.camera,a=t.renderingContext,o=t.renderingService;this.context=t;var l=a.root.ownerDocument.defaultView,u=l.context.eventService.nativeHTMLMap,c=function(y,b){b.style.transform=i.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},d=function(y){var b=y.target;if(b.nodeName===ee.HTML){i.$camera||(i.$camera=i.createCamera(s));var E=i.getOrCreateEl(b);i.$camera.appendChild(E),Object.keys(b.attributes).forEach(function(T){i.updateAttribute(T,b)}),c(b,E),u.set(E,b)}},h=function(y){var b=y.target;if(b.nodeName===ee.HTML&&i.$camera){var E=i.getOrCreateEl(b);E&&(E.remove(),u.delete(E))}},f=function(y){var b=y.target;if(b.nodeName===ee.HTML){var E=y.attrName;i.updateAttribute(E,b)}},g=function(y){var b=y.target,E=b.nodeName===ee.FRAGMENT?b.childNodes:[b];E.forEach(function(T){if(T.nodeName===ee.HTML){var S=i.getOrCreateEl(T);c(T,S)}})},v=function(){if(i.$camera){var y=i.context.config,b=y.width,E=y.height;i.$camera.parentElement.style.width="".concat(b||0,"px"),i.$camera.parentElement.style.height="".concat(E||0,"px")}};o.hooks.init.tap(r.tag,function(){l.addEventListener(qn.RESIZE,v),l.addEventListener(Ue.MOUNTED,d),l.addEventListener(Ue.UNMOUNTED,h),l.addEventListener(Ue.ATTR_MODIFIED,f),l.addEventListener(Ue.BOUNDS_CHANGED,g)}),o.hooks.endFrame.tap(r.tag,function(){i.$camera&&a.renderReasons.has(ia.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(s.getOrthoMatrix()))}),o.hooks.destroy.tap(r.tag,function(){i.$camera&&i.$camera.remove(),l.removeEventListener(qn.RESIZE,v),l.removeEventListener(Ue.MOUNTED,d),l.removeEventListener(Ue.UNMOUNTED,h),l.removeEventListener(Ue.ATTR_MODIFIED,f),l.removeEventListener(Ue.BOUNDS_CHANGED,g)})}},{key:"createCamera",value:function(t){var n=this.context.config,i=n.document,s=n.width,a=n.height,o=this.context.contextService.getDomElement(),l=o.parentNode;if(l){var u=OA,c=l.querySelector("#".concat(u));if(!c){var d=(i||document).createElement("div");d.style.overflow="hidden",d.style.pointerEvents="none",d.style.position="absolute",d.style.left="0px",d.style.top="0px",d.style.width="".concat(s||0,"px"),d.style.height="".concat(a||0,"px");var h=(i||document).createElement("div");c=h,h.id=u,h.style.position="absolute",h.style.left="".concat(o.offsetLeft||0,"px"),h.style.top="".concat(o.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",d.appendChild(h),l.appendChild(d)}return c}return null}},{key:"getOrCreateEl",value:function(t){var n=this.context.config.document,i=this.displayObjectHTMLElementMap.get(t);return i||(i=(n||document).createElement("div"),t.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(t,i),t.id&&(i.id=t.id),t.name&&i.setAttribute("name",t.name),t.className&&(i.className=t.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),i}},{key:"updateAttribute",value:function(t,n){var i=this.getOrCreateEl(n);switch(t){case"innerHTML":var s=n.parsedStyle.innerHTML;Ke(s)?i.innerHTML=s:(i.innerHTML="",i.appendChild(s));break;case"x":i.style.left="".concat(n.parsedStyle.x,"px");break;case"y":i.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var a=n.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(a[0].buildCSSText(null,null,"")," ").concat(a[1].buildCSSText(null,null,""));break;case"width":var o=n.parsedStyle.width;i.style.width=ye(o)?"".concat(o,"px"):o.toString();break;case"height":var l=n.parsedStyle.height;i.style.height=ye(l)?"".concat(l,"px"):l.toString();break;case"zIndex":var u=n.parsedStyle.zIndex;i.style["z-index"]="".concat(u);break;case"visibility":var c=n.parsedStyle.visibility;i.style.visibility=c;break;case"pointerEvents":var d=n.parsedStyle.pointerEvents,h=d===void 0?"auto":d;i.style.pointerEvents=h;break;case"opacity":var f=n.parsedStyle.opacity;i.style.opacity="".concat(f);break;case"fill":var g=n.parsedStyle.fill,v="";nu(g)?g.isNone?v="transparent":v=n.getAttribute("fill"):Array.isArray(g)?v=n.getAttribute("fill"):Ms(g),i.style.background=v;break;case"stroke":var p=n.parsedStyle.stroke,y="";nu(p)?p.isNone?y="transparent":y=n.getAttribute("stroke"):Array.isArray(p)?y=n.getAttribute("stroke"):Ms(p),i.style["border-color"]=y,i.style["border-style"]="solid";break;case"lineWidth":var b=n.parsedStyle.lineWidth;i.style["border-width"]="".concat(b||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var E=n.style.filter;i.style.filter=E;break;default:!Ae(n.style[t])&&n.style[t]!==""&&(i.style[t]=n.style[t])}}}])}();$1.tag="HTMLRendering";var kA=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="html-renderer",t}return $e(e,r),le(e,[{key:"init",value:function(){this.addRenderingPlugin(new $1)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(Xi);/*!
 * @antv/g-canvas
 * @description A renderer implemented by Canvas 2D API
 * @version 2.0.32
 * @date 11/27/2024, 2:19:51 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var NA=function(){function r(e){oe(this,r),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return le(r,[{key:"init",value:function(){var t=this.canvasConfig,n=t.container,i=t.canvas;if(i)this.$canvas=i,n&&i.parentElement!==n&&n.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=Ke(n)?document.getElementById(n):n,this.$container)){var s=document.createElement("canvas");this.$container.appendChild(s),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=s}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,n){var i=this.canvasConfig.devicePixelRatio,s=i||yo&&window.devicePixelRatio||1;s=s>=1?Math.ceil(s):1,this.dpr=s,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*n,iT(this.$canvas,t,n)),this.renderingContext.renderReasons.add(ia.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:function(){var e=Vi(gn().mark(function n(){var i,s,a,o=arguments;return gn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:{},s=i.type,a=i.encoderOptions,u.abrupt("return",this.context.canvas.toDataURL(s,a));case 3:case"end":return u.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),AA=function(r){function e(){var t;oe(this,e);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=Fe(this,e,[].concat(i)),t.name="canvas-context-register",t}return $e(e,r),le(e,[{key:"init",value:function(){this.context.ContextService=NA}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(Xi),so=function(r){function e(t){var n;return oe(this,e),n=Fe(this,e,[t]),n.registerPlugin(new AA),n.registerPlugin(new yA),n.registerPlugin(new qN),n.registerPlugin(new SA),n.registerPlugin(new TA),n.registerPlugin(new gA),n.registerPlugin(new kA),n}return $e(e,r),le(e)}(mM),CA=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class zu extends Or{constructor(e){super(Object.assign(Object.assign({},e),{style:Object.assign({},zu.defaultStyleProps,e.style)})),this.rootPointerEvent=new su(null),this.forwardEvents=t=>{const n=this.context.canvas,i=n.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(a=>{const o=this.bootstrapEvent(this.rootPointerEvent,a,i,t);eo(n.context.eventService,"mappingTable.pointerupoutside",[]),n.context.eventService.mapEvent(o)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[te.CLICK,te.POINTER_DOWN,te.POINTER_MOVE,te.POINTER_UP,te.POINTER_OVER,te.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.drawPortShapes(e,t)}getKeyStyle(e){const t=xs(e,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=t,s=CA(t,["dx","dy"]),[a,o]=this.getSize(e);return Object.assign(Object.assign({x:n,y:i},s),{width:a,height:o})}drawKeyShape(e,t){const n=this.getKeyStyle(e),{x:i,y:s,width:a=0,height:o=0}=n,l=this.upsert("key-container",pn,{x:i,y:s,width:a,height:o,opacity:0},t);return this.upsert("key",wo,n,l)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof so))return;const n=this.getDomElement();this.events.forEach(i=>{n.addEventListener(i,this.forwardEvents)})}attributeChangedCallback(e,t,n){e==="zIndex"&&t!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const e=this.getDomElement();this.events.forEach(t=>{e.removeEventListener(t,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(e,t){const n=[];if(t.isTouchEvent(e))for(let i=0;i<e.changedTouches.length;i++){const s=e.changedTouches[i];Ie(s.button)&&(s.button=0),Ie(s.buttons)&&(s.buttons=1),Ie(s.isPrimary)&&(s.isPrimary=e.touches.length===1&&e.type==="touchstart"),Ie(s.width)&&(s.width=s.radiusX||1),Ie(s.height)&&(s.height=s.radiusY||1),Ie(s.tiltX)&&(s.tiltX=0),Ie(s.tiltY)&&(s.tiltY=0),Ie(s.pointerType)&&(s.pointerType="touch"),Ie(s.pointerId)&&(s.pointerId=s.identifier||0),Ie(s.pressure)&&(s.pressure=s.force||.5),Ie(s.twist)&&(s.twist=0),Ie(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=e.type,n.push(s)}else if(t.isMouseEvent(e)){const i=e;Ie(i.isPrimary)&&(i.isPrimary=!0),Ie(i.width)&&(i.width=1),Ie(i.height)&&(i.height=1),Ie(i.tiltX)&&(i.tiltX=0),Ie(i.tiltY)&&(i.tiltY=0),Ie(i.pointerType)&&(i.pointerType="mouse"),Ie(i.pointerId)&&(i.pointerId=1),Ie(i.pressure)&&(i.pressure=.5),Ie(i.twist)&&(i.twist=0),Ie(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,n.push(i)}else n.push(e);return n}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}bootstrapEvent(e,t,n,i){e.view=n,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);const{x:s,y:a}=this.getViewportXY(t);e.viewport.x=s,e.viewport.y=a;const[o,l]=this.context.canvas.getCanvasByViewport([s,a]);return e.canvas.x=o,e.canvas.y=l,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e}getViewportXY(e){let t,n;const{offsetX:i,offsetY:s,clientX:a,clientY:o}=e;if(!Ae(i)&&!Ae(s))t=i,n=s;else{const l=this.eventService.client2Viewport({x:a,y:o});t=l.x,n=l.y}return{x:t,y:n}}onframe(){super.onframe();const{opacity:e}=this.attributes;this.getDomElement().style.opacity=`${e}`}}zu.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var Vp=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};let W1=class G1 extends Or{constructor(e){super(ln({style:G1.defaultStyleProps},e))}getKeyStyle(e){const[t,n]=this.getSize(e),i=super.getKeyStyle(e),{fillOpacity:s,opacity:a=s}=i,o=Vp(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:a},o),{width:t,height:n,x:-t/2,y:-n/2})}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getShape("key").attributes,{fill:n,stroke:i}=t;Vp(t,["fill","stroke"]);const s=Yt(this.getGraphicStyle(e),"halo"),a=Number(s.lineWidth),[o,l]=ze(this.getSize(e),[a,a]);return Object.assign(Object.assign({},s),{width:o,height:l,fill:"transparent",x:-o/2,y:-l/2})}getIconStyle(e){const t=super.getIconStyle(e),[n,i]=this.getSize(e);return t?Object.assign({width:n*hi,height:i*hi},t):!1}drawKeyShape(e,t){const n=this.upsert("key",Zf,this.getKeyStyle(e),t);return Kf(this),n}drawHaloShape(e,t){this.upsert("halo",pn,this.getHaloStyle(e),t)}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&Qf(this)}};W1.defaultStyleProps={size:32};class PA extends Or{constructor(e){super(e)}getKeyStyle(e){const[t,n]=this.getSize(e);return Object.assign(Object.assign({},super.getKeyStyle(e)),{width:t,height:n,x:-t/2,y:-n/2})}getIconStyle(e){const t=super.getIconStyle(e),{width:n,height:i}=this.getShape("key").attributes;return t?Object.assign({width:n*hi,height:i*hi},t):!1}drawKeyShape(e,t){return this.upsert("key",pn,this.getKeyStyle(e),t)}}class _A extends Ru{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return pC(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getInnerR(e)*2*hi;return t?Object.assign({width:n,height:n},t):!1}getPortXY(e,t){const{placement:n="top"}=t,i=this.getShape("key").getLocalBounds(),s=vC(this.getOuterR(e),this.getInnerR(e));return rg(i,n,s,!1)}}class Fu extends Ru{constructor(e){super(ln({style:Fu.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[n,i]=this.getSize(e);return mC(n,i,t)}getPortXY(e,t){const{direction:n}=e,{placement:i="top"}=t,s=this.getShape("key").getLocalBounds(),[a,o]=this.getSize(e),l=yC(a,o,n);return rg(s,i,l,!1)}getIconStyle(e){const{icon:t,iconText:n,iconSrc:i,direction:s}=e;if(t===!1||Ir(n||i))return!1;const a=Yt(this.getGraphicStyle(e),"icon"),o=this.getShape("key").getLocalBounds(),[l,u]=Ik(o,s),c=Rk(o,s)*2*hi;return Object.assign({x:l,y:u,width:c,height:c},a)}}Fu.defaultStyleProps={size:40,direction:"up"};var Up=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ya extends Or{constructor(e){super(ln({style:ya.defaultStyleProps},e)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(e){const{collapsed:t,childrenNode:n=[]}=e;return n.length===0?this.getEmptyKeySize(e):t?this.getCollapsedKeySize(e):this.getExpandedKeySize(e)}getEmptyKeySize(e){const{padding:t,collapsedSize:n}=e,[i,s,a,o]=Vr(t);return ze(er(n),[o+s,i+a,0])}getCollapsedKeySize(e){return er(e.collapsedSize)}getExpandedKeySize(e){const t=this.getContentBBox(e);return[Ur(t),Hr(t),0]}getContentBBox(e){const{childrenNode:t=[],padding:n}=e,i=t.map(a=>this.context.element.getElement(a)).filter(Boolean);if(i.length===0){const a=new ct,{x:o=0,y:l=0,size:u}=e,[c,d]=er(u);return a.setMinMax([o-c/2,l-d/2,0],[o+c/2,l+d/2,0]),a}const s=Eo(i.map(a=>a.getBounds()));return n?Zi(s,n):s}drawCollapsedMarkerShape(e,t){const n=this.getCollapsedMarkerStyle(e);this.upsert("collapsed-marker",P1,n,t),Kf(this)}getCollapsedMarkerStyle(e){if(!e.collapsed||!e.collapsedMarker)return!1;const t=Yt(this.getGraphicStyle(e),"collapsedMarker"),{type:n}=t,i=Up(t,["type"]),s=this.getShape("key"),[a,o]=ri(s.getLocalBounds(),"center"),l=Object.assign(Object.assign({},i),{x:a,y:o});if(n){const u=this.getCollapsedMarkerText(n,e);Object.assign(l,{text:u})}return l}getCollapsedMarkerText(e,t){const{childrenData:n=[]}=t,{model:i}=this.context;return e==="descendant-count"?i.getDescendantsData(this.id).length.toString():e==="child-count"?n.length.toString():e==="node-count"?i.getDescendantsData(this.id).filter(s=>i.getElementType(q(s))==="node").length.toString():Ee(e)?e(n):""}getComboPosition(e){const{x:t=0,y:n=0,collapsed:i,childrenData:s=[]}=e;if(s.length===0)return[+t,+n,0];if(i){const{model:a}=this.context,o=a.getDescendantsData(this.id).filter(l=>!a.isCombo(q(l)));if(o.length>0&&o.some(uN)){const l=o.reduce((u,c)=>ze(u,Kt(c)),[0,0,0]);return Tr(l,o.length)}return[+t,+n,0]}return this.getContentBBox(e).center}getComboStyle(e){const[t,n]=this.getComboPosition(e);return{x:t,y:n,transform:[["translate",t,n]]}}updateComboPosition(e){const t=this.getComboStyle(e);Object.assign(this.style,t);const{x:n,y:i}=t;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:i}}),Qf(this)}render(e,t=this){super.render(e,t),this.drawCollapsedMarkerShape(e,t)}update(e={}){super.update(e),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(this.attributes.collapsed?e:e.map(i=>{var{x:s,y:a,z:o,transform:l}=i,u=Up(i,["x","y","z","transform"]);return u}),t);return n&&new Proxy(n,{set:(i,s,a)=>(s==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,s,a))})}}ya.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class LA extends ya{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",pi,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,n=super.getKeyStyle(e),[i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},n),t&&Yt(n,"collapsed")),{r:i/2})}getCollapsedKeySize(e){const[t,n]=er(e.collapsedSize),i=Math.max(t,n)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[n,i]=qi(t),s=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[s*2,s*2,0]}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Du(e,n,t)}}class DA extends ya{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",pn,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},t),e.collapsed&&Yt(t,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}}const IA={padding:10};function Hp(r,e,t,n,i,s){const{padding:a}=Object.assign(IA,s),o=Ci(t,a),l=Ci(n,a),u=[r,...i,e];let c=null;const d=[];for(let h=0,f=u.length;h<f-1;h++){const g=h+1,v=u[h],p=u[g],y=hN(v,p);let b=null;if(h===0)if(g===f-1)if(o.intersects(l))b=Td(v,p,o,l);else if(!lu(v,o)&&!lu(p,l)){const E=ys(v,o),T=ys(p,l);b=qp(E,T,Pn(E,T)),b.points.unshift(E),b.points.push(T)}else y||(b=jA(v,p,o,l));else Sr(p,o)?b=Td(v,p,o,Ci(p,a),c):y||(b=Bl(v,p,o));else g===f-1?Sr(v,l)?b=Td(v,p,Ci(v,a),l,c):y||(b=Y1(v,p,l,c)):y||(b=qp(v,p,c));b?(d.push(...b.points),c=b.direction):c=Pn(v,p),g<f-1&&d.push(p)}return d.map(Os)}const RA={N:"S",S:"N",W:"E",E:"W"},Xp={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function Pn(r,e){const[t,n]=r,[i,s]=e;return t===i?n>s?"N":"S":n===s?t>i?"W":"E":null}function Kh(r,e){return e==="N"||e==="S"?Hr(r):Ur(r)}function qp(r,e,t){const n=[r[0],e[1]],i=[e[0],r[1]],s=Pn(r,n),a=Pn(r,i),o=t?RA[t]:null,l=s===t||s!==o&&a!==t?n:i;return{points:[l],direction:Pn(l,e)}}function Bl(r,e,t){if(lu(r,t)){const n=ao(r,e,t);return{points:[n],direction:Pn(n,e)}}else{const n=ys(r,t),s=["left","right"].includes(qa(r,t))?[e[0],n[1]]:[n[0],e[1]];return{points:[s],direction:Pn(s,e)}}}function Y1(r,e,t,n){const i=lu(e,t)?e:ys(e,t),s=[[i[0],r[1]],[r[0],i[1]]],a=s.filter(l=>Dk(l,t)&&!u1(l,t,!0)),o=a.filter(l=>Pn(l,r)!==n);if(o.length>0){const l=o.find(u=>Pn(r,u)===n)||o[0];return{points:[l],direction:Pn(l,e)}}else{const l=t2(s,a)[0],u=Fi(e,l,Kh(t,n)/2);return{points:[ao(u,r,t),u],direction:Pn(u,e)}}}function jA(r,e,t,n){let i=Bl(r,e,t);const s=io(i.points[0]);if(Sr(s,n)){i=Bl(e,r,n);const a=io(i.points[0]);if(Sr(a,t)){const o=Fi(r,s,Kh(t,Pn(r,s))/2),l=Fi(e,a,Kh(n,Pn(e,a))/2),u=[(o[0]+l[0])/2,(o[1]+l[1])/2],c=Bl(r,u,t),d=Y1(u,e,n,c.direction);i.points=[c.points[0],d.points[0]],i.direction=d.direction}}return i}function Td(r,e,t,n,i){const a=Eo([t,n]),o=ft(e,a.center)>ft(r,a.center),[l,u]=o?[e,r]:[r,e],c=Hr(a)+Ur(a);let d;if(i){const g=[l[0]+c*Math.cos(Xp[i]),l[1]+c*Math.sin(Xp[i])];d=Fi(ys(g,a),g,.01)}else d=Fi(ys(l,a),l,-.01);let h=ao(d,u,a),f=[Ca(d,2),Ca(h,2)];if(Ct(Ca(d),Ca(h))){const g=Hf(it(d,l),[1,0,0])+Math.PI/2;h=[u[0]+c*Math.cos(g),u[1]+c*Math.sin(g),0],h=Ca(Fi(ys(h,a),u,-.01),2);const v=ao(d,h,a);f=[d,v,h]}return{points:o?f.reverse():f,direction:Pn(o?d:h,e)}}function ao(r,e,t){let n=[r[0],e[1]];return Sr(n,t)&&(n=[e[0],r[1]]),n}function V1(r,e,t,n,i){let l=typeof e=="number"?e:.5;e==="start"&&(l=0),e==="end"&&(l=.99);const u=fn(r.getPoint(l)),c=fn(r.getPoint(l+.01));let d=e==="start"?"left":e==="end"?"right":"center";if(w1(u,c)||!t){const[y,b]=Zp(r,l,n,i);return{transform:[["translate",y,b]],textAlign:d}}let h=Math.atan2(c[1]-u[1],c[0]-u[0]);c[0]<u[0]&&(d=d==="center"?d:d==="left"?"right":"left",n*=-1,h+=Math.PI);const[g,v]=Zp(r,l,n,i,h),p=[["translate",g,v],["rotate",h/Math.PI*180]];return{textAlign:d,transform:p}}function BA(r,e,t,n,i){var s,a;const o=((s=r.badge)===null||s===void 0?void 0:s.getGeometryBounds().halfExtents[0])*2||0,l=((a=r.label)===null||a===void 0?void 0:a.getGeometryBounds().halfExtents[0])*2||0;return V1(r.key,t,!0,(l?(l/2+o/2)*(e==="suffix"?1:-1):0)+n,i)}function Zp(r,e,t,n,i){const[s,a]=fn(r.getPoint(e));let o=t,l=n;return i&&(o=t*Math.cos(i)-n*Math.sin(i),l=t*Math.sin(i)+n*Math.cos(i)),[s+o,a+l]}function Qh(r,e,t,n){if(Ct(r,e))return r;const i=it(e,r),s=[r[0]+t*i[0],r[1]+t*i[1]],a=ui(Lu(i,!1));return s[0]+=n*a[0],s[1]+=n*a[1],s}function zA(r){return ye(r)?[r,-r]:r}function FA(r){return ye(r)?[r,1-r]:r}function $A(r,e,t){return[["M",r[0],r[1]],["Q",t[0],t[1],e[0],e[1]]]}function U1(r,e,t){return[["M",r[0],r[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function tg(r,e=0,t=!1){const n=r[0],i=r[r.length-1],s=r.slice(1,r.length-1),a=[["M",n[0],n[1]]];return s.forEach((o,l)=>{const u=s[l-1]||n,c=s[l+1]||i;if(!x1(u,o,c)&&e){const[d,h]=WA(u,o,c,e);a.push(["L",d[0],d[1]],["Q",o[0],o[1],h[0],h[1]],["L",h[0],h[1]])}else a.push(["L",o[0],o[1]])}),a.push(["L",i[0],i[1]]),t&&a.push(["Z"]),a}function WA(r,e,t,n){const i=uu(r,e),s=uu(t,e),a=Math.min(n,Math.min(i,s)/2),o=[e[0]-a/i*(e[0]-r[0]),e[1]-a/i*(e[1]-r[1])],l=[e[0]-a/s*(e[0]-t[0]),e[1]-a/s*(e[1]-t[1])];return[o,l]}const GA=r=>{const e=Math.PI/2,t=Hr(r)/2,n=Ur(r)/2,i=Math.atan2(t,n)/2,s=Math.atan2(n,t)/2;return{top:[-e-s,-e+s],"top-right":[-e+s,-i],"right-top":[-e+s,-i],right:[-i,i],"bottom-right":[i,e-s],"right-bottom":[i,e-s],bottom:[e-s,e+s],"bottom-left":[e+s,Math.PI-i],"left-bottom":[e+s,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-s],"left-top":[Math.PI+i,-e-s]}};function H1(r,e,t,n,i){const s=Ci(r),a=r.getCenter();let o=n&&Ui(n),l=i&&Ui(i);if(!o||!l){const u=GA(s),c=u[e][0],d=u[e][1],[h,f]=qi(s),g=Math.max(h,f),v=ze(a,[g*Math.cos(c),g*Math.sin(c),0]),p=ze(a,[g*Math.cos(d),g*Math.sin(d),0]);o=ef(r,v),l=ef(r,p),t||([o,l]=[l,o])}return[o,l]}function YA(r,e,t,n,i,s){const a=r.getPorts()[i||s],o=r.getPorts()[s||i];let[l,u]=H1(r,e,t,a,o);const c=VA(r,l,u,n);return a&&(l=oo(a,c[0])),o&&(u=oo(o,c[c.length-1])),U1(l,u,c)}function VA(r,e,t,n){const i=r.getCenter();if(Ct(e,t)){const s=it(e,i),a=[n*Math.sign(s[0])||n/2,n*Math.sign(s[1])||-n/2,0];return[ze(e,a),ze(t,ni(a,[1,-1,1]))]}return[Fi(i,e,ft(i,e)+n),Fi(i,t,ft(i,t)+n)]}function UA(r,e,t,n,i,s,a){const o=ig(r),l=o[s||a],u=o[a||s];let[c,d]=H1(r,t,n,l,u);const h=HA(r,c,d,i);return l&&(c=oo(l,h[0])),u&&(d=oo(u,h[h.length-1])),tg([c,...h,d],e)}function HA(r,e,t,n){const i=[],s=Ci(r);if(Ct(e,t))switch(qa(e,s)){case"left":i.push([e[0]-n,e[1]]),i.push([e[0]-n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"right":i.push([e[0]+n,e[1]]),i.push([e[0]+n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"top":i.push([e[0],e[1]-n]),i.push([e[0]+n,e[1]-n]),i.push([e[0]+n,e[1]]);break;case"bottom":i.push([e[0],e[1]+n]),i.push([e[0]+n,e[1]+n]),i.push([e[0]+n,e[1]]);break}else{const a=qa(e,s),o=qa(t,s);if(a===o){const l=a;let u,c;switch(l){case"left":u=Math.min(e[0],t[0])-n,i.push([u,e[1]]),i.push([u,t[1]]);break;case"right":u=Math.max(e[0],t[0])+n,i.push([u,e[1]]),i.push([u,t[1]]);break;case"top":c=Math.min(e[1],t[1])-n,i.push([e[0],c]),i.push([t[0],c]);break;case"bottom":c=Math.max(e[1],t[1])+n,i.push([e[0],c]),i.push([t[0],c]);break}}else{const l=(h,f)=>({left:[f[0]-n,f[1]],right:[f[0]+n,f[1]],top:[f[0],f[1]-n],bottom:[f[0],f[1]+n]})[h],u=l(a,e),c=l(o,t),d=ao(u,c,s);i.push(u,d,c)}}return i}function Jh(r,e){const t=new Set,n=new Set,i=new Set;return r.forEach(s=>{e(s).forEach(o=>{t.add(o),r.includes(o.source)&&r.includes(o.target)?n.add(o):i.add(o)})}),{edges:Array.from(t),internal:Array.from(n),external:Array.from(i)}}function Kp(r,e){const t=[];let n=r;for(;n;){t.push(n);const i=e(q(n));if(i)n=i;else break}if(t.some(i=>{var s;return(s=i.style)===null||s===void 0?void 0:s.collapsed})){const i=t.reverse().findIndex(Wn);return t[i]||t.at(-1)}return r}function XA(r,e){return e||(r<4?10:r===4?12:r*2.5)}const qA=(r,e)=>{const t=Math.max(r,e)/2;return[["M",-r/2,0],["A",t,t,0,1,0,2*t-r/2,0],["A",t,t,0,1,0,-r/2,0],["Z"]]},X1=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",r/2,e/2],["Z"]],ZA=(r,e)=>[["M",-r/2,0],["L",0,-e/2],["L",r/2,0],["L",0,e/2],["Z"]],KA=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",4*r/5-r/2,0],["L",r/2,e/2],["Z"]],QA=(r,e)=>[["M",-r/2,-e/2],["L",r/2,-e/2],["L",r/2,e/2],["L",-r/2,e/2],["Z"]],JA=(r,e)=>{const t=r/2,n=r/7,i=r-n;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+n-t,-e/2],["L",i+n-t,e/2],["L",i-t,e/2],["Z"]]},eC=(r,e)=>[["M",r/2,-e/2],["L",-r/2,0],["L",r/2,0],["L",-r/2,0],["L",r/2,e/2]],tC=Object.freeze(Object.defineProperty({__proto__:null,circle:qA,diamond:ZA,rect:QA,simple:eC,triangle:X1,triangleRect:JA,vee:KA},Symbol.toStringTag,{value:"Module"}));var bl=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Qi extends _1{constructor(e){super(ln({style:Qi.defaultStyleProps},e)),this.type="edge"}get sourceNode(){const{sourceNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}get targetNode(){const{targetNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}getKeyStyle(e){const t=this.getGraphicStyle(e),{loop:n}=t,i=bl(t,["loop"]),{sourceNode:s,targetNode:a}=this,l={d:n&&dC(s,a)?this.getLoopPath(e):this.getKeyPath(e)};return Kn.PARSED_STYLE_LIST.forEach(u=>{u in i&&(l[u]=i[u])}),l}getLoopPath(e){const{sourcePort:t,targetPort:n}=e,i=this.sourceNode,s=Ci(i),a=Math.max(Ur(s),Hr(s)),{placement:o,clockwise:l,dist:u=a}=Yt(this.getGraphicStyle(e),"loop");return YA(i,o,l,u,t,n)}getEndpoints(e,t=!0,n=[]){const{sourcePort:i,targetPort:s}=e,{sourceNode:a,targetNode:o}=this,[l,u]=fC(a,o,i,s);if(!t){const f=l?Ui(l):a.getCenter(),g=u?Ui(u):o.getCenter();return[f,g]}const c=typeof n=="function"?n():n,d=nv(l||a,c[0]||u||o),h=nv(u||o,c[c.length-1]||l||a);return[d,h]}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),n=Yt(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign({},t),n)}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=Yt(this.getGraphicStyle(e),"label"),{placement:n,offsetX:i,offsetY:s,autoRotate:a,maxWidth:o}=t,l=bl(t,["placement","offsetX","offsetY","autoRotate","maxWidth"]),u=V1(this.shapeMap.key,n,a,i,s),c=this.shapeMap.key.getLocalBounds(),d=ON([c.min,c.max],o);return Object.assign({wordWrapWidth:d},u,l)}getBadgeStyle(e){if(e.badge===!1||!e.badgeText)return!1;const t=Yt(e,"badge"),{offsetX:n,offsetY:i,placement:s}=t,a=bl(t,["offsetX","offsetY","placement"]);return Object.assign(a,BA(this.shapeMap,s,e.labelPlacement,n,i))}drawArrow(e,t){var n;const i=t==="start",a=e[t==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(a){const l=this.getArrowStyle(e,i),[u,c,d]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],h=o.parsedStyle[u];if(h)h.attr(l);else{const f=l.src?xo:Kn,g=new f({style:l});o.style[u]=g}o.style[c]=e[d]||l.width/2+ +l.lineWidth}else{const l=i?"markerStart":"markerEnd";(n=o.style[l])===null||n===void 0||n.destroy(),o.style[l]=null}}getArrowStyle(e,t){const n=this.getShape("key").attributes,i=t?"startArrow":"endArrow",s=Yt(this.getGraphicStyle(e),i),{size:a,type:o}=s,l=bl(s,["size","type"]),[u,c]=er(XA(n.lineWidth,a)),h=(Ee(o)?o:tC[o]||X1)(u,c);return Object.assign(xs(n,["stroke","strokeOpacity","fillOpacity"]),{width:u,height:c},Object.assign({},h&&{d:h,fill:o==="simple"?"":n.stroke}),l)}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",Ki,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e);this.upsert("halo",Kn,n,t)}drawBadgeShape(e,t){const n=this.getBadgeStyle(e);this.upsert("badge",ma,n,t)}drawSourceArrow(e){this.drawArrow(e,"start")}drawTargetArrow(e){this.drawArrow(e,"end")}drawKeyShape(e,t){const n=this.getKeyStyle(e);return this.upsert("key",Kn,n,t)}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.getShape("key")&&(this.drawSourceArrow(e),this.drawTargetArrow(e),this.drawLabelShape(e,t),this.drawHaloShape(e,t),this.drawBadgeShape(e,t))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(e,t);return n&&new Proxy(n,{set:(i,s,a)=>(s==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,s,a))})}}Qi.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class Ls extends Qi{constructor(e){super(ln({style:Ls.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e),{controlPoints:i,curvePosition:s,curveOffset:a}=e,o=this.getControlPoints(t,n,FA(s),zA(a),i);return U1(t,n,o)}getControlPoints(e,t,n,i,s){return(s==null?void 0:s.length)===2?s:[Qh(e,t,n[0],i[0]),Qh(e,t,n[1],i[1])]}}Ls.defaultStyleProps={curvePosition:.5,curveOffset:20};class $u extends Ls{constructor(e){super(ln({style:$u.defaultStyleProps},e))}getControlPoints(e,t,n,i){const s=t[0]-e[0];return[[e[0]+s*n[0]+i[0],e[1]],[t[0]-s*n[1]+i[1],t[1]]]}}$u.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class Wu extends Ls{constructor(e){super(ln({style:Wu.defaultStyleProps},e))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(e){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(e);const t=Kt(this.ref),n=this.sourceNode.getIntersectPoint(t,!0),i=this.targetNode.getIntersectPoint(t);return[n,i]}toRadialCoordinate(e){const t=Kt(this.ref),n=ft(e,t),i=m1(it(e,t));return[n,i]}getControlPoints(e,t,n,i){const[s,a]=this.toRadialCoordinate(e),[o]=this.toRadialCoordinate(t),l=o-s;return[[e[0]+(l*n[0]+i[0])*Math.cos(a),e[1]+(l*n[0]+i[0])*Math.sin(a)],[t[0]-(l*n[1]-i[0])*Math.cos(a),t[1]-(l*n[1]-i[0])*Math.sin(a)]]}}Wu.defaultStyleProps={curvePosition:.5,curveOffset:20};class Gu extends Ls{constructor(e){super(ln({style:Gu.defaultStyleProps},e))}getControlPoints(e,t,n,i){const s=t[1]-e[1];return[[e[0],e[1]+s*n[0]+i[0]],[t[0],t[1]-s*n[1]+i[1]]]}}Gu.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let q1=class Z1 extends Qi{constructor(e){super(ln({style:Z1.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",n[0],n[1]]]}};q1.defaultStyleProps={};const nC={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:uu},ei=r=>`${Math.round(r[0])}|||${Math.round(r[1])}`;function gs(r,e){const t=n=>Math.round(n/e);return ye(r)?t(r):r.map(t)}function rC(r,e){const t=Math.abs(r-e);return t>Math.PI?2*Math.PI-t:t}function Qp(r,e){const t=e[0]-r[0],n=e[1]-r[1];return!t&&!n?0:Math.atan2(n,t)}function K1(r,e,t,n){const i=Qp(r,e),s=t[ei(r)],o=Qp(s||n,r);return rC(o,i)}const iC=(r,e)=>{const{offset:t,gridSize:n}=e,i={};return r.forEach(s=>{if(!s||s.destroyed||!s.isVisible())return;const a=Zi(s.getRenderBounds(),t);for(let o=gs(a.min[0],n);o<=gs(a.max[0],n);o+=1)for(let l=gs(a.min[1],n);l<=gs(a.max[1],n);l+=1)i[`${o}|||${l}`]=!0}),i};function Jp(r,e,t){return Math.min(...e.map(n=>t(r,n)))}function sC(r,e,t){let n=r[0],i=t(r[0],e);for(let s=0;s<r.length;s++){const a=r[s],o=t(a,e);o<i&&(n=a,i=o)}return n}const ev=(r,e,t,n)=>{if(!e)return[r];const{directionMap:i,offset:s}=n,a=Zi(e.getRenderBounds(),s),o=Object.keys(i).reduce((l,u)=>{if(t.includes(u)){const c=i[u],[d,h]=qi(a),f=[r[0]+c.stepX*d,r[1]+c.stepY*h],g=jk(a);for(let v=0;v<g.length;v++){const p=Xf([r,f],g[v]);p&&u1(p,a)&&l.push(p)}}return l},[]);return Sr(r,a)||o.push(r),o.map(l=>gs(l,n.gridSize))},aC=(r,e,t,n,i,s,a)=>{const o=[];let l=[s[0]===n[0]?n[0]:r[0]*a,s[1]===n[1]?n[1]:r[1]*a];o.unshift(l);let u=r,c=e[ei(u)];for(;c;){const f=c,g=u;K1(f,g,e,t)&&(l=[f[0]===g[0]?l[0]:f[0]*a,f[1]===g[1]?l[1]:f[1]*a],o.unshift(l)),c=e[ei(f)],u=f}const d=i.map(f=>[f[0]*a,f[1]*a]),h=sC(d,l,uu);return o.unshift(h),o};function oC(r,e,t,n){const i=Os(r.getCenter()),s=Os(e.getCenter()),a=Object.assign(nC,n),{gridSize:o}=a,l=a.enableObstacleAvoidance?t:[r,e],u=iC(l,a),c=gs(i,o),d=gs(s,o),h=ev(i,r,a.startDirections,a),f=ev(s,e,a.endDirections,a);h.forEach(O=>delete u[ei(O)]),f.forEach(O=>delete u[ei(O)]);const g={},v={},p={},y={},b={},E=new lC;for(let O=0;O<h.length;O++){const C=h[O],P=ei(C);g[P]=C,y[P]=0,b[P]=Jp(C,f,a.distFunc),E.add({id:P,value:b[P]})}const T=f.map(O=>ei(O));let S=a.maximumLoops,k,A=1/0;for(const[O,C]of Object.entries(g))b[O]<=A&&(A=b[O],k=C);for(;Object.keys(g).length>0&&S>0;){const O=E.minId(!1);if(O)k=g[O];else break;const C=ei(k);if(T.includes(C))return aC(k,p,c,s,h,d,o);delete g[C],E.remove(C),v[C]=!0;for(const P of Object.values(a.directionMap)){const L=ze(k,[P.stepX,P.stepY]),R=ei(L);if(v[R])continue;const z=K1(k,L,p,c);if(z>a.maxAllowedDirectionChange||u[R])continue;g[R]||(g[R]=L);const Y=a.penalties[z],U=a.distFunc(k,L)+(isNaN(Y)?o:Y),V=y[C]+U,W=y[R];W&&V>=W||(p[R]=k,y[R]=V,b[R]=V+Jp(L,f,a.distFunc),E.add({id:R,value:b[R]}))}S-=1}return[]}class lC{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(e,t){let n=0,i=t-1;for(;i-n>1;){const s=Math.floor((n+i)/2);if(this.arr[s].value>e.value)i=s;else if(this.arr[s].value<e.value)n=s;else{this.arr.splice(s,0,e),this.map[e.id]=!0;return}}this.arr.splice(i,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];const t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){const e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}}class Yu extends Qi{constructor(e){super(ln({style:Yu.defaultStyleProps},e))}getControlPoints(e){const{router:t}=e,{sourceNode:n,targetNode:i}=this,[s,a]=this.getEndpoints(e,!1);let o=[];if(!t)o=e.controlPoints;else if(t.type==="shortest-path"){const l=this.context.element.getNodes();o=oC(n,i,l,t),o.length||(o=Hp(s,a,n,i,e.controlPoints,{padding:t.offset}))}else t.type==="orth"&&(o=Hp(s,a,n,i,e.controlPoints,t));return o}getPoints(e){const t=this.getControlPoints(e),[n,i]=this.getEndpoints(e,!0,t);return[n,...t,i]}getKeyPath(e){const t=this.getPoints(e);return tg(t,e.radius)}getLoopPath(e){const{sourcePort:t,targetPort:n,radius:i}=e,s=this.sourceNode,a=Ci(s),o=Math.max(Ur(a),Hr(a))/4,{placement:l,clockwise:u,dist:c=o}=Yt(this.getGraphicStyle(e),"loop");return UA(s,i,l,u,c,t,n)}}Yu.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Vu extends Qi{constructor(e){super(ln({style:Vu.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:n}=e,[i,s]=this.getEndpoints(e),a=e.controlPoint||Qh(i,s,t,n);return $A(i,s,a)}}Vu.defaultStyleProps={curvePosition:.5,curveOffset:30};var uC=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function ko(r){return r instanceof Or&&r.type==="node"}function Q1(r){return r instanceof Qi}function ng(r){return r instanceof ya}function cC(r){return ko(r)||Q1(r)||ng(r)}function dC(r,e){return!r||!e?!1:r===e}const hC={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function rg(r,e,t=hC,n=!0){const i=[.5,.5],s=Ke(e)?An(t,e.toLocaleLowerCase(),i):e;if(!n&&Ke(e))return s;const[a,o]=s||i;return[r.min[0]+Ur(r)*a,r.min[1]+Hr(r)*o]}function ig(r){if(!r)return{};const e=r.getPorts();return(r.attributes.ports||[]).forEach((n,i)=>{var s;const{key:a,placement:o}=n;J1(n)&&(e[s=a||i]||(e[s]=ri(r.getShape("key").getBounds(),o)))}),e}function J1(r){const{r:e}=r;return!e||Number(e)===0}function Ui(r){return ha(r)?r:r.getPosition()}function fC(r,e,t,n){const i=tv(r,e,t,n),s=tv(e,r,n,t);return[i,s]}function tv(r,e,t,n){const i=ig(r);if(t)return i[t];const s=Object.values(i);if(s.length===0)return;const a=s.map(u=>Ui(u)),o=gC(e,n),[l]=pN(a,o);return s.find(u=>Ui(u)===l)}function gC(r,e){const t=ig(r);if(e)return[Ui(t[e])];const n=Object.values(t);return n.length>0?n.map(i=>Ui(i)):[r.getCenter()]}function nv(r,e){return ng(r)||ko(r)?ef(r,e):oo(r,e)}function oo(r,e){if(!r||!e)return[0,0,0];if(ha(r))return r;if(r.attributes.linkToCenter)return r.getPosition();const t=ha(e)?e:ko(e)?e.getCenter():e.getPosition();return Du(t,r.getBounds())}function ef(r,e){if(!r||!e)return[0,0,0];const t=ha(e)?e:ko(e)?e.getCenter():e.getPosition();return r.getIntersectPoint(t)||r.getCenter()}function rv(r,e="bottom",t=0,n=0,i=!1){const s=e.split("-"),[a,o]=ri(r,e),l=s.includes("left")?"right":s.includes("right")?"left":"center";let u=s.includes("top")?"bottom":s.includes("bottom")?"top":"middle";return i&&(u=u==="top"?"bottom":u==="bottom"?"top":u),{transform:[["translate",a+t,o+n]],textBaseline:u,textAlign:l}}function pC(r,e){return[[0,-r],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[0,e],[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function vC(r,e){const t={};return t.top=[0,-r],t.left=[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t["left-bottom"]=[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.right=t.default=[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t}function mC(r,e,t){const n=e/2,i=r/2,s={up:[[-i,n],[i,n],[0,-n]],left:[[-i,0],[i,n],[i,-n]],right:[[-i,n],[-i,-n],[i,0]],down:[[-i,-n],[i,-n],[0,n]]};return s[t]||s.up}function yC(r,e,t){const n=e/2,i=r/2,s={};return t==="down"?(s.bottom=s.default=[0,n],s.right=[i,-n],s.left=[-i,-n]):t==="left"?(s.top=[i,-n],s.bottom=[i,n],s.left=s.default=[-i,0]):t==="right"?(s.top=[-i,-n],s.bottom=[-i,n],s.right=s.default=[i,0]):(s.left=[-i,n],s.top=s.default=[0,-n],s.right=[i,n]),s}function bC(r,e){return[[0,-e/2],[r/2,0],[0,e/2],[-r/2,0]]}function wC(r){return An(r,["style","visibility"])!=="hidden"}function xC(r,e){const{zIndex:t,transform:n,transformOrigin:i,visibility:s,cursor:a,clipPath:o,component:l}=e,u=uC(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(r.attributes,u),n&&r.setAttribute("transform",n),ye(t)&&r.setAttribute("zIndex",t),i&&r.setAttribute("transformOrigin",i),s&&r.setAttribute("visibility",s),a&&r.setAttribute("cursor",a),o&&r.setAttribute("clipPath",o),l&&r.setAttribute("component",l)}function tf(r,e){"update"in r?r.update(e):r.attr(e)}function EC(r){return[[0,r],[r*Math.sqrt(3)/2,r/2],[r*Math.sqrt(3)/2,-r/2],[0,-r],[-r*Math.sqrt(3)/2,-r/2],[-r*Math.sqrt(3)/2,r/2]]}function MC(r){eo(r,"__to_be_destroyed__",!0)}function Uu(r){return An(r,"__to_be_destroyed__",!1)}var SC=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Hu extends rr{constructor(e,t){super(e,Object.assign({},Hu.defaultOptions,t)),this.onCollapseExpand=n=>SC(this,void 0,void 0,function*(){if(!this.validate(n))return;const{target:i}=n;if(!cC(i))return;const s=i.id,{model:a,graph:o}=this.context,l=a.getElementDataById(s);if(!l)return!1;const{onCollapse:u,onExpand:c,animation:d,align:h}=this.options;Wn(l)?(yield o.expandElement(s,{animation:d,align:h}),c==null||c(s)):(yield o.collapseElement(s,{animation:d,align:h}),u==null||u(s))}),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`node:${t}`,this.onCollapseExpand),e.on(`combo:${t}`,this.onCollapseExpand)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`node:${t}`,this.onCollapseExpand),e.off(`combo:${t}`,this.onCollapseExpand)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Hu.defaultOptions={enable:!0,animation:!0,trigger:te.DBLCLICK,align:!0};var wl=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};const TC="g6-create-edge-assist-edge-id",xl="g6-create-edge-assist-node-id";class Xu extends rr{constructor(e,t){super(e,Object.assign({},Xu.defaultOptions,t)),this.drop=n=>wl(this,void 0,void 0,function*(){const{targetType:i}=n;["combo","node"].includes(i)&&this.source?yield this.handleCreateEdge(n):yield this.cancelEdge()}),this.handleCreateEdge=n=>wl(this,void 0,void 0,function*(){var i,s,a;if(!this.validate(n))return;const{graph:o,canvas:l,batch:u,element:c}=this.context,{style:d}=this.options;if(this.source){this.createEdge(n),yield this.cancelEdge();return}u.startBatch(),l.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([n.target.id])[0];const h=o.getElementData(this.source);o.addNodeData([{id:xl,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(i=h.style)===null||i===void 0?void 0:i.x,y:(s=h.style)===null||s===void 0?void 0:s.y}}]),o.addEdgeData([{id:TC,source:this.source,target:xl,style:Object.assign({pointerEvents:"none"},d)}]),yield(a=c.draw({animation:!1}))===null||a===void 0?void 0:a.finished}),this.updateAssistEdge=n=>wl(this,void 0,void 0,function*(){var i;if(!this.source)return;const{model:s,element:a}=this.context;s.translateNodeTo(xl,[n.canvas.x,n.canvas.y]),yield(i=a.draw({animation:!1,silence:!0}))===null||i===void 0?void 0:i.finished}),this.createEdge=n=>{var i,s;const{graph:a}=this.context,{style:o,onFinish:l,onCreate:u}=this.options;if(((i=n.target)===null||i===void 0?void 0:i.id)===void 0||this.source===void 0)return;const d=(s=this.getSelectedNodeIDs([n.target.id]))===null||s===void 0?void 0:s[0],h=`${this.source}-${d}-${E2()}`,f=u({id:h,source:this.source,target:d,style:o});a.addEdgeData([f]),l(f)},this.cancelEdge=()=>wl(this,void 0,void 0,function*(){var n;if(!this.source)return;const{graph:i,element:s,batch:a}=this.context;i.removeNodeData([xl]),this.source=void 0,yield(n=s.draw({animation:!1}))===null||n===void 0?void 0:n.finished,a.endBatch()}),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;this.unbindEvents(),t==="click"?(e.on(hr.CLICK,this.handleCreateEdge),e.on(hs.CLICK,this.handleCreateEdge),e.on(ci.CLICK,this.cancelEdge),e.on(ou.CLICK,this.cancelEdge)):(e.on(hr.DRAG_START,this.handleCreateEdge),e.on(hs.DRAG_START,this.handleCreateEdge),e.on(te.POINTER_UP,this.drop)),e.on(te.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;e.off(hr.CLICK,this.handleCreateEdge),e.off(hs.CLICK,this.handleCreateEdge),e.off(ci.CLICK,this.cancelEdge),e.off(ou.CLICK,this.cancelEdge),e.off(hr.DRAG_START,this.handleCreateEdge),e.off(hs.DRAG_START,this.handleCreateEdge),e.off(te.POINTER_UP,this.drop),e.off(te.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Xu.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:r=>r,onFinish:()=>{}};var iv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class qu extends rr{constructor(e,t){super(e,Object.assign({},qu.defaultOptions,t)),this.isDragging=!1,this.onDragStart=n=>{this.validate(n)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=n=>{var i,s,a,o;if(!this.isDragging||Rt.isPinching)return;const l=(s=(i=n.movement)===null||i===void 0?void 0:i.x)!==null&&s!==void 0?s:n.dx,u=(o=(a=n.movement)===null||a===void 0?void 0:a.y)!==null&&o!==void 0?o:n.dy;(l|u)!==0&&this.translate([l,u],!1)},this.onDragEnd=()=>{var n,i;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},this.invokeOnFinish=vo(()=>{var n,i;(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},300),this.shortcut=new va(e.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(Bt(e)){const{up:t=[],down:n=[],left:i=[],right:s=[]}=e;this.shortcut.bind(t,a=>this.onTranslate([0,1],a)),this.shortcut.bind(n,a=>this.onTranslate([0,-1],a)),this.shortcut.bind(i,a=>this.onTranslate([1,0],a)),this.shortcut.bind(s,a=>this.onTranslate([-1,0],a))}else{const{graph:t}=this.context;t.on(te.DRAG_START,this.onDragStart),t.on(te.DRAG,this.onDrag),t.on(te.DRAG_END,this.onDragEnd)}}onTranslate(e,t){return iv(this,void 0,void 0,function*(){if(!this.validate(t))return;const{sensitivity:n}=this.options,i=n*-1;yield this.translate(ni(e,i),this.options.animation),this.invokeOnFinish()})}translate(e,t){return iv(this,void 0,void 0,function*(){e=this.clampByDirection(e),e=this.clampByRange(e),yield this.context.graph.translateBy(e,t)})}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[s,a]=i.getSize(),[o,l,u,c]=Vr(this.options.range),d=[a*o,s*l,a*u,s*c],h=Zi(Gf(n.getCanvasCenter()),d),f=it(n.getViewportCenter(),[e,t,0]);if(!Sr(f,h)){const{min:[g,v],max:[p,y]}=h;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return typeof t=="function"?t(e):!!t}unbindEvents(){this.shortcut.unbindAll();const{graph:e}=this.context;e.off(te.DRAG_START,this.onDragStart),e.off(te.DRAG,this.onDrag),e.off(te.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}qu.defaultOptions={enable:r=>"targetType"in r?r.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var sv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class No extends rr{constructor(e,t){super(e,Object.assign({},No.defaultOptions,t)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=n=>sv(this,void 0,void 0,function*(){var i;if(this.options.dropEffect!=="link")return;const{model:s,element:a}=this.context,o=n.target.id;this.target.forEach(l=>{const u=s.getParentData(l,st);u&&q(u)===o&&s.refreshComboData(o),s.setParent(l,o,st)}),yield(i=a==null?void 0:a.draw({animation:!0}))===null||i===void 0?void 0:i.finished}),this.setCursor=n=>{if(this.isDragging)return;const{type:i}=n,{canvas:s}=this.context,{cursor:a}=this.options;i===te.POINTER_ENTER?s.setCursor((a==null?void 0:a.grab)||"grab"):s.setCursor((a==null?void 0:a.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.on(`${i}:${te.DRAG_START}`,this.onDragStart),e.on(`${i}:${te.DRAG}`,this.onDrag),e.on(`${i}:${te.DRAG_END}`,this.onDragEnd),e.on(`${i}:${te.POINTER_ENTER}`,this.setCursor),e.on(`${i}:${te.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(e.on(hs.DROP,this.onDrop),e.on(ci.DROP,this.onDrop))}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}getDelta(e){const t=this.context.graph.getZoom();return Tr([e.dx,e.dy],t)}onDragStart(e){var t;if(this.enable=this.validate(e),!this.enable)return;const{batch:n,canvas:i,graph:s}=this.context;i.setCursor(((t=this.options.cursor)===null||t===void 0?void 0:t.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const a=e.target.id;s.getElementState(a).includes(this.options.state)?this.target=this.getSelectedNodeIDs([a]):this.target=[a],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.options.shadow?this.moveShadow(t):this.moveElement(this.target,t)}onDragEnd(){var e,t,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:a=0,y:o=0}=this.shadow.attributes,[l,u]=it([+a,+o],this.shadowOrigin);this.moveElement(this.target,[l,u])}this.showEdges(),(t=(e=this.options).onFinish)===null||t===void 0||t.call(e,this.target);const{batch:i,canvas:s}=this.context;i.endBatch(),s.setCursor(((n=this.options.cursor)===null||n===void 0?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}moveElement(e,t){return sv(this,void 0,void 0,function*(){const{graph:n,model:i}=this.context,{dropEffect:s}=this.options;s==="move"&&e.forEach(a=>i.refreshComboData(a)),n.translateElementBy(Object.fromEntries(e.map(a=>[a,t])),!1)})}moveShadow(e){if(!this.shadow)return;const{x:t=0,y:n=0}=this.shadow.attributes,[i,s]=e;this.shadow.attr({x:+t+i,y:+n+s})}createShadow(e){const t=Yt(this.options,"shadow"),n=Eo(e.map(u=>this.context.element.getElement(u).getBounds())),[i,s]=n.min;this.shadowOrigin=[i,s];const[a,o]=qi(n),l={width:a,height:o,x:i,y:s};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},t),l),{visibility:"visible"})):(this.shadow=new pn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},t),l),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:e,shadow:t}=this.options;if(e==="none"||t)return;const{graph:n}=this.context;e==="all"?this.hiddenEdges=n.getEdgeData().map(q):this.hiddenEdges=Array.from(new Set(this.target.map(i=>n.getRelatedEdgesData(i,e).map(q)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.off(`${i}:${te.DRAG_START}`,this.onDragStart),e.off(`${i}:${te.DRAG}`,this.onDrag),e.off(`${i}:${te.DRAG_END}`,this.onDragEnd),e.off(`${i}:${te.POINTER_ENTER}`,this.setCursor),e.off(`${i}:${te.POINTER_LEAVE}`,this.setCursor)}),e.off(`combo:${te.DROP}`,this.onDrop),e.off(`canvas:${te.DROP}`,this.onDrop)}destroy(){var e;this.unbindEvents(),(e=this.shadow)===null||e===void 0||e.destroy(),super.destroy()}}No.defaultOptions={animation:!0,enable:r=>["node","combo"].includes(r.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var OC="*",Zu=function(){function r(){this._events={}}return r.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},r.prototype.once=function(e,t){return this.on(e,t,!0)},r.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var s=this._events[e]||[],a=this._events[OC]||[],o=function(l){for(var u=l.length,c=0;c<u;c++)if(l[c]){var d=l[c],h=d.callback,f=d.once;f&&(l.splice(c,1),l.length===0&&delete t._events[e],u--,c--),h.apply(t,n)}};o(s),o(a)},r.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var n=this._events[e]||[],i=n.length,s=0;s<i;s++)n[s].callback===t&&(n.splice(s,1),i--,s--);n.length===0&&delete this._events[e]}return this},r.prototype.getEvents=function(){return this._events},r}();function nf(r,e,t,n){for(;r.length;){const i=r.shift();if(t(i))return!0;e.add(i.id),n(i.id).forEach(a=>{e.has(a.id)||(e.add(a.id),r.push(a))})}return!1}function pu(r,e,t,n){if(t(r))return!0;e.add(r.id);for(const s of n(r.id))if(!e.has(s.id)&&pu(s,e,t,n))return!0;return!1}const av=()=>!0;class kC{constructor(e){vt(this,"graph");vt(this,"nodeFilter");vt(this,"edgeFilter");vt(this,"cacheEnabled");vt(this,"inEdgesMap",new Map);vt(this,"outEdgesMap",new Map);vt(this,"bothEdgesMap",new Map);vt(this,"allNodesMap",new Map);vt(this,"allEdgesMap",new Map);vt(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});vt(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id))});vt(this,"updateCache",e=>{const t=new Set;e.forEach(n=>{const i=this.bothEdgesMap.get(n);if(i&&i.forEach(s=>t.add(s.id)),!this.hasNode(n))this.inEdgesMap.delete(n),this.outEdgesMap.delete(n),this.bothEdgesMap.delete(n),this.allNodesMap.delete(n);else{const s=this.graph.getRelatedEdges(n,"in").filter(this.edgeFilter),a=this.graph.getRelatedEdges(n,"out").filter(this.edgeFilter),o=Array.from(new Set([...s,...a]));o.forEach(l=>t.add(l.id)),this.inEdgesMap.set(n,s),this.outEdgesMap.set(n,a),this.bothEdgesMap.set(n,o),this.allNodesMap.set(n,this.graph.getNode(n))}}),t.forEach(n=>{this.hasEdge(n)?this.allEdgesMap.set(n,this.graph.getEdge(n)):this.allEdgesMap.delete(n)})});vt(this,"handleGraphChanged",e=>{const t=new Set;e.changes.forEach(n=>{switch(n.type){case"NodeAdded":t.add(n.value.id);break;case"NodeDataUpdated":t.add(n.id);break;case"EdgeAdded":t.add(n.value.source),t.add(n.value.target);break;case"EdgeUpdated":(n.propertyName==="source"||n.propertyName==="target")&&(t.add(n.oldValue),t.add(n.newValue));break;case"EdgeDataUpdated":if(e.graph.hasEdge(n.id)){const i=e.graph.getEdge(n.id);t.add(i.source),t.add(i.target)}break;case"EdgeRemoved":t.add(n.value.source),t.add(n.value.target);break;case"NodeRemoved":t.add(n.value.id);break}}),this.updateCache(t)});this.graph=e.graph;const t=e.nodeFilter||av,n=e.edgeFilter||av;this.nodeFilter=t,this.edgeFilter=i=>{const{source:s,target:a}=this.graph.getEdgeDetail(i.id);return!t(s)||!t(a)?!1:n(i,s,a)},e.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):e.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(e){this.getNode(e)}hasNode(e){if(!this.graph.hasNode(e))return!1;const t=this.graph.getNode(e);return this.nodeFilter(t)}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(n=>n.id===e)}getNode(e){const t=this.graph.getNode(e);if(!this.nodeFilter(t))throw new Error("Node not found for id: "+e);return t}getRelatedEdges(e,t){return this.checkNodeExistence(e),this.cacheEnabled?t==="in"?this.inEdgesMap.get(e):t==="out"?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter)}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){const n=this.getRelatedEdges(e,"out").map(i=>this.getNode(i.target));return Array.from(new Set(n))}getPredecessors(e){const n=this.getRelatedEdges(e,"in").map(i=>this.getNode(i.source));return Array.from(new Set(n))}getNeighbors(e){const t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}hasEdge(e){if(!this.graph.hasEdge(e))return!1;const t=this.graph.getEdge(e);return this.edgeFilter(t)}getEdge(e){const t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw new Error("Edge not found for id: "+e);return t}getEdgeDetail(e){const t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}hasTreeStructure(e){return this.graph.hasTreeStructure(e)}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter)}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter)}getParent(e,t){this.checkNodeExistence(e);const n=this.graph.getParent(e,t);return!n||!this.nodeFilter(n)?null:n}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];nf([this.getNode(e)],new Set,t,i)}dfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];pu(this.getNode(e),new Set,t,i)}}let en=class eb extends Zu{constructor(t){super();vt(this,"nodeMap",new Map);vt(this,"edgeMap",new Map);vt(this,"inEdgesMap",new Map);vt(this,"outEdgesMap",new Map);vt(this,"bothEdgesMap",new Map);vt(this,"treeIndices",new Map);vt(this,"changes",[]);vt(this,"batchCount",0);vt(this,"onChanged",()=>{});vt(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const n={graph:this,changes:t};this.emit("changed",n),this.onChanged(n)}reduceChanges(t){let n=[];return t.forEach(i=>{switch(i.type){case"NodeRemoved":{let s=!1;n=n.filter(a=>{if(a.type==="NodeAdded"){const o=a.value.id===i.value.id;return o&&(s=!0),!o}else{if(a.type==="NodeDataUpdated")return a.id!==i.value.id;if(a.type==="TreeStructureChanged")return a.nodeId!==i.value.id}return!0}),s||n.push(i);break}case"EdgeRemoved":{let s=!1;n=n.filter(a=>{if(a.type==="EdgeAdded"){const o=a.value.id===i.value.id;return o&&(s=!0),!o}else if(a.type==="EdgeDataUpdated"||a.type==="EdgeUpdated")return a.id!==i.value.id;return!0}),s||n.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const s=n.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),a=n[s];a?i.propertyName!==void 0?a.newValue=i.newValue:(n.splice(s,1),n.push(i)):n.push(i);break}case"TreeStructureDetached":{n=n.filter(s=>s.type==="TreeStructureAttached"||s.type==="TreeStructureChanged"?s.treeKey!==i.treeKey:!0),n.push(i);break}case"TreeStructureChanged":{const s=n.find(a=>a.type==="TreeStructureChanged"&&a.treeKey===i.treeKey&&a.nodeId===i.nodeId);s?s.newParentId=i.newParentId:n.push(i);break}default:n.push(i);break}}),n}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,n){return this.getNeighbors(n).some(i=>i.id===t)}getNode(t){const n=this.nodeMap.get(t);if(!n)throw new Error("Node not found for id: "+t);return n}getRelatedEdges(t,n){if(this.checkNodeExistence(t),n==="in"){const i=this.inEdgesMap.get(t);return Array.from(i)}else if(n==="out"){const i=this.outEdgesMap.get(t);return Array.from(i)}else{const i=this.bothEdgesMap.get(t);return Array.from(i)}}getDegree(t,n){return this.getRelatedEdges(t,n).length}getSuccessors(t){const i=this.getRelatedEdges(t,"out").map(s=>this.getNode(s.target));return Array.from(new Set(i))}getPredecessors(t){const i=this.getRelatedEdges(t,"in").map(s=>this.getNode(s.source));return Array.from(new Set(i))}getNeighbors(t){const n=this.getPredecessors(t),i=this.getSuccessors(t);return Array.from(new Set([...n,...i]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(n=>{n.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const n of t)this.doAddNode(n)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const n=this.getNode(t),i=this.bothEdgesMap.get(t);i==null||i.forEach(s=>this.doRemoveEdge(s.id)),this.nodeMap.delete(t),this.treeIndices.forEach(s=>{var o,l;(o=s.childrenMap.get(t))==null||o.forEach(u=>{s.parentMap.delete(u.id)});const a=s.parentMap.get(t);a&&((l=s.childrenMap.get(a.id))==null||l.delete(n)),s.parentMap.delete(t),s.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:n})}removeNodes(t){this.batch(()=>{t.forEach(n=>this.doRemoveNode(n))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,n,i){const s=this.getNode(t);this.batch(()=>{const a=s.data[n],o=i;s.data[n]=o,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:n,oldValue:a,newValue:o})})}mergeNodeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,s])=>{this.updateNodeDataProperty(t,i,s)})})}updateNodeData(...t){const n=t[0],i=this.getNode(n);if(typeof t[1]=="string"){this.updateNodeDataProperty(n,t[1],t[2]);return}let s;if(typeof t[1]=="function"){const a=t[1];s=a(i.data)}else typeof t[1]=="object"&&(s=t[1]);this.batch(()=>{const a=i.data,o=s;i.data=s,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:a,newValue:o})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const n=this.getEdge(t);return{edge:n,source:this.getNode(n.source),target:this.getNode(n.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const n=this.inEdgesMap.get(t.target),i=this.outEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.target);n.add(t),i.add(t),s.add(t),a.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const n of t)this.doAddEdge(n)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const n=this.getEdge(t),i=this.outEdgesMap.get(n.source),s=this.inEdgesMap.get(n.target),a=this.bothEdgesMap.get(n.source),o=this.bothEdgesMap.get(n.target);i.delete(n),s.delete(n),a.delete(n),o.delete(n),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:n})}removeEdges(t){this.batch(()=>{t.forEach(n=>this.doRemoveEdge(n))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const s=i.source,a=n;this.outEdgesMap.get(s).delete(i),this.bothEdgesMap.get(s).delete(i),this.outEdgesMap.get(a).add(i),this.bothEdgesMap.get(a).add(i),i.source=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:s,newValue:a})})}updateEdgeTarget(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const s=i.target,a=n;this.inEdgesMap.get(s).delete(i),this.bothEdgesMap.get(s).delete(i),this.inEdgesMap.get(a).add(i),this.bothEdgesMap.get(a).add(i),i.target=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:s,newValue:a})})}updateEdgeDataProperty(t,n,i){const s=this.getEdge(t);this.batch(()=>{const a=s.data[n],o=i;s.data[n]=o,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:n,oldValue:a,newValue:o})})}updateEdgeData(...t){const n=t[0],i=this.getEdge(n);if(typeof t[1]=="string"){this.updateEdgeDataProperty(n,t[1],t[2]);return}let s;if(typeof t[1]=="function"){const a=t[1];s=a(i.data)}else typeof t[1]=="object"&&(s=t[1]);this.batch(()=>{const a=i.data,o=s;i.data=s,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:a,newValue:o})})}mergeEdgeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,s])=>{this.updateEdgeDataProperty(t,i,s)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,n){this.batch(()=>{this.attachTreeStructure(n);const i=[],s=Array.isArray(t)?t:[t];for(;s.length;){const a=s.shift();i.push(a),a.children&&s.push(...a.children)}this.addNodes(i),i.forEach(a=>{var o;(o=a.children)==null||o.forEach(l=>{this.setParent(l.id,a.id,n)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(n=>!this.getParent(n.id,t))}getChildren(t,n){this.checkNodeExistence(t),this.checkTreeExistence(n);const s=this.treeIndices.get(n).childrenMap.get(t);return Array.from(s||[])}getParent(t,n){return this.checkNodeExistence(t),this.checkTreeExistence(n),this.treeIndices.get(n).parentMap.get(t)||null}getAncestors(t,n){const i=[];let s=this.getNode(t),a;for(;a=this.getParent(s.id,n);)i.push(a),s=a;return i}setParent(t,n,i){var c,d;this.checkTreeExistence(i);const s=this.treeIndices.get(i);if(!s)return;const a=this.getNode(t),o=s.parentMap.get(t);if((o==null?void 0:o.id)===n)return;if(n==null){o&&((c=s.childrenMap.get(o.id))==null||c.delete(a)),s.parentMap.delete(t);return}const l=this.getNode(n);s.parentMap.set(t,l),o&&((d=s.childrenMap.get(o.id))==null||d.delete(a));let u=s.childrenMap.get(l.id);u||(u=new Set,s.childrenMap.set(l.id,u)),u.add(a),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:t,oldParentId:o==null?void 0:o.id,newParentId:l.id})})}dfsTree(t,n,i){const s=a=>this.getChildren(a,i);return pu(this.getNode(t),new Set,n,s)}bfsTree(t,n,i){const s=a=>this.getChildren(a,i);return nf([this.getNode(t)],new Set,n,s)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,n,i="out"){const s={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return nf([this.getNode(t)],new Set,n,s)}dfs(t,n,i="out"){const s={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return pu(this.getNode(t),new Set,n,s)}clone(){const t=this.getAllNodes().map(s=>({...s,data:{...s.data}})),n=this.getAllEdges().map(s=>({...s,data:{...s.data}})),i=new eb({nodes:t,edges:n});return this.treeIndices.forEach(({parentMap:s,childrenMap:a},o)=>{const l=new Map;s.forEach((c,d)=>{l.set(d,i.getNode(c.id))});const u=new Map;a.forEach((c,d)=>{u.set(d,new Set(Array.from(c).map(h=>i.getNode(h.id))))}),i.treeIndices.set(o,{parentMap:l,childrenMap:u})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new kC({graph:this,...t})}};class Ku{constructor(e,t){this.context=e,this.options=t||{}}}var NC=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},AC=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function CC(r){const{type:e}=r;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function PC(r){return!Array.isArray(r)&&(r==null?void 0:r.preLayout)}function zl(r){const{nodes:e,edges:t}=r,n={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const s=i.data._isCombo?n.combos:n.nodes,{x:a,y:o,z:l=0}=i.data;s==null||s.push({id:i.id,style:{x:a,y:o,z:l}})}),t.forEach(i=>{const{id:s,source:a,target:o,data:{points:l=[],controlPoints:u=l.slice(1,l.length-1)}}=i;n.edges.push({id:s,source:a,target:o,style:Object.assign({},u!=null&&u.length?{controlPoints:u.map(fn)}:{})})}),n}function _C(r,e){class t extends Ku{constructor(i,s){if(super(i,s),this.instance=new r({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const a=this.instance;this.stop=a.stop.bind(a),this.tick=o=>{const l=a.tick(o);return zl(l)}}}execute(i,s){return NC(this,void 0,void 0,function*(){return zl(yield this.instance.execute(this.graphData2LayoutModel(i),this.transformOptions(Ln({},this.options,s))))})}transformOptions(i){const{onTick:s}=i;return s&&(i.onTick=a=>s(zl(a))),i}graphData2LayoutModel(i){const{nodes:s=[],edges:a=[],combos:o=[]}=i,l=s.map(f=>{const g=q(f),{data:v,style:p,combo:y}=f,b=AC(f,["data","style","combo"]),E={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),{data:v}),y?{parentId:y}:{}),{style:p}),b)};return p!=null&&p.x&&Object.assign(E.data,{x:p.x}),p!=null&&p.y&&Object.assign(E.data,{y:p.y}),p!=null&&p.z&&Object.assign(E.data,{z:p.z}),E}),u=new Map(l.map(f=>[f.id,f])),c=a.filter(f=>{const{source:g,target:v}=f;return u.has(g)&&u.has(v)}).map(f=>{const{source:g,target:v,data:p,style:y}=f;return{id:q(f),source:g,target:v,data:Object.assign({},p),style:Object.assign({},y)}}),d=o.map(f=>({id:q(f),data:Object.assign({_isCombo:!0},f.data),style:Object.assign({},f.style)})),h=new en({nodes:[...l,...d],edges:c});return e.model.model.hasTreeStructure(st)&&(h.attachTreeStructure(st),l.forEach(f=>{const g=e.model.model.getParent(f.id,st);g&&h.hasNode(g.id)&&h.setParent(f.id,g.id,st)})),h}}return t}function Od(r,e,...t){if(e in r)return r[e](...t);if("instance"in r){const n=r.instance;if(e in n)return n[e](...t)}return null}function ov(r,e){if(e in r)return r[e];if("instance"in r){const t=r.instance;if(e in t)return t[e]}return null}var LC=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class DC extends No{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(Yr.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(e,t){return LC(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,s)=>{const{x:a=0,y:o=0}=i.style||{};n&&Od(n,"setFixedPosition",e[s],[...ze([+a,+o],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&ov(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(n=>{const{x:i=0,y:s=0}=n.style||{};t&&Od(t,"setFixedPosition",q(n),[+i,+s])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&ov(e,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(t=>{e&&Od(e,"setFixedPosition",q(t),[null,null,null])})}}var lv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Qu extends rr{constructor(e,t){super(e,Object.assign({},Qu.defaultOptions,t)),this.isZoomEvent=n=>!!(n.data&&"scale"in n.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=n=>lv(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context,{state:s,nodeFilter:a,edgeFilter:o,comboFilter:l}=this.options,u=(s?i.getElementDataByState("node",s):i.getNodeData()).filter(a),c=(s?i.getElementDataByState("edge",s):i.getEdgeData()).filter(o),d=(s?i.getElementDataByState("combo",s):i.getComboData()).filter(l),h=this.isZoomEvent(n)?this.zoom=Math.max(.01,Math.min(n.data.scale,10)):this.zoom,f=[...u,...d];f.length>0&&f.forEach(g=>this.fixNodeLike(g,h)),this.updateRelatedEdges(),c.length>0&&c.forEach(g=>this.fixEdge(g,h))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(n,i,s)=>{var a;const o=this.cachedStyles.get(n)||[],l=((a=o.find(u=>u.shape===i))===null||a===void 0?void 0:a.style)||{};return s in l||(l[s]=i.attributes[s],this.cachedStyles.set(n,[...o.filter(u=>u.shape!==i),{shape:i,style:l}])),l[s]},this.scaleEntireElement=(n,i,s)=>{i.setLocalScale(1/s);const a=this.cachedStyles.get(n)||[];a.push({shape:i}),this.cachedStyles.set(n,a)},this.scaleSpecificShapes=(n,i,s)=>{const a=LN(n);(Array.isArray(s)?s:[s]).forEach(l=>{const{shape:u,fields:c}=l,d=typeof u=="function"?u(a):n.getShape(u);if(d){if(!c){this.scaleEntireElement(n.id,d,i);return}c.forEach(h=>{const f=this.getOriginalFieldValue(n.id,d,h);ye(f)&&(d.style[h]=f/i)})}})},this.skipIfExceedViewport=n=>{const{viewport:i}=this.context;return!(i!=null&&i.isInViewport(n.getRenderBounds(),!1,30))},this.fixNodeLike=(n,i)=>{const s=q(n),{element:a,model:o}=this.context,l=a.getElement(s);if(!l||this.skipIfExceedViewport(l))return;o.getRelatedEdgesData(s).forEach(d=>this.relatedEdgeToUpdate.add(q(d)));const c=this.options[l.type];if(!c){this.scaleEntireElement(s,l,i);return}this.scaleSpecificShapes(l,i,c)},this.fixEdge=(n,i)=>{const s=q(n),a=this.context.element.getElement(s);if(!a||this.skipIfExceedViewport(a))return;const o=this.options.edge;if(!o){a.style.transformOrigin="center",this.scaleEntireElement(s,a,i);return}this.scaleSpecificShapes(a,i,o)},this.updateRelatedEdges=()=>{const{element:n}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(i=>{const s=n.getElement(i);s==null||s.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=n=>lv(this,void 0,void 0,function*(){var i;!((i=n.data)===null||i===void 0)&&i.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(i=>{i.forEach(({shape:s,style:a})=>{if(Ir(a))s.setLocalScale(1);else{if(this.options.state)return;Object.entries(a).forEach(([o,l])=>s.style[o]=l)}})});const{graph:e,element:t}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(i=>i&&e.getElementType(i)==="node");if(n.length>0){const i=new Set;n.forEach(s=>{e.getRelatedEdgesData(s).forEach(a=>i.add(q(a)))}),i.forEach(s=>{const a=t==null?void 0:t.getElement(s);a==null||a.update({})})}}}bindEvents(){const{graph:e}=this.context;e.on(fe.AFTER_DRAW,this.resetTransform),e.on(fe.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:e}=this.context;e.off(fe.AFTER_DRAW,this.resetTransform),e.off(fe.AFTER_TRANSFORM,this.fixElementSize)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Qu.defaultOptions={enable:r=>r.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var IC=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Ju extends rr{constructor(e,t){super(e,Object.assign({},Ju.defaultOptions,t)),this.focus=n=>IC(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context;yield i.focusElement(n.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),ks.forEach(t=>{e.on(`${t}:${te.CLICK}`,this.focus)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;ks.forEach(t=>{e.off(`${t}:${te.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}Ju.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class ec extends rr{constructor(e,t){super(e,Object.assign({},ec.defaultOptions,t)),this.isFrozen=!1,this.toggleFrozen=n=>{this.isFrozen=n.type==="dragstart"},this.hoverElement=n=>{if(!this.validate(n))return;const i=n.type===te.POINTER_ENTER;this.updateElementsState(n,i);const{onHover:s,onHoverEnd:a}=this.options;i?s==null||s(n):a==null||a(n)},this.updateElementsState=(n,i)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:s}=this.context,{state:a,animation:o,inactiveState:l}=this.options,u=this.getActiveIds(n),c={};if(a&&Object.assign(c,this.getElementsState(u,a,i)),l){const d=g1(s.getData(),!0).filter(h=>!u.includes(h));Object.assign(c,this.getElementsState(d,l,i))}s.setElementState(c,o)},this.getElementsState=(n,i,s)=>{const{graph:a}=this.context,o={};return n.forEach(l=>{const u=a.getElementState(l);s?o[l]=u.includes(i)?u:[...u,i]:o[l]=u.filter(c=>c!==i)}),o},this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),ks.forEach(n=>{e.on(`${n}:${te.POINTER_ENTER}`,this.hoverElement),e.on(`${n}:${te.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.addEventListener(`${te.DRAG_START}`,this.toggleFrozen),t.addEventListener(`${te.DRAG_END}`,this.toggleFrozen)}getActiveIds(e){const{graph:t}=this.context,{degree:n,direction:i}=this.options,s=e.target.id;return n?T1(t,e.targetType,s,typeof n=="function"?n(e):n,i):[s]}validate(e){if(this.destroyed||this.isFrozen||Uu(e.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;ks.forEach(n=>{e.off(`${n}:${te.POINTER_ENTER}`,this.hoverElement),e.off(`${n}:${te.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.removeEventListener(`${te.DRAG_START}`,this.toggleFrozen),t.removeEventListener(`${te.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}ec.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class RC extends Mo{onPointerDown(e){if(!super.validate(e)||!super.isKeydown()||this.points)return;const{canvas:t}=this.context;this.pathShape=new Kn({id:"g6-lasso-select",style:this.options.style}),t.appendChild(this.pathShape),this.points=[cu(e)]}onPointerMove(e){var t;if(!this.points)return;const{immediately:n,mode:i}=this.options;this.points.push(cu(e)),(t=this.pathShape)===null||t===void 0||t.setAttribute("d",NN(this.points)),n&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var e;(e=this.pathShape)===null||e===void 0||e.remove(),this.pathShape=void 0,this.points=void 0}}class tc extends rr{constructor(e,t){super(e,Object.assign({},tc.defaultOptions,t)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(n,i,s)=>{n.filter(Boolean).forEach(a=>{i==="hidden"&&!a.isVisible()?this.hiddenShapes.push(a):i==="visible"&&this.hiddenShapes.includes(a)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(a),1):Ts(a,i,s)})},this.filterShapes=(n,i)=>{if(Ee(i))return a=>!i(n,a);const s=i==null?void 0:i[n];return a=>a.className?!(s!=null&&s.includes(a.className)):!0},this.hideShapes=n=>{if(!this.validate(n)||!this.isVisible)return;const{element:i}=this.context,{shapes:s={}}=this.options;this.setElementsVisibility(i.getNodes(),"hidden",this.filterShapes("node",s)),this.setElementsVisibility(i.getEdges(),"hidden",this.filterShapes("edge",s)),this.setElementsVisibility(i.getCombos(),"hidden",this.filterShapes("combo",s)),this.isVisible=!1},this.showShapes=vo(n=>{if(!this.validate(n)||this.isVisible)return;const{element:i}=this.context;this.setElementsVisibility(i.getNodes(),"visible"),this.setElementsVisibility(i.getEdges(),"visible"),this.setElementsVisibility(i.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:e}=this.context;e.on(fe.BEFORE_TRANSFORM,this.hideShapes),e.on(fe.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:e}=this.context;e.off(fe.BEFORE_TRANSFORM,this.hideShapes),e.off(fe.AFTER_TRANSFORM,this.showShapes)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}tc.defaultOptions={enable:!0,debounce:200,shapes:r=>r==="node"};var uv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class nc extends rr{constructor(e,t){super(e,Object.assign({},nc.defaultOptions,t)),this.onWheel=n=>uv(this,void 0,void 0,function*(){this.options.preventDefault&&n.preventDefault();const i=n.deltaX,s=n.deltaY;yield this.scroll([-i,-s],n)}),this.shortcut=new va(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){var e,t;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Bt(n)){(e=this.graphDom)===null||e===void 0||e.removeEventListener(te.WHEEL,this.onWheel);const{up:i=[],down:s=[],left:a=[],right:o=[]}=n;this.shortcut.bind(i,l=>this.scroll([0,-10],l)),this.shortcut.bind(s,l=>this.scroll([0,10],l)),this.shortcut.bind(a,l=>this.scroll([-10,0],l)),this.shortcut.bind(o,l=>this.scroll([10,0],l))}else(t=this.graphDom)===null||t===void 0||t.addEventListener(te.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(e){const{sensitivity:t}=this.options;return e=ni(e,t),e=this.clampByDirection(e),e=this.clampByRange(e),e}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[s,a]=i.getSize(),[o,l,u,c]=Vr(this.options.range),d=[a*o,s*l,a*u,s*c],h=Zi(Gf(n.getCanvasCenter()),d),f=it(n.getViewportCenter(),[e,t,0]);if(!Sr(f,h)){const{min:[g,v],max:[p,y]}=h;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}scroll(e,t){return uv(this,void 0,void 0,function*(){if(!this.validate(t))return;const{onFinish:n}=this.options,i=this.context.graph,s=this.formatDisplacement(e);yield i.translateBy(s,!1),n==null||n()})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.graphDom)===null||e===void 0||e.removeEventListener(te.WHEEL,this.onWheel),super.destroy()}}nc.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var cv=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class rc extends rr{constructor(e,t){super(e,Object.assign({},rc.defaultOptions,t)),this.zoom=(n,i,s)=>cv(this,void 0,void 0,function*(){if(!this.validate(i))return;const{graph:a}=this.context;let o;"viewport"in i&&(o=fn(i.viewport));const{sensitivity:l,onFinish:u}=this.options,c=1+At(n,-50,50)*l/100,d=a.getZoom();yield a.zoomTo(d*c,s,o),u==null||u()}),this.onReset=()=>cv(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=n=>{this.options.preventDefault&&n.preventDefault()},this.shortcut=new va(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e))if(e.includes(te.PINCH))this.shortcut.bind([te.PINCH],t=>{this.zoom(t.scale,t,!1)});else{const t=this.context.canvas.getContainer();t==null||t.addEventListener(te.WHEEL,this.preventDefault),this.shortcut.bind([...e,te.WHEEL],n=>{const{deltaX:i,deltaY:s}=n;this.zoom(-(s??i),n,!1)})}if(typeof e=="object"){const{zoomIn:t=[],zoomOut:n=[],reset:i=[]}=e;this.shortcut.bind(t,s=>this.zoom(10,s,this.options.animation)),this.shortcut.bind(n,s=>this.zoom(-10,s,this.options.animation)),this.shortcut.bind(i,this.onReset)}}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Ee(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.context.canvas.getContainer())===null||e===void 0||e.removeEventListener(te.WHEEL,this.preventDefault),super.destroy()}}rc.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var kd,dv;function Ji(){if(dv)return kd;dv=1;function r(e,t,n,i){return i===void 0&&(i="height"),n==="center"?(e[i]+t[i])/2:e.height}return kd={assign:Object.assign,getHeight:r},kd}var Nd,hv;function tb(){if(hv)return Nd;hv=1;var r=Ji(),e=18,t=e*2,n=e,i={getId:function(l){return l.id||l.name},getPreH:function(l){return l.preH||0},getPreV:function(l){return l.preV||0},getHGap:function(l){return l.hgap||n},getVGap:function(l){return l.vgap||n},getChildren:function(l){return l.children},getHeight:function(l){return l.height||t},getWidth:function(l){var u=l.label||" ";return l.width||u.split("").length*e}};function s(o,l){var u=this;if(u.vgap=u.hgap=0,o instanceof s)return o;u.data=o;var c=l.getHGap(o),d=l.getVGap(o);return u.preH=l.getPreH(o),u.preV=l.getPreV(o),u.width=l.getWidth(o),u.height=l.getHeight(o),u.width+=u.preH,u.height+=u.preV,u.id=l.getId(o),u.x=u.y=0,u.depth=0,u.children||(u.children=[]),u.addGap(c,d),u}r.assign(s.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(l,u){var c=this;c.hgap+=l,c.vgap+=u,c.width+=2*l,c.height+=2*u},eachNode:function(l){for(var u=this,c=[u],d;d=c.shift();)l(d),c=d.children.concat(c)},DFTraverse:function(l){this.eachNode(l)},BFTraverse:function(l){for(var u=this,c=[u],d;d=c.shift();)l(d),c=c.concat(d.children)},getBoundingBox:function(){var l={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(u){l.left=Math.min(l.left,u.x),l.top=Math.min(l.top,u.y),l.width=Math.max(l.width,u.x+u.width),l.height=Math.max(l.height,u.y+u.height)}),l},translate:function(l,u){l===void 0&&(l=0),u===void 0&&(u=0),this.eachNode(function(c){c.x+=l,c.y+=u,c.x+=c.preH,c.y+=c.preV})},right2left:function(){var l=this,u=l.getBoundingBox();l.eachNode(function(c){c.x=c.x-(c.x-u.left)*2-c.width}),l.translate(u.width,0)},bottom2top:function(){var l=this,u=l.getBoundingBox();l.eachNode(function(c){c.y=c.y-(c.y-u.top)*2-c.height}),l.translate(0,u.height)}});function a(o,l,u){l===void 0&&(l={}),l=r.assign({},i,l);var c=new s(o,l),d=[c],h;if(!u&&!o.collapsed){for(;h=d.shift();)if(!h.data.collapsed){var f=l.getChildren(h.data),g=f?f.length:0;if(h.children=new Array(g),f&&g)for(var v=0;v<g;v++){var p=new s(f[v],l);h.children[v]=p,d.push(p),p.parent=h,p.depth=h.depth+1}}}return c}return Nd=a,Nd}var Ad,fv;function ic(){if(fv)return Ad;fv=1;var r=tb(),e=function(){function t(i,s){s===void 0&&(s={});var a=this;a.options=s,a.rootNode=r(i,s)}var n=t.prototype;return n.execute=function(){throw new Error("please override this method")},t}();return Ad=e,Ad}var Cd,gv;function jC(){if(gv)return Cd;gv=1;function r(a,o,l,u){u===void 0&&(u=[]);var c=this;c.w=a||0,c.h=o||0,c.y=l||0,c.x=0,c.c=u||[],c.cs=u.length,c.prelim=0,c.mod=0,c.shift=0,c.change=0,c.tl=null,c.tr=null,c.el=null,c.er=null,c.msel=0,c.mser=0}r.fromNode=function(a,o){if(!a)return null;var l=[];return a.children.forEach(function(u){l.push(r.fromNode(u,o))}),o?new r(a.height,a.width,a.x,l):new r(a.width,a.height,a.y,l)};function e(a,o,l){l?a.y+=o:a.x+=o,a.children.forEach(function(u){e(u,o,l)})}function t(a,o){var l=o?a.y:a.x;return a.children.forEach(function(u){l=Math.min(t(u,o),l)}),l}function n(a,o){var l=t(a,o);e(a,-l,o)}function i(a,o,l){l?o.y=a.x:o.x=a.x,a.c.forEach(function(u,c){i(u,o.children[c],l)})}function s(a,o,l){l===void 0&&(l=0),o?(a.x=l,l+=a.width):(a.y=l,l+=a.height),a.children.forEach(function(u){s(u,o,l)})}return Cd=function(a,o){o===void 0&&(o={});var l=o.isHorizontal;function u(O){if(O.cs===0){c(O);return}u(O.c[0]);for(var C=k(v(O.c[0].el),0,null),P=1;P<O.cs;++P){u(O.c[P]);var L=v(O.c[P].er);d(O,P,C),C=k(L,P,C)}b(O),c(O)}function c(O){O.cs===0?(O.el=O,O.er=O,O.msel=O.mser=0):(O.el=O.c[0].el,O.msel=O.c[0].msel,O.er=O.c[O.cs-1].er,O.mser=O.c[O.cs-1].mser)}function d(O,C,P){for(var L=O.c[C-1],R=L.mod,z=O.c[C],Y=z.mod;L!==null&&z!==null;){v(L)>P.low&&(P=P.nxt);var U=R+L.prelim+L.w-(Y+z.prelim);U>0&&(Y+=U,h(O,C,P.index,U));var V=v(L),W=v(z);V<=W&&(L=g(L),L!==null&&(R+=L.mod)),V>=W&&(z=f(z),z!==null&&(Y+=z.mod))}!L&&z?p(O,C,z,Y):L&&!z&&y(O,C,L,R)}function h(O,C,P,L){O.c[C].mod+=L,O.c[C].msel+=L,O.c[C].mser+=L,T(O,C,P,L)}function f(O){return O.cs===0?O.tl:O.c[0]}function g(O){return O.cs===0?O.tr:O.c[O.cs-1]}function v(O){return O.y+O.h}function p(O,C,P,L){var R=O.c[0].el;R.tl=P;var z=L-P.mod-O.c[0].msel;R.mod+=z,R.prelim-=z,O.c[0].el=O.c[C].el,O.c[0].msel=O.c[C].msel}function y(O,C,P,L){var R=O.c[C].er;R.tr=P;var z=L-P.mod-O.c[C].mser;R.mod+=z,R.prelim-=z,O.c[C].er=O.c[C-1].er,O.c[C].mser=O.c[C-1].mser}function b(O){O.prelim=(O.c[0].prelim+O.c[0].mod+O.c[O.cs-1].mod+O.c[O.cs-1].prelim+O.c[O.cs-1].w)/2-O.w/2}function E(O,C){C+=O.mod,O.x=O.prelim+C,S(O);for(var P=0;P<O.cs;P++)E(O.c[P],C)}function T(O,C,P,L){if(P!==C-1){var R=C-P;O.c[P+1].shift+=L/R,O.c[C].shift-=L/R,O.c[C].change-=L-L/R}}function S(O){for(var C=0,P=0,L=0;L<O.cs;L++)C+=O.c[L].shift,P+=C+O.c[L].change,O.c[L].mod+=P}function k(O,C,P){for(;P!==null&&O>=P.low;)P=P.nxt;return{low:O,index:C,nxt:P}}s(a,l);var A=r.fromNode(a,l);return u(A),E(A,0),i(A,a,l),n(a,l),a},Cd}var Pd,pv;function nb(){if(pv)return Pd;pv=1;var r=tb();return Pd=function(e,t){for(var n=r(e.data,t,!0),i=r(e.data,t,!0),s=e.children.length,a=Math.round(s/2),o=t.getSide||function(d,h){return h<a?"right":"left"},l=0;l<s;l++){var u=e.children[l],c=o(u,l);c==="right"?i.children.push(u):n.children.push(u)}return n.eachNode(function(d){d.isRoot()||(d.side="left")}),i.eachNode(function(d){d.isRoot()||(d.side="right")}),{left:n,right:i}},Pd}var _d,vv;function sg(){if(vv)return _d;vv=1;var r=nb(),e=["LR","RL","TB","BT","H","V"],t=["LR","RL","H"],n=function(o){return t.indexOf(o)>-1},i=e[0];_d=function(a,o,l){var u=o.direction||i;if(o.isHorizontal=n(u),e.indexOf(u)===-1)throw new TypeError("Invalid direction: "+u);if(u===e[0])l(a,o);else if(u===e[1])l(a,o),a.right2left();else if(u===e[2])l(a,o);else if(u===e[3])l(a,o),a.bottom2top();else if(u===e[4]||u===e[5]){var c=r(a,o),d=c.left,h=c.right;l(d,o),l(h,o),o.isHorizontal?d.right2left():d.bottom2top(),h.translate(d.x-h.x,d.y-h.y),a.x=d.x,a.y=h.y;var f=a.getBoundingBox();o.isHorizontal?f.top<0&&a.translate(0,-f.top):f.left<0&&a.translate(-f.left,0)}var g=o.fixedRoot;return g===void 0&&(g=!0),g&&a.translate(-(a.x+a.width/2+a.hgap),-(a.y+a.height/2+a.vgap)),s(a,o),a};function s(a,o){if(o.radial){var l=o.isHorizontal?["x","y"]:["y","x"],u=l[0],c=l[1],d={x:1/0,y:1/0},h={x:-1/0,y:-1/0},f=0;a.DFTraverse(function(p){f++;var y=p.x,b=p.y;d.x=Math.min(d.x,y),d.y=Math.min(d.y,b),h.x=Math.max(h.x,y),h.y=Math.max(h.y,b)});var g=h[c]-d[c];if(g===0)return;var v=Math.PI*2/f;a.DFTraverse(function(p){var y=(p[c]-d[c])/g*(Math.PI*2-v)+v,b=p[u]-a[u];p.x=Math.cos(y)*b,p.y=Math.sin(y)*b})}}return _d}var Ld,mv;function BC(){if(mv)return Ld;mv=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(u,c)}var t=ic(),n=jC(),i=sg(),s=Ji(),a=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var d=c.prototype;return d.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=s.assign({},o,c),new a(u,c).execute()}return Ld=l,Ld}var Dd,yv;function zC(){if(yv)return Dd;yv=1;var r=Ji();function e(i,s){s===void 0&&(s=[]);var a=this;a.x=a.y=0,a.leftChild=a.rightChild=null,a.height=0,a.children=s}var t={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function n(i,s,a){a?(s.x=i.x,s.y=i.y):(s.x=i.y,s.y=i.x),i.children.forEach(function(o,l){n(o,s.children[l],a)})}return Dd=function(i,s){s===void 0&&(s={}),s=r.assign({},t,s);var a=0;function o(h){if(!h)return null;h.width=0,h.depth&&h.depth>a&&(a=h.depth);var f=h.children,g=f.length,v=new e(h.height,[]);return f.forEach(function(p,y){var b=o(p);v.children.push(b),y===0&&(v.leftChild=b),y===g-1&&(v.rightChild=b)}),v.originNode=h,v.isLeaf=h.isLeaf(),v}function l(h){if(h.isLeaf||h.children.length===0)h.drawingDepth=a;else{var f=h.children.map(function(v){return l(v)}),g=Math.min.apply(null,f);h.drawingDepth=g-1}return h.drawingDepth}var u;function c(h){h.x=h.drawingDepth*s.rankSep,h.isLeaf?(h.y=0,u&&(h.y=u.y+u.height+s.nodeSep,h.originNode.parent!==u.originNode.parent&&(h.y+=s.subTreeSep)),u=h):(h.children.forEach(function(f){c(f)}),h.y=(h.leftChild.y+h.rightChild.y)/2)}var d=o(i);return l(d),c(d),n(d,i,s.isHorizontal),i},Dd}var Id,bv;function FC(){if(bv)return Id;bv=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(u,c)}var t=ic(),n=zC(),i=sg(),s=Ji(),a=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var d=c.prototype;return d.execute=function(){var f=this;return f.rootNode.width=0,i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=s.assign({},o,c),new a(u,c).execute()}return Id=l,Id}var Rd,wv;function $C(){if(wv)return Rd;wv=1;var r=Ji();function e(t,n,i,s,a){var o=(typeof i=="function"?i(t):i)*t.depth;if(!s)try{if(t.id===t.parent.children[0].id){t.x+=o,t.y=n?n.y:0;return}}catch{}if(t.x+=o,n){if(t.y=n.y+r.getHeight(n,t,a),n.parent&&t.parent.id!==n.parent.id){var l=n.parent,u=l.y+r.getHeight(l,t,a);t.y=u>t.y?u:t.y}}else t.y=0}return Rd=function(t,n,i,s){var a=null;t.eachNode(function(o){e(o,a,n,i,s),a=o})},Rd}var jd,xv;function WC(){if(xv)return jd;xv=1;function r(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,e(d,h)}function e(d,h){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,g){return f.__proto__=g,f},e(d,h)}var t=ic(),n=$C(),i=nb(),s=Ji(),a=["LR","RL","H"],o=a[0],l=function(d){function h(){return d.apply(this,arguments)||this}r(h,d);var f=h.prototype;return f.execute=function(){var v=this,p=v.options,y=v.rootNode;p.isHorizontal=!0;var b=p.indent,E=b===void 0?20:b,T=p.dropCap,S=T===void 0?!0:T,k=p.direction,A=k===void 0?o:k,O=p.align;if(A&&a.indexOf(A)===-1)throw new TypeError("Invalid direction: "+A);if(A===a[0])n(y,E,S,O);else if(A===a[1])n(y,E,S,O),y.right2left();else if(A===a[2]){var C=i(y,p),P=C.left,L=C.right;n(P,E,S,O),P.right2left(),n(L,E,S,O);var R=P.getBoundingBox();L.translate(R.width,0),y.x=L.x-y.width/2}return y},h}(t),u={};function c(d,h){return h=s.assign({},u,h),new l(d,h).execute()}return jd=c,jd}var Bd,Ev;function GC(){if(Ev)return Bd;Ev=1;var r=Ji();function e(i,s){var a=0;return i.children.length?i.children.forEach(function(o){a+=e(o,s)}):a=i.height,i._subTreeSep=s.getSubTreeSep(i.data),i.totalHeight=Math.max(i.height,a)+2*i._subTreeSep,i.totalHeight}function t(i){var s=i.children,a=s.length;if(a){s.forEach(function(h){t(h)});var o=s[0],l=s[a-1],u=l.y-o.y+l.height,c=0;if(s.forEach(function(h){c+=h.totalHeight}),u>i.height)i.y=o.y+u/2-i.height/2;else if(s.length!==1||i.height>c){var d=i.y+(i.height-u)/2-o.y;s.forEach(function(h){h.translate(0,d)})}else i.y=(o.y+o.height/2+l.y+l.height/2)/2-i.height/2}}var n={getSubTreeSep:function(){return 0}};return Bd=function(i,s){s===void 0&&(s={}),s=r.assign({},n,s),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse(function(a){a.x=a.parent.x+a.parent.width}),i.parent=null,e(i,s),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode(function(a){var o=a.children,l=o.length;if(l){var u=o[0];if(u.startY=a.startY+a._subTreeSep,l===1)u.y=a.y+a.height/2-u.height/2;else{u.y=u.startY+u.totalHeight/2-u.height/2;for(var c=1;c<l;c++){var d=o[c];d.startY=o[c-1].startY+o[c-1].totalHeight,d.y=d.startY+d.totalHeight/2-d.height/2}}}}),t(i)},Bd}var zd,Mv;function YC(){if(Mv)return zd;Mv=1;function r(u,c){u.prototype=Object.create(c.prototype),u.prototype.constructor=u,e(u,c)}function e(u,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(u,c)}var t=ic(),n=GC(),i=sg(),s=Ji(),a=function(u){function c(){return u.apply(this,arguments)||this}r(c,u);var d=c.prototype;return d.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function l(u,c){return c=s.assign({},o,c),new a(u,c).execute()}return zd=l,zd}var Fd,Sv;function VC(){if(Sv)return Fd;Sv=1;var r={compactBox:BC(),dendrogram:FC(),indented:WC(),mindmap:YC()};return Fd=r,Fd}var El=VC();const UC=(r,e)=>{if(r!=="next"&&r!=="prev")return e},Tv=r=>{r.prev.next=r.next,r.next.prev=r.prev,delete r.next,delete r.prev};let HC=class{constructor(){const e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){const e=this.shortcut,t=e.prev;if(t&&t!==e)return Tv(t),t}enqueue(e){const t=this.shortcut;e.prev&&e.next&&Tv(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){const e=[],t=this.shortcut;let n=t.prev;for(;n!==t;)e.push(JSON.stringify(n,UC)),n=n==null?void 0:n.prev;return`[${e.join(", ")}]`}};class XC extends HC{}const qC=()=>1,ZC=(r,e)=>{var t;if(r.getAllNodes().length<=1)return[];const n=QC(r,e||qC);return(t=KC(n.graph,n.buckets,n.zeroIdx).map(s=>r.getRelatedEdges(s.v,"out").filter(({target:a})=>a===s.w)))===null||t===void 0?void 0:t.flat()},KC=(r,e,t)=>{let n=[];const i=e[e.length-1],s=e[0];let a;for(;r.getAllNodes().length;){for(;a=s.dequeue();)$d(r,e,t,a);for(;a=i.dequeue();)$d(r,e,t,a);if(r.getAllNodes().length){for(let o=e.length-2;o>0;--o)if(a=e[o].dequeue(),a){n=n.concat($d(r,e,t,a,!0));break}}}return n},$d=(r,e,t,n,i)=>{var s,a;const o=[];return r.hasNode(n.v)&&((s=r.getRelatedEdges(n.v,"in"))===null||s===void 0||s.forEach(l=>{const u=l.data.weight,c=r.getNode(l.source);i&&o.push({v:l.source,w:l.target,in:0,out:0}),c.data.out===void 0&&(c.data.out=0),c.data.out-=u,rf(e,t,Object.assign({v:c.id},c.data))}),(a=r.getRelatedEdges(n.v,"out"))===null||a===void 0||a.forEach(l=>{const u=l.data.weight,c=l.target,d=r.getNode(c);d.data.in===void 0&&(d.data.in=0),d.data.in-=u,rf(e,t,Object.assign({v:d.id},d.data))}),r.removeNode(n.v)),i?o:void 0},QC=(r,e)=>{const t=new en;let n=0,i=0;r.getAllNodes().forEach(l=>{t.addNode({id:l.id,data:{v:l.id,in:0,out:0}})}),r.getAllEdges().forEach(l=>{const u=t.getRelatedEdges(l.source,"out").find(d=>d.target===l.target),c=(e==null?void 0:e(l))||1;u?t.updateEdgeData(u==null?void 0:u.id,Object.assign(Object.assign({},u.data),{weight:u.data.weight+c})):t.addEdge({id:l.id,source:l.source,target:l.target,data:{weight:c}}),i=Math.max(i,t.getNode(l.source).data.out+=c),n=Math.max(n,t.getNode(l.target).data.in+=c)});const s=[],a=i+n+3;for(let l=0;l<a;l++)s.push(new XC);const o=n+1;return t.getAllNodes().forEach(l=>{rf(s,o,Object.assign({v:l.id},t.getNode(l.id).data))}),{buckets:s,zeroIdx:o,graph:t}},rf=(r,e,t)=>{t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)},JC=(r,e)=>{const n=ZC(r,(i=>s=>s.data.weight||1)());n==null||n.forEach(i=>{const s=i.data;r.removeEdge(i.id),s.forwardName=i.data.name,s.reversed=!0,r.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},s)})})},eP=r=>{r.getAllEdges().forEach(e=>{const t=e.data;if(t.reversed){r.removeEdge(e.id);const n=t.forwardName;delete t.reversed,delete t.forwardName,r.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},t),{forwardName:n})})}})},tP=(r,e)=>Number(r)-Number(e),ba=(r,e,t,n)=>{let i;do i=`${n}${Math.random()}`;while(r.hasNode(i));return t.dummy=e,r.addNode({id:i,data:t}),i},nP=r=>{const e=new en;return r.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{const n=e.getRelatedEdges(t.source,"out").find(i=>i.target===t.target);n?e.updateEdgeData(n==null?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e},rb=r=>{const e=new en;return r.getAllNodes().forEach(t=>{r.getChildren(t.id).length||e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{e.addEdge(t)}),e},rP=(r,e)=>r==null?void 0:r.reduce((t,n,i)=>(t[n]=e[i],t),{}),Ov=(r,e)=>{const t=Number(r.x),n=Number(r.y),i=Number(e.x)-t,s=Number(e.y)-n;let a=Number(r.width)/2,o=Number(r.height)/2;if(!i&&!s)return{x:0,y:0};let l,u;return Math.abs(s)*a>Math.abs(i)*o?(s<0&&(o=-o),l=o*i/s,u=o):(i<0&&(a=-a),l=a,u=a*s/i),{x:t+l,y:n+u}},lo=r=>{const e=[],t=ib(r)+1;for(let n=0;n<t;n++)e.push([]);r.getAllNodes().forEach(n=>{const i=n.data.rank;i!==void 0&&e[i]&&e[i].push(n.id)});for(let n=0;n<t;n++)e[n]=e[n].sort((i,s)=>tP(r.getNode(i).data.order,r.getNode(s).data.order));return e},iP=r=>{const e=r.getAllNodes().filter(n=>n.data.rank!==void 0).map(n=>n.data.rank),t=Math.min(...e);r.getAllNodes().forEach(n=>{n.data.hasOwnProperty("rank")&&t!==1/0&&(n.data.rank-=t)})},sP=(r,e=0)=>{const t=r.getAllNodes(),n=t.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...n),s=[];t.forEach(o=>{const l=(o.data.rank||0)-i;s[l]||(s[l]=[]),s[l].push(o.id)});let a=0;for(let o=0;o<s.length;o++){const l=s[o];l===void 0?o%e!==0&&(a-=1):a&&(l==null||l.forEach(u=>{const c=r.getNode(u);c&&(c.data.rank=c.data.rank||0,c.data.rank+=a)}))}},kv=(r,e,t,n)=>{const i={width:0,height:0};return ye(t)&&ye(n)&&(i.rank=t,i.order=n),ba(r,"border",i,e)},ib=r=>{let e;return r.getAllNodes().forEach(t=>{const n=t.data.rank;n!==void 0&&(e===void 0||n>e)&&(e=n)}),e||(e=0),e},aP=(r,e)=>{const t={lhs:[],rhs:[]};return r==null||r.forEach(n=>{e(n)?t.lhs.push(n):t.rhs.push(n)}),t},ag=(r,e)=>r.reduce((t,n)=>{const i=e(t),s=e(n);return i>s?n:t}),sb=(r,e,t,n,i,s)=>{n.includes(e.id)||(n.push(e.id),t||s.push(e.id),i(e.id).forEach(a=>sb(r,a,t,n,i,s)),t&&s.push(e.id))},ab=(r,e,t,n)=>{const i=Array.isArray(e)?e:[e],s=l=>r.getNeighbors(l),a=[],o=[];return i.forEach(l=>{if(r.hasNode(l.id))sb(r,l,t==="post",o,s,a);else throw new Error(`Graph does not have node: ${l}`)}),a},oP=r=>{const e=t=>{const n=r.getChildren(t),i=r.getNode(t);if(n!=null&&n.length&&n.forEach(s=>e(s.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let s=i.data.minRank,a=i.data.maxRank+1;s<a;s+=1)Nv(r,"borderLeft","_bl",t,i,s),Nv(r,"borderRight","_br",t,i,s)}};r.getRoots().forEach(t=>e(t.id))},Nv=(r,e,t,n,i,s)=>{const a={rank:s,borderType:e,width:0,height:0},o=i.data[e][s-1],l=ba(r,"border",a,t);i.data[e][s]=l,r.setParent(l,n),o&&r.addEdge({id:`e${Math.random()}`,source:o,target:l,data:{weight:1}})},lP=(r,e)=>{const t=e.toLowerCase();(t==="lr"||t==="rl")&&ob(r)},uP=(r,e)=>{const t=e.toLowerCase();(t==="bt"||t==="rl")&&cP(r),(t==="lr"||t==="rl")&&(dP(r),ob(r))},ob=r=>{r.getAllNodes().forEach(e=>{Av(e)}),r.getAllEdges().forEach(e=>{Av(e)})},Av=r=>{const e=r.data.width;r.data.width=r.data.height,r.data.height=e},cP=r=>{r.getAllNodes().forEach(e=>{Wd(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>Wd(n)),e.data.hasOwnProperty("y")&&Wd(e.data)})},Wd=r=>{r!=null&&r.y&&(r.y=-r.y)},dP=r=>{r.getAllNodes().forEach(e=>{Gd(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>Gd(n)),e.data.hasOwnProperty("x")&&Gd(e.data)})},Gd=r=>{const e=r.x;r.x=r.y,r.y=e},hP=r=>{const e=ba(r,"root",{},"_root"),t=fP(r);let n=Math.max(...Object.values(t));Math.abs(n)===1/0&&(n=1);const i=n-1,s=2*i+1;r.getAllEdges().forEach(o=>{o.data.minlen*=s});const a=gP(r)+1;return r.getRoots().forEach(o=>{lb(r,e,s,a,i,t,o.id)}),{nestingRoot:e,nodeRankFactor:s}},lb=(r,e,t,n,i,s,a)=>{const o=r.getChildren(a);if(!(o!=null&&o.length)){a!==e&&r.addEdge({id:`e${Math.random()}`,source:e,target:a,data:{weight:0,minlen:t}});return}const l=kv(r,"_bt"),u=kv(r,"_bb"),c=r.getNode(a);r.setParent(l,a),c.data.borderTop=l,r.setParent(u,a),c.data.borderBottom=u,o==null||o.forEach(d=>{lb(r,e,t,n,i,s,d.id);const h=d.data.borderTop?d.data.borderTop:d.id,f=d.data.borderBottom?d.data.borderBottom:d.id,g=d.data.borderTop?n:2*n,v=h!==f?1:i-s[a]+1;r.addEdge({id:`e${Math.random()}`,source:l,target:h,data:{minlen:v,weight:g,nestingEdge:!0}}),r.addEdge({id:`e${Math.random()}`,source:f,target:u,data:{minlen:v,weight:g,nestingEdge:!0}})}),r.getParent(a)||r.addEdge({id:`e${Math.random()}`,source:e,target:l,data:{weight:0,minlen:i+s[a]}})},fP=r=>{const e={},t=(n,i)=>{const s=r.getChildren(n);s==null||s.forEach(a=>t(a.id,i+1)),e[n]=i};return r.getRoots().forEach(n=>t(n.id,1)),e},gP=r=>{let e=0;return r.getAllEdges().forEach(t=>{e+=t.data.weight}),e},pP=(r,e)=>{e&&r.removeNode(e),r.getAllEdges().forEach(t=>{t.data.nestingEdge&&r.removeEdge(t.id)})},vP="edge",ub="edge-label",mP=(r,e)=>{r.getAllEdges().forEach(t=>yP(r,t,e))},yP=(r,e,t)=>{let n=e.source,i=r.getNode(n).data.rank;const s=e.target,a=r.getNode(s).data.rank,o=e.data.labelRank;if(a===i+1)return;r.removeEdge(e.id);let l,u,c;for(c=0,++i;i<a;++c,++i)e.data.points=[],u={originalEdge:e,width:0,height:0,rank:i},l=ba(r,vP,u,"_d"),i===o&&(u.width=e.data.width,u.height=e.data.height,u.dummy=ub,u.labelpos=e.data.labelpos),r.addEdge({id:`e${Math.random()}`,source:n,target:l,data:{weight:e.data.weight}}),c===0&&t.push(l),n=l;r.addEdge({id:`e${Math.random()}`,source:n,target:s,data:{weight:e.data.weight}})},bP=(r,e)=>{e.forEach(t=>{let n=r.getNode(t);const{data:i}=n,s=i.originalEdge;let a;s&&r.addEdge(s);let o=t;for(;n.data.dummy;)a=r.getSuccessors(o)[0],r.removeNode(o),s.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===ub&&(s.data.x=n.data.x,s.data.y=n.data.y,s.data.width=n.data.width,s.data.height=n.data.height),o=a.id,n=r.getNode(o)})},wP=(r,e,t)=>{const n={};let i;t==null||t.forEach(s=>{let a=r.getParent(s),o,l;for(;a;){if(o=r.getParent(a.id),o?(l=n[o.id],n[o.id]=a.id):(l=i,i=a.id),l&&l!==a.id){e.hasNode(l)||e.addNode({id:l,data:{}}),e.hasNode(a.id)||e.addNode({id:a.id,data:{}}),e.hasEdge(`e${l}-${a.id}`)||e.addEdge({id:`e${l}-${a.id}`,source:l,target:a.id,data:{}});return}a=o}})},xP=(r,e,t)=>{const n=EP(r),i=new en({tree:[{id:n,children:[],data:{}}]});return r.getAllNodes().forEach(s=>{const a=r.getParent(s.id);(s.data.rank===e||s.data.minRank<=e&&e<=s.data.maxRank)&&(i.hasNode(s.id)||i.addNode(Object.assign({},s)),a!=null&&a.id&&!i.hasNode(a==null?void 0:a.id)&&i.addNode(Object.assign({},a)),i.setParent(s.id,(a==null?void 0:a.id)||n),r.getRelatedEdges(s.id,t).forEach(o=>{const l=o.source===s.id?o.target:o.source;i.hasNode(l)||i.addNode(Object.assign({},r.getNode(l)));const u=i.getRelatedEdges(l,"out").find(({target:d})=>d===s.id),c=u!==void 0?u.data.weight:0;u?i.updateEdgeData(u.id,Object.assign(Object.assign({},u.data),{weight:o.data.weight+c})):i.addEdge({id:o.id,source:l,target:s.id,data:{weight:o.data.weight+c}})}),s.data.hasOwnProperty("minRank")&&i.updateNodeData(s.id,Object.assign(Object.assign({},s.data),{borderLeft:s.data.borderLeft[e],borderRight:s.data.borderRight[e]})))}),i},EP=r=>{let e;for(;r.hasNode(e=`_root${Math.random()}`););return e},MP=(r,e,t)=>{const n=rP(t,t.map((c,d)=>d)),s=e.map(c=>{const d=r.getRelatedEdges(c,"out").map(h=>({pos:n[h.target]||0,weight:h.data.weight}));return d==null?void 0:d.sort((h,f)=>h.pos-f.pos)}).flat().filter(c=>c!==void 0);let a=1;for(;a<t.length;)a<<=1;const o=2*a-1;a-=1;const l=Array(o).fill(0,0,o);let u=0;return s==null||s.forEach(c=>{if(c){let d=c.pos+a;l[d]+=c.weight;let h=0;for(;d>0;)d%2&&(h+=l[d+1]),d=d-1>>1,l[d]+=c.weight;u+=c.weight*h}}),u},Cv=(r,e)=>{let t=0;for(let n=1;n<(e==null?void 0:e.length);n+=1)t+=MP(r,e[n-1],e[n]);return t},Pv=r=>{const e={},t=r.getAllNodes(),n=t.map(u=>{var c;return(c=u.data.rank)!==null&&c!==void 0?c:-1/0}),i=Math.max(...n),s=[];for(let u=0;u<i+1;u++)s.push([]);const a=t.sort((u,c)=>r.getNode(u.id).data.rank-r.getNode(c.id).data.rank),l=a.filter(u=>r.getNode(u.id).data.fixorder!==void 0).sort((u,c)=>r.getNode(u.id).data.fixorder-r.getNode(c.id).data.fixorder);return l==null||l.forEach(u=>{isNaN(r.getNode(u.id).data.rank)||s[r.getNode(u.id).data.rank].push(u.id),e[u.id]=!0}),a==null||a.forEach(u=>r.dfsTree(u.id,c=>{if(e.hasOwnProperty(c.id))return!0;e[c.id]=!0,isNaN(c.data.rank)||s[c.data.rank].push(c.id)})),s},SP=(r,e)=>e.map(t=>{const n=r.getRelatedEdges(t,"in");if(!(n!=null&&n.length))return{v:t};const i={sum:0,weight:0};return n==null||n.forEach(s=>{const a=r.getNode(s.source);i.sum+=s.data.weight*a.data.order,i.weight+=s.data.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}),TP=(r,e)=>{var t,n,i;const s={};r==null||r.forEach((o,l)=>{s[o.v]={i:l,indegree:0,in:[],out:[],vs:[o.v]};const u=s[o.v];o.barycenter!==void 0&&(u.barycenter=o.barycenter,u.weight=o.weight)}),(t=e.getAllEdges())===null||t===void 0||t.forEach(o=>{const l=s[o.source],u=s[o.target];l!==void 0&&u!==void 0&&(u.indegree++,l.out.push(s[o.target]))});const a=(i=(n=Object.values(s)).filter)===null||i===void 0?void 0:i.call(n,o=>!o.indegree);return OP(a)},OP=r=>{var e,t;const n=[],i=l=>u=>{u.merged||(u.barycenter===void 0||l.barycenter===void 0||u.barycenter>=l.barycenter)&&kP(l,u)},s=l=>u=>{u.in.push(l),--u.indegree===0&&r.push(u)};for(;r!=null&&r.length;){const l=r.pop();n.push(l),(e=l.in.reverse())===null||e===void 0||e.forEach(u=>i(l)(u)),(t=l.out)===null||t===void 0||t.forEach(u=>s(l)(u))}const a=n.filter(l=>!l.merged),o=["vs","i","barycenter","weight"];return a.map(l=>{const u={};return o==null||o.forEach(c=>{l[c]!==void 0&&(u[c]=l[c])}),u})},kP=(r,e)=>{var t;let n=0,i=0;r.weight&&(n+=r.barycenter*r.weight,i+=r.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),r.vs=(t=e.vs)===null||t===void 0?void 0:t.concat(r.vs),r.barycenter=n/i,r.weight=i,r.i=Math.min(e.i,r.i),e.merged=!0},NP=(r,e,t,n)=>{const i=aP(r,h=>{const f=h.hasOwnProperty("fixorder")&&!isNaN(h.fixorder);return n?!f&&h.hasOwnProperty("barycenter"):f||h.hasOwnProperty("barycenter")}),s=i.lhs,a=i.rhs.sort((h,f)=>-h.i- -f.i),o=[];let l=0,u=0,c=0;s==null||s.sort(AP(!!e,!!t)),c=_v(o,a,c),s==null||s.forEach(h=>{var f;c+=(f=h.vs)===null||f===void 0?void 0:f.length,o.push(h.vs),l+=h.barycenter*h.weight,u+=h.weight,c=_v(o,a,c)});const d={vs:o.flat()};return u&&(d.barycenter=l/u,d.weight=u),d},_v=(r,e,t)=>{let n=t,i;for(;e.length&&(i=e[e.length-1]).i<=n;)e.pop(),r==null||r.push(i.vs),n++;return n},AP=(r,e)=>(t,n)=>{if(t.fixorder!==void 0&&n.fixorder!==void 0)return t.fixorder-n.fixorder;if(t.barycenter<n.barycenter)return-1;if(t.barycenter>n.barycenter)return 1;if(e&&t.order!==void 0&&n.order!==void 0){if(t.order<n.order)return-1;if(t.order>n.order)return 1}return r?n.i-t.i:t.i-n.i},cb=(r,e,t,n,i,s)=>{var a,o,l,u;let c=r.getChildren(e).map(b=>b.id);const d=r.getNode(e),h=d?d.data.borderLeft:void 0,f=d?d.data.borderRight:void 0,g={};h&&(c=c==null?void 0:c.filter(b=>b!==h&&b!==f));const v=SP(r,c||[]);v==null||v.forEach(b=>{var E;if(!((E=r.getChildren(b.v))===null||E===void 0)&&E.length){const T=cb(r,b.v,t,n,s);g[b.v]=T,T.hasOwnProperty("barycenter")&&PP(b,T)}});const p=TP(v,t);CP(p,g),(a=p.filter(b=>b.vs.length>0))===null||a===void 0||a.forEach(b=>{const E=r.getNode(b.vs[0]);E&&(b.fixorder=E.data.fixorder,b.order=E.data.order)});const y=NP(p,n,i,s);if(h&&(y.vs=[h,y.vs,f].flat(),!((o=r.getPredecessors(h))===null||o===void 0)&&o.length)){const b=r.getNode(((l=r.getPredecessors(h))===null||l===void 0?void 0:l[0].id)||""),E=r.getNode(((u=r.getPredecessors(f))===null||u===void 0?void 0:u[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+b.data.order+E.data.order)/(y.weight+2),y.weight+=2}return y},CP=(r,e)=>{r==null||r.forEach(t=>{var n;const i=(n=t.vs)===null||n===void 0?void 0:n.map(s=>e[s]?e[s].vs:s);t.vs=i.flat()})},PP=(r,e)=>{r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight):(r.barycenter=e.barycenter,r.weight=e.weight)},_P=(r,e)=>{const t=ib(r),n=[],i=[];for(let c=1;c<t+1;c++)n.push(c);for(let c=t-1;c>-1;c--)i.push(c);const s=Lv(r,n,"in"),a=Lv(r,i,"out");let o=Pv(r);Yd(r,o);let l=Number.POSITIVE_INFINITY,u;for(let c=0,d=0;d<4;++c,++d){Dv(c%2?s:a,c%4>=2,!1,e),o=lo(r);const h=Cv(r,o);h<l&&(d=0,u=Gi(o),l=h)}o=Pv(r),Yd(r,o);for(let c=0,d=0;d<4;++c,++d){Dv(c%2?s:a,c%4>=2,!0,e),o=lo(r);const h=Cv(r,o);h<l&&(d=0,u=Gi(o),l=h)}Yd(r,u)},Lv=(r,e,t)=>e.map(n=>xP(r,n,t)),Dv=(r,e,t,n)=>{const i=new en;r==null||r.forEach(s=>{var a;const o=s.getRoots()[0].id,l=cb(s,o,i,e,t,n);for(let u=0;u<((a=l.vs)===null||a===void 0?void 0:a.length);u++){const c=s.getNode(l.vs[u]);c&&(c.data.order=u)}wP(s,i,l.vs)})},Yd=(r,e)=>{e==null||e.forEach(t=>{t==null||t.forEach((n,i)=>{r.getNode(n).data.order=i})})},LP=(r,e)=>{const n=r.getAllNodes().filter(a=>{var o;return!(!((o=r.getChildren(a.id))===null||o===void 0)&&o.length)}).map(a=>a.data.rank),i=Math.max(...n),s=[];for(let a=0;a<i+1;a++)s[a]=[];e==null||e.forEach(a=>{const o=r.getNode(a);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=s[o.data.rank].length,s[o.data.rank].push(a))})},DP=r=>{const e={};let t=0;const n=i=>{const s=t;r.getChildren(i).forEach(a=>n(a.id)),e[i]={low:s,lim:t++}};return r.getRoots().forEach(i=>n(i.id)),e},IP=(r,e,t,n)=>{var i,s;const a=[],o=[],l=Math.min(e[t].low,e[n].low),u=Math.max(e[t].lim,e[n].lim);let c,d;c=t;do c=(i=r.getParent(c))===null||i===void 0?void 0:i.id,a.push(c);while(c&&(e[c].low>l||u>e[c].lim));for(d=c,c=n;c&&c!==d;)o.push(c),c=(s=r.getParent(c))===null||s===void 0?void 0:s.id;return{lca:d,path:a.concat(o.reverse())}},RP=(r,e)=>{const t=DP(r);e.forEach(n=>{var i,s;let a=n,o=r.getNode(a);const l=o.data.originalEdge;if(!l)return;const u=IP(r,t,l.source,l.target),c=u.path,d=u.lca;let h=0,f=c[h],g=!0;for(;a!==l.target;){if(o=r.getNode(a),g){for(;f!==d&&((i=r.getNode(f))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)h++,f=c[h];f===d&&(g=!1)}if(!g){for(;h<c.length-1&&((s=r.getNode(c[h+1]))===null||s===void 0?void 0:s.data.minRank)<=o.data.rank;)h++;f=c[h]}r.hasNode(f)&&r.setParent(a,f),a=r.getSuccessors(a)[0].id}})},jP=(r,e)=>{const t={},n=(i,s)=>{let a=0,o=0;const l=i.length,u=s==null?void 0:s[(s==null?void 0:s.length)-1];return s==null||s.forEach((c,d)=>{var h;const f=zP(r,c),g=f?r.getNode(f.id).data.order:l;(f||c===u)&&((h=s.slice(o,d+1))===null||h===void 0||h.forEach(v=>{var p;(p=r.getPredecessors(v))===null||p===void 0||p.forEach(y=>{var b;const E=r.getNode(y.id),T=E.data.order;(T<a||g<T)&&!(E.data.dummy&&(!((b=r.getNode(v))===null||b===void 0)&&b.data.dummy))&&db(t,y.id,v)})}),o=d+1,a=g)}),s};return e!=null&&e.length&&e.reduce(n),t},BP=(r,e)=>{const t={};function n(o,l,u,c,d){var h,f;let g;for(let v=l;v<u;v++)g=o[v],!((h=r.getNode(g))===null||h===void 0)&&h.data.dummy&&((f=r.getPredecessors(g))===null||f===void 0||f.forEach(p=>{const y=r.getNode(p.id);y.data.dummy&&(y.data.order<c||y.data.order>d)&&db(t,p.id,g)}))}function i(o){return JSON.stringify(o.slice(1))}function s(o,l){const u=i(o);l.get(u)||(n(...o),l.set(u,!0))}const a=(o,l)=>{let u=-1,c,d=0;const h=new Map;return l==null||l.forEach((f,g)=>{var v;if(((v=r.getNode(f))===null||v===void 0?void 0:v.data.dummy)==="border"){const p=r.getPredecessors(f)||[];p.length&&(c=r.getNode(p[0].id).data.order,s([l,d,g,u,c],h),d=g,u=c)}s([l,d,l.length,c,o.length],h)}),l};return e!=null&&e.length&&e.reduce(a),t},zP=(r,e)=>{var t,n;if(!((t=r.getNode(e))===null||t===void 0)&&t.data.dummy)return(n=r.getPredecessors(e))===null||n===void 0?void 0:n.find(i=>r.getNode(i.id).data.dummy)},db=(r,e,t)=>{let n=e,i=t;if(n>i){const a=n;n=i,i=a}let s=r[n];s||(r[n]=s={}),s[i]=!0},FP=(r,e,t)=>{let n=e,i=t;if(n>i){const s=e;n=i,i=s}return!!r[n]},$P=(r,e,t,n)=>{const i={},s={},a={};return e==null||e.forEach(o=>{o==null||o.forEach((l,u)=>{i[l]=l,s[l]=l,a[l]=u})}),e==null||e.forEach(o=>{let l=-1;o==null||o.forEach(u=>{let c=n(u).map(d=>d.id);if(c.length){c=c.sort((h,f)=>a[h]-a[f]);const d=(c.length-1)/2;for(let h=Math.floor(d),f=Math.ceil(d);h<=f;++h){const g=c[h];s[u]===u&&l<a[g]&&!FP(t,u,g)&&(s[g]=u,s[u]=i[u]=i[g],l=a[g])}}})}),{root:i,align:s}},WP=(r,e,t,n,i,s,a)=>{var o;const l={},u=GP(r,e,t,i,s,a),c=a?"borderLeft":"borderRight",d=(g,v)=>{let p=u.getAllNodes(),y=p.pop();const b={};for(;y;)b[y.id]?g(y.id):(b[y.id]=!0,p.push(y),p=p.concat(v(y.id))),y=p.pop()},h=g=>{l[g]=(u.getRelatedEdges(g,"in")||[]).reduce((v,p)=>Math.max(v,(l[p.source]||0)+p.data.weight),0)},f=g=>{const v=(u.getRelatedEdges(g,"out")||[]).reduce((y,b)=>Math.min(y,(l[b.target]||0)-b.data.weight),Number.POSITIVE_INFINITY),p=r.getNode(g);v!==Number.POSITIVE_INFINITY&&p.data.borderType!==c&&(l[g]=Math.max(l[g],v))};return d(h,u.getPredecessors.bind(u)),d(f,u.getSuccessors.bind(u)),(o=Object.values(n))===null||o===void 0||o.forEach(g=>{l[g]=l[t[g]]}),l},GP=(r,e,t,n,i,s)=>{const a=new en,o=HP(n,i,s);return e==null||e.forEach(l=>{let u;l==null||l.forEach(c=>{const d=t[c];if(a.hasNode(d)||a.addNode({id:d,data:{}}),u){const h=t[u],f=a.getRelatedEdges(h,"out").find(g=>g.target===d);f?a.updateEdgeData(f.id,Object.assign(Object.assign({},f.data),{weight:Math.max(o(r,c,u),f.data.weight||0)})):a.addEdge({id:`e${Math.random()}`,source:h,target:d,data:{weight:Math.max(o(r,c,u),0)}})}u=c})}),a},YP=(r,e)=>ag(Object.values(e),t=>{var n;let i=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return(n=Object.keys(t))===null||n===void 0||n.forEach(a=>{const o=t[a],l=XP(r,a)/2;i=Math.max(o+l,i),s=Math.min(o-l,s)}),i-s});function VP(r,e){const t=Object.values(e),n=Math.min(...t),i=Math.max(...t);["u","d"].forEach(s=>{["l","r"].forEach(a=>{const o=s+a,l=r[o];let u;if(l===e)return;const c=Object.values(l);u=a==="l"?n-Math.min(...c):i-Math.max(...c),u&&(r[o]={},Object.keys(l).forEach(d=>{r[o][d]=l[d]+u}))})})}const UP=(r,e)=>{const t={};return Object.keys(r.ul).forEach(n=>{if(e)t[n]=r[e.toLowerCase()][n];else{const i=Object.values(r).map(s=>s[n]);t[n]=(i[0]+i[1])/2}}),t},HP=(r,e,t)=>(n,i,s)=>{const a=n.getNode(i),o=n.getNode(s);let l=0,u=0;if(l+=a.data.width/2,a.data.hasOwnProperty("labelpos"))switch((a.data.labelpos||"").toLowerCase()){case"l":u=-a.data.width/2;break;case"r":u=a.data.width/2;break}if(u&&(l+=t?u:-u),u=0,l+=(a.data.dummy?e:r)/2,l+=(o.data.dummy?e:r)/2,l+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":u=o.data.width/2;break;case"r":u=-o.data.width/2;break}return u&&(l+=t?u:-u),u=0,l},XP=(r,e)=>r.getNode(e).data.width||0,qP=(r,e)=>{const{ranksep:t=0}=e||{},n=lo(r);let i=0;n==null||n.forEach(s=>{const a=s.map(l=>r.getNode(l).data.height),o=Math.max(...a,0);s==null||s.forEach(l=>{r.getNode(l).data.y=i+o/2}),i+=o+t})},ZP=(r,e)=>{const{align:t,nodesep:n=0,edgesep:i=0}=e||{},s=lo(r),a=Object.assign(jP(r,s),BP(r,s)),o={};let l=[];["u","d"].forEach(c=>{l=c==="u"?s:Object.values(s).reverse(),["l","r"].forEach(d=>{d==="r"&&(l=l.map(v=>Object.values(v).reverse()));const h=(c==="u"?r.getPredecessors:r.getSuccessors).bind(r),f=$P(r,l,a,h),g=WP(r,l,f.root,f.align,n,i,d==="r");d==="r"&&Object.keys(g).forEach(v=>g[v]=-g[v]),o[c+d]=g})});const u=YP(r,o);return u&&VP(o,u),UP(o,t)},KP=(r,e)=>{var t;const n=rb(r);qP(n,e);const i=ZP(n,e);(t=Object.keys(i))===null||t===void 0||t.forEach(s=>{n.getNode(s).data.x=i[s]})},hb=r=>{const e={},t=n=>{var i;const s=r.getNode(n);if(!s)return 0;if(e[n])return s.data.rank;e[n]=!0;let a;return(i=r.getRelatedEdges(n,"out"))===null||i===void 0||i.forEach(o=>{const l=t(o.target),u=o.data.minlen,c=l-u;c&&(a===void 0||c<a)&&(a=c)}),a||(a=0),s.data.rank=a,a};r.getAllNodes().filter(n=>r.getRelatedEdges(n.id,"in").length===0).forEach(n=>t(n.id))},QP=r=>{const e={};let t;const n=a=>{var o;const l=r.getNode(a);if(!l)return 0;if(e[a])return l.data.rank;e[a]=!0;let u;return(o=r.getRelatedEdges(a,"out"))===null||o===void 0||o.forEach(c=>{const d=n(c.target),h=c.data.minlen,f=d-h;f&&(u===void 0||f<u)&&(u=f)}),u||(u=0),(t===void 0||u<t)&&(t=u),l.data.rank=u,u};r.getAllNodes().filter(a=>r.getRelatedEdges(a.id,"in").length===0).forEach(a=>{a&&n(a.id)}),t===void 0&&(t=0);const i={},s=(a,o)=>{var l;const u=r.getNode(a),c=isNaN(u.data.layer)?o:u.data.layer;(u.data.rank===void 0||u.data.rank<c)&&(u.data.rank=c),!i[a]&&(i[a]=!0,(l=r.getRelatedEdges(a,"out"))===null||l===void 0||l.forEach(d=>{s(d.target,c+d.data.minlen)}))};r.getAllNodes().forEach(a=>{const o=a.data;o&&(isNaN(o.layer)?o.rank-=t:s(a.id,o.layer))})},Hi=(r,e)=>r.getNode(e.target).data.rank-r.getNode(e.source).data.rank-e.data.minlen,JP=r=>{const e=new en({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,s;for(;e_(e,r)<n;)i=fb(e,r),s=e.hasNode(i.source)?Hi(r,i):-Hi(r,i),gb(e,r,s);return e},e_=(r,e)=>{const t=n=>{e.getRelatedEdges(n,"both").forEach(i=>{const s=i.source,a=n===s?i.target:s;!r.hasNode(a)&&!Hi(e,i)&&(r.addNode({id:a,data:{}}),r.addEdge({id:i.id,source:n,target:a,data:{}}),t(a))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},t_=r=>{const e=new en({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,s;for(;n_(e,r)<n;)i=fb(e,r),s=e.hasNode(i.source)?Hi(r,i):-Hi(r,i),gb(e,r,s);return e},n_=(r,e)=>{const t=n=>{var i;(i=e.getRelatedEdges(n,"both"))===null||i===void 0||i.forEach(s=>{const a=s.source,o=n===a?s.target:a;!r.hasNode(o)&&(e.getNode(o).data.layer!==void 0||!Hi(e,s))&&(r.addNode({id:o,data:{}}),r.addEdge({id:s.id,source:n,target:o,data:{}}),t(o))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},fb=(r,e)=>ag(e.getAllEdges(),t=>r.hasNode(t.source)!==r.hasNode(t.target)?Hi(e,t):1/0),gb=(r,e,t)=>{r.getAllNodes().forEach(n=>{const i=e.getNode(n.id);i.data.rank||(i.data.rank=0),i.data.rank+=t})},r_=r=>{const e=nP(r);hb(e);const t=JP(e);vb(t),pb(t,e);let n,i;for(;n=a_(t);)i=o_(t,e,n),l_(t,e,n,i)},pb=(r,e)=>{let t=ab(r,r.getAllNodes(),"post");t=t.slice(0,(t==null?void 0:t.length)-1),t.forEach(n=>{i_(r,e,n)})},i_=(r,e,t)=>{const i=r.getNode(t).data.parent,s=r.getRelatedEdges(t,"both").find(a=>a.target===i||a.source===i);s.data.cutvalue=s_(r,e,t)},s_=(r,e,t)=>{const i=r.getNode(t).data.parent;let s=!0,a=e.getRelatedEdges(t,"out").find(l=>l.target===i),o=0;return a||(s=!1,a=e.getRelatedEdges(i,"out").find(l=>l.target===t)),o=a.data.weight,e.getRelatedEdges(t,"both").forEach(l=>{const u=l.source===t,c=u?l.target:l.source;if(c!==i){const d=u===s,h=l.data.weight;if(o+=d?h:-h,c_(r,t,c)){const f=r.getRelatedEdges(t,"both").find(g=>g.source===c||g.target===c).data.cutvalue;o+=d?-f:f}}}),o},vb=(r,e=r.getAllNodes()[0].id)=>{mb(r,{},1,e)},mb=(r,e,t,n,i)=>{var s;const a=t;let o=t;const l=r.getNode(n);return e[n]=!0,(s=r.getNeighbors(n))===null||s===void 0||s.forEach(u=>{e[u.id]||(o=mb(r,e,o,u.id,n))}),l.data.low=a,l.data.lim=o++,i?l.data.parent=i:delete l.data.parent,o},a_=r=>r.getAllEdges().find(e=>e.data.cutvalue<0),o_=(r,e,t)=>{let n=t.source,i=t.target;e.getRelatedEdges(n,"out").find(c=>c.target===i)||(n=t.target,i=t.source);const s=r.getNode(n),a=r.getNode(i);let o=s,l=!1;s.data.lim>a.data.lim&&(o=a,l=!0);const u=e.getAllEdges().filter(c=>l===Iv(r.getNode(c.source),o)&&l!==Iv(r.getNode(c.target),o));return ag(u,c=>Hi(e,c))},l_=(r,e,t,n)=>{const i=r.getRelatedEdges(t.source,"both").find(s=>s.source===t.target||s.target===t.target);i&&r.removeEdge(i.id),r.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),vb(r),pb(r,e),u_(r,e)},u_=(r,e)=>{const t=r.getAllNodes().find(i=>!i.data.parent);let n=ab(r,t,"pre");n=n.slice(1),n.forEach(i=>{const s=r.getNode(i).data.parent;let a=e.getRelatedEdges(i,"out").find(l=>l.target===s),o=!1;!a&&e.hasNode(s)&&(a=e.getRelatedEdges(s,"out").find(l=>l.target===i),o=!0),e.getNode(i).data.rank=(e.hasNode(s)&&e.getNode(s).data.rank||0)+(o?a==null?void 0:a.data.minlen:-(a==null?void 0:a.data.minlen))})},c_=(r,e,t)=>r.getRelatedEdges(e,"both").find(n=>n.source===t||n.target===t),Iv=(r,e)=>e.data.low<=r.data.lim&&r.data.lim<=e.data.lim,d_=(r,e)=>{switch(e){case"network-simplex":f_(r);break;case"tight-tree":Rv(r);break;case"longest-path":h_(r);break;default:Rv(r)}},h_=hb,Rv=r=>{QP(r),t_(r)},f_=r=>{r_(r)},g_=(r,e)=>{const{edgeLabelSpace:t,keepNodeOrder:n,prevGraph:i,rankdir:s,ranksep:a}=e;!n&&i&&v_(r,i);const o=E_(r);t&&(e.ranksep=M_(o,{rankdir:s,ranksep:a}));let l;try{l=p_(o,e)}catch(u){if(u.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,u);return}throw u}return m_(r,o),l},p_=(r,e)=>{const{ranker:t,rankdir:n="tb",nodeOrder:i,keepNodeOrder:s,align:a,nodesep:o=50,edgesep:l=20,ranksep:u=50}=e;__(r),JC(r);const{nestingRoot:c,nodeRankFactor:d}=hP(r);d_(rb(r),t),S_(r),sP(r,d),pP(r,c),iP(r),T_(r),O_(r);const h=[];mP(r,h),RP(r,h),oP(r),s&&LP(r,i),_P(r,s),L_(r),lP(r,n),KP(r,{align:a,nodesep:o,edgesep:l,ranksep:u}),D_(r),P_(r),bP(r,h),A_(r),uP(r,n);const{width:f,height:g}=k_(r);return N_(r),C_(r),eP(r),{width:f,height:g}},v_=(r,e)=>{r.getAllNodes().forEach(t=>{const n=r.getNode(t.id);if(e.hasNode(t.id)){const i=e.getNode(t.id);n.data.fixorder=i.data._order,delete i.data._order}else delete n.data.fixorder})},m_=(r,e)=>{r.getAllNodes().forEach(t=>{var n;const i=r.getNode(t.id);if(i){const s=e.getNode(t.id);i.data.x=s.data.x,i.data.y=s.data.y,i.data._order=s.data.order,i.data._rank=s.data.rank,!((n=e.getChildren(t.id))===null||n===void 0)&&n.length&&(i.data.width=s.data.width,i.data.height=s.data.height)}}),r.getAllEdges().forEach(t=>{const n=r.getEdge(t.id),i=e.getEdge(t.id);n.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(n.data.x=i.data.x,n.data.y=i.data.y)})},y_=["width","height","layer","fixorder"],b_={width:0,height:0},w_=["minlen","weight","width","height","labeloffset"],x_={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Vd=["labelpos"],E_=r=>{const e=new en({tree:[]});return r.getAllNodes().forEach(t=>{const n=Bv(r.getNode(t.id).data),i=Object.assign(Object.assign({},b_),n),s=jv(i,y_);e.hasNode(t.id)||e.addNode({id:t.id,data:Object.assign({},s)});const a=r.hasTreeStructure("combo")?r.getParent(t.id,"combo"):r.getParent(t.id);Ae(a)||(e.hasNode(a.id)||e.addNode(Object.assign({},a)),e.setParent(t.id,a.id))}),r.getAllEdges().forEach(t=>{const n=Bv(r.getEdge(t.id).data),i={};Vd==null||Vd.forEach(s=>{n[s]!==void 0&&(i[s]=n[s])}),e.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},x_,jv(n,w_),i)})}),e},M_=(r,e)=>{const{ranksep:t=0,rankdir:n}=e;return r.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),r.getAllEdges().forEach(i=>{var s;i.data.minlen*=2,((s=i.data.labelpos)===null||s===void 0?void 0:s.toLowerCase())!=="c"&&(n==="TB"||n==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),t/2},S_=r=>{r.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){const t=r.getNode(e.source),n=r.getNode(e.target),i={e,rank:(n.data.rank-t.data.rank)/2+t.data.rank};ba(r,"edge-proxy",i,"_ep")}})},T_=r=>{let e=0;return r.getAllNodes().forEach(t=>{var n,i;t.data.borderTop&&(t.data.minRank=(n=r.getNode(t.data.borderTop))===null||n===void 0?void 0:n.data.rank,t.data.maxRank=(i=r.getNode(t.data.borderBottom))===null||i===void 0?void 0:i.data.rank,e=Math.max(e,t.data.maxRank||-1/0))}),e},O_=r=>{r.getAllNodes().forEach(e=>{e.data.dummy==="edge-proxy"&&(r.getEdge(e.data.e.id).data.labelRank=e.data.rank,r.removeNode(e.id))})},k_=(r,e)=>{let t,n=0,i,s=0;const{marginx:a=0,marginy:o=0}={},l=u=>{if(!u.data)return;const c=u.data.x,d=u.data.y,h=u.data.width,f=u.data.height;!isNaN(c)&&!isNaN(h)&&(t===void 0&&(t=c-h/2),t=Math.min(t,c-h/2),n=Math.max(n,c+h/2)),!isNaN(d)&&!isNaN(f)&&(i===void 0&&(i=d-f/2),i=Math.min(i,d-f/2),s=Math.max(s,d+f/2))};return r.getAllNodes().forEach(u=>{l(u)}),r.getAllEdges().forEach(u=>{u!=null&&u.data.hasOwnProperty("x")&&l(u)}),t-=a,i-=o,r.getAllNodes().forEach(u=>{u.data.x-=t,u.data.y-=i}),r.getAllEdges().forEach(u=>{var c;(c=u.data.points)===null||c===void 0||c.forEach(d=>{d.x-=t,d.y-=i}),u.data.hasOwnProperty("x")&&(u.data.x-=t),u.data.hasOwnProperty("y")&&(u.data.y-=i)}),{width:n-t+a,height:s-i+o}},N_=r=>{r.getAllEdges().forEach(e=>{const t=r.getNode(e.source),n=r.getNode(e.target);let i,s;e.data.points?(i=e.data.points[0],s=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:n.data.x,y:n.data.y},s={x:t.data.x,y:t.data.y}),e.data.points.unshift(Ov(t.data,i)),e.data.points.push(Ov(n.data,s))})},A_=r=>{r.getAllEdges().forEach(e=>{if(e.data.hasOwnProperty("x"))switch((e.data.labelpos==="l"||e.data.labelpos==="r")&&(e.data.width-=e.data.labeloffset),e.data.labelpos){case"l":e.data.x-=e.data.width/2+e.data.labeloffset;break;case"r":e.data.x+=e.data.width/2+e.data.labeloffset;break}})},C_=r=>{r.getAllEdges().forEach(e=>{var t;e.data.reversed&&((t=e.data.points)===null||t===void 0||t.reverse())})},P_=r=>{r.getAllNodes().forEach(e=>{var t,n,i;if(!((t=r.getChildren(e.id))===null||t===void 0)&&t.length){const s=r.getNode(e.id),a=r.getNode(s.data.borderTop),o=r.getNode(s.data.borderBottom),l=r.getNode(s.data.borderLeft[((n=s.data.borderLeft)===null||n===void 0?void 0:n.length)-1]),u=r.getNode(s.data.borderRight[((i=s.data.borderRight)===null||i===void 0?void 0:i.length)-1]);s.data.width=Math.abs((u==null?void 0:u.data.x)-(l==null?void 0:l.data.x))||10,s.data.height=Math.abs((o==null?void 0:o.data.y)-(a==null?void 0:a.data.y))||10,s.data.x=((l==null?void 0:l.data.x)||0)+s.data.width/2,s.data.y=((a==null?void 0:a.data.y)||0)+s.data.height/2}}),r.getAllNodes().forEach(e=>{e.data.dummy==="border"&&r.removeNode(e.id)})},__=r=>{r.getAllEdges().forEach(e=>{if(e.source===e.target){const t=r.getNode(e.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(e),r.removeEdge(e.id)}})},L_=r=>{const e=lo(r);e==null||e.forEach(t=>{let n=0;t==null||t.forEach((i,s)=>{var a;const o=r.getNode(i);o.data.order=s+n,(a=o.data.selfEdges)===null||a===void 0||a.forEach(l=>{ba(r,"selfedge",{width:l.data.width,height:l.data.height,rank:o.data.rank,order:s+ ++n,e:l},"_se")}),delete o.data.selfEdges})})},D_=r=>{r.getAllNodes().forEach(e=>{const t=r.getNode(e.id);if(t.data.dummy==="selfedge"){const n=r.getNode(t.data.e.source),i=n.data.x+n.data.width/2,s=n.data.y,a=t.data.x-i,o=n.data.height/2;r.hasEdge(t.data.e.id)?r.updateEdgeData(t.data.e.id,t.data.e.data):r.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),r.removeNode(e.id),t.data.e.data.points=[{x:i+2*a/3,y:s-o},{x:i+5*a/6,y:s-o},{y:s,x:i+a},{x:i+5*a/6,y:s+o},{x:i+2*a/3,y:s+o}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},jv=(r,e)=>{const t={};return e==null||e.forEach(n=>{r[n]!==void 0&&(t[n]=+r[n])}),t},Bv=(r={})=>{const e={};return Object.keys(r).forEach(t=>{e[t.toLowerCase()]=r[t]}),e},ii=Array.isArray,yb=r=>{const e=[],t=r.length;for(let n=0;n<t;n+=1){e[n]=[];for(let i=0;i<t;i+=1)n===i?e[n][i]=0:r[n][i]===0||!r[n][i]?e[n][i]=1/0:e[n][i]=r[n][i]}for(let n=0;n<t;n+=1)for(let i=0;i<t;i+=1)for(let s=0;s<t;s+=1)e[i][s]>e[i][n]+e[n][s]&&(e[i][s]=e[i][n]+e[n][s]);return e},bb=(r,e)=>{const{nodes:t,edges:n}=r,i=[],s={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((a,o)=>{s[a.id]=o;const l=[];i.push(l)}),n==null||n.forEach(a=>{const{source:o,target:l}=a,u=s[o],c=s[l];u===void 0||c===void 0||(i[u][c]=1,i[c][u]=1)}),i},I_=(r,e)=>{const t=[];return r.forEach(n=>{const i=[];n.forEach(s=>{i.push(s*e)}),t.push(i)}),t},R_=r=>{let e=1/0,t=1/0,n=-1/0,i=-1/0;return r.forEach(s=>{let a=s.data.size;ii(a)?a.length===1&&(a=[a[0],a[0]]):ye(a)?a=[a,a]:(a===void 0||isNaN(a))&&(a=[30,30]);const o=[a[0]/2,a[1]/2],l=s.data.x-o[0],u=s.data.x+o[0],c=s.data.y-o[1],d=s.data.y+o[1];e>l&&(e=l),t>c&&(t=c),n<u&&(n=u),i<d&&(i=d)}),{minX:e,minY:t,maxX:n,maxY:i}},zv=(r,e)=>Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y)),sf=(r,e,t,n="TB",i,s={})=>{if(!(e!=null&&e.length))return;const{stopBranchFn:a,stopAllFn:o}=s;for(let l=0;l<e.length;l++){const u=e[l];if(r.hasNode(u.id)&&!(a!=null&&a(u))){if(o!=null&&o(u))return;n==="TB"&&t(u),sf(r,r.getChildren(u.id,i),t,n,i,s),n!=="TB"&&t(u)}}},af=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const e=[];return r.forEach(t=>{e.push(t)}),e.map(t=>af(t))}if(typeof r=="object"){const e={};return Object.keys(r).forEach(t=>{e[t]=af(r[t])}),e}return r},Qn=(r,e)=>{const t=af(r);return t.data=t.data||{},e&&(ye(t.data.x)||(t.data.x=Math.random()*e[0]),ye(t.data.y)||(t.data.y=Math.random()*e[1])),t};function Ao(r){if(!r)return[0,0,0];if(ye(r))return[r,r,r];if(r.length===0)return[0,0,0];const[e,t=e,n=e]=r;return[e,t,n]}function bs(r,e){let t;return Ee(e)?t=e:ye(e)?t=()=>e:t=()=>r,t}function og(r,e,t=!0){return!e&&e!==0?n=>{const{size:i}=n.data||{};return i?Array.isArray(i)?t?Math.max(...i)||r:i:Bt(i)&&i.width&&i.height?t?Math.max(i.width,i.height)||r:[i.width,i.height]:i:r}:Ee(e)?e:ye(e)?()=>e:Array.isArray(e)?()=>t?Math.max(...e)||r:e:Bt(e)&&e.width&&e.height?()=>t?Math.max(e.width,e.height)||r:[e.width,e.height]:()=>r}const lg=(r,e,t=10)=>{let n;const i=typeof e=="function"?e:()=>e||0;return r?Array.isArray(r)?n=a=>r:Ee(r)?n=r:n=a=>r:n=a=>{var o,l,u;if(!((o=a.data)===null||o===void 0)&&o.bboxSize)return(l=a.data)===null||l===void 0?void 0:l.bboxSize;if(!((u=a.data)===null||u===void 0)&&u.size){const c=a.data.size;return Array.isArray(c)?c:Bt(c)?[c.width,c.height]:c}return t},a=>{const o=n(a),l=i(a);return Math.max(...Ao(o))+l}},j_={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class B_{constructor(e={}){this.options=e,this.id="antv-dagre",this.options=Object.assign(Object.assign({},j_),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,t)})}genericDagreLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{nodeSize:s,align:a,rankdir:o="TB",ranksep:l,nodesep:u,ranksepFunc:c,nodesepFunc:d,edgeLabelSpace:h,ranker:f,nodeOrder:g,begin:v,controlPoints:p,radial:y,sortByCombo:b,preset:E}=i,T=new en({tree:[]}),S=bs(l||50,c),k=bs(u||50,d);let A=k,O=S;(o==="LR"||o==="RL")&&(A=S,O=k);const C=og(10,s,!1),P=t.getAllNodes(),L=t.getAllEdges();P.forEach(F=>{const K=Ao(C(F)),re=O(F),se=A(F),ae=K[0]+2*se,Ce=K[1]+2*re,Te=F.data.layer;ye(Te)?T.addNode({id:F.id,data:{width:ae,height:Ce,layer:Te}}):T.addNode({id:F.id,data:{width:ae,height:Ce}})}),b&&(T.attachTreeStructure("combo"),P.forEach(F=>{const{parentId:K}=F.data;K!==void 0&&T.hasNode(K)&&T.setParent(F.id,K,"combo")})),L.forEach(F=>{T.addEdge({id:F.id,source:F.source,target:F.target,data:{weight:F.data.weight||1}})});let R;E!=null&&E.length&&(R=new en({nodes:E})),g_(T,{prevGraph:R,edgeLabelSpace:h,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:f,rankdir:o,nodesep:u,align:a});const z=[0,0];if(v){let F=1/0,K=1/0;T.getAllNodes().forEach(re=>{F>re.data.x&&(F=re.data.x),K>re.data.y&&(K=re.data.y)}),T.getAllEdges().forEach(re=>{var se;(se=re.data.points)===null||se===void 0||se.forEach(ae=>{F>ae.x&&(F=ae.x),K>ae.y&&(K=ae.y)})}),z[0]=v[0]-F,z[1]=v[1]-K}const Y=o==="LR"||o==="RL";if(!y){const F=new Set,re=o==="BT"||o==="RL"?(Te,J)=>J-Te:(Te,J)=>Te-J;T.getAllNodes().forEach(Te=>{Te.data.x=Te.data.x+z[0],Te.data.y=Te.data.y+z[1],F.add(Y?Te.data.x:Te.data.y)});const se=Array.from(F).sort(re),ae=Y?(Te,J)=>Te.x!==J.x:(Te,J)=>Te.y!==J.y,Ce=Y?(Te,J,Oe)=>{const _e=Math.max(J.y,Oe.y),Ve=Math.min(J.y,Oe.y);return Te.filter(Qe=>Qe.y<=_e&&Qe.y>=Ve)}:(Te,J,Oe)=>{const _e=Math.max(J.x,Oe.x),Ve=Math.min(J.x,Oe.x);return Te.filter(Qe=>Qe.x<=_e&&Qe.x>=Ve)};T.getAllEdges().forEach((Te,J)=>{var Oe;h&&p&&Te.data.type!=="loop"&&(Te.data.controlPoints=z_((Oe=Te.data.points)===null||Oe===void 0?void 0:Oe.map(({x:_e,y:Ve})=>({x:_e+z[0],y:Ve+z[1]})),T.getNode(Te.source),T.getNode(Te.target),se,Y,ae,Ce))})}let U=[];U=T.getAllNodes().map(F=>Qn(F));const V=T.getAllEdges();return e&&(U.forEach(F=>{t.mergeNodeData(F.id,{x:F.data.x,y:F.data.y})}),V.forEach(F=>{t.mergeEdgeData(F.id,{controlPoints:F.data.controlPoints})})),{nodes:U,edges:V}})}}const z_=(r,e,t,n,i,s,a)=>{let o=(r==null?void 0:r.slice(1,r.length-1))||[];if(e&&t){let{x:l,y:u}=e.data,{x:c,y:d}=t.data;if(i&&(l=e.data.y,u=e.data.x,c=t.data.y,d=t.data.x),d!==u&&l!==c){const h=n.indexOf(u),f=n[h+1];if(f){const p=o[0],y=i?{x:(u+f)/2,y:(p==null?void 0:p.y)||c}:{x:(p==null?void 0:p.x)||c,y:(u+f)/2};(!p||s(p,y))&&o.unshift(y)}const g=n.indexOf(d),v=Math.abs(g-h);if(v===1)o=a(o,e.data,t.data),o.length||o.push(i?{x:(u+d)/2,y:l}:{x:l,y:(u+d)/2});else if(v>1){const p=n[g-1];if(p){const y=o[o.length-1],b=i?{x:(d+p)/2,y:(y==null?void 0:y.y)||c}:{x:(y==null?void 0:y.x)||l,y:(d+p)/2};(!y||s(y,b))&&o.push(b)}}}}return o},Ds=(r,e,t)=>{const n=r.getAllNodes(),i=r.getAllEdges();if(!(n!=null&&n.length))return{nodes:[],edges:i};if(n.length===1)return e&&r.mergeNodeData(n[0].id,{x:t[0],y:t[1]}),{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:t[0],y:t[1]})})],edges:i}},F_={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class $_{constructor(e={}){this.options=e,this.id="circular",this.options=Object.assign(Object.assign({},F_),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,e,t)})}genericCircularLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:s,height:a,center:o,divisions:l,startAngle:u=0,endAngle:c=2*Math.PI,angleRatio:d,ordering:h,clockwise:f,nodeSpacing:g,nodeSize:v}=i,p=t.getAllNodes(),y=t.getAllEdges(),[b,E,T]=G_(s,a,o),S=p==null?void 0:p.length;if(!S||S===1)return Ds(t,e,T);const k=(c-u)/S;let{radius:A,startRadius:O,endRadius:C}=i;if(g){const Y=bs(10,g),U=og(10,v);let V=-1/0;p.forEach(F=>{const K=U(F);V<K&&(V=K)});let W=0;p.forEach((F,K)=>{K===0?W+=V||10:W+=(Y(F)||0)+(V||10)}),A=W/(2*Math.PI)}else!A&&!O&&!C?A=Math.min(E,b)/2:!O&&C?O=C:O&&!C&&(C=O);const P=k*d;let L=[];h==="topology"?L=Fv(t,p):h==="topology-directed"?L=Fv(t,p,!0):h==="degree"?L=W_(t,p):L=p.map(Y=>Qn(Y));const R=Math.ceil(S/l);for(let Y=0;Y<S;++Y){let U=A;!U&&O!==null&&C!==null&&(U=O+Y*(C-O)/(S-1)),U||(U=10+Y*100/(S-1));let V=u+Y%R*P+2*Math.PI/l*Math.floor(Y/R);f||(V=c-Y%R*P-2*Math.PI/l*Math.floor(Y/R)),L[Y].data.x=T[0]+Math.cos(V)*U,L[Y].data.y=T[1]+Math.sin(V)*U}return e&&L.forEach(Y=>{t.mergeNodeData(Y.id,{x:Y.data.x,y:Y.data.y})}),{nodes:L,edges:y}})}}const Fv=(r,e,t=!1)=>{const n=[Qn(e[0])],i={},s=e.length;i[e[0].id]=!0;let a=0;return e.forEach((o,l)=>{if(l!==0)if((l===s-1||r.getDegree(o.id,"both")!==r.getDegree(e[l+1].id,"both")||r.areNeighbors(n[a].id,o.id))&&!i[o.id])n.push(Qn(o)),i[o.id]=!0,a++;else{const u=t?r.getSuccessors(n[a].id):r.getNeighbors(n[a].id);let c=!1;for(let h=0;h<u.length;h++){const f=u[h];if(r.getDegree(f.id)===r.getDegree(o.id)&&!i[f.id]){n.push(Qn(f)),i[f.id]=!0,c=!0;break}}let d=0;for(;!c&&(i[e[d].id]||(n.push(Qn(e[d])),i[e[d].id]=!0,c=!0),d++,d!==s););}}),n};function W_(r,e){const t=[];return e.forEach((n,i)=>{t.push(Qn(n))}),t.sort((n,i)=>r.getDegree(n.id,"both")-r.getDegree(i.id,"both")),t}const G_=(r,e,t)=>{let n=r,i=e,s=t;return!n&&typeof window<"u"&&(n=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),s||(s=[n/2,i/2]),[n,i,s]},Y_={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class of{constructor(e={}){this.options=e,this.id="concentric",this.options=Object.assign(Object.assign({},Y_),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,e,t)})}genericConcentricLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:s,width:a,height:o,sortBy:l,maxLevelDiff:u,sweep:c,clockwise:d,equidistant:h,preventOverlap:f,startAngle:g=3/2*Math.PI,nodeSize:v,nodeSpacing:p}=i,y=t.getAllNodes(),b=t.getAllEdges(),E=!a&&typeof window<"u"?window.innerWidth:a,T=!o&&typeof window<"u"?window.innerHeight:o,S=s||[E/2,T/2];if(!(y!=null&&y.length)||y.length===1)return Ds(t,e,S);const k=[];let A,O=0;ii(v)?A=Math.max(v[0],v[1]):Ee(v)?(A=-1/0,y.forEach(F=>{const K=Math.max(...Ao(v(F)));K>A&&(A=K)})):A=v,ii(p)?O=Math.max(p[0],p[1]):ye(p)&&(O=p),y.forEach(F=>{const K=Qn(F);k.push(K);let re=A;const{data:se}=K;ii(se.size)?re=Math.max(se.size[0],se.size[1]):ye(se.size)?re=se.size:Bt(se.size)&&(re=Math.max(se.size.width,se.size.height)),A=Math.max(A,re),Ee(p)&&(O=Math.max(p(F),O))});const C={};k.forEach((F,K)=>{C[F.id]=K});let P=l;(!Ke(P)||k[0].data[P]===void 0)&&(P="degree"),P==="degree"?k.sort((F,K)=>t.getDegree(K.id,"both")-t.getDegree(F.id,"both")):k.sort((F,K)=>K.data[P]-F.data[P]);const L=k[0],R=(u||(P==="degree"?t.getDegree(L.id,"both"):L.data[P]))/4,z=[{nodes:[]}];let Y=z[0];k.forEach(F=>{if(Y.nodes.length>0){const K=Math.abs(P==="degree"?t.getDegree(Y.nodes[0].id,"both")-t.getDegree(F.id,"both"):Y.nodes[0].data[P]-F.data[P]);R&&K>=R&&(Y={nodes:[]},z.push(Y))}Y.nodes.push(F)});let U=A+O;if(!f){const F=z.length>0&&z[0].nodes.length>1,re=(Math.min(E,T)/2-U)/(z.length+(F?1:0));U=Math.min(U,re)}let V=0;if(z.forEach(F=>{const K=c===void 0?2*Math.PI-2*Math.PI/F.nodes.length:c;if(F.dTheta=K/Math.max(1,F.nodes.length-1),F.nodes.length>1&&f){const re=Math.cos(F.dTheta)-Math.cos(0),se=Math.sin(F.dTheta)-Math.sin(0),ae=Math.sqrt(U*U/(re*re+se*se));V=Math.max(ae,V)}F.r=V,V+=U}),h){let F=0,K=0;for(let re=0;re<z.length;re++){const ae=(z[re].r||0)-K;F=Math.max(F,ae)}K=0,z.forEach((re,se)=>{se===0&&(K=re.r||0),re.r=K,K+=F})}return z.forEach(F=>{const K=F.dTheta||0,re=F.r||0;F.nodes.forEach((se,ae)=>{const Ce=g+(d?1:-1)*K*ae;se.data.x=S[0]+re*Math.cos(Ce),se.data.y=S[1]+re*Math.sin(Ce)})}),e&&k.forEach(F=>t.mergeNodeData(F.id,{x:F.data.x,y:F.data.y})),{nodes:k,edges:b}})}}function V_(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return wb(this.cover(e,t),e,t,r)}function wb(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,s=r._root,a={data:n},o=r._x0,l=r._y0,u=r._x1,c=r._y1,d,h,f,g,v,p,y,b;if(!s)return r._root=a,r;for(;s.length;)if((v=e>=(d=(o+u)/2))?o=d:u=d,(p=t>=(h=(l+c)/2))?l=h:c=h,i=s,!(s=s[y=p<<1|v]))return i[y]=a,r;if(f=+r._x.call(null,s.data),g=+r._y.call(null,s.data),e===f&&t===g)return a.next=s,i?i[y]=a:r._root=a,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(v=e>=(d=(o+u)/2))?o=d:u=d,(p=t>=(h=(l+c)/2))?l=h:c=h;while((y=p<<1|v)===(b=(g>=h)<<1|f>=d));return i[b]=s,i[y]=a,r}function U_(r){var e,t,n=r.length,i,s,a=new Array(n),o=new Array(n),l=1/0,u=1/0,c=-1/0,d=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(s=+this._y.call(null,e))||(a[t]=i,o[t]=s,i<l&&(l=i),i>c&&(c=i),s<u&&(u=s),s>d&&(d=s));if(l>c||u>d)return this;for(this.cover(l,u).cover(c,d),t=0;t<n;++t)wb(this,a[t],o[t],r[t]);return this}function H_(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,s=(n=Math.floor(e))+1;else{for(var a=i-t||1,o=this._root,l,u;t>r||r>=i||n>e||e>=s;)switch(u=(e<n)<<1|r<t,l=new Array(4),l[u]=o,o=l,a*=2,u){case 0:i=t+a,s=n+a;break;case 1:t=i-a,s=n+a;break;case 2:i=t+a,n=s-a;break;case 3:t=i-a,n=s-a;break}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=n,this._x1=i,this._y1=s,this}function X_(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function q_(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Cn(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function Z_(r,e,t){var n,i=this._x0,s=this._y0,a,o,l,u,c=this._x1,d=this._y1,h=[],f=this._root,g,v;for(f&&h.push(new Cn(f,i,s,c,d)),t==null?t=1/0:(i=r-t,s=e-t,c=r+t,d=e+t,t*=t);g=h.pop();)if(!(!(f=g.node)||(a=g.x0)>c||(o=g.y0)>d||(l=g.x1)<i||(u=g.y1)<s))if(f.length){var p=(a+l)/2,y=(o+u)/2;h.push(new Cn(f[3],p,y,l,u),new Cn(f[2],a,y,p,u),new Cn(f[1],p,o,l,y),new Cn(f[0],a,o,p,y)),(v=(e>=y)<<1|r>=p)&&(g=h[h.length-1],h[h.length-1]=h[h.length-1-v],h[h.length-1-v]=g)}else{var b=r-+this._x.call(null,f.data),E=e-+this._y.call(null,f.data),T=b*b+E*E;if(T<t){var S=Math.sqrt(t=T);i=r-S,s=e-S,c=r+S,d=e+S,n=f.data}}return n}function K_(r){if(isNaN(c=+this._x.call(null,r))||isNaN(d=+this._y.call(null,r)))return this;var e,t=this._root,n,i,s,a=this._x0,o=this._y0,l=this._x1,u=this._y1,c,d,h,f,g,v,p,y;if(!t)return this;if(t.length)for(;;){if((g=c>=(h=(a+l)/2))?a=h:l=h,(v=d>=(f=(o+u)/2))?o=f:u=f,e=t,!(t=t[p=v<<1|g]))return this;if(!t.length)break;(e[p+1&3]||e[p+2&3]||e[p+3&3])&&(n=e,y=p)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[p]=s:delete e[p],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=s,this)}function Q_(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function J_(){return this._root}function e3(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function t3(r){var e=[],t,n=this._root,i,s,a,o,l;for(n&&e.push(new Cn(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,s=t.x0,a=t.y0,o=t.x1,l=t.y1)&&n.length){var u=(s+o)/2,c=(a+l)/2;(i=n[3])&&e.push(new Cn(i,u,c,o,l)),(i=n[2])&&e.push(new Cn(i,s,c,u,l)),(i=n[1])&&e.push(new Cn(i,u,a,o,c)),(i=n[0])&&e.push(new Cn(i,s,a,u,c))}return this}function n3(r){var e=[],t=[],n;for(this._root&&e.push(new Cn(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var s,a=n.x0,o=n.y0,l=n.x1,u=n.y1,c=(a+l)/2,d=(o+u)/2;(s=i[0])&&e.push(new Cn(s,a,o,c,d)),(s=i[1])&&e.push(new Cn(s,c,o,l,d)),(s=i[2])&&e.push(new Cn(s,a,d,c,u)),(s=i[3])&&e.push(new Cn(s,c,d,l,u))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function r3(r){return r[0]}function i3(r){return arguments.length?(this._x=r,this):this._x}function s3(r){return r[1]}function a3(r){return arguments.length?(this._y=r,this):this._y}function sc(r,e,t){var n=new ug(e??r3,t??s3,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function ug(r,e,t,n,i,s){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=s,this._root=void 0}function $v(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var In=sc.prototype=ug.prototype;In.copy=function(){var r=new ug(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=$v(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=$v(n));return r};In.add=V_;In.addAll=U_;In.cover=H_;In.data=X_;In.extent=q_;In.find=Z_;In.remove=K_;In.removeAll=Q_;In.root=J_;In.size=e3;In.visit=t3;In.visitAfter=n3;In.x=i3;In.y=a3;function o3(r){const e=+this._x.call(null,r),t=+this._y.call(null,r),n=+this._z.call(null,r);return xb(this.cover(e,t,n),e,t,n,r)}function xb(r,e,t,n,i){if(isNaN(e)||isNaN(t)||isNaN(n))return r;var s,a=r._root,o={data:i},l=r._x0,u=r._y0,c=r._z0,d=r._x1,h=r._y1,f=r._z1,g,v,p,y,b,E,T,S,k,A,O;if(!a)return r._root=o,r;for(;a.length;)if((T=e>=(g=(l+d)/2))?l=g:d=g,(S=t>=(v=(u+h)/2))?u=v:h=v,(k=n>=(p=(c+f)/2))?c=p:f=p,s=a,!(a=a[A=k<<2|S<<1|T]))return s[A]=o,r;if(y=+r._x.call(null,a.data),b=+r._y.call(null,a.data),E=+r._z.call(null,a.data),e===y&&t===b&&n===E)return o.next=a,s?s[A]=o:r._root=o,r;do s=s?s[A]=new Array(8):r._root=new Array(8),(T=e>=(g=(l+d)/2))?l=g:d=g,(S=t>=(v=(u+h)/2))?u=v:h=v,(k=n>=(p=(c+f)/2))?c=p:f=p;while((A=k<<2|S<<1|T)===(O=(E>=p)<<2|(b>=v)<<1|y>=g));return s[O]=a,s[A]=o,r}function l3(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,t=new Float64Array(e),n=new Float64Array(e),i=new Float64Array(e);let s=1/0,a=1/0,o=1/0,l=-1/0,u=-1/0,c=-1/0;for(let d=0,h,f,g,v;d<e;++d)isNaN(f=+this._x.call(null,h=r[d]))||isNaN(g=+this._y.call(null,h))||isNaN(v=+this._z.call(null,h))||(t[d]=f,n[d]=g,i[d]=v,f<s&&(s=f),f>l&&(l=f),g<a&&(a=g),g>u&&(u=g),v<o&&(o=v),v>c&&(c=v));if(s>l||a>u||o>c)return this;this.cover(s,a,o).cover(l,u,c);for(let d=0;d<e;++d)xb(this,t[d],n[d],i[d],r[d]);return this}function u3(r,e,t){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,s=this._z0,a=this._x1,o=this._y1,l=this._z1;if(isNaN(n))a=(n=Math.floor(r))+1,o=(i=Math.floor(e))+1,l=(s=Math.floor(t))+1;else{for(var u=a-n||1,c=this._root,d,h;n>r||r>=a||i>e||e>=o||s>t||t>=l;)switch(h=(t<s)<<2|(e<i)<<1|r<n,d=new Array(8),d[h]=c,c=d,u*=2,h){case 0:a=n+u,o=i+u,l=s+u;break;case 1:n=a-u,o=i+u,l=s+u;break;case 2:a=n+u,i=o-u,l=s+u;break;case 3:n=a-u,i=o-u,l=s+u;break;case 4:a=n+u,o=i+u,s=l-u;break;case 5:n=a-u,o=i+u,s=l-u;break;case 6:a=n+u,i=o-u,s=l-u;break;case 7:n=a-u,i=o-u,s=l-u;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this}function c3(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function d3(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function dt(r,e,t,n,i,s,a){this.node=r,this.x0=e,this.y0=t,this.z0=n,this.x1=i,this.y1=s,this.z1=a}function h3(r,e,t,n){var i,s=this._x0,a=this._y0,o=this._z0,l,u,c,d,h,f,g=this._x1,v=this._y1,p=this._z1,y=[],b=this._root,E,T;for(b&&y.push(new dt(b,s,a,o,g,v,p)),n==null?n=1/0:(s=r-n,a=e-n,o=t-n,g=r+n,v=e+n,p=t+n,n*=n);E=y.pop();)if(!(!(b=E.node)||(l=E.x0)>g||(u=E.y0)>v||(c=E.z0)>p||(d=E.x1)<s||(h=E.y1)<a||(f=E.z1)<o))if(b.length){var S=(l+d)/2,k=(u+h)/2,A=(c+f)/2;y.push(new dt(b[7],S,k,A,d,h,f),new dt(b[6],l,k,A,S,h,f),new dt(b[5],S,u,A,d,k,f),new dt(b[4],l,u,A,S,k,f),new dt(b[3],S,k,c,d,h,A),new dt(b[2],l,k,c,S,h,A),new dt(b[1],S,u,c,d,k,A),new dt(b[0],l,u,c,S,k,A)),(T=(t>=A)<<2|(e>=k)<<1|r>=S)&&(E=y[y.length-1],y[y.length-1]=y[y.length-1-T],y[y.length-1-T]=E)}else{var O=r-+this._x.call(null,b.data),C=e-+this._y.call(null,b.data),P=t-+this._z.call(null,b.data),L=O*O+C*C+P*P;if(L<n){var R=Math.sqrt(n=L);s=r-R,a=e-R,o=t-R,g=r+R,v=e+R,p=t+R,i=b.data}}return i}function f3(r){if(isNaN(h=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r))||isNaN(g=+this._z.call(null,r)))return this;var e,t=this._root,n,i,s,a=this._x0,o=this._y0,l=this._z0,u=this._x1,c=this._y1,d=this._z1,h,f,g,v,p,y,b,E,T,S,k;if(!t)return this;if(t.length)for(;;){if((b=h>=(v=(a+u)/2))?a=v:u=v,(E=f>=(p=(o+c)/2))?o=p:c=p,(T=g>=(y=(l+d)/2))?l=y:d=y,e=t,!(t=t[S=T<<2|E<<1|b]))return this;if(!t.length)break;(e[S+1&7]||e[S+2&7]||e[S+3&7]||e[S+4&7]||e[S+5&7]||e[S+6&7]||e[S+7&7])&&(n=e,k=S)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[S]=s:delete e[S],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[k]=t:this._root=t),this):(this._root=s,this)}function g3(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function p3(){return this._root}function v3(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function m3(r){var e=[],t,n=this._root,i,s,a,o,l,u,c;for(n&&e.push(new dt(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!r(n=t.node,s=t.x0,a=t.y0,o=t.z0,l=t.x1,u=t.y1,c=t.z1)&&n.length){var d=(s+l)/2,h=(a+u)/2,f=(o+c)/2;(i=n[7])&&e.push(new dt(i,d,h,f,l,u,c)),(i=n[6])&&e.push(new dt(i,s,h,f,d,u,c)),(i=n[5])&&e.push(new dt(i,d,a,f,l,h,c)),(i=n[4])&&e.push(new dt(i,s,a,f,d,h,c)),(i=n[3])&&e.push(new dt(i,d,h,o,l,u,f)),(i=n[2])&&e.push(new dt(i,s,h,o,d,u,f)),(i=n[1])&&e.push(new dt(i,d,a,o,l,h,f)),(i=n[0])&&e.push(new dt(i,s,a,o,d,h,f))}return this}function y3(r){var e=[],t=[],n;for(this._root&&e.push(new dt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var i=n.node;if(i.length){var s,a=n.x0,o=n.y0,l=n.z0,u=n.x1,c=n.y1,d=n.z1,h=(a+u)/2,f=(o+c)/2,g=(l+d)/2;(s=i[0])&&e.push(new dt(s,a,o,l,h,f,g)),(s=i[1])&&e.push(new dt(s,h,o,l,u,f,g)),(s=i[2])&&e.push(new dt(s,a,f,l,h,c,g)),(s=i[3])&&e.push(new dt(s,h,f,l,u,c,g)),(s=i[4])&&e.push(new dt(s,a,o,g,h,f,d)),(s=i[5])&&e.push(new dt(s,h,o,g,u,f,d)),(s=i[6])&&e.push(new dt(s,a,f,g,h,c,d)),(s=i[7])&&e.push(new dt(s,h,f,g,u,c,d))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function b3(r){return r[0]}function w3(r){return arguments.length?(this._x=r,this):this._x}function x3(r){return r[1]}function E3(r){return arguments.length?(this._y=r,this):this._y}function M3(r){return r[2]}function S3(r){return arguments.length?(this._z=r,this):this._z}function Eb(r,e,t,n){var i=new cg(e??b3,t??x3,n??M3,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function cg(r,e,t,n,i,s,a,o,l){this._x=r,this._y=e,this._z=t,this._x0=n,this._y0=i,this._z0=s,this._x1=a,this._y1=o,this._z1=l,this._root=void 0}function Wv(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Tn=Eb.prototype=cg.prototype;Tn.copy=function(){var r=new cg(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=Wv(e),r;for(t=[{source:e,target:r._root=new Array(8)}];e=t.pop();)for(var i=0;i<8;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(8)}):e.target[i]=Wv(n));return r};Tn.add=o3;Tn.addAll=l3;Tn.cover=u3;Tn.data=c3;Tn.extent=d3;Tn.find=h3;Tn.remove=f3;Tn.removeAll=g3;Tn.root=p3;Tn.size=v3;Tn.visit=m3;Tn.visitAfter=y3;Tn.x=w3;Tn.y=E3;Tn.z=S3;const T3=.81,Ud=.1;function O3(r,e,t,n,i=2){const s=e/t,a=r.getAllNodes(),o=a.map((c,d)=>{const{nodeStrength:h,x:f,y:g,z:v,size:p}=c.data;return{x:f,y:g,z:v,size:p,index:d,id:c.id,vx:0,vy:0,vz:0,weight:s*h}}),l=(i===2?sc(o,c=>c.x,c=>c.y):Eb(o,c=>c.x,c=>c.y,c=>c.z)).visitAfter(k3),u=new Map;return o.forEach(c=>{u.set(c.id,c),A3(c,l,i)}),o.map((c,d)=>{const{id:h,data:f}=a[d],{mass:g=1}=f;n[h]={x:c.vx/g,y:c.vy/g,z:c.vz/g}}),n}function k3(r){let e=0,t=0,n=0,i=0,s=0;const a=r.length;if(a){for(let o=0;o<a;o++){const l=r[o];l&&l.weight&&(e+=l.weight,t+=l.x*l.weight,n+=l.y*l.weight,i+=l.z*l.weight,s+=l.size*l.weight)}r.x=t/e,r.y=n/e,r.z=i/e,r.size=s/e,r.weight=e}else{const o=r;r.x=o.data.x,r.y=o.data.y,r.z=o.data.z,r.size=o.data.size,r.weight=o.data.weight}}const N3=(r,e,t,n,i,s,a)=>{var o;if(((o=r.data)===null||o===void 0?void 0:o.id)===s.id)return;const l=[t,n,i][a-1],u=s.x-r.x||Ud,c=s.y-r.y||Ud,d=s.z-r.z||Ud,h=[u,c,d],f=l-e;let g=0;for(let y=0;y<a;y++)g+=h[y]*h[y];const p=Math.sqrt(g)*g;if(f*f*T3<g){const y=r.weight/p;return s.vx+=u*y,s.vy+=c*y,s.vz+=d*y,!0}if(r.length)return!1;if(r.data!==s){const y=r.data.weight/p;s.vx+=u*y,s.vy+=c*y,s.vz+=d*y}};function A3(r,e,t){e.visit((n,i,s,a,o)=>N3(n,i,s,a,o,r,t))}const C3={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class Mb{constructor(e={}){this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},C3),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericForceLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<e;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericForceLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),s=t.getAllNodes(),a=t.getAllEdges(),o=this.formatOptions(i,t),{dimensions:l,width:u,height:c,nodeSize:d,getMass:h,nodeStrength:f,edgeStrength:g,linkDistance:v}=o,p=s.map((O,C)=>Object.assign(Object.assign({},O),{data:Object.assign(Object.assign({},O.data),{x:ye(O.data.x)?O.data.x:Math.random()*u,y:ye(O.data.y)?O.data.y:Math.random()*c,z:ye(O.data.z)?O.data.z:Math.random()*Math.sqrt(u*c),size:d(O)||30,mass:h(O),nodeStrength:f(O)})})),y=a.map(O=>Object.assign(Object.assign({},O),{data:Object.assign(Object.assign({},O.data),{edgeStrength:g(O),linkDistance:v(O,t.getNode(O.source),t.getNode(O.target))})}));if(!(s!=null&&s.length))return this.lastResult={nodes:[],edges:a},{nodes:[],edges:a};const b={};s.forEach((O,C)=>{b[O.id]={x:0,y:0,z:0}});const E=new en({nodes:p,edges:y});this.formatCentripetal(o,E);const{maxIteration:T,minMovement:S,onTick:k}=o;if(this.lastLayoutNodes=p,this.lastLayoutEdges=y,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=E,this.lastOptions=o,this.lastVelMap=b,typeof window>"u")return;let A=0;return new Promise(O=>{this.timeInterval=window.setInterval(()=>{(!s||!this.running)&&O({nodes:Hd(t,p),edges:a}),this.runOneStep(E,t,A,b,o),this.updatePosition(t,E,b,o),e&&p.forEach(C=>t.mergeNodeData(C.id,{x:C.data.x,y:C.data.y,z:l===3?C.data.z:void 0})),k==null||k({nodes:Hd(t,p),edges:a}),A++,(A>=T||this.judgingDistance<S)&&(window.clearInterval(this.timeInterval),O({nodes:Hd(t,p),edges:a}))},0),this.running=!0})})}formatOptions(e,t){const n=Object.assign({},e),{width:i,height:s,getMass:a}=e;n.width=!i&&typeof window<"u"?window.innerWidth:i,n.height=!s&&typeof window<"u"?window.innerHeight:s,e.center||(n.center=[n.width/2,n.height/2]),a||(n.getMass=l=>{let u=1;ye(l==null?void 0:l.data.mass)&&(u=l==null?void 0:l.data.mass);const c=t.getDegree(l.id,"both");return!c||c<5?u:c*5*u}),n.nodeSize=lg(e.nodeSize,e.nodeSpacing);const o=e.linkDistance?bs(1,e.linkDistance):l=>1+n.nodeSize(t.getNode(l.source))+n.nodeSize(t.getNode(l.target));return n.linkDistance=o,n.nodeStrength=bs(1,e.nodeStrength),n.edgeStrength=bs(1,e.edgeStrength),n}formatCentripetal(e,t){const{dimensions:n,centripetalOptions:i,center:s,clusterNodeStrength:a,leafCluster:o,clustering:l,nodeClusterBy:u}=e,c=t.getAllNodes(),d=i||{leaf:2,single:2,others:1,center:y=>({x:s[0],y:s[1],z:n===3?s[2]:void 0})};typeof a!="function"&&(e.clusterNodeStrength=y=>a);let h,f;if(o&&u&&(h=Gv(t,u),f=Array.from(new Set(c==null?void 0:c.map(y=>y.data[u])))||[],e.centripetalOptions=Object.assign(d,{single:100,leaf:y=>{const{siblingLeaves:b,sameTypeLeaves:E}=h[y.id]||{};return(E==null?void 0:E.length)===(b==null?void 0:b.length)||(f==null?void 0:f.length)===1?1:e.clusterNodeStrength(y)},others:1,center:y=>{const b=t.getDegree(y.id,"both");if(!b)return{x:100,y:100,z:0};let E;if(b===1){const{sameTypeLeaves:T=[]}=h[y.id]||{};T.length===1?E=void 0:T.length>1&&(E=Yv(T))}else E=void 0;return{x:E==null?void 0:E.x,y:E==null?void 0:E.y,z:E==null?void 0:E.z}}})),l&&u){h||(h=Gv(t,u)),f||(f=Array.from(new Set(c.map(b=>b.data[u])))),f=f.filter(b=>b!==void 0);const y={};f.forEach(b=>{const E=c.filter(T=>T.data[u]===b).map(T=>t.getNode(T.id));y[b]=Yv(E)}),e.centripetalOptions=Object.assign(d,{single:b=>e.clusterNodeStrength(b),leaf:b=>e.clusterNodeStrength(b),others:b=>e.clusterNodeStrength(b),center:b=>{const E=y[b.data[u]];return{x:E==null?void 0:E.x,y:E==null?void 0:E.y,z:E==null?void 0:E.z}}})}const{leaf:g,single:v,others:p}=e.centripetalOptions||{};g&&typeof g!="function"&&(e.centripetalOptions.leaf=()=>g),v&&typeof v!="function"&&(e.centripetalOptions.single=()=>v),p&&typeof p!="function"&&(e.centripetalOptions.others=()=>p)}runOneStep(e,t,n,i,s){const a={},o=e.getAllNodes(),l=e.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:u}=s;if(this.calRepulsive(e,a,s),l&&this.calAttractive(e,a,s),this.calGravity(e,t,a,s),this.updateVelocity(e,a,i,s),u){const c=this.calTotalEnergy(a,o);u({energy:c,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:n})}}calTotalEnergy(e,t){if(!(t!=null&&t.length))return 0;let n=0;return t.forEach((i,s)=>{const a=e[i.id].x,o=e[i.id].y,l=this.options.dimensions===3?e[i.id].z:0,u=a*a+o*o+l*l,{mass:c=1}=i.data;n+=c*u*.5}),n}calRepulsive(e,t,n){const{dimensions:i,factor:s,coulombDisScale:a}=n;O3(e,s,a*a,t,i)}calAttractive(e,t,n){const{dimensions:i,nodeSize:s}=n;e.getAllEdges().forEach((a,o)=>{const{source:l,target:u}=a,c=e.getNode(l),d=e.getNode(u);if(!c||!d)return;let h=d.data.x-c.data.x,f=d.data.y-c.data.y,g=i===3?d.data.z-c.data.z:0;!h&&!f&&(h=Math.random()*.01,f=Math.random()*.01,i===3&&!g&&(g=Math.random()*.01));const v=Math.sqrt(h*h+f*f+g*g);if(v<s(c)+s(d))return;const p=h/v,y=f/v,b=g/v,{linkDistance:E=200,edgeStrength:T=200}=a.data||{},k=(E-v)*T,A=c.data.mass||1,O=d.data.mass||1,C=1/A,P=1/O,L=p*k,R=y*k,z=b*k;t[l].x-=L*C,t[l].y-=R*C,t[l].z-=z*C,t[u].x+=L*P,t[u].y+=R*P,t[u].z+=z*P})}calGravity(e,t,n,i){const{getCenter:s}=i,a=e.getAllNodes(),o=t.getAllNodes(),l=t.getAllEdges(),{width:u,height:c,center:d,gravity:h,centripetalOptions:f}=i;a&&a.forEach(g=>{const{id:v,data:p}=g,{mass:y,x:b,y:E,z:T}=p,S=t.getNode(v);let k=0,A=0,O=0,C=h;const P=e.getDegree(v,"in"),L=e.getDegree(v,"out"),R=e.getDegree(v,"both"),z=s==null?void 0:s(S,R);if(z){const[Y,U,V]=z;k=b-Y,A=E-U,C=V}else k=b-d[0],A=E-d[1],O=T-d[2];if(C&&(n[v].x-=C*k/y,n[v].y-=C*A/y,n[v].z-=C*O/y),f){const{leaf:Y,single:U,others:V,center:W}=f,{x:F,y:K,z:re,centerStrength:se}=(W==null?void 0:W(S,o,l,u,c))||{x:0,y:0,z:0,centerStrength:0};if(!ye(F)||!ye(K))return;const ae=(b-F)/y,Ce=(E-K)/y,Te=(T-re)/y;if(se&&(n[v].x-=se*ae,n[v].y-=se*Ce,n[v].z-=se*Te),R===0){const Oe=U(S);if(!Oe)return;n[v].x-=Oe*ae,n[v].y-=Oe*Ce,n[v].z-=Oe*Te;return}if(P===0||L===0){const Oe=Y(S,o,l);if(!Oe)return;n[v].x-=Oe*ae,n[v].y-=Oe*Ce,n[v].z-=Oe*Te;return}const J=V(S);if(!J)return;n[v].x-=J*ae,n[v].y-=J*Ce,n[v].z-=J*Te}})}updateVelocity(e,t,n,i){const{damping:s,maxSpeed:a,interval:o,dimensions:l}=i,u=e.getAllNodes();u!=null&&u.length&&u.forEach(c=>{const{id:d}=c;let h=(n[d].x+t[d].x*o)*s||.01,f=(n[d].y+t[d].y*o)*s||.01,g=l===3?(n[d].z+t[d].z*o)*s||.01:0;const v=Math.sqrt(h*h+f*f+g*g);if(v>a){const p=a/v;h=p*h,f=p*f,g=p*g}n[d]={x:h,y:f,z:g}})}updatePosition(e,t,n,i){const{distanceThresholdMode:s,interval:a,dimensions:o}=i,l=t.getAllNodes();if(!(l!=null&&l.length)){this.judgingDistance=0;return}let u=0;s==="max"?this.judgingDistance=-1/0:s==="min"&&(this.judgingDistance=1/0),l.forEach(c=>{const{id:d}=c,h=e.getNode(d);if(ye(h.data.fx)&&ye(h.data.fy)){t.mergeNodeData(d,{x:h.data.fx,y:h.data.fy,z:o===3?h.data.fz:void 0});return}const f=n[d].x*a,g=n[d].y*a,v=o===3?n[d].z*a:0;t.mergeNodeData(d,{x:c.data.x+f,y:c.data.y+g,z:c.data.z+v});const p=Math.sqrt(f*f+g*g+v*v);switch(s){case"max":this.judgingDistance<p&&(this.judgingDistance=p);break;case"min":this.judgingDistance>p&&(this.judgingDistance=p);break;default:u=u+p;break}}),(!s||s==="mean")&&(this.judgingDistance=u/l.length)}}const Gv=(r,e)=>{const t=r.getAllNodes();if(!(t!=null&&t.length))return{};const n={};return t.forEach((i,s)=>{r.getDegree(i.id,"both")===1&&(n[i.id]=P3(r,"leaf",i,e))}),n},P3=(r,e,t,n)=>{const i=r.getDegree(t.id,"in"),s=r.getDegree(t.id,"out");let a=t,o=[];i===0?(a=r.getSuccessors(t.id)[0],o=r.getNeighbors(a.id)):s===0&&(a=r.getPredecessors(t.id)[0],o=r.getNeighbors(a.id)),o=o.filter(u=>r.getDegree(u.id,"in")===0||r.getDegree(u.id,"out")===0);const l=_3(r,e,n,t,o);return{coreNode:a,siblingLeaves:o,sameTypeLeaves:l}},_3=(r,e,t,n,i)=>{const s=n.data[t]||"";let a=(i==null?void 0:i.filter(o=>o.data[t]===s))||[];return a=a.filter(o=>r.getDegree(o.id,"in")===0||r.getDegree(o.id,"out")===0),a},Yv=r=>{const e={x:0,y:0};r.forEach(n=>{const{x:i,y:s}=n.data;e.x+=i||0,e.y+=s||0});const t=r.length||1;return{x:e.x/t,y:e.y/t}},Hd=(r,e)=>e.map(t=>{const{id:n,data:i}=t,s=r.getNode(n);return Object.assign(Object.assign({},s),{data:Object.assign(Object.assign({},s.data),{x:i.x,y:i.y,z:i.z})})});var He={};const L3=Object.prototype.toString;function uo(r){const e=L3.call(r);return e.endsWith("Array]")&&!e.includes("Big")}const D3=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:uo},Symbol.toStringTag,{value:"Module"})),I3=Sm(D3);function R3(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!uo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,s=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>r.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=r[n],o=n+1;o<s;o++)r[o]>a&&(a=r[o]);return a}function j3(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!uo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,s=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>r.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=r[n],o=n+1;o<s;o++)r[o]<a&&(a=r[o]);return a}function B3(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(uo(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!uo(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(r.length);var n=j3(r),i=R3(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=e.min,a=s===void 0?e.autoMinMax?n:0:s,o=e.max,l=o===void 0?e.autoMinMax?i:1:o;if(a>=l)throw new RangeError("min option must be smaller than max option");for(var u=(l-a)/(i-n),c=0;c<r.length;c++)t[c]=(r[c]-n)*u+a;return t}const z3=Object.freeze(Object.defineProperty({__proto__:null,default:B3},Symbol.toStringTag,{value:"Module"})),F3=Sm(z3);var Vv;function $3(){var Sa,lf,yn;if(Vv)return He;Vv=1,Object.defineProperty(He,"__esModule",{value:!0});var r=I3,e=F3;const t=" ".repeat(2),n=" ".repeat(4);function i(){return s(this)}function s(_,M={}){const{maxRows:w=15,maxColumns:m=10,maxNumSize:x=8,padMinus:N="auto"}=M;return`${_.constructor.name} {
${t}[
${n}${a(_,w,m,x,N)}
${t}]
${t}rows: ${_.rows}
${t}columns: ${_.columns}
}`}function a(_,M,w,m,x){const{rows:N,columns:D}=_,I=Math.min(N,M),j=Math.min(D,w),B=[];if(x==="auto"){x=!1;e:for(let Z=0;Z<I;Z++)for(let G=0;G<j;G++)if(_.get(Z,G)<0){x=!0;break e}}for(let Z=0;Z<I;Z++){let G=[];for(let ne=0;ne<j;ne++)G.push(o(_.get(Z,ne),m,x));B.push(`${G.join(" ")}`)}return j!==D&&(B[B.length-1]+=` ... ${D-w} more columns`),I!==N&&B.push(`... ${N-M} more rows`),B.join(`
${n}`)}function o(_,M,w){return(_>=0&&w?` ${l(_,M-1)}`:l(_,M)).padEnd(M)}function l(_,M){let w=_.toString();if(w.length<=M)return w;let m=_.toFixed(M);if(m.length>M&&(m=_.toFixed(Math.max(0,M-(m.length-M)))),m.length<=M&&!m.startsWith("0.000")&&!m.startsWith("-0.000"))return m;let x=_.toExponential(M);return x.length>M&&(x=_.toExponential(Math.max(0,M-(x.length-M)))),x.slice(0)}function u(_,M){_.prototype.add=function(m){return typeof m=="number"?this.addS(m):this.addM(m)},_.prototype.addS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)+m);return this},_.prototype.addM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)+m.get(x,N));return this},_.add=function(m,x){return new M(m).add(x)},_.prototype.sub=function(m){return typeof m=="number"?this.subS(m):this.subM(m)},_.prototype.subS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)-m);return this},_.prototype.subM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)-m.get(x,N));return this},_.sub=function(m,x){return new M(m).sub(x)},_.prototype.subtract=_.prototype.sub,_.prototype.subtractS=_.prototype.subS,_.prototype.subtractM=_.prototype.subM,_.subtract=_.sub,_.prototype.mul=function(m){return typeof m=="number"?this.mulS(m):this.mulM(m)},_.prototype.mulS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)*m);return this},_.prototype.mulM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)*m.get(x,N));return this},_.mul=function(m,x){return new M(m).mul(x)},_.prototype.multiply=_.prototype.mul,_.prototype.multiplyS=_.prototype.mulS,_.prototype.multiplyM=_.prototype.mulM,_.multiply=_.mul,_.prototype.div=function(m){return typeof m=="number"?this.divS(m):this.divM(m)},_.prototype.divS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)/m);return this},_.prototype.divM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)/m.get(x,N));return this},_.div=function(m,x){return new M(m).div(x)},_.prototype.divide=_.prototype.div,_.prototype.divideS=_.prototype.divS,_.prototype.divideM=_.prototype.divM,_.divide=_.div,_.prototype.mod=function(m){return typeof m=="number"?this.modS(m):this.modM(m)},_.prototype.modS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)%m);return this},_.prototype.modM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)%m.get(x,N));return this},_.mod=function(m,x){return new M(m).mod(x)},_.prototype.modulus=_.prototype.mod,_.prototype.modulusS=_.prototype.modS,_.prototype.modulusM=_.prototype.modM,_.modulus=_.mod,_.prototype.and=function(m){return typeof m=="number"?this.andS(m):this.andM(m)},_.prototype.andS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)&m);return this},_.prototype.andM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)&m.get(x,N));return this},_.and=function(m,x){return new M(m).and(x)},_.prototype.or=function(m){return typeof m=="number"?this.orS(m):this.orM(m)},_.prototype.orS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)|m);return this},_.prototype.orM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)|m.get(x,N));return this},_.or=function(m,x){return new M(m).or(x)},_.prototype.xor=function(m){return typeof m=="number"?this.xorS(m):this.xorM(m)},_.prototype.xorS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)^m);return this},_.prototype.xorM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)^m.get(x,N));return this},_.xor=function(m,x){return new M(m).xor(x)},_.prototype.leftShift=function(m){return typeof m=="number"?this.leftShiftS(m):this.leftShiftM(m)},_.prototype.leftShiftS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)<<m);return this},_.prototype.leftShiftM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)<<m.get(x,N));return this},_.leftShift=function(m,x){return new M(m).leftShift(x)},_.prototype.signPropagatingRightShift=function(m){return typeof m=="number"?this.signPropagatingRightShiftS(m):this.signPropagatingRightShiftM(m)},_.prototype.signPropagatingRightShiftS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)>>m);return this},_.prototype.signPropagatingRightShiftM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)>>m.get(x,N));return this},_.signPropagatingRightShift=function(m,x){return new M(m).signPropagatingRightShift(x)},_.prototype.rightShift=function(m){return typeof m=="number"?this.rightShiftS(m):this.rightShiftM(m)},_.prototype.rightShiftS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)>>>m);return this},_.prototype.rightShiftM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)>>>m.get(x,N));return this},_.rightShift=function(m,x){return new M(m).rightShift(x)},_.prototype.zeroFillRightShift=_.prototype.rightShift,_.prototype.zeroFillRightShiftS=_.prototype.rightShiftS,_.prototype.zeroFillRightShiftM=_.prototype.rightShiftM,_.zeroFillRightShift=_.rightShift,_.prototype.not=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,~this.get(m,x));return this},_.not=function(m){return new M(m).not()},_.prototype.abs=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.abs(this.get(m,x)));return this},_.abs=function(m){return new M(m).abs()},_.prototype.acos=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.acos(this.get(m,x)));return this},_.acos=function(m){return new M(m).acos()},_.prototype.acosh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.acosh(this.get(m,x)));return this},_.acosh=function(m){return new M(m).acosh()},_.prototype.asin=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.asin(this.get(m,x)));return this},_.asin=function(m){return new M(m).asin()},_.prototype.asinh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.asinh(this.get(m,x)));return this},_.asinh=function(m){return new M(m).asinh()},_.prototype.atan=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.atan(this.get(m,x)));return this},_.atan=function(m){return new M(m).atan()},_.prototype.atanh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.atanh(this.get(m,x)));return this},_.atanh=function(m){return new M(m).atanh()},_.prototype.cbrt=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.cbrt(this.get(m,x)));return this},_.cbrt=function(m){return new M(m).cbrt()},_.prototype.ceil=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.ceil(this.get(m,x)));return this},_.ceil=function(m){return new M(m).ceil()},_.prototype.clz32=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.clz32(this.get(m,x)));return this},_.clz32=function(m){return new M(m).clz32()},_.prototype.cos=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.cos(this.get(m,x)));return this},_.cos=function(m){return new M(m).cos()},_.prototype.cosh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.cosh(this.get(m,x)));return this},_.cosh=function(m){return new M(m).cosh()},_.prototype.exp=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.exp(this.get(m,x)));return this},_.exp=function(m){return new M(m).exp()},_.prototype.expm1=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.expm1(this.get(m,x)));return this},_.expm1=function(m){return new M(m).expm1()},_.prototype.floor=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.floor(this.get(m,x)));return this},_.floor=function(m){return new M(m).floor()},_.prototype.fround=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.fround(this.get(m,x)));return this},_.fround=function(m){return new M(m).fround()},_.prototype.log=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.log(this.get(m,x)));return this},_.log=function(m){return new M(m).log()},_.prototype.log1p=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.log1p(this.get(m,x)));return this},_.log1p=function(m){return new M(m).log1p()},_.prototype.log10=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.log10(this.get(m,x)));return this},_.log10=function(m){return new M(m).log10()},_.prototype.log2=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.log2(this.get(m,x)));return this},_.log2=function(m){return new M(m).log2()},_.prototype.round=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.round(this.get(m,x)));return this},_.round=function(m){return new M(m).round()},_.prototype.sign=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.sign(this.get(m,x)));return this},_.sign=function(m){return new M(m).sign()},_.prototype.sin=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.sin(this.get(m,x)));return this},_.sin=function(m){return new M(m).sin()},_.prototype.sinh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.sinh(this.get(m,x)));return this},_.sinh=function(m){return new M(m).sinh()},_.prototype.sqrt=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.sqrt(this.get(m,x)));return this},_.sqrt=function(m){return new M(m).sqrt()},_.prototype.tan=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.tan(this.get(m,x)));return this},_.tan=function(m){return new M(m).tan()},_.prototype.tanh=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.tanh(this.get(m,x)));return this},_.tanh=function(m){return new M(m).tanh()},_.prototype.trunc=function(){for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.set(m,x,Math.trunc(this.get(m,x)));return this},_.trunc=function(m){return new M(m).trunc()},_.pow=function(m,x){return new M(m).pow(x)},_.prototype.pow=function(m){return typeof m=="number"?this.powS(m):this.powM(m)},_.prototype.powS=function(m){for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)**m);return this},_.prototype.powM=function(m){if(m=M.checkMatrix(m),this.rows!==m.rows||this.columns!==m.columns)throw new RangeError("Matrices dimensions must be equal");for(let x=0;x<this.rows;x++)for(let N=0;N<this.columns;N++)this.set(x,N,this.get(x,N)**m.get(x,N));return this}}function c(_,M,w){let m=w?_.rows:_.rows-1;if(M<0||M>m)throw new RangeError("Row index out of range")}function d(_,M,w){let m=w?_.columns:_.columns-1;if(M<0||M>m)throw new RangeError("Column index out of range")}function h(_,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==_.columns)throw new RangeError("vector size must be the same as the number of columns");return M}function f(_,M){if(M.to1DArray&&(M=M.to1DArray()),M.length!==_.rows)throw new RangeError("vector size must be the same as the number of rows");return M}function g(_,M){if(!r.isAnyArray(M))throw new TypeError("row indices must be an array");for(let w=0;w<M.length;w++)if(M[w]<0||M[w]>=_.rows)throw new RangeError("row indices are out of range")}function v(_,M){if(!r.isAnyArray(M))throw new TypeError("column indices must be an array");for(let w=0;w<M.length;w++)if(M[w]<0||M[w]>=_.columns)throw new RangeError("column indices are out of range")}function p(_,M,w,m,x){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(b("startRow",M),b("endRow",w),b("startColumn",m),b("endColumn",x),M>w||m>x||M<0||M>=_.rows||w<0||w>=_.rows||m<0||m>=_.columns||x<0||x>=_.columns)throw new RangeError("Submatrix indices are out of range")}function y(_,M=0){let w=[];for(let m=0;m<_;m++)w.push(M);return w}function b(_,M){if(typeof M!="number")throw new TypeError(`${_} must be a number`)}function E(_){if(_.isEmpty())throw new Error("Empty matrix has no elements to index")}function T(_){let M=y(_.rows);for(let w=0;w<_.rows;++w)for(let m=0;m<_.columns;++m)M[w]+=_.get(w,m);return M}function S(_){let M=y(_.columns);for(let w=0;w<_.rows;++w)for(let m=0;m<_.columns;++m)M[m]+=_.get(w,m);return M}function k(_){let M=0;for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)M+=_.get(w,m);return M}function A(_){let M=y(_.rows,1);for(let w=0;w<_.rows;++w)for(let m=0;m<_.columns;++m)M[w]*=_.get(w,m);return M}function O(_){let M=y(_.columns,1);for(let w=0;w<_.rows;++w)for(let m=0;m<_.columns;++m)M[m]*=_.get(w,m);return M}function C(_){let M=1;for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)M*=_.get(w,m);return M}function P(_,M,w){const m=_.rows,x=_.columns,N=[];for(let D=0;D<m;D++){let I=0,j=0,B=0;for(let Z=0;Z<x;Z++)B=_.get(D,Z)-w[D],I+=B,j+=B*B;M?N.push((j-I*I/x)/(x-1)):N.push((j-I*I/x)/x)}return N}function L(_,M,w){const m=_.rows,x=_.columns,N=[];for(let D=0;D<x;D++){let I=0,j=0,B=0;for(let Z=0;Z<m;Z++)B=_.get(Z,D)-w[D],I+=B,j+=B*B;M?N.push((j-I*I/m)/(m-1)):N.push((j-I*I/m)/m)}return N}function R(_,M,w){const m=_.rows,x=_.columns,N=m*x;let D=0,I=0,j=0;for(let B=0;B<m;B++)for(let Z=0;Z<x;Z++)j=_.get(B,Z)-w,D+=j,I+=j*j;return M?(I-D*D/N)/(N-1):(I-D*D/N)/N}function z(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)-M[w])}function Y(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)-M[m])}function U(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)-M)}function V(_){const M=[];for(let w=0;w<_.rows;w++){let m=0;for(let x=0;x<_.columns;x++)m+=_.get(w,x)**2/(_.columns-1);M.push(Math.sqrt(m))}return M}function W(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)/M[w])}function F(_){const M=[];for(let w=0;w<_.columns;w++){let m=0;for(let x=0;x<_.rows;x++)m+=_.get(x,w)**2/(_.rows-1);M.push(Math.sqrt(m))}return M}function K(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)/M[m])}function re(_){const M=_.size-1;let w=0;for(let m=0;m<_.columns;m++)for(let x=0;x<_.rows;x++)w+=_.get(x,m)**2/M;return Math.sqrt(w)}function se(_,M){for(let w=0;w<_.rows;w++)for(let m=0;m<_.columns;m++)_.set(w,m,_.get(w,m)/M)}class ae{static from1DArray(M,w,m){if(M*w!==m.length)throw new RangeError("data length does not match given dimensions");let N=new J(M,w);for(let D=0;D<M;D++)for(let I=0;I<w;I++)N.set(D,I,m[D*w+I]);return N}static rowVector(M){let w=new J(1,M.length);for(let m=0;m<M.length;m++)w.set(0,m,M[m]);return w}static columnVector(M){let w=new J(M.length,1);for(let m=0;m<M.length;m++)w.set(m,0,M[m]);return w}static zeros(M,w){return new J(M,w)}static ones(M,w){return new J(M,w).fill(1)}static rand(M,w,m={}){if(typeof m!="object")throw new TypeError("options must be an object");const{random:x=Math.random}=m;let N=new J(M,w);for(let D=0;D<M;D++)for(let I=0;I<w;I++)N.set(D,I,x());return N}static randInt(M,w,m={}){if(typeof m!="object")throw new TypeError("options must be an object");const{min:x=0,max:N=1e3,random:D=Math.random}=m;if(!Number.isInteger(x))throw new TypeError("min must be an integer");if(!Number.isInteger(N))throw new TypeError("max must be an integer");if(x>=N)throw new RangeError("min must be smaller than max");let I=N-x,j=new J(M,w);for(let B=0;B<M;B++)for(let Z=0;Z<w;Z++){let G=x+Math.round(D()*I);j.set(B,Z,G)}return j}static eye(M,w,m){w===void 0&&(w=M),m===void 0&&(m=1);let x=Math.min(M,w),N=this.zeros(M,w);for(let D=0;D<x;D++)N.set(D,D,m);return N}static diag(M,w,m){let x=M.length;w===void 0&&(w=x),m===void 0&&(m=w);let N=Math.min(x,w,m),D=this.zeros(w,m);for(let I=0;I<N;I++)D.set(I,I,M[I]);return D}static min(M,w){M=this.checkMatrix(M),w=this.checkMatrix(w);let m=M.rows,x=M.columns,N=new J(m,x);for(let D=0;D<m;D++)for(let I=0;I<x;I++)N.set(D,I,Math.min(M.get(D,I),w.get(D,I)));return N}static max(M,w){M=this.checkMatrix(M),w=this.checkMatrix(w);let m=M.rows,x=M.columns,N=new this(m,x);for(let D=0;D<m;D++)for(let I=0;I<x;I++)N.set(D,I,Math.max(M.get(D,I),w.get(D,I)));return N}static checkMatrix(M){return ae.isMatrix(M)?M:new J(M)}static isMatrix(M){return M!=null&&M.klass==="Matrix"}get size(){return this.rows*this.columns}apply(M){if(typeof M!="function")throw new TypeError("callback must be a function");for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)M.call(this,w,m);return this}to1DArray(){let M=[];for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)M.push(this.get(w,m));return M}to2DArray(){let M=[];for(let w=0;w<this.rows;w++){M.push([]);for(let m=0;m<this.columns;m++)M[w].push(this.get(w,m))}return M}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let M=0;M<this.rows;M++)for(let w=0;w<=M;w++)if(this.get(M,w)!==this.get(w,M))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let M=0;M<this.rows;M++)if(this.get(M,M)!==0)return!1;return!0}isEchelonForm(){let M=0,w=0,m=-1,x=!0,N=!1;for(;M<this.rows&&x;){for(w=0,N=!1;w<this.columns&&N===!1;)this.get(M,w)===0?w++:this.get(M,w)===1&&w>m?(N=!0,m=w):(x=!1,N=!0);M++}return x}isReducedEchelonForm(){let M=0,w=0,m=-1,x=!0,N=!1;for(;M<this.rows&&x;){for(w=0,N=!1;w<this.columns&&N===!1;)this.get(M,w)===0?w++:this.get(M,w)===1&&w>m?(N=!0,m=w):(x=!1,N=!0);for(let D=w+1;D<this.rows;D++)this.get(M,D)!==0&&(x=!1);M++}return x}echelonForm(){let M=this.clone(),w=0,m=0;for(;w<M.rows&&m<M.columns;){let x=w;for(let N=w;N<M.rows;N++)M.get(N,m)>M.get(x,m)&&(x=N);if(M.get(x,m)===0)m++;else{M.swapRows(w,x);let N=M.get(w,m);for(let D=m;D<M.columns;D++)M.set(w,D,M.get(w,D)/N);for(let D=w+1;D<M.rows;D++){let I=M.get(D,m)/M.get(w,m);M.set(D,m,0);for(let j=m+1;j<M.columns;j++)M.set(D,j,M.get(D,j)-M.get(w,j)*I)}w++,m++}}return M}reducedEchelonForm(){let M=this.echelonForm(),w=M.columns,m=M.rows,x=m-1;for(;x>=0;)if(M.maxRow(x)===0)x--;else{let N=0,D=!1;for(;N<m&&D===!1;)M.get(x,N)===1?D=!0:N++;for(let I=0;I<x;I++){let j=M.get(I,N);for(let B=N;B<w;B++){let Z=M.get(I,B)-j*M.get(x,B);M.set(I,B,Z)}}x--}return M}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{rows:w=1,columns:m=1}=M;if(!Number.isInteger(w)||w<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(m)||m<=0)throw new TypeError("columns must be a positive integer");let x=new J(this.rows*w,this.columns*m);for(let N=0;N<w;N++)for(let D=0;D<m;D++)x.setSubMatrix(this,this.rows*N,this.columns*D);return x}fill(M){for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,M);return this}neg(){return this.mulS(-1)}getRow(M){c(this,M);let w=[];for(let m=0;m<this.columns;m++)w.push(this.get(M,m));return w}getRowVector(M){return J.rowVector(this.getRow(M))}setRow(M,w){c(this,M),w=h(this,w);for(let m=0;m<this.columns;m++)this.set(M,m,w[m]);return this}swapRows(M,w){c(this,M),c(this,w);for(let m=0;m<this.columns;m++){let x=this.get(M,m);this.set(M,m,this.get(w,m)),this.set(w,m,x)}return this}getColumn(M){d(this,M);let w=[];for(let m=0;m<this.rows;m++)w.push(this.get(m,M));return w}getColumnVector(M){return J.columnVector(this.getColumn(M))}setColumn(M,w){d(this,M),w=f(this,w);for(let m=0;m<this.rows;m++)this.set(m,M,w[m]);return this}swapColumns(M,w){d(this,M),d(this,w);for(let m=0;m<this.rows;m++){let x=this.get(m,M);this.set(m,M,this.get(m,w)),this.set(m,w,x)}return this}addRowVector(M){M=h(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)+M[m]);return this}subRowVector(M){M=h(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)-M[m]);return this}mulRowVector(M){M=h(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)*M[m]);return this}divRowVector(M){M=h(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)/M[m]);return this}addColumnVector(M){M=f(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)+M[w]);return this}subColumnVector(M){M=f(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)-M[w]);return this}mulColumnVector(M){M=f(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)*M[w]);return this}divColumnVector(M){M=f(this,M);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)this.set(w,m,this.get(w,m)/M[w]);return this}mulRow(M,w){c(this,M);for(let m=0;m<this.columns;m++)this.set(M,m,this.get(M,m)*w);return this}mulColumn(M,w){d(this,M);for(let m=0;m<this.rows;m++)this.set(m,M,this.get(m,M)*w);return this}max(M){if(this.isEmpty())return NaN;switch(M){case"row":{const w=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)>w[m]&&(w[m]=this.get(m,x));return w}case"column":{const w=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)>w[x]&&(w[x]=this.get(m,x));return w}case void 0:{let w=this.get(0,0);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)>w&&(w=this.get(m,x));return w}default:throw new Error(`invalid option: ${M}`)}}maxIndex(){E(this);let M=this.get(0,0),w=[0,0];for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)>M&&(M=this.get(m,x),w[0]=m,w[1]=x);return w}min(M){if(this.isEmpty())return NaN;switch(M){case"row":{const w=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)<w[m]&&(w[m]=this.get(m,x));return w}case"column":{const w=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)<w[x]&&(w[x]=this.get(m,x));return w}case void 0:{let w=this.get(0,0);for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)<w&&(w=this.get(m,x));return w}default:throw new Error(`invalid option: ${M}`)}}minIndex(){E(this);let M=this.get(0,0),w=[0,0];for(let m=0;m<this.rows;m++)for(let x=0;x<this.columns;x++)this.get(m,x)<M&&(M=this.get(m,x),w[0]=m,w[1]=x);return w}maxRow(M){if(c(this,M),this.isEmpty())return NaN;let w=this.get(M,0);for(let m=1;m<this.columns;m++)this.get(M,m)>w&&(w=this.get(M,m));return w}maxRowIndex(M){c(this,M),E(this);let w=this.get(M,0),m=[M,0];for(let x=1;x<this.columns;x++)this.get(M,x)>w&&(w=this.get(M,x),m[1]=x);return m}minRow(M){if(c(this,M),this.isEmpty())return NaN;let w=this.get(M,0);for(let m=1;m<this.columns;m++)this.get(M,m)<w&&(w=this.get(M,m));return w}minRowIndex(M){c(this,M),E(this);let w=this.get(M,0),m=[M,0];for(let x=1;x<this.columns;x++)this.get(M,x)<w&&(w=this.get(M,x),m[1]=x);return m}maxColumn(M){if(d(this,M),this.isEmpty())return NaN;let w=this.get(0,M);for(let m=1;m<this.rows;m++)this.get(m,M)>w&&(w=this.get(m,M));return w}maxColumnIndex(M){d(this,M),E(this);let w=this.get(0,M),m=[0,M];for(let x=1;x<this.rows;x++)this.get(x,M)>w&&(w=this.get(x,M),m[0]=x);return m}minColumn(M){if(d(this,M),this.isEmpty())return NaN;let w=this.get(0,M);for(let m=1;m<this.rows;m++)this.get(m,M)<w&&(w=this.get(m,M));return w}minColumnIndex(M){d(this,M),E(this);let w=this.get(0,M),m=[0,M];for(let x=1;x<this.rows;x++)this.get(x,M)<w&&(w=this.get(x,M),m[0]=x);return m}diag(){let M=Math.min(this.rows,this.columns),w=[];for(let m=0;m<M;m++)w.push(this.get(m,m));return w}norm(M="frobenius"){switch(M){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${M}`)}}cumulativeSum(){let M=0;for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)M+=this.get(w,m),this.set(w,m,M);return this}dot(M){ae.isMatrix(M)&&(M=M.to1DArray());let w=this.to1DArray();if(w.length!==M.length)throw new RangeError("vectors do not have the same size");let m=0;for(let x=0;x<w.length;x++)m+=w[x]*M[x];return m}mmul(M){M=J.checkMatrix(M);let w=this.rows,m=this.columns,x=M.columns,N=new J(w,x),D=new Float64Array(m);for(let I=0;I<x;I++){for(let j=0;j<m;j++)D[j]=M.get(j,I);for(let j=0;j<w;j++){let B=0;for(let Z=0;Z<m;Z++)B+=this.get(j,Z)*D[Z];N.set(j,I,B)}}return N}mpow(M){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(M)||M<0)throw new RangeError("Exponent must be a non-negative integer");let w=J.eye(this.rows),m=this;for(let x=M;x>1;x/=2)(x&1)!==0&&(w=w.mmul(m)),m=m.mmul(m);return w}strassen2x2(M){M=J.checkMatrix(M);let w=new J(2,2);const m=this.get(0,0),x=M.get(0,0),N=this.get(0,1),D=M.get(0,1),I=this.get(1,0),j=M.get(1,0),B=this.get(1,1),Z=M.get(1,1),G=(m+B)*(x+Z),ne=(I+B)*x,pe=m*(D-Z),Q=B*(j-x),ie=(m+N)*Z,we=(I-m)*(x+D),H=(N-B)*(j+Z),ge=G+Q-ie+H,Se=pe+ie,De=ne+Q,je=G-ne+pe+we;return w.set(0,0,ge),w.set(0,1,Se),w.set(1,0,De),w.set(1,1,je),w}strassen3x3(M){M=J.checkMatrix(M);let w=new J(3,3);const m=this.get(0,0),x=this.get(0,1),N=this.get(0,2),D=this.get(1,0),I=this.get(1,1),j=this.get(1,2),B=this.get(2,0),Z=this.get(2,1),G=this.get(2,2),ne=M.get(0,0),pe=M.get(0,1),Q=M.get(0,2),ie=M.get(1,0),we=M.get(1,1),H=M.get(1,2),ge=M.get(2,0),Se=M.get(2,1),De=M.get(2,2),je=(m+x+N-D-I-Z-G)*we,Et=(m-D)*(-pe+we),Ne=I*(-ne+pe+ie-we-H-ge+De),Pe=(-m+D+I)*(ne-pe+we),ot=(D+I)*(-ne+pe),X=m*ne,de=(-m+B+Z)*(ne-Q+H),xe=(-m+B)*(Q-H),he=(B+Z)*(-ne+Q),Mt=(m+x+N-I-j-B-Z)*H,Je=Z*(-ne+Q+ie-we-H-ge+Se),pt=(-N+Z+G)*(we+ge-Se),St=(N-G)*(we-Se),un=N*ge,pr=(Z+G)*(-ge+Se),Ht=(-N+I+j)*(H+ge-De),Cr=(N-j)*(H-De),Qr=(I+j)*(-ge+De),qe=x*ie,cn=j*Se,Yn=D*Q,Vn=B*pe,Xt=G*De,jw=X+un+qe,Bw=je+Pe+ot+X+pt+un+pr,zw=X+de+he+Mt+un+Ht+Qr,Fw=Et+Ne+Pe+X+un+Ht+Cr,$w=Et+Pe+ot+X+cn,Ww=un+Ht+Cr+Qr+Yn,Gw=X+de+xe+Je+pt+St+un,Yw=pt+St+un+pr+Vn,Vw=X+de+xe+he+Xt;return w.set(0,0,jw),w.set(0,1,Bw),w.set(0,2,zw),w.set(1,0,Fw),w.set(1,1,$w),w.set(1,2,Ww),w.set(2,0,Gw),w.set(2,1,Yw),w.set(2,2,Vw),w}mmulStrassen(M){M=J.checkMatrix(M);let w=this.clone(),m=w.rows,x=w.columns,N=M.rows,D=M.columns;x!==N&&console.warn(`Multiplying ${m} x ${x} and ${N} x ${D} matrix: dimensions do not match.`);function I(G,ne,pe){let Q=G.rows,ie=G.columns;if(Q===ne&&ie===pe)return G;{let we=ae.zeros(ne,pe);return we=we.setSubMatrix(G,0,0),we}}let j=Math.max(m,N),B=Math.max(x,D);w=I(w,j,B),M=I(M,j,B);function Z(G,ne,pe,Q){if(pe<=512||Q<=512)return G.mmul(ne);pe%2===1&&Q%2===1?(G=I(G,pe+1,Q+1),ne=I(ne,pe+1,Q+1)):pe%2===1?(G=I(G,pe+1,Q),ne=I(ne,pe+1,Q)):Q%2===1&&(G=I(G,pe,Q+1),ne=I(ne,pe,Q+1));let ie=parseInt(G.rows/2,10),we=parseInt(G.columns/2,10),H=G.subMatrix(0,ie-1,0,we-1),ge=ne.subMatrix(0,ie-1,0,we-1),Se=G.subMatrix(0,ie-1,we,G.columns-1),De=ne.subMatrix(0,ie-1,we,ne.columns-1),je=G.subMatrix(ie,G.rows-1,0,we-1),Et=ne.subMatrix(ie,ne.rows-1,0,we-1),Ne=G.subMatrix(ie,G.rows-1,we,G.columns-1),Pe=ne.subMatrix(ie,ne.rows-1,we,ne.columns-1),ot=Z(ae.add(H,Ne),ae.add(ge,Pe),ie,we),X=Z(ae.add(je,Ne),ge,ie,we),de=Z(H,ae.sub(De,Pe),ie,we),xe=Z(Ne,ae.sub(Et,ge),ie,we),he=Z(ae.add(H,Se),Pe,ie,we),Mt=Z(ae.sub(je,H),ae.add(ge,De),ie,we),Je=Z(ae.sub(Se,Ne),ae.add(Et,Pe),ie,we),pt=ae.add(ot,xe);pt.sub(he),pt.add(Je);let St=ae.add(de,he),un=ae.add(X,xe),pr=ae.sub(ot,X);pr.add(de),pr.add(Mt);let Ht=ae.zeros(2*pt.rows,2*pt.columns);return Ht=Ht.setSubMatrix(pt,0,0),Ht=Ht.setSubMatrix(St,pt.rows,0),Ht=Ht.setSubMatrix(un,0,pt.columns),Ht=Ht.setSubMatrix(pr,pt.rows,pt.columns),Ht.subMatrix(0,pe-1,0,Q-1)}return Z(w,M,j,B)}scaleRows(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:w=0,max:m=1}=M;if(!Number.isFinite(w))throw new TypeError("min must be a number");if(!Number.isFinite(m))throw new TypeError("max must be a number");if(w>=m)throw new RangeError("min must be smaller than max");let x=new J(this.rows,this.columns);for(let N=0;N<this.rows;N++){const D=this.getRow(N);D.length>0&&e(D,{min:w,max:m,output:D}),x.setRow(N,D)}return x}scaleColumns(M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:w=0,max:m=1}=M;if(!Number.isFinite(w))throw new TypeError("min must be a number");if(!Number.isFinite(m))throw new TypeError("max must be a number");if(w>=m)throw new RangeError("min must be smaller than max");let x=new J(this.rows,this.columns);for(let N=0;N<this.columns;N++){const D=this.getColumn(N);D.length&&e(D,{min:w,max:m,output:D}),x.setColumn(N,D)}return x}flipRows(){const M=Math.ceil(this.columns/2);for(let w=0;w<this.rows;w++)for(let m=0;m<M;m++){let x=this.get(w,m),N=this.get(w,this.columns-1-m);this.set(w,m,N),this.set(w,this.columns-1-m,x)}return this}flipColumns(){const M=Math.ceil(this.rows/2);for(let w=0;w<this.columns;w++)for(let m=0;m<M;m++){let x=this.get(m,w),N=this.get(this.rows-1-m,w);this.set(m,w,N),this.set(this.rows-1-m,w,x)}return this}kroneckerProduct(M){M=J.checkMatrix(M);let w=this.rows,m=this.columns,x=M.rows,N=M.columns,D=new J(w*x,m*N);for(let I=0;I<w;I++)for(let j=0;j<m;j++)for(let B=0;B<x;B++)for(let Z=0;Z<N;Z++)D.set(x*I+B,N*j+Z,this.get(I,j)*M.get(B,Z));return D}kroneckerSum(M){if(M=J.checkMatrix(M),!this.isSquare()||!M.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let w=this.rows,m=M.rows,x=this.kroneckerProduct(J.eye(m,m)),N=J.eye(w,w).kroneckerProduct(M);return x.add(N)}transpose(){let M=new J(this.columns,this.rows);for(let w=0;w<this.rows;w++)for(let m=0;m<this.columns;m++)M.set(m,w,this.get(w,m));return M}sortRows(M=Ce){for(let w=0;w<this.rows;w++)this.setRow(w,this.getRow(w).sort(M));return this}sortColumns(M=Ce){for(let w=0;w<this.columns;w++)this.setColumn(w,this.getColumn(w).sort(M));return this}subMatrix(M,w,m,x){p(this,M,w,m,x);let N=new J(w-M+1,x-m+1);for(let D=M;D<=w;D++)for(let I=m;I<=x;I++)N.set(D-M,I-m,this.get(D,I));return N}subMatrixRow(M,w,m){if(w===void 0&&(w=0),m===void 0&&(m=this.columns-1),w>m||w<0||w>=this.columns||m<0||m>=this.columns)throw new RangeError("Argument out of range");let x=new J(M.length,m-w+1);for(let N=0;N<M.length;N++)for(let D=w;D<=m;D++){if(M[N]<0||M[N]>=this.rows)throw new RangeError(`Row index out of range: ${M[N]}`);x.set(N,D-w,this.get(M[N],D))}return x}subMatrixColumn(M,w,m){if(w===void 0&&(w=0),m===void 0&&(m=this.rows-1),w>m||w<0||w>=this.rows||m<0||m>=this.rows)throw new RangeError("Argument out of range");let x=new J(m-w+1,M.length);for(let N=0;N<M.length;N++)for(let D=w;D<=m;D++){if(M[N]<0||M[N]>=this.columns)throw new RangeError(`Column index out of range: ${M[N]}`);x.set(D-w,N,this.get(D,M[N]))}return x}setSubMatrix(M,w,m){if(M=J.checkMatrix(M),M.isEmpty())return this;let x=w+M.rows-1,N=m+M.columns-1;p(this,w,x,m,N);for(let D=0;D<M.rows;D++)for(let I=0;I<M.columns;I++)this.set(w+D,m+I,M.get(D,I));return this}selection(M,w){g(this,M),v(this,w);let m=new J(M.length,w.length);for(let x=0;x<M.length;x++){let N=M[x];for(let D=0;D<w.length;D++){let I=w[D];m.set(x,D,this.get(N,I))}}return m}trace(){let M=Math.min(this.rows,this.columns),w=0;for(let m=0;m<M;m++)w+=this.get(m,m);return w}clone(){return this.constructor.copy(this,new J(this.rows,this.columns))}static copy(M,w){for(const[m,x,N]of M.entries())w.set(m,x,N);return w}sum(M){switch(M){case"row":return T(this);case"column":return S(this);case void 0:return k(this);default:throw new Error(`invalid option: ${M}`)}}product(M){switch(M){case"row":return A(this);case"column":return O(this);case void 0:return C(this);default:throw new Error(`invalid option: ${M}`)}}mean(M){const w=this.sum(M);switch(M){case"row":{for(let m=0;m<this.rows;m++)w[m]/=this.columns;return w}case"column":{for(let m=0;m<this.columns;m++)w[m]/=this.rows;return w}case void 0:return w/this.size;default:throw new Error(`invalid option: ${M}`)}}variance(M,w={}){if(typeof M=="object"&&(w=M,M=void 0),typeof w!="object")throw new TypeError("options must be an object");const{unbiased:m=!0,mean:x=this.mean(M)}=w;if(typeof m!="boolean")throw new TypeError("unbiased must be a boolean");switch(M){case"row":{if(!r.isAnyArray(x))throw new TypeError("mean must be an array");return P(this,m,x)}case"column":{if(!r.isAnyArray(x))throw new TypeError("mean must be an array");return L(this,m,x)}case void 0:{if(typeof x!="number")throw new TypeError("mean must be a number");return R(this,m,x)}default:throw new Error(`invalid option: ${M}`)}}standardDeviation(M,w){typeof M=="object"&&(w=M,M=void 0);const m=this.variance(M,w);if(M===void 0)return Math.sqrt(m);for(let x=0;x<m.length;x++)m[x]=Math.sqrt(m[x]);return m}center(M,w={}){if(typeof M=="object"&&(w=M,M=void 0),typeof w!="object")throw new TypeError("options must be an object");const{center:m=this.mean(M)}=w;switch(M){case"row":{if(!r.isAnyArray(m))throw new TypeError("center must be an array");return z(this,m),this}case"column":{if(!r.isAnyArray(m))throw new TypeError("center must be an array");return Y(this,m),this}case void 0:{if(typeof m!="number")throw new TypeError("center must be a number");return U(this,m),this}default:throw new Error(`invalid option: ${M}`)}}scale(M,w={}){if(typeof M=="object"&&(w=M,M=void 0),typeof w!="object")throw new TypeError("options must be an object");let m=w.scale;switch(M){case"row":{if(m===void 0)m=V(this);else if(!r.isAnyArray(m))throw new TypeError("scale must be an array");return W(this,m),this}case"column":{if(m===void 0)m=F(this);else if(!r.isAnyArray(m))throw new TypeError("scale must be an array");return K(this,m),this}case void 0:{if(m===void 0)m=re(this);else if(typeof m!="number")throw new TypeError("scale must be a number");return se(this,m),this}default:throw new Error(`invalid option: ${M}`)}}toString(M){return s(this,M)}[Symbol.iterator](){return this.entries()}*entries(){for(let M=0;M<this.rows;M++)for(let w=0;w<this.columns;w++)yield[M,w,this.get(M,w)]}*values(){for(let M=0;M<this.rows;M++)for(let w=0;w<this.columns;w++)yield this.get(M,w)}}ae.prototype.klass="Matrix",typeof Symbol<"u"&&(ae.prototype[Symbol.for("nodejs.util.inspect.custom")]=i);function Ce(_,M){return _-M}function Te(_){return _.every(M=>typeof M=="number")}ae.random=ae.rand,ae.randomInt=ae.randInt,ae.diagonal=ae.diag,ae.prototype.diagonal=ae.prototype.diag,ae.identity=ae.eye,ae.prototype.negate=ae.prototype.neg,ae.prototype.tensorProduct=ae.prototype.kroneckerProduct;const Ro=class Ro extends ae{constructor(w,m){super();Yc(this,Sa);vt(this,"data");if(Ro.isMatrix(w))Vc(this,Sa,lf).call(this,w.rows,w.columns),Ro.copy(w,this);else if(Number.isInteger(w)&&w>=0)Vc(this,Sa,lf).call(this,w,m);else if(r.isAnyArray(w)){const x=w;if(w=x.length,m=w?x[0].length:0,typeof m!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let N=0;N<w;N++){if(x[N].length!==m)throw new RangeError("Inconsistent array dimensions");if(!Te(x[N]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(x[N]))}this.rows=w,this.columns=m}else throw new TypeError("First argument must be a positive number or an array")}set(w,m,x){return this.data[w][m]=x,this}get(w,m){return this.data[w][m]}removeRow(w){return c(this,w),this.data.splice(w,1),this.rows-=1,this}addRow(w,m){return m===void 0&&(m=w,w=this.rows),c(this,w,!0),m=Float64Array.from(h(this,m)),this.data.splice(w,0,m),this.rows+=1,this}removeColumn(w){d(this,w);for(let m=0;m<this.rows;m++){const x=new Float64Array(this.columns-1);for(let N=0;N<w;N++)x[N]=this.data[m][N];for(let N=w+1;N<this.columns;N++)x[N-1]=this.data[m][N];this.data[m]=x}return this.columns-=1,this}addColumn(w,m){typeof m>"u"&&(m=w,w=this.columns),d(this,w,!0),m=f(this,m);for(let x=0;x<this.rows;x++){const N=new Float64Array(this.columns+1);let D=0;for(;D<w;D++)N[D]=this.data[x][D];for(N[D++]=m[x];D<this.columns+1;D++)N[D]=this.data[x][D-1];this.data[x]=N}return this.columns+=1,this}};Sa=new WeakSet,lf=function(w,m){if(this.data=[],Number.isInteger(m)&&m>=0)for(let x=0;x<w;x++)this.data.push(new Float64Array(m));else throw new TypeError("nColumns must be a positive integer");this.rows=w,this.columns=m};let J=Ro;u(ae,J);const jo=class jo extends ae{constructor(w){super();Yc(this,yn);if(J.isMatrix(w)){if(!w.isSymmetric())throw new TypeError("not symmetric data");Bo(this,yn,J.copy(w,new J(w.rows,w.rows)))}else if(Number.isInteger(w)&&w>=0)Bo(this,yn,new J(w,w));else if(Bo(this,yn,new J(w)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return vr(this,yn).size}get rows(){return vr(this,yn).rows}get columns(){return vr(this,yn).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(w){return J.isMatrix(w)&&w.klassType==="SymmetricMatrix"}static zeros(w){return new this(w)}static ones(w){return new this(w).fill(1)}clone(){const w=new jo(this.diagonalSize);for(const[m,x,N]of this.upperRightEntries())w.set(m,x,N);return w}toMatrix(){return new J(this)}get(w,m){return vr(this,yn).get(w,m)}set(w,m,x){return vr(this,yn).set(w,m,x),vr(this,yn).set(m,w,x),this}removeCross(w){return vr(this,yn).removeRow(w),vr(this,yn).removeColumn(w),this}addCross(w,m){m===void 0&&(m=w,w=this.diagonalSize);const x=m.slice();return x.splice(w,1),vr(this,yn).addRow(w,x),vr(this,yn).addColumn(w,m),this}applyMask(w){if(w.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const m=[];for(const[x,N]of w.entries())N||m.push(x);m.reverse();for(const x of m)this.removeCross(x);return this}toCompact(){const{diagonalSize:w}=this,m=new Array(w*(w+1)/2);for(let x=0,N=0,D=0;D<m.length;D++)m[D]=this.get(N,x),++x>=w&&(x=++N);return m}static fromCompact(w){const m=w.length,x=(Math.sqrt(8*m+1)-1)/2;if(!Number.isInteger(x))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(w)}`);const N=new jo(x);for(let D=0,I=0,j=0;j<m;j++)N.set(D,I,w[j]),++D>=x&&(D=++I);return N}*upperRightEntries(){for(let w=0,m=0;w<this.diagonalSize;void 0){const x=this.get(w,m);yield[w,m,x],++m>=this.diagonalSize&&(m=++w)}}*upperRightValues(){for(let w=0,m=0;w<this.diagonalSize;void 0)yield this.get(w,m),++m>=this.diagonalSize&&(m=++w)}};yn=new WeakMap;let Oe=jo;Oe.prototype.klassType="SymmetricMatrix";class _e extends Oe{static isDistanceMatrix(M){return Oe.isSymmetricMatrix(M)&&M.klassSubType==="DistanceMatrix"}constructor(M){if(super(M),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(M,w,m){return M===w&&(m=0),super.set(M,w,m)}addCross(M,w){return w===void 0&&(w=M,M=this.diagonalSize),w=w.slice(),w[M]=0,super.addCross(M,w)}toSymmetricMatrix(){return new Oe(this)}clone(){const M=new _e(this.diagonalSize);for(const[w,m,x]of this.upperRightEntries())w!==m&&M.set(w,m,x);return M}toCompact(){const{diagonalSize:M}=this,w=(M-1)*M/2,m=new Array(w);for(let x=1,N=0,D=0;D<m.length;D++)m[D]=this.get(N,x),++x>=M&&(x=++N+1);return m}static fromCompact(M){const w=M.length;if(w===0)return new this(0);const m=(Math.sqrt(8*w+1)+1)/2;if(!Number.isInteger(m))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(M)}`);const x=new this(m);for(let N=1,D=0,I=0;I<w;I++)x.set(N,D,M[I]),++N>=m&&(N=++D+1);return x}}_e.prototype.klassSubType="DistanceMatrix";class Ve extends ae{constructor(M,w,m){super(),this.matrix=M,this.rows=w,this.columns=m}}class Qe extends Ve{constructor(M,w){d(M,w),super(M,M.rows,1),this.column=w}set(M,w,m){return this.matrix.set(M,this.column,m),this}get(M){return this.matrix.get(M,this.column)}}class zt extends Ve{constructor(M,w){v(M,w),super(M,M.rows,w.length),this.columnIndices=w}set(M,w,m){return this.matrix.set(M,this.columnIndices[w],m),this}get(M,w){return this.matrix.get(M,this.columnIndices[w])}}class Xr extends Ve{constructor(M){super(M,M.rows,M.columns)}set(M,w,m){return this.matrix.set(M,this.columns-w-1,m),this}get(M,w){return this.matrix.get(M,this.columns-w-1)}}class Gn extends Ve{constructor(M){super(M,M.rows,M.columns)}set(M,w,m){return this.matrix.set(this.rows-M-1,w,m),this}get(M,w){return this.matrix.get(this.rows-M-1,w)}}class qr extends Ve{constructor(M,w){c(M,w),super(M,1,M.columns),this.row=w}set(M,w,m){return this.matrix.set(this.row,w,m),this}get(M,w){return this.matrix.get(this.row,w)}}class zc extends Ve{constructor(M,w){g(M,w),super(M,w.length,M.columns),this.rowIndices=w}set(M,w,m){return this.matrix.set(this.rowIndices[M],w,m),this}get(M,w){return this.matrix.get(this.rowIndices[M],w)}}class ts extends Ve{constructor(M,w,m){g(M,w),v(M,m),super(M,w.length,m.length),this.rowIndices=w,this.columnIndices=m}set(M,w,m){return this.matrix.set(this.rowIndices[M],this.columnIndices[w],m),this}get(M,w){return this.matrix.get(this.rowIndices[M],this.columnIndices[w])}}class _o extends Ve{constructor(M,w,m,x,N){p(M,w,m,x,N),super(M,m-w+1,N-x+1),this.startRow=w,this.startColumn=x}set(M,w,m){return this.matrix.set(this.startRow+M,this.startColumn+w,m),this}get(M,w){return this.matrix.get(this.startRow+M,this.startColumn+w)}}class Lo extends Ve{constructor(M){super(M,M.columns,M.rows)}set(M,w,m){return this.matrix.set(w,M,m),this}get(M,w){return this.matrix.get(w,M)}}class Ma extends ae{constructor(M,w={}){const{rows:m=1}=w;if(M.length%m!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=m,this.columns=M.length/m,this.data=M}set(M,w,m){let x=this._calculateIndex(M,w);return this.data[x]=m,this}get(M,w){let m=this._calculateIndex(M,w);return this.data[m]}_calculateIndex(M,w){return M*this.columns+w}}class tn extends ae{constructor(M){super(),this.data=M,this.rows=M.length,this.columns=M[0].length}set(M,w,m){return this.data[M][w]=m,this}get(M,w){return this.data[M][w]}}function Do(_,M){if(r.isAnyArray(_))return _[0]&&r.isAnyArray(_[0])?new tn(_):new Ma(_,M);throw new Error("the argument is not an array")}class ns{constructor(M){M=tn.checkMatrix(M);let w=M.clone(),m=w.rows,x=w.columns,N=new Float64Array(m),D=1,I,j,B,Z,G,ne,pe,Q,ie;for(I=0;I<m;I++)N[I]=I;for(Q=new Float64Array(m),j=0;j<x;j++){for(I=0;I<m;I++)Q[I]=w.get(I,j);for(I=0;I<m;I++){for(ie=Math.min(I,j),G=0,B=0;B<ie;B++)G+=w.get(I,B)*Q[B];Q[I]-=G,w.set(I,j,Q[I])}for(Z=j,I=j+1;I<m;I++)Math.abs(Q[I])>Math.abs(Q[Z])&&(Z=I);if(Z!==j){for(B=0;B<x;B++)ne=w.get(Z,B),w.set(Z,B,w.get(j,B)),w.set(j,B,ne);pe=N[Z],N[Z]=N[j],N[j]=pe,D=-D}if(j<m&&w.get(j,j)!==0)for(I=j+1;I<m;I++)w.set(I,j,w.get(I,j)/w.get(j,j))}this.LU=w,this.pivotVector=N,this.pivotSign=D}isSingular(){let M=this.LU,w=M.columns;for(let m=0;m<w;m++)if(M.get(m,m)===0)return!0;return!1}solve(M){M=J.checkMatrix(M);let w=this.LU;if(w.rows!==M.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let x=M.columns,N=M.subMatrixRow(this.pivotVector,0,x-1),D=w.columns,I,j,B;for(B=0;B<D;B++)for(I=B+1;I<D;I++)for(j=0;j<x;j++)N.set(I,j,N.get(I,j)-N.get(B,j)*w.get(I,B));for(B=D-1;B>=0;B--){for(j=0;j<x;j++)N.set(B,j,N.get(B,j)/w.get(B,B));for(I=0;I<B;I++)for(j=0;j<x;j++)N.set(I,j,N.get(I,j)-N.get(B,j)*w.get(I,B))}return N}get determinant(){let M=this.LU;if(!M.isSquare())throw new Error("Matrix must be square");let w=this.pivotSign,m=M.columns;for(let x=0;x<m;x++)w*=M.get(x,x);return w}get lowerTriangularMatrix(){let M=this.LU,w=M.rows,m=M.columns,x=new J(w,m);for(let N=0;N<w;N++)for(let D=0;D<m;D++)N>D?x.set(N,D,M.get(N,D)):N===D?x.set(N,D,1):x.set(N,D,0);return x}get upperTriangularMatrix(){let M=this.LU,w=M.rows,m=M.columns,x=new J(w,m);for(let N=0;N<w;N++)for(let D=0;D<m;D++)N<=D?x.set(N,D,M.get(N,D)):x.set(N,D,0);return x}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function ir(_,M){let w=0;return Math.abs(_)>Math.abs(M)?(w=M/_,Math.abs(_)*Math.sqrt(1+w*w)):M!==0?(w=_/M,Math.abs(M)*Math.sqrt(1+w*w)):0}class vi{constructor(M){M=tn.checkMatrix(M);let w=M.clone(),m=M.rows,x=M.columns,N=new Float64Array(x),D,I,j,B;for(j=0;j<x;j++){let Z=0;for(D=j;D<m;D++)Z=ir(Z,w.get(D,j));if(Z!==0){for(w.get(j,j)<0&&(Z=-Z),D=j;D<m;D++)w.set(D,j,w.get(D,j)/Z);for(w.set(j,j,w.get(j,j)+1),I=j+1;I<x;I++){for(B=0,D=j;D<m;D++)B+=w.get(D,j)*w.get(D,I);for(B=-B/w.get(j,j),D=j;D<m;D++)w.set(D,I,w.get(D,I)+B*w.get(D,j))}}N[j]=-Z}this.QR=w,this.Rdiag=N}solve(M){M=J.checkMatrix(M);let w=this.QR,m=w.rows;if(M.rows!==m)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let x=M.columns,N=M.clone(),D=w.columns,I,j,B,Z;for(B=0;B<D;B++)for(j=0;j<x;j++){for(Z=0,I=B;I<m;I++)Z+=w.get(I,B)*N.get(I,j);for(Z=-Z/w.get(B,B),I=B;I<m;I++)N.set(I,j,N.get(I,j)+Z*w.get(I,B))}for(B=D-1;B>=0;B--){for(j=0;j<x;j++)N.set(B,j,N.get(B,j)/this.Rdiag[B]);for(I=0;I<B;I++)for(j=0;j<x;j++)N.set(I,j,N.get(I,j)-N.get(B,j)*w.get(I,B))}return N.subMatrix(0,D-1,0,x-1)}isFullRank(){let M=this.QR.columns;for(let w=0;w<M;w++)if(this.Rdiag[w]===0)return!1;return!0}get upperTriangularMatrix(){let M=this.QR,w=M.columns,m=new J(w,w),x,N;for(x=0;x<w;x++)for(N=0;N<w;N++)x<N?m.set(x,N,M.get(x,N)):x===N?m.set(x,N,this.Rdiag[x]):m.set(x,N,0);return m}get orthogonalMatrix(){let M=this.QR,w=M.rows,m=M.columns,x=new J(w,m),N,D,I,j;for(I=m-1;I>=0;I--){for(N=0;N<w;N++)x.set(N,I,0);for(x.set(I,I,1),D=I;D<m;D++)if(M.get(I,I)!==0){for(j=0,N=I;N<w;N++)j+=M.get(N,I)*x.get(N,D);for(j=-j/M.get(I,I),N=I;N<w;N++)x.set(N,D,x.get(N,D)+j*M.get(N,I))}}return x}}class Zr{constructor(M,w={}){if(M=tn.checkMatrix(M),M.isEmpty())throw new Error("Matrix must be non-empty");let m=M.rows,x=M.columns;const{computeLeftSingularVectors:N=!0,computeRightSingularVectors:D=!0,autoTranspose:I=!1}=w;let j=!!N,B=!!D,Z=!1,G;if(m<x)if(!I)G=M.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{G=M.transpose(),m=G.rows,x=G.columns,Z=!0;let X=j;j=B,B=X}else G=M.clone();let ne=Math.min(m,x),pe=Math.min(m+1,x),Q=new Float64Array(pe),ie=new J(m,ne),we=new J(x,x),H=new Float64Array(x),ge=new Float64Array(m),Se=new Float64Array(pe);for(let X=0;X<pe;X++)Se[X]=X;let De=Math.min(m-1,x),je=Math.max(0,Math.min(x-2,m)),Et=Math.max(De,je);for(let X=0;X<Et;X++){if(X<De){Q[X]=0;for(let de=X;de<m;de++)Q[X]=ir(Q[X],G.get(de,X));if(Q[X]!==0){G.get(X,X)<0&&(Q[X]=-Q[X]);for(let de=X;de<m;de++)G.set(de,X,G.get(de,X)/Q[X]);G.set(X,X,G.get(X,X)+1)}Q[X]=-Q[X]}for(let de=X+1;de<x;de++){if(X<De&&Q[X]!==0){let xe=0;for(let he=X;he<m;he++)xe+=G.get(he,X)*G.get(he,de);xe=-xe/G.get(X,X);for(let he=X;he<m;he++)G.set(he,de,G.get(he,de)+xe*G.get(he,X))}H[de]=G.get(X,de)}if(j&&X<De)for(let de=X;de<m;de++)ie.set(de,X,G.get(de,X));if(X<je){H[X]=0;for(let de=X+1;de<x;de++)H[X]=ir(H[X],H[de]);if(H[X]!==0){H[X+1]<0&&(H[X]=0-H[X]);for(let de=X+1;de<x;de++)H[de]/=H[X];H[X+1]+=1}if(H[X]=-H[X],X+1<m&&H[X]!==0){for(let de=X+1;de<m;de++)ge[de]=0;for(let de=X+1;de<m;de++)for(let xe=X+1;xe<x;xe++)ge[de]+=H[xe]*G.get(de,xe);for(let de=X+1;de<x;de++){let xe=-H[de]/H[X+1];for(let he=X+1;he<m;he++)G.set(he,de,G.get(he,de)+xe*ge[he])}}if(B)for(let de=X+1;de<x;de++)we.set(de,X,H[de])}}let Ne=Math.min(x,m+1);if(De<x&&(Q[De]=G.get(De,De)),m<Ne&&(Q[Ne-1]=0),je+1<Ne&&(H[je]=G.get(je,Ne-1)),H[Ne-1]=0,j){for(let X=De;X<ne;X++){for(let de=0;de<m;de++)ie.set(de,X,0);ie.set(X,X,1)}for(let X=De-1;X>=0;X--)if(Q[X]!==0){for(let de=X+1;de<ne;de++){let xe=0;for(let he=X;he<m;he++)xe+=ie.get(he,X)*ie.get(he,de);xe=-xe/ie.get(X,X);for(let he=X;he<m;he++)ie.set(he,de,ie.get(he,de)+xe*ie.get(he,X))}for(let de=X;de<m;de++)ie.set(de,X,-ie.get(de,X));ie.set(X,X,1+ie.get(X,X));for(let de=0;de<X-1;de++)ie.set(de,X,0)}else{for(let de=0;de<m;de++)ie.set(de,X,0);ie.set(X,X,1)}}if(B)for(let X=x-1;X>=0;X--){if(X<je&&H[X]!==0)for(let de=X+1;de<x;de++){let xe=0;for(let he=X+1;he<x;he++)xe+=we.get(he,X)*we.get(he,de);xe=-xe/we.get(X+1,X);for(let he=X+1;he<x;he++)we.set(he,de,we.get(he,de)+xe*we.get(he,X))}for(let de=0;de<x;de++)we.set(de,X,0);we.set(X,X,1)}let Pe=Ne-1,ot=Number.EPSILON;for(;Ne>0;){let X,de;for(X=Ne-2;X>=-1&&X!==-1;X--){const xe=Number.MIN_VALUE+ot*Math.abs(Q[X]+Math.abs(Q[X+1]));if(Math.abs(H[X])<=xe||Number.isNaN(H[X])){H[X]=0;break}}if(X===Ne-2)de=4;else{let xe;for(xe=Ne-1;xe>=X&&xe!==X;xe--){let he=(xe!==Ne?Math.abs(H[xe]):0)+(xe!==X+1?Math.abs(H[xe-1]):0);if(Math.abs(Q[xe])<=ot*he){Q[xe]=0;break}}xe===X?de=3:xe===Ne-1?de=1:(de=2,X=xe)}switch(X++,de){case 1:{let xe=H[Ne-2];H[Ne-2]=0;for(let he=Ne-2;he>=X;he--){let Mt=ir(Q[he],xe),Je=Q[he]/Mt,pt=xe/Mt;if(Q[he]=Mt,he!==X&&(xe=-pt*H[he-1],H[he-1]=Je*H[he-1]),B)for(let St=0;St<x;St++)Mt=Je*we.get(St,he)+pt*we.get(St,Ne-1),we.set(St,Ne-1,-pt*we.get(St,he)+Je*we.get(St,Ne-1)),we.set(St,he,Mt)}break}case 2:{let xe=H[X-1];H[X-1]=0;for(let he=X;he<Ne;he++){let Mt=ir(Q[he],xe),Je=Q[he]/Mt,pt=xe/Mt;if(Q[he]=Mt,xe=-pt*H[he],H[he]=Je*H[he],j)for(let St=0;St<m;St++)Mt=Je*ie.get(St,he)+pt*ie.get(St,X-1),ie.set(St,X-1,-pt*ie.get(St,he)+Je*ie.get(St,X-1)),ie.set(St,he,Mt)}break}case 3:{const xe=Math.max(Math.abs(Q[Ne-1]),Math.abs(Q[Ne-2]),Math.abs(H[Ne-2]),Math.abs(Q[X]),Math.abs(H[X])),he=Q[Ne-1]/xe,Mt=Q[Ne-2]/xe,Je=H[Ne-2]/xe,pt=Q[X]/xe,St=H[X]/xe,un=((Mt+he)*(Mt-he)+Je*Je)/2,pr=he*Je*(he*Je);let Ht=0;(un!==0||pr!==0)&&(un<0?Ht=0-Math.sqrt(un*un+pr):Ht=Math.sqrt(un*un+pr),Ht=pr/(un+Ht));let Cr=(pt+he)*(pt-he)+Ht,Qr=pt*St;for(let qe=X;qe<Ne-1;qe++){let cn=ir(Cr,Qr);cn===0&&(cn=Number.MIN_VALUE);let Yn=Cr/cn,Vn=Qr/cn;if(qe!==X&&(H[qe-1]=cn),Cr=Yn*Q[qe]+Vn*H[qe],H[qe]=Yn*H[qe]-Vn*Q[qe],Qr=Vn*Q[qe+1],Q[qe+1]=Yn*Q[qe+1],B)for(let Xt=0;Xt<x;Xt++)cn=Yn*we.get(Xt,qe)+Vn*we.get(Xt,qe+1),we.set(Xt,qe+1,-Vn*we.get(Xt,qe)+Yn*we.get(Xt,qe+1)),we.set(Xt,qe,cn);if(cn=ir(Cr,Qr),cn===0&&(cn=Number.MIN_VALUE),Yn=Cr/cn,Vn=Qr/cn,Q[qe]=cn,Cr=Yn*H[qe]+Vn*Q[qe+1],Q[qe+1]=-Vn*H[qe]+Yn*Q[qe+1],Qr=Vn*H[qe+1],H[qe+1]=Yn*H[qe+1],j&&qe<m-1)for(let Xt=0;Xt<m;Xt++)cn=Yn*ie.get(Xt,qe)+Vn*ie.get(Xt,qe+1),ie.set(Xt,qe+1,-Vn*ie.get(Xt,qe)+Yn*ie.get(Xt,qe+1)),ie.set(Xt,qe,cn)}H[Ne-2]=Cr;break}case 4:{if(Q[X]<=0&&(Q[X]=Q[X]<0?-Q[X]:0,B))for(let xe=0;xe<=Pe;xe++)we.set(xe,X,-we.get(xe,X));for(;X<Pe&&!(Q[X]>=Q[X+1]);){let xe=Q[X];if(Q[X]=Q[X+1],Q[X+1]=xe,B&&X<x-1)for(let he=0;he<x;he++)xe=we.get(he,X+1),we.set(he,X+1,we.get(he,X)),we.set(he,X,xe);if(j&&X<m-1)for(let he=0;he<m;he++)xe=ie.get(he,X+1),ie.set(he,X+1,ie.get(he,X)),ie.set(he,X,xe);X++}Ne--;break}}}if(Z){let X=we;we=ie,ie=X}this.m=m,this.n=x,this.s=Q,this.U=ie,this.V=we}solve(M){let w=M,m=this.threshold,x=this.s.length,N=J.zeros(x,x);for(let ne=0;ne<x;ne++)Math.abs(this.s[ne])<=m?N.set(ne,ne,0):N.set(ne,ne,1/this.s[ne]);let D=this.U,I=this.rightSingularVectors,j=I.mmul(N),B=I.rows,Z=D.rows,G=J.zeros(B,Z);for(let ne=0;ne<B;ne++)for(let pe=0;pe<Z;pe++){let Q=0;for(let ie=0;ie<x;ie++)Q+=j.get(ne,ie)*D.get(pe,ie);G.set(ne,pe,Q)}return G.mmul(w)}solveForDiagonal(M){return this.solve(J.diag(M))}inverse(){let M=this.V,w=this.threshold,m=M.rows,x=M.columns,N=new J(m,this.s.length);for(let Z=0;Z<m;Z++)for(let G=0;G<x;G++)Math.abs(this.s[G])>w&&N.set(Z,G,M.get(Z,G)/this.s[G]);let D=this.U,I=D.rows,j=D.columns,B=new J(m,I);for(let Z=0;Z<m;Z++)for(let G=0;G<I;G++){let ne=0;for(let pe=0;pe<j;pe++)ne+=N.get(Z,pe)*D.get(G,pe);B.set(Z,G,ne)}return B}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let M=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,w=0,m=this.s;for(let x=0,N=m.length;x<N;x++)m[x]>M&&w++;return w}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return J.diag(this.s)}}function Kr(_,M=!1){return _=tn.checkMatrix(_),M?new Zr(_).inverse():Ar(_,J.eye(_.rows))}function Ar(_,M,w=!1){return _=tn.checkMatrix(_),M=tn.checkMatrix(M),w?new Zr(_).solve(M):_.isSquare()?new ns(_).solve(M):new vi(_).solve(M)}function Is(_){if(_=J.checkMatrix(_),_.isSquare()){if(_.columns===0)return 1;let M,w,m,x;if(_.columns===2)return M=_.get(0,0),w=_.get(0,1),m=_.get(1,0),x=_.get(1,1),M*x-w*m;if(_.columns===3){let N,D,I;return N=new ts(_,[1,2],[1,2]),D=new ts(_,[1,2],[0,2]),I=new ts(_,[1,2],[0,1]),M=_.get(0,0),w=_.get(0,1),m=_.get(0,2),M*Is(N)-w*Is(D)+m*Is(I)}else return new ns(_).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Fc(_,M){let w=[];for(let m=0;m<_;m++)m!==M&&w.push(m);return w}function $c(_,M,w,m=1e-9,x=1e-9){if(_>x)return new Array(M.rows+1).fill(0);{let N=M.addRow(w,[0]);for(let D=0;D<N.rows;D++)Math.abs(N.get(D,0))<m&&N.set(D,0,0);return N.to1DArray()}}function Wc(_,M={}){const{thresholdValue:w=1e-9,thresholdError:m=1e-9}=M;_=J.checkMatrix(_);let x=_.rows,N=new J(x,x);for(let D=0;D<x;D++){let I=J.columnVector(_.getRow(D)),j=_.subMatrixRow(Fc(x,D)).transpose(),Z=new Zr(j).solve(I),G=J.sub(I,j.mmul(Z)).abs().max();N.setRow(D,$c(G,Z,D,w,m))}return N}function Cw(_,M=Number.EPSILON){if(_=J.checkMatrix(_),_.isEmpty())return _.transpose();let w=new Zr(_,{autoTranspose:!0}),m=w.leftSingularVectors,x=w.rightSingularVectors,N=w.diagonal;for(let D=0;D<N.length;D++)Math.abs(N[D])>M?N[D]=1/N[D]:N[D]=0;return x.mmul(J.diag(N).mmul(m.transpose()))}function Pw(_,M=_,w={}){_=new J(_);let m=!1;if(typeof M=="object"&&!J.isMatrix(M)&&!r.isAnyArray(M)?(w=M,M=_,m=!0):M=new J(M),_.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:x=!0}=w;x&&(_=_.center("column"),m||(M=M.center("column")));const N=_.transpose().mmul(M);for(let D=0;D<N.rows;D++)for(let I=0;I<N.columns;I++)N.set(D,I,N.get(D,I)*(1/(_.rows-1)));return N}function _w(_,M=_,w={}){_=new J(_);let m=!1;if(typeof M=="object"&&!J.isMatrix(M)&&!r.isAnyArray(M)?(w=M,M=_,m=!0):M=new J(M),_.rows!==M.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:x=!0,scale:N=!0}=w;x&&(_.center("column"),m||M.center("column")),N&&(_.scale("column"),m||M.scale("column"));const D=_.standardDeviation("column",{unbiased:!0}),I=m?D:M.standardDeviation("column",{unbiased:!0}),j=_.transpose().mmul(M);for(let B=0;B<j.rows;B++)for(let Z=0;Z<j.columns;Z++)j.set(B,Z,j.get(B,Z)*(1/(D[B]*I[Z]))*(1/(_.rows-1)));return j}class Cg{constructor(M,w={}){const{assumeSymmetric:m=!1}=w;if(M=tn.checkMatrix(M),!M.isSquare())throw new Error("Matrix is not a square matrix");if(M.isEmpty())throw new Error("Matrix must be non-empty");let x=M.columns,N=new J(x,x),D=new Float64Array(x),I=new Float64Array(x),j=M,B,Z,G=!1;if(m?G=!0:G=M.isSymmetric(),G){for(B=0;B<x;B++)for(Z=0;Z<x;Z++)N.set(B,Z,j.get(B,Z));Lw(x,I,D,N),Dw(x,I,D,N)}else{let ne=new J(x,x),pe=new Float64Array(x);for(Z=0;Z<x;Z++)for(B=0;B<x;B++)ne.set(B,Z,j.get(B,Z));Iw(x,ne,pe,N),Rw(x,I,D,N,ne)}this.n=x,this.e=I,this.d=D,this.V=N}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let M=this.n,w=this.e,m=this.d,x=new J(M,M),N,D;for(N=0;N<M;N++){for(D=0;D<M;D++)x.set(N,D,0);x.set(N,N,m[N]),w[N]>0?x.set(N,N+1,w[N]):w[N]<0&&x.set(N,N-1,w[N])}return x}}function Lw(_,M,w,m){let x,N,D,I,j,B,Z,G;for(j=0;j<_;j++)w[j]=m.get(_-1,j);for(I=_-1;I>0;I--){for(G=0,D=0,B=0;B<I;B++)G=G+Math.abs(w[B]);if(G===0)for(M[I]=w[I-1],j=0;j<I;j++)w[j]=m.get(I-1,j),m.set(I,j,0),m.set(j,I,0);else{for(B=0;B<I;B++)w[B]/=G,D+=w[B]*w[B];for(x=w[I-1],N=Math.sqrt(D),x>0&&(N=-N),M[I]=G*N,D=D-x*N,w[I-1]=x-N,j=0;j<I;j++)M[j]=0;for(j=0;j<I;j++){for(x=w[j],m.set(j,I,x),N=M[j]+m.get(j,j)*x,B=j+1;B<=I-1;B++)N+=m.get(B,j)*w[B],M[B]+=m.get(B,j)*x;M[j]=N}for(x=0,j=0;j<I;j++)M[j]/=D,x+=M[j]*w[j];for(Z=x/(D+D),j=0;j<I;j++)M[j]-=Z*w[j];for(j=0;j<I;j++){for(x=w[j],N=M[j],B=j;B<=I-1;B++)m.set(B,j,m.get(B,j)-(x*M[B]+N*w[B]));w[j]=m.get(I-1,j),m.set(I,j,0)}}w[I]=D}for(I=0;I<_-1;I++){if(m.set(_-1,I,m.get(I,I)),m.set(I,I,1),D=w[I+1],D!==0){for(B=0;B<=I;B++)w[B]=m.get(B,I+1)/D;for(j=0;j<=I;j++){for(N=0,B=0;B<=I;B++)N+=m.get(B,I+1)*m.get(B,j);for(B=0;B<=I;B++)m.set(B,j,m.get(B,j)-N*w[B])}}for(B=0;B<=I;B++)m.set(B,I+1,0)}for(j=0;j<_;j++)w[j]=m.get(_-1,j),m.set(_-1,j,0);m.set(_-1,_-1,1),M[0]=0}function Dw(_,M,w,m){let x,N,D,I,j,B,Z,G,ne,pe,Q,ie,we,H,ge,Se;for(D=1;D<_;D++)M[D-1]=M[D];M[_-1]=0;let De=0,je=0,Et=Number.EPSILON;for(B=0;B<_;B++){for(je=Math.max(je,Math.abs(w[B])+Math.abs(M[B])),Z=B;Z<_&&!(Math.abs(M[Z])<=Et*je);)Z++;if(Z>B)do{for(x=w[B],G=(w[B+1]-x)/(2*M[B]),ne=ir(G,1),G<0&&(ne=-ne),w[B]=M[B]/(G+ne),w[B+1]=M[B]*(G+ne),pe=w[B+1],N=x-w[B],D=B+2;D<_;D++)w[D]-=N;for(De=De+N,G=w[Z],Q=1,ie=Q,we=Q,H=M[B+1],ge=0,Se=0,D=Z-1;D>=B;D--)for(we=ie,ie=Q,Se=ge,x=Q*M[D],N=Q*G,ne=ir(G,M[D]),M[D+1]=ge*ne,ge=M[D]/ne,Q=G/ne,G=Q*w[D]-ge*x,w[D+1]=N+ge*(Q*x+ge*w[D]),j=0;j<_;j++)N=m.get(j,D+1),m.set(j,D+1,ge*m.get(j,D)+Q*N),m.set(j,D,Q*m.get(j,D)-ge*N);G=-ge*Se*we*H*M[B]/pe,M[B]=ge*G,w[B]=Q*G}while(Math.abs(M[B])>Et*je);w[B]=w[B]+De,M[B]=0}for(D=0;D<_-1;D++){for(j=D,G=w[D],I=D+1;I<_;I++)w[I]<G&&(j=I,G=w[I]);if(j!==D)for(w[j]=w[D],w[D]=G,I=0;I<_;I++)G=m.get(I,D),m.set(I,D,m.get(I,j)),m.set(I,j,G)}}function Iw(_,M,w,m){let x=0,N=_-1,D,I,j,B,Z,G,ne;for(G=x+1;G<=N-1;G++){for(ne=0,B=G;B<=N;B++)ne=ne+Math.abs(M.get(B,G-1));if(ne!==0){for(j=0,B=N;B>=G;B--)w[B]=M.get(B,G-1)/ne,j+=w[B]*w[B];for(I=Math.sqrt(j),w[G]>0&&(I=-I),j=j-w[G]*I,w[G]=w[G]-I,Z=G;Z<_;Z++){for(D=0,B=N;B>=G;B--)D+=w[B]*M.get(B,Z);for(D=D/j,B=G;B<=N;B++)M.set(B,Z,M.get(B,Z)-D*w[B])}for(B=0;B<=N;B++){for(D=0,Z=N;Z>=G;Z--)D+=w[Z]*M.get(B,Z);for(D=D/j,Z=G;Z<=N;Z++)M.set(B,Z,M.get(B,Z)-D*w[Z])}w[G]=ne*w[G],M.set(G,G-1,ne*I)}}for(B=0;B<_;B++)for(Z=0;Z<_;Z++)m.set(B,Z,B===Z?1:0);for(G=N-1;G>=x+1;G--)if(M.get(G,G-1)!==0){for(B=G+1;B<=N;B++)w[B]=M.get(B,G-1);for(Z=G;Z<=N;Z++){for(I=0,B=G;B<=N;B++)I+=w[B]*m.get(B,Z);for(I=I/w[G]/M.get(G,G-1),B=G;B<=N;B++)m.set(B,Z,m.get(B,Z)+I*w[B])}}}function Rw(_,M,w,m,x){let N=_-1,D=0,I=_-1,j=Number.EPSILON,B=0,Z=0,G=0,ne=0,pe=0,Q=0,ie=0,we=0,H,ge,Se,De,je,Et,Ne,Pe,ot,X,de,xe,he,Mt,Je;for(H=0;H<_;H++)for((H<D||H>I)&&(w[H]=x.get(H,H),M[H]=0),ge=Math.max(H-1,0);ge<_;ge++)Z=Z+Math.abs(x.get(H,ge));for(;N>=D;){for(De=N;De>D&&(Q=Math.abs(x.get(De-1,De-1))+Math.abs(x.get(De,De)),Q===0&&(Q=Z),!(Math.abs(x.get(De,De-1))<j*Q));)De--;if(De===N)x.set(N,N,x.get(N,N)+B),w[N]=x.get(N,N),M[N]=0,N--,we=0;else if(De===N-1){if(Ne=x.get(N,N-1)*x.get(N-1,N),G=(x.get(N-1,N-1)-x.get(N,N))/2,ne=G*G+Ne,ie=Math.sqrt(Math.abs(ne)),x.set(N,N,x.get(N,N)+B),x.set(N-1,N-1,x.get(N-1,N-1)+B),Pe=x.get(N,N),ne>=0){for(ie=G>=0?G+ie:G-ie,w[N-1]=Pe+ie,w[N]=w[N-1],ie!==0&&(w[N]=Pe-Ne/ie),M[N-1]=0,M[N]=0,Pe=x.get(N,N-1),Q=Math.abs(Pe)+Math.abs(ie),G=Pe/Q,ne=ie/Q,pe=Math.sqrt(G*G+ne*ne),G=G/pe,ne=ne/pe,ge=N-1;ge<_;ge++)ie=x.get(N-1,ge),x.set(N-1,ge,ne*ie+G*x.get(N,ge)),x.set(N,ge,ne*x.get(N,ge)-G*ie);for(H=0;H<=N;H++)ie=x.get(H,N-1),x.set(H,N-1,ne*ie+G*x.get(H,N)),x.set(H,N,ne*x.get(H,N)-G*ie);for(H=D;H<=I;H++)ie=m.get(H,N-1),m.set(H,N-1,ne*ie+G*m.get(H,N)),m.set(H,N,ne*m.get(H,N)-G*ie)}else w[N-1]=Pe+G,w[N]=Pe+G,M[N-1]=ie,M[N]=-ie;N=N-2,we=0}else{if(Pe=x.get(N,N),ot=0,Ne=0,De<N&&(ot=x.get(N-1,N-1),Ne=x.get(N,N-1)*x.get(N-1,N)),we===10){for(B+=Pe,H=D;H<=N;H++)x.set(H,H,x.get(H,H)-Pe);Q=Math.abs(x.get(N,N-1))+Math.abs(x.get(N-1,N-2)),Pe=ot=.75*Q,Ne=-.4375*Q*Q}if(we===30&&(Q=(ot-Pe)/2,Q=Q*Q+Ne,Q>0)){for(Q=Math.sqrt(Q),ot<Pe&&(Q=-Q),Q=Pe-Ne/((ot-Pe)/2+Q),H=D;H<=N;H++)x.set(H,H,x.get(H,H)-Q);B+=Q,Pe=ot=Ne=.964}for(we=we+1,je=N-2;je>=De&&(ie=x.get(je,je),pe=Pe-ie,Q=ot-ie,G=(pe*Q-Ne)/x.get(je+1,je)+x.get(je,je+1),ne=x.get(je+1,je+1)-ie-pe-Q,pe=x.get(je+2,je+1),Q=Math.abs(G)+Math.abs(ne)+Math.abs(pe),G=G/Q,ne=ne/Q,pe=pe/Q,!(je===De||Math.abs(x.get(je,je-1))*(Math.abs(ne)+Math.abs(pe))<j*(Math.abs(G)*(Math.abs(x.get(je-1,je-1))+Math.abs(ie)+Math.abs(x.get(je+1,je+1))))));)je--;for(H=je+2;H<=N;H++)x.set(H,H-2,0),H>je+2&&x.set(H,H-3,0);for(Se=je;Se<=N-1&&(Mt=Se!==N-1,Se!==je&&(G=x.get(Se,Se-1),ne=x.get(Se+1,Se-1),pe=Mt?x.get(Se+2,Se-1):0,Pe=Math.abs(G)+Math.abs(ne)+Math.abs(pe),Pe!==0&&(G=G/Pe,ne=ne/Pe,pe=pe/Pe)),Pe!==0);Se++)if(Q=Math.sqrt(G*G+ne*ne+pe*pe),G<0&&(Q=-Q),Q!==0){for(Se!==je?x.set(Se,Se-1,-Q*Pe):De!==je&&x.set(Se,Se-1,-x.get(Se,Se-1)),G=G+Q,Pe=G/Q,ot=ne/Q,ie=pe/Q,ne=ne/G,pe=pe/G,ge=Se;ge<_;ge++)G=x.get(Se,ge)+ne*x.get(Se+1,ge),Mt&&(G=G+pe*x.get(Se+2,ge),x.set(Se+2,ge,x.get(Se+2,ge)-G*ie)),x.set(Se,ge,x.get(Se,ge)-G*Pe),x.set(Se+1,ge,x.get(Se+1,ge)-G*ot);for(H=0;H<=Math.min(N,Se+3);H++)G=Pe*x.get(H,Se)+ot*x.get(H,Se+1),Mt&&(G=G+ie*x.get(H,Se+2),x.set(H,Se+2,x.get(H,Se+2)-G*pe)),x.set(H,Se,x.get(H,Se)-G),x.set(H,Se+1,x.get(H,Se+1)-G*ne);for(H=D;H<=I;H++)G=Pe*m.get(H,Se)+ot*m.get(H,Se+1),Mt&&(G=G+ie*m.get(H,Se+2),m.set(H,Se+2,m.get(H,Se+2)-G*pe)),m.set(H,Se,m.get(H,Se)-G),m.set(H,Se+1,m.get(H,Se+1)-G*ne)}}}if(Z!==0){for(N=_-1;N>=0;N--)if(G=w[N],ne=M[N],ne===0)for(De=N,x.set(N,N,1),H=N-1;H>=0;H--){for(Ne=x.get(H,H)-G,pe=0,ge=De;ge<=N;ge++)pe=pe+x.get(H,ge)*x.get(ge,N);if(M[H]<0)ie=Ne,Q=pe;else if(De=H,M[H]===0?x.set(H,N,Ne!==0?-pe/Ne:-pe/(j*Z)):(Pe=x.get(H,H+1),ot=x.get(H+1,H),ne=(w[H]-G)*(w[H]-G)+M[H]*M[H],Et=(Pe*Q-ie*pe)/ne,x.set(H,N,Et),x.set(H+1,N,Math.abs(Pe)>Math.abs(ie)?(-pe-Ne*Et)/Pe:(-Q-ot*Et)/ie)),Et=Math.abs(x.get(H,N)),j*Et*Et>1)for(ge=H;ge<=N;ge++)x.set(ge,N,x.get(ge,N)/Et)}else if(ne<0)for(De=N-1,Math.abs(x.get(N,N-1))>Math.abs(x.get(N-1,N))?(x.set(N-1,N-1,ne/x.get(N,N-1)),x.set(N-1,N,-(x.get(N,N)-G)/x.get(N,N-1))):(Je=Io(0,-x.get(N-1,N),x.get(N-1,N-1)-G,ne),x.set(N-1,N-1,Je[0]),x.set(N-1,N,Je[1])),x.set(N,N-1,0),x.set(N,N,1),H=N-2;H>=0;H--){for(X=0,de=0,ge=De;ge<=N;ge++)X=X+x.get(H,ge)*x.get(ge,N-1),de=de+x.get(H,ge)*x.get(ge,N);if(Ne=x.get(H,H)-G,M[H]<0)ie=Ne,pe=X,Q=de;else if(De=H,M[H]===0?(Je=Io(-X,-de,Ne,ne),x.set(H,N-1,Je[0]),x.set(H,N,Je[1])):(Pe=x.get(H,H+1),ot=x.get(H+1,H),xe=(w[H]-G)*(w[H]-G)+M[H]*M[H]-ne*ne,he=(w[H]-G)*2*ne,xe===0&&he===0&&(xe=j*Z*(Math.abs(Ne)+Math.abs(ne)+Math.abs(Pe)+Math.abs(ot)+Math.abs(ie))),Je=Io(Pe*pe-ie*X+ne*de,Pe*Q-ie*de-ne*X,xe,he),x.set(H,N-1,Je[0]),x.set(H,N,Je[1]),Math.abs(Pe)>Math.abs(ie)+Math.abs(ne)?(x.set(H+1,N-1,(-X-Ne*x.get(H,N-1)+ne*x.get(H,N))/Pe),x.set(H+1,N,(-de-Ne*x.get(H,N)-ne*x.get(H,N-1))/Pe)):(Je=Io(-pe-ot*x.get(H,N-1),-Q-ot*x.get(H,N),ie,ne),x.set(H+1,N-1,Je[0]),x.set(H+1,N,Je[1]))),Et=Math.max(Math.abs(x.get(H,N-1)),Math.abs(x.get(H,N))),j*Et*Et>1)for(ge=H;ge<=N;ge++)x.set(ge,N-1,x.get(ge,N-1)/Et),x.set(ge,N,x.get(ge,N)/Et)}for(H=0;H<_;H++)if(H<D||H>I)for(ge=H;ge<_;ge++)m.set(H,ge,x.get(H,ge));for(ge=_-1;ge>=D;ge--)for(H=D;H<=I;H++){for(ie=0,Se=D;Se<=Math.min(ge,I);Se++)ie=ie+m.get(H,Se)*x.get(Se,ge);m.set(H,ge,ie)}}}function Io(_,M,w,m){let x,N;return Math.abs(w)>Math.abs(m)?(x=m/w,N=w+x*m,[(_+x*M)/N,(M-x*_)/N]):(x=w/m,N=m+x*w,[(x*_+M)/N,(x*M-_)/N])}class Pg{constructor(M){if(M=tn.checkMatrix(M),!M.isSymmetric())throw new Error("Matrix is not symmetric");let w=M,m=w.rows,x=new J(m,m),N=!0,D,I,j;for(I=0;I<m;I++){let B=0;for(j=0;j<I;j++){let Z=0;for(D=0;D<j;D++)Z+=x.get(j,D)*x.get(I,D);Z=(w.get(I,j)-Z)/x.get(j,j),x.set(I,j,Z),B=B+Z*Z}for(B=w.get(I,I)-B,N&&(N=B>0),x.set(I,I,Math.sqrt(Math.max(B,0))),j=I+1;j<m;j++)x.set(I,j,0)}this.L=x,this.positiveDefinite=N}isPositiveDefinite(){return this.positiveDefinite}solve(M){M=tn.checkMatrix(M);let w=this.L,m=w.rows;if(M.rows!==m)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let x=M.columns,N=M.clone(),D,I,j;for(j=0;j<m;j++)for(I=0;I<x;I++){for(D=0;D<j;D++)N.set(j,I,N.get(j,I)-N.get(D,I)*w.get(j,D));N.set(j,I,N.get(j,I)/w.get(j,j))}for(j=m-1;j>=0;j--)for(I=0;I<x;I++){for(D=j+1;D<m;D++)N.set(j,I,N.get(j,I)-N.get(D,I)*w.get(D,j));N.set(j,I,N.get(j,I)/w.get(j,j))}return N}get lowerTriangularMatrix(){return this.L}}class _g{constructor(M,w={}){M=tn.checkMatrix(M);let{Y:m}=w;const{scaleScores:x=!1,maxIterations:N=1e3,terminationCriteria:D=1e-10}=w;let I;if(m){if(r.isAnyArray(m)&&typeof m[0]=="number"?m=J.columnVector(m):m=tn.checkMatrix(m),m.rows!==M.rows)throw new Error("Y should have the same number of rows as X");I=m.getColumnVector(0)}else I=M.getColumnVector(0);let j=1,B,Z,G,ne;for(let pe=0;pe<N&&j>D;pe++)G=M.transpose().mmul(I).div(I.transpose().mmul(I).get(0,0)),G=G.div(G.norm()),B=M.mmul(G).div(G.transpose().mmul(G).get(0,0)),pe>0&&(j=B.clone().sub(ne).pow(2).sum()),ne=B.clone(),m?(Z=m.transpose().mmul(B).div(B.transpose().mmul(B).get(0,0)),Z=Z.div(Z.norm()),I=m.mmul(Z).div(Z.transpose().mmul(Z).get(0,0))):I=B;if(m){let pe=M.transpose().mmul(B).div(B.transpose().mmul(B).get(0,0));pe=pe.div(pe.norm());let Q=M.clone().sub(B.clone().mmul(pe.transpose())),ie=I.transpose().mmul(B).div(B.transpose().mmul(B).get(0,0)),we=m.clone().sub(B.clone().mulS(ie.get(0,0)).mmul(Z.transpose()));this.t=B,this.p=pe.transpose(),this.w=G.transpose(),this.q=Z,this.u=I,this.s=B.transpose().mmul(B),this.xResidual=Q,this.yResidual=we,this.betas=ie}else this.w=G.transpose(),this.s=B.transpose().mmul(B).sqrt(),x?this.t=B.clone().div(this.s.get(0,0)):this.t=B,this.xResidual=M.sub(B.mmul(G.transpose()))}}return He.AbstractMatrix=ae,He.CHO=Pg,He.CholeskyDecomposition=Pg,He.DistanceMatrix=_e,He.EVD=Cg,He.EigenvalueDecomposition=Cg,He.LU=ns,He.LuDecomposition=ns,He.Matrix=J,He.MatrixColumnSelectionView=zt,He.MatrixColumnView=Qe,He.MatrixFlipColumnView=Xr,He.MatrixFlipRowView=Gn,He.MatrixRowSelectionView=zc,He.MatrixRowView=qr,He.MatrixSelectionView=ts,He.MatrixSubView=_o,He.MatrixTransposeView=Lo,He.NIPALS=_g,He.Nipals=_g,He.QR=vi,He.QrDecomposition=vi,He.SVD=Zr,He.SingularValueDecomposition=Zr,He.SymmetricMatrix=Oe,He.WrapperMatrix1D=Ma,He.WrapperMatrix2D=tn,He.correlation=_w,He.covariance=Pw,He.default=J,He.determinant=Is,He.inverse=Kr,He.linearDependencies=Wc,He.pseudoInverse=Cw,He.solve=Ar,He.wrap=Do,He}var ac=$3();const Uv=Ou(ac),Li=ac.Matrix,Sb=ac.SingularValueDecomposition;Uv.Matrix?Uv.Matrix:ac.Matrix;const W3={center:[0,0],linkDistance:50};class Tb{constructor(e={}){this.options=e,this.id="mds",this.options=Object.assign(Object.assign({},W3),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,e,t)})}genericMDSLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:s=[0,0],linkDistance:a=50}=i,o=t.getAllNodes(),l=t.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return Ds(t,e,s);const u=bb({nodes:o,edges:l}),c=yb(u);G3(c);const d=I_(c,a),h=Y3(d),f=[];return h.forEach((v,p)=>{const y=Qn(o[p]);y.data.x=v[0]+s[0],y.data.y=v[1]+s[1],f.push(y)}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:l}})}}const G3=r=>{let e=-999999;r.forEach(t=>{t.forEach(n=>{n!==1/0&&e<n&&(e=n)})}),r.forEach((t,n)=>{t.forEach((i,s)=>{i===1/0&&(r[n][s]=e)})})},Y3=r=>{const t=Li.mul(Li.pow(r,2),-.5),n=t.mean("row"),i=t.mean("column"),s=t.mean();t.add(s).subRowVector(n).subColumnVector(i);const a=new Sb(t),o=Li.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map(l=>Li.mul([l],[o]).toJSON()[0].splice(0,2))};function uf(r){return!!r.tick&&!!r.stop}const V3={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},U3={center:[0,0],comboPadding:10,treeKey:"combo"};class H3{constructor(e={}){this.options=e,this.id="comboCombined",this.options=Object.assign(Object.assign({},U3),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,e,t)})}genericComboCombinedLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:s,treeKey:a,outerLayout:o}=i,l=t.getAllNodes().filter(O=>!O.data._isCombo),u=t.getAllNodes().filter(O=>O.data._isCombo),c=t.getAllEdges(),d=l==null?void 0:l.length;if(!d||d===1)return Ds(t,e,s);const h=[],f=new Map;l.forEach(O=>{f.set(O.id,O)});const g=new Map;u.forEach(O=>{g.set(O.id,O)});const v=new Map,p=this.getInnerGraphs(t,a,f,g,c,i,v);yield Promise.all(p);const y=new Map,b=[],E=new Map;let T=!0;t.getRoots(a).forEach(O=>{const C=v.get(O.id),P=g.get(O.id)||f.get(O.id),L={id:O.id,data:Object.assign(Object.assign({},O.data),{x:C.data.x||P.data.x,y:C.data.y||P.data.y,fx:C.data.fx||P.data.fx,fy:C.data.fy||P.data.fy,mass:C.data.mass||P.data.mass,size:C.data.size})};b.push(L),y.set(O.id,!0),!isNaN(L.data.x)&&L.data.x!==0&&!isNaN(L.data.y)&&L.data.y!==0?T=!1:(L.data.x=Math.random()*100,L.data.y=Math.random()*100),sf(t,[O],R=>{R.id!==O.id&&E.set(R.id,O.id)},"TB",a)});const S=[];c.forEach(O=>{const C=E.get(O.source)||O.source,P=E.get(O.target)||O.target;C!==P&&y.has(C)&&y.has(P)&&S.push({id:O.id,source:C,target:P,data:{}})});let k;if(b!=null&&b.length){if(b.length===1)b[0].data.x=s[0],b[0].data.y=s[1];else{const O=new en({nodes:b,edges:S}),C=o||new Mb;T&&V3[C.id]&&(yield(b.length<100?new Tb:new of).assign(O));const P=Object.assign({center:s,kg:5,preventOverlap:!0,animate:!1},C.id==="force"?{gravity:1,factor:4,linkDistance:(L,R,z)=>{const Y=Math.max(...R.data.size)||32,U=Math.max(...z.data.size)||32;return Y/2+U/2+200}}:{});k=yield Hv(C,O,P)}v.forEach(O=>{var C;const P=k.nodes.find(z=>z.id===O.id);if(P){const{x:z,y:Y}=P.data;O.data.visited=!0,O.data.x=z,O.data.y=Y,h.push({id:O.id,data:{x:z,y:Y}})}const{x:L,y:R}=O.data;(C=O.data.nodes)===null||C===void 0||C.forEach(z=>{h.push({id:z.id,data:{x:z.data.x+L,y:z.data.y+R}})})}),v.forEach(({data:O})=>{const{x:C,y:P,visited:L,nodes:R}=O;R==null||R.forEach(z=>{if(!L){const Y=h.find(U=>U.id===z.id);Y.data.x+=C||0,Y.data.y+=P||0}})})}return e&&h.forEach(O=>{t.mergeNodeData(O.id,{x:O.data.x,y:O.data.y})}),{nodes:h,edges:c}})}initVals(e){const t=Object.assign({},e),{nodeSize:n,spacing:i,comboPadding:s}=e;let a,o;if(ye(i)?o=()=>i:Ee(i)?o=i:o=()=>0,t.spacing=o,!n)a=u=>{const c=o(u);return u.size?ii(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+c)/2:Bt(u.size)?((u.size.width>u.size.height?u.size.width:u.size.height)+c)/2:(u.size+c)/2:32+c/2};else if(Ee(n))a=u=>{const c=n(u),d=o(u);return ii(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+d)/2:((c||32)+d)/2};else if(ii(n)){const c=(n[0]>n[1]?n[0]:n[1])/2;a=d=>c+o(d)/2}else{const u=n/2;a=c=>u+o(c)/2}t.nodeSize=a;let l;return ye(s)?l=()=>s:ii(s)?l=()=>Math.max.apply(null,s):Ee(s)?l=s:l=()=>0,t.comboPadding=l,t}getInnerGraphs(e,t,n,i,s,a,o){const{nodeSize:l,comboPadding:u,spacing:c,innerLayout:d}=a,h=d||new of({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:c},g=[],v=p=>{let y=(u==null?void 0:u(p))||10;return ii(y)&&(y=Math.max(...y)),{size:y?[y*2,y*2]:[30,30],padding:y}};return e.getRoots(t).forEach(p=>{o.set(p.id,{id:p.id,data:{nodes:[],size:v(p).size}});let y=Promise.resolve();sf(e,[p],b=>{var E;if(!b.data._isCombo)return;const{size:T,padding:S}=v(b);if(!(!((E=e.getChildren(b.id,t))===null||E===void 0)&&E.length))o.set(b.id,{id:b.id,data:Object.assign(Object.assign({},b.data),{size:T})});else{const k=o.get(b.id);o.set(b.id,{id:b.id,data:Object.assign({nodes:[]},k==null?void 0:k.data)});const A=new Map,O=e.getChildren(b.id,t).map(L=>{if(L.data._isCombo)return o.has(L.id)||o.set(L.id,{id:L.id,data:Object.assign({},L.data)}),A.set(L.id,!0),o.get(L.id);const R=n.get(L.id)||i.get(L.id);return A.set(L.id,!0),{id:L.id,data:Object.assign(Object.assign({},R.data),L.data)}}),C={nodes:O,edges:s.filter(L=>A.has(L.source)&&A.has(L.target))};let P=1/0;O.forEach(L=>{var R;let{size:z}=L.data;z||(z=((R=o.get(L.id))===null||R===void 0?void 0:R.data.size)||(l==null?void 0:l(L))||[30,30]),ye(z)&&(z=[z,z]);const[Y,U]=z;P>Y&&(P=Y),P>U&&(P=U),L.data.size=z}),y=y.then(()=>Ge(this,void 0,void 0,function*(){const L=new en(C);yield Hv(h,L,f,!0);const{minX:R,minY:z,maxX:Y,maxY:U}=R_(O),V={x:(Y+R)/2,y:(U+z)/2};C.nodes.forEach(F=>{F.data.x-=V.x,F.data.y-=V.y});const W=[Math.max(Y-R,P)+S*2,Math.max(U-z,P)+S*2];o.get(b.id).data.size=W,o.get(b.id).data.nodes=O}))}return!0},"BT",t),g.push(y)}),g}}function Hv(r,e,t,n){var i;return Ge(this,void 0,void 0,function*(){return uf(r)?(r.execute(e,t),r.stop(),r.tick((i=t.iterations)!==null&&i!==void 0?i:300)):n?yield r.assign(e,t):yield r.execute(e,t)})}function X3(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var s,a=t.length,o,l=0,u=0;for(s=0;s<a;++s)o=t[s],l+=o.x,u+=o.y;for(l=(l/a-r)*n,u=(u/a-e)*n,s=0;s<a;++s)o=t[s],o.x-=l,o.y-=u}return i.initialize=function(s){t=s},i.x=function(s){return arguments.length?(r=+s,i):r},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(n=+s,i):n},i}function Qt(r){return function(){return r}}function Di(r){return(r()-.5)*1e-6}function q3(r){return r.x+r.vx}function Z3(r){return r.y+r.vy}function K3(r){var e,t,n,i=1,s=1;typeof r!="function"&&(r=Qt(r==null?1:+r));function a(){for(var u,c=e.length,d,h,f,g,v,p,y=0;y<s;++y)for(d=sc(e,q3,Z3).visitAfter(o),u=0;u<c;++u)h=e[u],v=t[h.index],p=v*v,f=h.x+h.vx,g=h.y+h.vy,d.visit(b);function b(E,T,S,k,A){var O=E.data,C=E.r,P=v+C;if(O){if(O.index>h.index){var L=f-O.x-O.vx,R=g-O.y-O.vy,z=L*L+R*R;z<P*P&&(L===0&&(L=Di(n),z+=L*L),R===0&&(R=Di(n),z+=R*R),z=(P-(z=Math.sqrt(z)))/z*i,h.vx+=(L*=z)*(P=(C*=C)/(p+C)),h.vy+=(R*=z)*P,O.vx-=L*(P=1-P),O.vy-=R*P)}return}return T>f+P||k<f-P||S>g+P||A<g-P}}function o(u){if(u.data)return u.r=t[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(e){var u,c=e.length,d;for(t=new Array(c),u=0;u<c;++u)d=e[u],t[d.index]=+r(d,u,e)}}return a.initialize=function(u,c){e=u,n=c,l()},a.iterations=function(u){return arguments.length?(s=+u,a):s},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(r=typeof u=="function"?u:Qt(+u),l(),a):r},a}function Q3(r){return r.index}function Xv(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function J3(r){var e=Q3,t=d,n,i=Qt(30),s,a,o,l,u,c=1;r==null&&(r=[]);function d(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function h(p){for(var y=0,b=r.length;y<c;++y)for(var E=0,T,S,k,A,O,C,P;E<b;++E)T=r[E],S=T.source,k=T.target,A=k.x+k.vx-S.x-S.vx||Di(u),O=k.y+k.vy-S.y-S.vy||Di(u),C=Math.sqrt(A*A+O*O),C=(C-s[E])/C*p*n[E],A*=C,O*=C,k.vx-=A*(P=l[E]),k.vy-=O*P,S.vx+=A*(P=1-P),S.vy+=O*P}function f(){if(a){var p,y=a.length,b=r.length,E=new Map(a.map((S,k)=>[e(S,k,a),S])),T;for(p=0,o=new Array(y);p<b;++p)T=r[p],T.index=p,typeof T.source!="object"&&(T.source=Xv(E,T.source)),typeof T.target!="object"&&(T.target=Xv(E,T.target)),o[T.source.index]=(o[T.source.index]||0)+1,o[T.target.index]=(o[T.target.index]||0)+1;for(p=0,l=new Array(b);p<b;++p)T=r[p],l[p]=o[T.source.index]/(o[T.source.index]+o[T.target.index]);n=new Array(b),g(),s=new Array(b),v()}}function g(){if(a)for(var p=0,y=r.length;p<y;++p)n[p]=+t(r[p],p,r)}function v(){if(a)for(var p=0,y=r.length;p<y;++p)s[p]=+i(r[p],p,r)}return h.initialize=function(p,y){a=p,u=y,f()},h.links=function(p){return arguments.length?(r=p,f(),h):r},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(c=+p,h):c},h.strength=function(p){return arguments.length?(t=typeof p=="function"?p:Qt(+p),g(),h):t},h.distance=function(p){return arguments.length?(i=typeof p=="function"?p:Qt(+p),v(),h):i},h}const eL=1664525,tL=1013904223,qv=4294967296;function nL(){let r=1;return()=>(r=(eL*r+tL)%qv)/qv}function rL(r){return r.x}function iL(r){return r.y}var sL=10,aL=Math.PI*(3-Math.sqrt(5));function oL(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),s=0,a=.6,o=new Map,l=gx(d),u=px("tick","end"),c=nL();r==null&&(r=[]);function d(){h(),u.call("tick",e),t<n&&(l.stop(),u.call("end",e))}function h(v){var p,y=r.length,b;v===void 0&&(v=1);for(var E=0;E<v;++E)for(t+=(s-t)*i,o.forEach(function(T){T(t)}),p=0;p<y;++p)b=r[p],b.fx==null?b.x+=b.vx*=a:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=a:(b.y=b.fy,b.vy=0);return e}function f(){for(var v=0,p=r.length,y;v<p;++v){if(y=r[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var b=sL*Math.sqrt(.5+v),E=v*aL;y.x=b*Math.cos(E),y.y=b*Math.sin(E)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(r,c),v}return f(),e={tick:h,restart:function(){return l.restart(d),e},stop:function(){return l.stop(),e},nodes:function(v){return arguments.length?(r=v,f(),o.forEach(g),e):r},alpha:function(v){return arguments.length?(t=+v,e):t},alphaMin:function(v){return arguments.length?(n=+v,e):n},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(s=+v,e):s},velocityDecay:function(v){return arguments.length?(a=1-v,e):1-a},randomSource:function(v){return arguments.length?(c=v,o.forEach(g),e):c},force:function(v,p){return arguments.length>1?(p==null?o.delete(v):o.set(v,g(p)),e):o.get(v)},find:function(v,p,y){var b=0,E=r.length,T,S,k,A,O;for(y==null?y=1/0:y*=y,b=0;b<E;++b)A=r[b],T=v-A.x,S=p-A.y,k=T*T+S*S,k<y&&(O=A,y=k);return O},on:function(v,p){return arguments.length>1?(u.on(v,p),e):u.on(v)}}}function lL(){var r,e,t,n,i=Qt(-30),s,a=1,o=1/0,l=.81;function u(f){var g,v=r.length,p=sc(r,rL,iL).visitAfter(d);for(n=f,g=0;g<v;++g)e=r[g],p.visit(h)}function c(){if(r){var f,g=r.length,v;for(s=new Array(g),f=0;f<g;++f)v=r[f],s[v.index]=+i(v,f,r)}}function d(f){var g=0,v,p,y=0,b,E,T;if(f.length){for(b=E=T=0;T<4;++T)(v=f[T])&&(p=Math.abs(v.value))&&(g+=v.value,y+=p,b+=p*v.x,E+=p*v.y);f.x=b/y,f.y=E/y}else{v=f,v.x=v.data.x,v.y=v.data.y;do g+=s[v.data.index];while(v=v.next)}f.value=g}function h(f,g,v,p){if(!f.value)return!0;var y=f.x-e.x,b=f.y-e.y,E=p-g,T=y*y+b*b;if(E*E/l<T)return T<o&&(y===0&&(y=Di(t),T+=y*y),b===0&&(b=Di(t),T+=b*b),T<a&&(T=Math.sqrt(a*T)),e.vx+=y*f.value*n/T,e.vy+=b*f.value*n/T),!0;if(f.length||T>=o)return;(f.data!==e||f.next)&&(y===0&&(y=Di(t),T+=y*y),b===0&&(b=Di(t),T+=b*b),T<a&&(T=Math.sqrt(a*T)));do f.data!==e&&(E=s[f.data.index]*n/T,e.vx+=y*E,e.vy+=b*E);while(f=f.next)}return u.initialize=function(f,g){r=f,t=g,c()},u.strength=function(f){return arguments.length?(i=typeof f=="function"?f:Qt(+f),c(),u):i},u.distanceMin=function(f){return arguments.length?(a=f*f,u):Math.sqrt(a)},u.distanceMax=function(f){return arguments.length?(o=f*f,u):Math.sqrt(o)},u.theta=function(f){return arguments.length?(l=f*f,u):Math.sqrt(l)},u}function uL(r,e,t){var n,i=Qt(.1),s,a;typeof r!="function"&&(r=Qt(+r)),e==null&&(e=0),t==null&&(t=0);function o(u){for(var c=0,d=n.length;c<d;++c){var h=n[c],f=h.x-e||1e-6,g=h.y-t||1e-6,v=Math.sqrt(f*f+g*g),p=(a[c]-v)*s[c]*u/v;h.vx+=f*p,h.vy+=g*p}}function l(){if(n){var u,c=n.length;for(s=new Array(c),a=new Array(c),u=0;u<c;++u)a[u]=+r(n[u],u,n),s[u]=isNaN(a[u])?0:+i(n[u],u,n)}}return o.initialize=function(u){n=u,l()},o.strength=function(u){return arguments.length?(i=typeof u=="function"?u:Qt(+u),l(),o):i},o.radius=function(u){return arguments.length?(r=typeof u=="function"?u:Qt(+u),l(),o):r},o.x=function(u){return arguments.length?(e=+u,o):e},o.y=function(u){return arguments.length?(t=+u,o):t},o}function cL(r){var e=Qt(.1),t,n,i;typeof r!="function"&&(r=Qt(r==null?0:+r));function s(o){for(var l=0,u=t.length,c;l<u;++l)c=t[l],c.vx+=(i[l]-c.x)*n[l]*o}function a(){if(t){var o,l=t.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return s.initialize=function(o){t=o,a()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Qt(+o),a(),s):e},s.x=function(o){return arguments.length?(r=typeof o=="function"?o:Qt(+o),a(),s):r},s}function dL(r){var e=Qt(.1),t,n,i;typeof r!="function"&&(r=Qt(r==null?0:+r));function s(o){for(var l=0,u=t.length,c;l<u;++l)c=t[l],c.vy+=(i[l]-c.y)*n[l]*o}function a(){if(t){var o,l=t.length;for(n=new Array(l),i=new Array(l),o=0;o<l;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return s.initialize=function(o){t=o,a()},s.strength=function(o){return arguments.length?(e=typeof o=="function"?o:Qt(+o),a(),s):e},s.y=function(o){return arguments.length?(r=typeof o=="function"?o:Qt(+o),a(),s):r},s}class hL{constructor(e){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:J3,manyBody:lL,center:X3,collide:K3,radial:uL,x:cL,y:dL},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Ln(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericLayout(!0,e,t)})}stop(){this.simulation.stop()}tick(e){return this.simulation.tick(e),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(e,t){const n=this.context.nodes.find(i=>i.id===e);n&&t.forEach((i,s)=>{if(typeof i=="number"||i===null){const a=["fx","fy","fz"][s];n[a]=i}})}getOptions(e){var t,n;const i=Ln({},this.options,e);return i.collide&&((t=i.collide)===null||t===void 0?void 0:t.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(n=i.nodeSize)!==null&&n!==void 0?n:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(e,t,n){var i;return Ge(this,void 0,void 0,function*(){const s=this.getOptions(n),a=t.getAllNodes().map(({id:c,data:d})=>Object.assign(Object.assign({id:c},d),xs(d.data,this.config.inputNodeAttrs))),o=t.getAllEdges().map(c=>Object.assign({},c));Object.assign(this.context,{assign:e,nodes:a,edges:o,graph:t});const l=new Promise(c=>{this.resolver=c}),u=this.setSimulation(s);return u.nodes(a),(i=u.force("link"))===null||i===void 0||i.links(o),l})}getResult(){const{assign:e,nodes:t,edges:n,graph:i}=this.context,s=t.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),xs(o,this.config.outputNodeAttrs))})),a=n.map(({id:o,source:l,target:u,data:c})=>({id:o,source:typeof l=="object"?l.id:l,target:typeof u=="object"?u.id:u,data:c}));return e&&s.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:s,edges:a}}initSimulation(){return oL()}setSimulation(e){const t=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=t.on("tick",()=>{var n;return(n=e.onTick)===null||n===void 0?void 0:n.call(e,this.getResult())}).on("end",()=>{var n;return(n=this.resolver)===null||n===void 0?void 0:n.call(this,this.getResult())})),Zv(t,this.config.simulationAttrs.map(n=>[n,e[n]])),Object.entries(this.forceMap).forEach(([n,i])=>{const s=n;if(e[n]){let a=t.force(s);a||(a=i(),t.force(s,a)),Zv(a,Object.entries(e[s]))}else t.force(s,null)}),t}}const Zv=(r,e)=>e.reduce((t,[n,i])=>!t[n]||i===void 0?t:t[n].call(r,i),r);class oc{constructor(e){this.id="dagre",this.options={},Object.assign(this.options,oc.defaultOptions,e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,Object.assign(Object.assign({},this.options),t))})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,Object.assign(Object.assign({},this.options),t))})}genericDagreLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const{nodeSize:i}=n,s=new vx.graphlib.Graph;s.setGraph(n),s.setDefaultEdgeLabel(()=>({}));const a=t.getAllNodes(),o=t.getAllEdges();[...a,...o].some(({id:u})=>ye(u))&&console.error("Dagre layout only support string id, it will convert number to string."),t.getAllNodes().forEach(u=>{const{id:c}=u,d=Object.assign({},u.data);if(i!==void 0){const[h,f]=Ao(Ee(i)?i(u):i);Object.assign(d,{width:h,height:f})}s.setNode(c.toString(),d)}),t.getAllEdges().forEach(({id:u,source:c,target:d})=>{s.setEdge(c.toString(),d.toString(),{id:u})}),mx.layout(s);const l={nodes:[],edges:[]};return s.nodes().forEach(u=>{const c=s.node(u);l.nodes.push({id:u,data:c}),e&&t.mergeNodeData(u,c)}),s.edges().forEach(u=>{const c=s.edge(u),{id:d}=c,h=iy(c,["id"]),{v:f,w:g}=u;l.edges.push({id:d,source:f,target:g,data:h}),e&&t.mergeEdgeData(d,h)}),l})}}oc.defaultOptions={};class dg{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const s=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=s*t/i,this.fy+=s*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,s=this.degree+e.degree,a={rx:n,ry:i,mass:t,degree:s};return new dg(a)}}class Js{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Js(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Js(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Js(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new Js(i)}}class ea{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new ea(this.quad.NW()),this.NE=new ea(this.quad.NE()),this.SW=new ea(this.quad.SW()),this.SE=new ea(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}const fL={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class gL{constructor(e={}){this.options=e,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},fL),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,e,t)})}genericForceAtlas2Layout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=t.getAllEdges(),s=t.getAllNodes(),a=this.formatOptions(n,s.length),{width:o,height:l,prune:u,maxIteration:c,nodeSize:d,center:h}=a;if(!(s!=null&&s.length)||s.length===1)return Ds(t,e,h);const f=s.map(y=>Qn(y,[o,l])),g=i.filter(y=>{const{source:b,target:E}=y;return b!==E}),v=new en({nodes:f,edges:g}),p=this.getSizes(v,d);if(this.run(v,t,c,p,e,a),u){for(let b=0;b<g.length;b+=1){const{source:E,target:T}=g[b],S=v.getDegree(E),k=v.getDegree(E);if(S<=1){const A=v.getNode(T);v.mergeNodeData(E,{x:A.data.x,y:A.data.y})}else if(k<=1){const A=v.getNode(E);v.mergeNodeData(T,{x:A.data.x,y:A.data.y})}}const y=Object.assign(Object.assign({},a),{prune:!1,barnesHut:!1});this.run(v,t,100,p,e,y)}return{nodes:f,edges:i}})}getSizes(e,t){const n=e.getAllNodes(),i={};for(let s=0;s<n.length;s+=1){const a=n[s];i[a.id]=lg(t,void 0)(a)}return i}formatOptions(e={},t){const n=Object.assign(Object.assign({},this.options),e),{center:i,width:s,height:a,barnesHut:o,prune:l,maxIteration:u,kr:c,kg:d}=n;return n.width=!s&&typeof window<"u"?window.innerWidth:s,n.height=!a&&typeof window<"u"?window.innerHeight:a,n.center=i||[n.width/2,n.height/2],o===void 0&&t>250&&(n.barnesHut=!0),l===void 0&&t>100&&(n.prune=!0),u===0&&!l?(n.maxIteration=250,t<=200&&t>100?n.maxIteration=1e3:t>200&&(n.maxIteration=1200)):u===0&&l&&(n.maxIteration=100,t<=200&&t>100?n.maxIteration=500:t>200&&(n.maxIteration=950)),c||(n.kr=50,t>100&&t<=500?n.kr=20:t>500&&(n.kr=1)),d||(n.kg=20,t>100&&t<=500?n.kg=10:t>500&&(n.kg=1)),n}run(e,t,n,i,s,a){const{kr:o,barnesHut:l,onTick:u}=a,c=e.getAllNodes();let d=0,h=n;const f={},g={},v={};for(let p=0;p<c.length;p+=1){const{data:y,id:b}=c[p];if(f[b]=[0,0],l){const E={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:e.getDegree(b)};v[b]=new dg(E)}}for(;h>0;)d=this.oneStep(e,{iter:h,preventOverlapIters:50,krPrime:100,sg:d,forces:f,preForces:g,bodies:v,sizes:i},a),h--,u==null||u({nodes:c,edges:t.getAllEdges()});return e}oneStep(e,t,n){const{iter:i,preventOverlapIters:s,krPrime:a,sg:o,preForces:l,bodies:u,sizes:c}=t;let{forces:d}=t;const{preventOverlap:h,barnesHut:f}=n,g=e.getAllNodes();for(let v=0;v<g.length;v+=1){const{id:p}=g[v];l[p]=[...d[p]],d[p]=[0,0]}return d=this.getAttrForces(e,i,s,c,d,n),f&&(h&&i>s||!h)?d=this.getOptRepGraForces(e,d,u,n):d=this.getRepGraForces(e,i,s,d,a,c,n),this.updatePos(e,d,l,o,n)}getAttrForces(e,t,n,i,s,a){const{preventOverlap:o,dissuadeHubs:l,mode:u,prune:c}=a,d=e.getAllEdges();for(let h=0;h<d.length;h+=1){const{source:f,target:g}=d[h],v=e.getNode(f),p=e.getNode(g),y=e.getDegree(f),b=e.getDegree(g);if(c&&(y<=1||b<=1))continue;const E=[p.data.x-v.data.x,p.data.y-v.data.y];let T=Math.hypot(E[0],E[1]);T=T<1e-4?1e-4:T,E[0]=E[0]/T,E[1]=E[1]/T,o&&t<n&&(T=T-i[f]-i[g]);let S=T,k=S;u==="linlog"&&(S=Math.log(1+T),k=S),l&&(S=T/y,k=T/b),o&&t<n&&T<=0?(S=0,k=0):o&&t<n&&T>0&&(S=T,k=T),s[f][0]+=S*E[0],s[g][0]-=k*E[0],s[f][1]+=S*E[1],s[g][1]-=k*E[1]}return s}getOptRepGraForces(e,t,n,i){const{kg:s,center:a,prune:o}=i,l=e.getAllNodes(),u=l.length;let c=9e10,d=-9e10,h=9e10,f=-9e10;for(let b=0;b<u;b+=1){const{id:E,data:T}=l[b];o&&e.getDegree(E)<=1||(n[E].setPos(T.x,T.y),T.x>=d&&(d=T.x),T.x<=c&&(c=T.x),T.y>=f&&(f=T.y),T.y<=h&&(h=T.y))}const g=Math.max(d-c,f-h),v={xmid:(d+c)/2,ymid:(f+h)/2,length:g,massCenter:a,mass:u},p=new Js(v),y=new ea(p);for(let b=0;b<u;b+=1){const{id:E}=l[b];o&&e.getDegree(E)<=1||n[E].in(p)&&y.insert(n[E])}for(let b=0;b<u;b+=1){const{id:E,data:T}=l[b],S=e.getDegree(E);if(o&&S<=1)continue;n[E].resetForce(),y.updateForce(n[E]),t[E][0]-=n[E].fx,t[E][1]-=n[E].fy;const k=[T.x-a[0],T.y-a[1]];let A=Math.hypot(k[0],k[1]);A=A<1e-4?1e-4:A,k[0]=k[0]/A,k[1]=k[1]/A;const O=s*(S+1);t[E][0]-=O*k[0],t[E][1]-=O*k[1]}return t}getRepGraForces(e,t,n,i,s,a,o){const{preventOverlap:l,kr:u,kg:c,center:d,prune:h}=o,f=e.getAllNodes(),g=f.length;for(let v=0;v<g;v+=1){const p=f[v],y=e.getDegree(p.id);for(let S=v+1;S<g;S+=1){const k=f[S],A=e.getDegree(k.id);if(h&&(y<=1||A<=1))continue;const O=[k.data.x-p.data.x,k.data.y-p.data.y];let C=Math.hypot(O[0],O[1]);C=C<1e-4?1e-4:C,O[0]=O[0]/C,O[1]=O[1]/C,l&&t<n&&(C=C-a[p.id]-a[k.id]);let P=u*(y+1)*(A+1)/C;l&&t<n&&C<0?P=s*(y+1)*(A+1):l&&t<n&&C===0?P=0:l&&t<n&&C>0&&(P=u*(y+1)*(A+1)/C),i[p.id][0]-=P*O[0],i[k.id][0]+=P*O[0],i[p.id][1]-=P*O[1],i[k.id][1]+=P*O[1]}const b=[p.data.x-d[0],p.data.y-d[1]],E=Math.hypot(b[0],b[1]);b[0]=b[0]/E,b[1]=b[1]/E;const T=c*(y+1);i[p.id][0]-=T*b[0],i[p.id][1]-=T*b[1]}return i}updatePos(e,t,n,i,s){const{ks:a,tao:o,prune:l,ksmax:u}=s,c=e.getAllNodes(),d=c.length,h=[],f=[];let g=0,v=0,p=i;for(let b=0;b<d;b+=1){const{id:E}=c[b],T=e.getDegree(E);if(l&&T<=1)continue;const S=[t[E][0]-n[E][0],t[E][1]-n[E][1]],k=Math.hypot(S[0],S[1]),A=[t[E][0]+n[E][0],t[E][1]+n[E][1]],O=Math.hypot(A[0],A[1]);h[b]=k,f[b]=O/2,g+=(T+1)*h[b],v+=(T+1)*f[b]}const y=p;p=o*v/g,y!==0&&(p=p>1.5*y?1.5*y:p);for(let b=0;b<d;b+=1){const{id:E,data:T}=c[b],S=e.getDegree(E);if(l&&S<=1||ye(T.fx)&&ye(T.fy))continue;let k=a*p/(1+p*Math.sqrt(h[b])),A=Math.hypot(t[E][0],t[E][1]);A=A<1e-4?1e-4:A;const O=u/A;k=k>O?O:k;const C=k*t[E][0],P=k*t[E][1];e.mergeNodeData(E,{x:T.x+C,y:T.y+P})}return p}}const pL={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},vL=800;class mL{constructor(e={}){this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},pL),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;n<e;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericFruchtermanLayout(e,t,n){return Ge(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(n),{dimensions:s,width:a,height:o,center:l,clustering:u,nodeClusterBy:c,maxIteration:d,onTick:h}=i,f=t.getAllNodes(),g=t.getAllEdges();if(!(f!=null&&f.length)){const E={nodes:[],edges:g};return this.lastResult=E,E}if(f.length===1){e&&t.mergeNodeData(f[0].id,{x:l[0],y:l[1],z:s===3?l[2]:void 0});const E={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:l[0],y:l[1],z:s===3?l[2]:void 0})})],edges:g};return this.lastResult=E,E}const v=f.map(E=>Qn(E,[a,o])),p=new en({nodes:v,edges:g}),y={};if(u&&v.forEach(E=>{const T=E.data[c];y[T]||(y[T]={name:T,cx:0,cy:0,count:0})}),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=e,this.lastGraph=p,this.lastOptions=i,this.lastClusterMap=y,typeof window>"u")return;let b=0;return new Promise(E=>{this.timeInterval=window.setInterval(()=>{if(!this.running){E({nodes:v,edges:g});return}this.runOneStep(p,y,i),e&&v.forEach(({id:T,data:S})=>t.mergeNodeData(T,{x:S.x,y:S.y,z:s===3?S.z:void 0})),h==null||h({nodes:v,edges:g}),b++,b>=d&&(window.clearInterval(this.timeInterval),E({nodes:v,edges:g}))},0),this.running=!0})})}formatOptions(e={}){const t=Object.assign(Object.assign({},this.options),e),{clustering:n,nodeClusterBy:i}=t,{center:s,width:a,height:o}=t;return t.width=!a&&typeof window<"u"?window.innerWidth:a,t.height=!o&&typeof window<"u"?window.innerHeight:o,t.center=s||[t.width/2,t.height/2],t.clustering=n&&!!i,t}runOneStep(e,t,n){const{dimensions:i,height:s,width:a,gravity:o,center:l,speed:u,clustering:c,nodeClusterBy:d,clusterGravity:h}=n,f=s*a,g=Math.sqrt(f)/10,v=e.getAllNodes(),p=f/(v.length+1),y=Math.sqrt(p),b={};if(this.applyCalculate(e,b,y,p),c){for(const T in t)t[T].cx=0,t[T].cy=0,t[T].count=0;v.forEach(T=>{const{data:S}=T,k=t[S[d]];ye(S.x)&&(k.cx+=S.x),ye(S.y)&&(k.cy+=S.y),k.count++});for(const T in t)t[T].cx/=t[T].count,t[T].cy/=t[T].count;const E=h||o;v.forEach((T,S)=>{const{id:k,data:A}=T;if(!ye(A.x)||!ye(A.y))return;const O=t[A[d]],C=Math.sqrt((A.x-O.cx)*(A.x-O.cx)+(A.y-O.cy)*(A.y-O.cy)),P=y*E;b[k].x-=P*(A.x-O.cx)/C,b[k].y-=P*(A.y-O.cy)/C})}v.forEach((E,T)=>{const{id:S,data:k}=E;if(!ye(k.x)||!ye(k.y))return;const A=.01*y*o;b[S].x-=A*(k.x-l[0]),b[S].y-=A*(k.y-l[1]),i===3&&(b[S].z-=A*(k.z-l[2]))}),v.forEach((E,T)=>{const{id:S,data:k}=E;if(ye(k.fx)&&ye(k.fy)){k.x=k.fx,k.y=k.fy,i===3&&(k.z=k.fz);return}if(!ye(k.x)||!ye(k.y))return;const A=Math.sqrt(b[S].x*b[S].x+b[S].y*b[S].y+(i===3?b[S].z*b[S].z:0));if(A>0){const O=Math.min(g*(u/vL),A);e.mergeNodeData(S,{x:k.x+b[S].x/A*O,y:k.y+b[S].y/A*O,z:i===3?k.z+b[S].z/A*O:void 0})}})}applyCalculate(e,t,n,i){this.calRepulsive(e,t,i),this.calAttractive(e,t,n)}calRepulsive(e,t,n){const i=e.getAllNodes();i.forEach(({data:s,id:a},o)=>{t[a]={x:0,y:0,z:0},i.forEach(({data:l,id:u},c)=>{if(o<=c||!ye(s.x)||!ye(l.x)||!ye(s.y)||!ye(l.y))return;let d=s.x-l.x,h=s.y-l.y,f=this.options.dimensions===3?s.z-l.z:0,g=d*d+h*h+f*f;g===0&&(g=1,d=.01,h=.01,f=.01);const v=n/g,p=d*v,y=h*v,b=f*v;t[a].x+=p,t[a].y+=y,t[u].x-=p,t[u].y-=y,this.options.dimensions===3&&(t[a].z+=b,t[u].z-=b)})})}calAttractive(e,t,n){e.getAllEdges().forEach(s=>{const{source:a,target:o}=s;if(!a||!o||a===o)return;const{data:l}=e.getNode(a),{data:u}=e.getNode(o);if(!ye(u.x)||!ye(l.x)||!ye(u.y)||!ye(l.y))return;const c=u.x-l.x,d=u.y-l.y,h=this.options.dimensions===3?u.z-l.z:0,f=Math.sqrt(c*c+d*d+h*h)/n,g=c*f,v=d*f,p=h*f;t[a].x+=g,t[a].y+=v,t[o].x-=g,t[o].y-=v,this.options.dimensions===3&&(t[a].z+=p,t[o].z-=p)})}}const yL={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class bL{constructor(e={}){this.options=e,this.id="grid",this.options=Object.assign(Object.assign({},yL),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericGridLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,e,t)})}genericGridLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{begin:s=[0,0],condense:a,preventOverlapPadding:o,preventOverlap:l,rows:u,cols:c,nodeSpacing:d,nodeSize:h,width:f,height:g,position:v}=i;let{sortBy:p}=i;const y=t.getAllNodes(),b=t.getAllEdges(),E=y==null?void 0:y.length;if(!E||E===1)return Ds(t,e,s);const T=y.map(U=>Qn(U));p!=="id"&&(!Ke(p)||T[0].data[p]===void 0)&&(p="degree"),p==="degree"?T.sort((U,V)=>t.getDegree(V.id,"both")-t.getDegree(U.id,"both")):p==="id"?T.sort((U,V)=>ye(V.id)&&ye(U.id)?V.id-U.id:`${U.id}`.localeCompare(`${V.id}`)):T.sort((U,V)=>V.data[p]-U.data[p]);const S=!f&&typeof window<"u"?window.innerWidth:f,k=!g&&typeof window<"u"?window.innerHeight:g,A=E,O={rows:u,cols:c};if(u!=null&&c!=null)O.rows=u,O.cols=c;else if(u!=null&&c==null)O.rows=u,O.cols=Math.ceil(A/O.rows);else if(u==null&&c!=null)O.cols=c,O.rows=Math.ceil(A/O.cols);else{const U=Math.sqrt(A*k/S);O.rows=Math.round(U),O.cols=Math.round(S/k*U)}if(O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>A){const U=Ml(O),V=Sl(O);(U-1)*V>=A?Ml(O,U-1):(V-1)*U>=A&&Sl(O,V-1)}else for(;O.cols*O.rows<A;){const U=Ml(O),V=Sl(O);(V+1)*U>=A?Sl(O,V+1):Ml(O,U+1)}let C=a?0:S/O.cols,P=a?0:k/O.rows;if(l||d){const U=bs(10,d),V=og(30,h,!1);T.forEach(W=>{(!W.data.x||!W.data.y)&&(W.data.x=0,W.data.y=0);const F=t.getNode(W.id),[K,re]=Ao(V(F)||30),se=U!==void 0?U(W):o,ae=K+se,Ce=re+se;C=Math.max(C,ae),P=Math.max(P,Ce)})}const L={},R={row:0,col:0},z={};for(let U=0;U<T.length;U++){const V=T[U];let W;if(v&&(W=v(t.getNode(V.id))),W&&(W.row!==void 0||W.col!==void 0)){const F={row:W.row,col:W.col};if(F.col===void 0)for(F.col=0;cf(L,F);)F.col++;else if(F.row===void 0)for(F.row=0;cf(L,F);)F.row++;z[V.id]=F,Ob(L,F)}wL(V,s,C,P,z,O,R,L)}const Y={nodes:T,edges:b};return e&&T.forEach(U=>{t.mergeNodeData(U.id,{x:U.data.x,y:U.data.y})}),Y})}}const Ml=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.min(n,i):Math.min(n,i)===r.rows?r.rows=e:r.cols=e,t},Sl=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.max(n,i):Math.max(n,i)===r.rows?r.rows=e:r.cols=e,t},cf=(r,e)=>r[`c-${e.row}-${e.col}`]||!1,Ob=(r,e)=>r[`c-${e.row}-${e.col}`]=!0,Kv=(r,e)=>{const t=r.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)},wL=(r,e,t,n,i,s,a,o)=>{let l,u;const c=i[r.id];if(c)l=c.col*t+t/2+e[0],u=c.row*n+n/2+e[1];else{for(;cf(o,a);)Kv(s,a);l=a.col*t+t/2+e[0],u=a.row*n+n/2+e[1],Ob(o,a),Kv(s,a)}r.data.x=l,r.data.y=u},xL=(r,e,t)=>{try{const n=Li.mul(Li.pow(e,2),-.5),i=n.mean("row"),s=n.mean("column"),a=n.mean();n.add(a).subRowVector(i).subColumnVector(s);const o=new Sb(n),l=Li.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(u=>Li.mul([u],[l]).toJSON()[0].splice(0,r))}catch{const i=[];for(let s=0;s<e.length;s++){const a=Math.random()*t,o=Math.random()*t;i.push([a,o])}return i}},EL=800,ML={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},SL=(r,e)=>{const t=Object.assign(Object.assign({},ML),e),{positions:n,iterations:i,width:s,k:a,speed:o=100,strictRadial:l,focusIdx:u,radii:c=[],nodeSizeFunc:d}=t,h=r.getAllNodes(),f=[],g=s/10;for(let v=0;v<i;v++)n.forEach((p,y)=>{f[y]={x:0,y:0}}),TL(h,n,f,a,c,d),OL(n,f,o,l,u,g,s,c);return n},TL=(r,e,t,n,i,s)=>{e.forEach((a,o)=>{t[o]={x:0,y:0},e.forEach((l,u)=>{if(o===u||i[o]!==i[u])return;let c=a.x-l.x,d=a.y-l.y,h=Math.sqrt(c*c+d*d);if(h===0){h=1;const f=o>u?1:-1;c=.01*f,d=.01*f}if(h<s(r[o])/2+s(r[u])/2){const f=n*n/h;t[o].x+=c/h*f,t[o].y+=d/h*f}})})},OL=(r,e,t,n,i,s,a,o)=>{const l=s||a/10;return n&&e.forEach((u,c)=>{const d=r[c].x-r[i].x,h=r[c].y-r[i].y,f=Math.sqrt(d*d+h*h);let g=h/f,v=-d/f;const p=Math.sqrt(u.x*u.x+u.y*u.y);let y=Math.acos((g*u.x+v*u.y)/p);y>Math.PI/2&&(y-=Math.PI/2,g*=-1,v*=-1);const b=Math.cos(y)*p;u.x=g*b,u.y=v*b}),r.forEach((u,c)=>{if(c===i)return;const d=Math.sqrt(e[c].x*e[c].x+e[c].y*e[c].y);if(d>0&&c!==i){const h=Math.min(l*(t/EL),d);if(u.x+=e[c].x/d*h,u.y+=e[c].y/d*h,n){let f=u.x-r[i].x,g=u.y-r[i].y;const v=Math.sqrt(f*f+g*g);f=f/v*o[c],g=g/v*o[c],u.x=r[i].x+f,u.y=r[i].y+g}}}),r},kL={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class NL{constructor(e={}){this.options=e,this.id="radial",this.options=Object.assign(Object.assign({},kL),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,e,t)})}genericRadialLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:s,height:a,center:o,focusNode:l,unitRadius:u,nodeSize:c,nodeSpacing:d,strictRadial:h,preventOverlap:f,maxPreventOverlapIteration:g,sortBy:v,linkDistance:p=50,sortStrength:y=10,maxIteration:b=1e3}=i,E=t.getAllNodes(),T=t.getAllEdges(),S=!s&&typeof window<"u"?window.innerWidth:s,k=!a&&typeof window<"u"?window.innerHeight:a,A=o||[S/2,k/2];if(!(E!=null&&E.length)||E.length===1)return Ds(t,e,A);let O=E[0];if(Ke(l)){for(let _e=0;_e<E.length;_e++)if(E[_e].id===l){O=E[_e];break}}else O=l||E[0];const C=PL(E,O.id),P=bb({nodes:E,edges:T}),L=yb(P),R=LL(L,C);_L(L,C,R+1);const z=L[C];let Y=S-A[0]>A[0]?A[0]:S-A[0],U=k-A[1]>A[1]?A[1]:k-A[1];Y===0&&(Y=S/2),U===0&&(U=k/2);const V=Math.min(Y,U),W=Math.max(...z),F=[],K=u||V/W;z.forEach((_e,Ve)=>{F[Ve]=_e*K});const re=AL(E,L,p,F,K,v,y),se=CL(re),ae=xL(p,re,p);let Ce=ae.map(([_e,Ve])=>({x:(isNaN(_e)?Math.random()*p:_e)-ae[C][0],y:(isNaN(Ve)?Math.random()*p:Ve)-ae[C][1]}));this.run(b,Ce,se,re,F,C);let Te;if(f){Te=lg(c,d);const _e={nodes:E,nodeSizeFunc:Te,positions:Ce,radii:F,height:k,width:S,strictRadial:!!h,focusIdx:C,iterations:g||200,k:Ce.length/4.5};Ce=SL(t,_e)}const J=[];return Ce.forEach((_e,Ve)=>{const Qe=Qn(E[Ve]);Qe.data.x=_e.x+A[0],Qe.data.y=_e.y+A[1],J.push(Qe)}),e&&J.forEach(_e=>t.mergeNodeData(_e.id,{x:_e.data.x,y:_e.data.y})),{nodes:J,edges:T}})}run(e,t,n,i,s,a){for(let o=0;o<=e;o++){const l=o/e;this.oneIteration(l,t,s,i,n,a)}}oneIteration(e,t,n,i,s,a){const o=1-e;t.forEach((l,u)=>{const c=zv(l,{x:0,y:0}),d=c===0?0:1/c;if(u===a)return;let h=0,f=0,g=0;t.forEach((p,y)=>{if(u===y)return;const b=zv(l,p),E=b===0?0:1/b,T=i[y][u];g+=s[u][y],h+=s[u][y]*(p.x+T*(l.x-p.x)*E),f+=s[u][y]*(p.y+T*(l.y-p.y)*E)});const v=n[u]===0?0:1/n[u];g*=o,g+=e*v*v,h*=o,h+=e*v*l.x*d,l.x=h/g,f*=o,f+=e*v*l.y*d,l.y=f/g})}}const AL=(r,e,t,n,i,s,a)=>{if(!r)return[];const o=[];if(e){const l={};e.forEach((u,c)=>{const d=[];u.forEach((h,f)=>{var g,v;if(c===f)d.push(0);else if(n[c]===n[f])if(s==="data")d.push(h*(Math.abs(c-f)*a)/(n[c]/i));else if(s){let p,y;if(l[r[c].id])p=l[r[c].id];else{const b=(s==="id"?r[c].id:(g=r[c].data)===null||g===void 0?void 0:g[s])||0;Ke(b)?p=b.charCodeAt(0):p=b,l[r[c].id]=p}if(l[r[f].id])y=l[r[f].id];else{const b=(s==="id"?r[f].id:(v=r[f].data)===null||v===void 0?void 0:v[s])||0;Ke(b)?y=b.charCodeAt(0):y=b,l[r[f].id]=y}d.push(h*(Math.abs(p-y)*a)/(n[c]/i))}else d.push(h*t/(n[c]/i));else{const p=(t+i)/2;d.push(h*p)}}),o.push(d)})}return o},CL=r=>{const e=r.length,t=r[0].length,n=[];for(let i=0;i<e;i++){const s=[];for(let a=0;a<t;a++)r[i][a]!==0?s.push(1/(r[i][a]*r[i][a])):s.push(0);n.push(s)}return n},PL=(r,e)=>{let t=-1;return r.forEach((n,i)=>{n.id===e&&(t=i)}),Math.max(t,0)},_L=(r,e,t)=>{const n=r.length;for(let i=0;i<n;i++)if(r[e][i]===1/0){r[e][i]=t,r[i][e]=t;for(let s=0;s<n;s++)r[i][s]!==1/0&&r[e][s]===1/0&&(r[e][s]=t+r[i][s],r[s][e]=t+r[i][s])}for(let i=0;i<n;i++)if(i!==e){for(let s=0;s<n;s++)if(r[i][s]===1/0){let a=Math.abs(r[e][i]-r[e][s]);a=a===0?1:a,r[i][s]=a}}},LL=(r,e)=>{let t=0;for(let n=0;n<r[e].length;n++)r[e][n]!==1/0&&(t=r[e][n]>t?r[e][n]:t);return t},DL={center:[0,0],width:300,height:300};class IL{constructor(e={}){this.options=e,this.id="random",this.options=Object.assign(Object.assign({},DL),e)}execute(e,t){return Ge(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,e,t)})}assign(e,t){return Ge(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,e,t)})}genericRandomLayout(e,t,n){return Ge(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:s,width:a,height:o}=i,l=t.getAllNodes(),u=.9,c=!a&&typeof window<"u"?window.innerWidth:a,d=!o&&typeof window<"u"?window.innerHeight:o,h=s||[c/2,d/2],f=[];return l&&l.forEach(v=>{f.push({id:v.id,data:{x:(Math.random()-.5)*u*c+h[0],y:(Math.random()-.5)*u*d+h[1]}})}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:t.getAllEdges()}})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kb=Symbol("Comlink.proxy"),RL=Symbol("Comlink.endpoint"),Nb=Symbol("Comlink.releaseProxy"),Xd=Symbol("Comlink.finalizer"),Fl=Symbol("Comlink.thrown"),Ab=r=>typeof r=="object"&&r!==null||typeof r=="function",jL={canHandle:r=>Ab(r)&&r[kb],serialize(r){const{port1:e,port2:t}=new MessageChannel;return Pb(r,e),[t,[t]]},deserialize(r){return r.start(),Lb(r)}},BL={canHandle:r=>Ab(r)&&Fl in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},Cb=new Map([["proxy",jL],["throw",BL]]);function zL(r,e){for(const t of r)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function Pb(r,e=globalThis,t=["*"]){e.addEventListener("message",function n(i){if(!i||!i.data)return;if(!zL(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:s,type:a,path:o}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(ds);let u;try{const c=o.slice(0,-1).reduce((h,f)=>h[f],r),d=o.reduce((h,f)=>h[f],r);switch(a){case"GET":u=d;break;case"SET":c[o.slice(-1)[0]]=ds(i.data.value),u=!0;break;case"APPLY":u=d.apply(c,l);break;case"CONSTRUCT":{const h=new d(...l);u=VL(h)}break;case"ENDPOINT":{const{port1:h,port2:f}=new MessageChannel;Pb(r,f),u=YL(h,[h])}break;case"RELEASE":u=void 0;break;default:return}}catch(c){u={value:c,[Fl]:0}}Promise.resolve(u).catch(c=>({value:c,[Fl]:0})).then(c=>{const[d,h]=yu(c);e.postMessage(Object.assign(Object.assign({},d),{id:s}),h),a==="RELEASE"&&(e.removeEventListener("message",n),_b(e),Xd in r&&typeof r[Xd]=="function"&&r[Xd]())}).catch(c=>{const[d,h]=yu({value:new TypeError("Unserializable return value"),[Fl]:0});e.postMessage(Object.assign(Object.assign({},d),{id:s}),h)})}),e.start&&e.start()}function FL(r){return r.constructor.name==="MessagePort"}function _b(r){FL(r)&&r.close()}function Lb(r,e){const t=new Map;return r.addEventListener("message",function(i){const{data:s}=i;if(!s||!s.id)return;const a=t.get(s.id);if(a)try{a(s)}finally{t.delete(s.id)}}),df(r,t,[],e)}function Tl(r){if(r)throw new Error("Proxy has been released and is not useable")}function Db(r){return Zs(r,new Map,{type:"RELEASE"}).then(()=>{_b(r)})}const vu=new WeakMap,mu="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const e=(vu.get(r)||0)-1;vu.set(r,e),e===0&&Db(r)});function $L(r,e){const t=(vu.get(e)||0)+1;vu.set(e,t),mu&&mu.register(r,e,r)}function WL(r){mu&&mu.unregister(r)}function df(r,e,t=[],n=function(){}){let i=!1;const s=new Proxy(n,{get(a,o){if(Tl(i),o===Nb)return()=>{WL(s),Db(r),e.clear(),i=!0};if(o==="then"){if(t.length===0)return{then:()=>s};const l=Zs(r,e,{type:"GET",path:t.map(u=>u.toString())}).then(ds);return l.then.bind(l)}return df(r,e,[...t,o])},set(a,o,l){Tl(i);const[u,c]=yu(l);return Zs(r,e,{type:"SET",path:[...t,o].map(d=>d.toString()),value:u},c).then(ds)},apply(a,o,l){Tl(i);const u=t[t.length-1];if(u===RL)return Zs(r,e,{type:"ENDPOINT"}).then(ds);if(u==="bind")return df(r,e,t.slice(0,-1));const[c,d]=Qv(l);return Zs(r,e,{type:"APPLY",path:t.map(h=>h.toString()),argumentList:c},d).then(ds)},construct(a,o){Tl(i);const[l,u]=Qv(o);return Zs(r,e,{type:"CONSTRUCT",path:t.map(c=>c.toString()),argumentList:l},u).then(ds)}});return $L(s,r),s}function GL(r){return Array.prototype.concat.apply([],r)}function Qv(r){const e=r.map(yu);return[e.map(t=>t[0]),GL(e.map(t=>t[1]))]}const Ib=new WeakMap;function YL(r,e){return Ib.set(r,e),r}function VL(r){return Object.assign(r,{[kb]:!0})}function yu(r){for(const[e,t]of Cb)if(t.canHandle(r)){const[n,i]=t.serialize(r);return[{type:"HANDLER",name:e,value:n},i]}return[{type:"RAW",value:r},Ib.get(r)||[]]}function ds(r){switch(r.type){case"HANDLER":return Cb.get(r.name).deserialize(r.value);case"RAW":return r.value}}function Zs(r,e,t,n){return new Promise(i=>{const s=UL();e.set(s,i),r.start&&r.start(),r.postMessage(Object.assign({id:s},t),n)})}function UL(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class HL extends Zu{constructor(e,t,n){super(),this.graph=e,this.layout=t,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=Lb(new Worker(new URL("/assets/worker-CUPcZfeV.js",import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var e;return Ge(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,{onTick:n}=t,i=iy(t,["onTick"]),s={};Object.keys(i).forEach(u=>{Ee(i[u])||(s[u]=i[u])});const a={layout:{id:this.layout.id,options:s,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(a,[o]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[Nb]()}isRunning(){return this.running}}var XL=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class lc extends Ku{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const e=this.context.model.getRootsData();if(!(Ir(e)||e.length>2))return e[0]}formatSize(e){const t=typeof e=="function"?e:()=>e;return n=>er(t(n))}doLayout(e,t){const{hGap:n,getRibSep:i,vGap:s,nodeSize:a,height:o}=t,{model:l}=this.context,u=this.formatSize(a);let c=u(e)[0]+i(e);const d=(E,T=0)=>{var S;return T+=n*((E.children||[]).length+1),(S=E.children)===null||S===void 0||S.forEach(k=>{var A;(A=l.getNodeLikeDatum(k).children)===null||A===void 0||A.forEach(C=>{const P=l.getNodeLikeDatum(C);T=d(P,T)})}),T},h=E=>{if(E.depth===1)return c;const T=l.getParentData(E.id,"tree");if(Gs(E)){const S=l.getParentData(T.id,"tree"),k=v(E)-v(S);return h(T)+k*n/s}else{const S=(T.children||[]).indexOf(E.id),k=l.getNodeData((T.children||[]).slice(S));return f(T)-k.reduce((A,O)=>A+d(O),0)-u(T)[0]/2}},f=Sh(E=>{if(qd(E))return u(E)[0]/2;const T=l.getParentData(E.id,"tree");if(Gs(E))return h(E)+d(E)+u(E)[0]/2;{const S=v(E)-v(T),k=n/s;return h(E)+S*k}},E=>E.id),g=E=>v(l.getParentData(E,"tree")),v=Sh(E=>{if(qd(E))return o/2;if(Gs(E)){const T=l.getParentData(E.id,"tree"),S=T.children.indexOf(E.id);if(S===0)return g(T.id)+s;const k=l.getNodeLikeDatum(T.children[S-1]);if(Ir(k.children))return v(k)+s;const A=l.getDescendantsData(k.id);return Math.max(...A.map(O=>Gs(O)?g(O.id):v(O)))+s}else{if(Ir(E.children))return g(E.id)+s;const T=l.getNodeLikeDatum(E.children.slice(-1)[0]);if(Ir(T.children))return v(T)+s;const S=l.getDescendantsData(E.id).slice(-1)[0];return(Gs(S)?g(S.id):v(S))+s}},E=>E.id);let p=0;const y={nodes:[],edges:[]},b=E=>{var T;(T=E.children)===null||T===void 0||T.forEach(C=>b(l.getNodeLikeDatum(C)));const S=v(E),k=f(E);if(y.nodes.push({id:E.id,x:k,y:S}),qd(E))return;const A=l.getRelatedEdgesData(E.id,"in")[0],O=[h(E),Gs(E)?S:g(E.id)];y.edges.push({id:q(A),controlPoints:[O],relatedNodeId:E.id}),p=Math.max(p,k+i(E)),E.depth===1&&(c=p)};return b(e),y}placeAlterative(e,t){const n=(t.children||[]).filter((o,l)=>l%2!==0);if(n.length===0)return e;const{model:i}=this.context,s=e.nodes.find(o=>o.id===t.id).y,a=o=>{const l=i.getAncestorsData(o,"tree");if(Ir(l))return!1;const u=l.length===1?o:l[l.length-2].id;return n.includes(u)};e.nodes.forEach(o=>{a(o.id)&&(o.y=2*s-o.y)}),e.edges.forEach(o=>{a(o.relatedNodeId)&&(o.controlPoints=o.controlPoints.map(l=>[l[0],2*s-l[1]]))})}rightToLeft(e,t){return e.nodes.forEach(n=>n.x=t.width-n.x),e.edges.forEach(n=>{n.controlPoints=n.controlPoints.map(i=>[t.width-i[0],i[1]])}),e}execute(e,t){return XL(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},lc.defaultOptions),this.options),t),{direction:i,nodeSize:s}=n,a=this.getRoot();if(!a)return e;const o=this.formatSize(s);n.vGap||(n.vGap=Math.max(...(e.nodes||[]).map(h=>o(h)[1]))),n.hGap||(n.hGap=Math.max(...(e.nodes||[]).map(h=>o(h)[0])));let l=this.doLayout(a,n);this.placeAlterative(l,a),i==="RL"&&(l=this.rightToLeft(l,n));const{model:u}=this.context,c=[],d=[];return l.nodes.forEach(h=>{const{id:f,x:g,y:v}=h,p=u.getNodeLikeDatum(f);c.push(Jv(p,{x:g,y:v}))}),l.edges.forEach(h=>{const{id:f,controlPoints:g}=h,v=u.getEdgeDatum(f);d.push(Jv(v,{controlPoints:g}))}),{nodes:c,edges:d}})}}lc.defaultOptions={direction:"RL",getRibSep:()=>60};const Jv=(r,e)=>Object.assign(Object.assign({},r),{style:Object.assign(Object.assign({},r.style||{}),e)}),qd=r=>r.depth===0,Gs=r=>(r.depth||(r.depth=0))%2===0;var qL=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class uc extends Ku{constructor(){super(...arguments),this.id="snake"}formatSize(e,t){const n=typeof t=="function"?t:()=>t;return e.reduce((i,s)=>{const[a,o]=er(n(s))||[0,0];return[Math.max(i[0],a),Math.max(i[1],o)]},[0,0])}validate(e){const{nodes:t=[],edges:n=[]}=e,i={},s={},a={};t.forEach(h=>{i[h.id]=0,s[h.id]=0,a[h.id]=[]}),n.forEach(h=>{i[h.target]++,s[h.source]++,a[h.source].push(h.target)});const o=new Set,l=h=>{o.has(h)||(o.add(h),a[h].forEach(l))};if(l(t[0].id),o.size!==t.length)return!1;const u=t.filter(h=>i[h.id]===0),c=t.filter(h=>s[h.id]===0);return!(u.length!==1||c.length!==1||t.filter(h=>i[h.id]===1&&s[h.id]===1).length!==t.length-2)}execute(e,t){return qL(this,void 0,void 0,function*(){var n;if(!this.validate(e))return e;const{nodeSize:i,padding:s,sortBy:a,cols:o,colGap:l,rowGap:u,clockwise:c,width:d,height:h}=Object.assign({},uc.defaultOptions,this.options,t),[f,g,v,p]=Vr(s),y=this.formatSize(e.nodes||[],i),b=Math.ceil((e.nodes||[]).length/o);let E=l||(d-p-g-o*y[0])/(o-1),T=u||(h-f-v-b*y[1])/(b-1);return(T===1/0||T<0)&&(T=0),(E===1/0||E<0)&&(E=0),{nodes:((a?(n=e.nodes)===null||n===void 0?void 0:n.sort(a):ZL(e))||[]).map((A,O)=>{const C=Math.floor(O/o),P=O%o,L=c?C%2===0?P:o-1-P:C%2===0?o-1-P:P,R=p+L*(y[0]+E)+y[0]/2,z=f+C*(y[1]+T)+y[1]/2;return{id:A.id,style:{x:R,y:z}}})}})}}uc.defaultOptions={padding:0,cols:5,clockwise:!0};function ZL(r){const{nodes:e=[],edges:t=[]}=r,n={},i={};e.forEach(o=>{n[o.id]=0,i[o.id]=[]}),t.forEach(o=>{n[o.target]++,i[o.source].push(o.target)});const s=[],a=[];for(e.forEach(o=>{n[o.id]===0&&s.push(o.id)});s.length>0;){const o=s.shift(),l=e.find(u=>u.id===o);a.push(l),i[o].forEach(u=>{n[u]--,n[u]===0&&s.push(u)})}return a}const KL=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],QL=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],JL=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],eD=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],tD=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];class mn extends Uf{}function wa(r,e=!0,t){const n=document.createElement("div");return n.setAttribute("class",`g6-${r}`),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),t&&Object.assign(n.style,t),n}function hf(r,e="div",t={},n="",i=document.body){const s=document.getElementById(r);s&&s.remove();const a=document.createElement(e);return a.innerHTML=n,a.id=r,Object.assign(a.style,t),i.appendChild(a),a}var nD=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class cc extends mn{constructor(e,t){super(e,Object.assign({},cc.defaultOptions,t)),this.$element=wa("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return nD(this,void 0,void 0,function*(){t.update.call(this,e),Object.assign(this.$element.style,Cf(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}cc.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function hg(r,e,t,n,i,s){const a=r,o=e,l=t-a,u=n-o;let c=i-a,d=s-o,h=c*l+d*u,f=0;h<=0?f=0:(c=l-c,d=u-d,h=c*l+d*u,h<=0?f=0:f=h*h/(l*l+u*u));const g=c*c+d*d-f;return g<0?0:g}function Ii(r,e,t,n){return(r-t)*(r-t)+(e-n)*(e-n)}function e0(r,e,t,n,i){return Ii(r,e,t,n)<i*i}function rD(r){if(!Number.isFinite(r))return t=>t;if(r===0)return Math.round;const e=Math.pow(10,r);return t=>Math.round(t*e)/e}function Rb(r){const e=Math.min(r.x1,r.x2),t=Math.max(r.x1,r.x2),n=Math.min(r.y1,r.y2),i=Math.max(r.y1,r.y2);return{x:e,y:n,x2:t,y2:i,width:t-e,height:i-n}}class an{constructor(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new an(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const n=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=n}distSquare(e,t){return hg(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,n){if(this.x1<this.x2){if(e<this.x1-n||e>this.x2+n)return!1}else if(e<this.x2-n||e>this.x1+n)return!1;if(this.y1<this.y2){if(t<this.y1-n||t>this.y2+n)return!1}else if(t<this.y2-n||t>this.y1+n)return!1;return!0}}var Pt;(function(r){r[r.POINT=1]="POINT",r[r.PARALLEL=2]="PARALLEL",r[r.COINCIDENT=3]="COINCIDENT",r[r.NONE=4]="NONE"})(Pt||(Pt={}));class Zd{constructor(e,t=0,n=0){this.state=e,this.x=t,this.y=n}}function Ol(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const s=t/i,a=n/i;return 0<=s&&s<=1&&0<=a&&a<=1?new Zd(Pt.POINT,r.x1+s*(r.x2-r.x1),r.y1+s*(r.y2-r.y1)):new Zd(Pt.NONE)}return new Zd(t===0||n===0?Pt.COINCIDENT:Pt.PARALLEL)}function jb(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const s=t/i,a=n/i;if(0<=s&&s<=1&&0<=a&&a<=1)return s}return Number.POSITIVE_INFINITY}function iD(r,e){function t(i,s,a,o){let l=jb(e,new an(i,s,a,o));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let n=t(r.x,r.y,r.x2,r.y);return n+=t(r.x,r.y,r.x,r.y2),n>1||(n+=t(r.x,r.y2,r.x2,r.y2),n>1)?!0:(n+=t(r.x2,r.y,r.x2,r.y2),n>0)}var _t;(function(r){r[r.LEFT=0]="LEFT",r[r.TOP=1]="TOP",r[r.RIGHT=2]="RIGHT",r[r.BOTTOM=3]="BOTTOM"})(_t||(_t={}));function $l(r,e,t){const n=new Set;return r.width<=0?(n.add(_t.LEFT),n.add(_t.RIGHT)):e<r.x?n.add(_t.LEFT):e>r.x+r.width&&n.add(_t.RIGHT),r.height<=0?(n.add(_t.TOP),n.add(_t.BOTTOM)):t<r.y?n.add(_t.TOP):t>r.y+r.height&&n.add(_t.BOTTOM),n}function Bb(r,e){let t=e.x1,n=e.y1;const i=e.x2,s=e.y2,a=Array.from($l(r,i,s));if(a.length===0)return!0;let o=$l(r,t,n);for(;o.size!==0;){for(const l of a)if(o.has(l))return!1;if(o.has(_t.RIGHT)||o.has(_t.LEFT)){let l=r.x;o.has(_t.RIGHT)&&(l+=r.width),n=n+(l-t)*(s-n)/(i-t),t=l}else{let l=r.y;o.has(_t.BOTTOM)&&(l+=r.height),t=t+(l-n)*(i-t)/(s-n),n=l}o=$l(r,t,n)}return!0}function sD(r,e){let t=Number.POSITIVE_INFINITY,n=0;function i(s,a,o,l){let u=jb(e,new an(s,a,o,l));u=Math.abs(u-.5),u>=0&&u<=1&&(n++,u<t&&(t=u))}return i(r.x,r.y,r.x2,r.y),i(r.x,r.y,r.x,r.y2),n>1||(i(r.x,r.y2,r.x2,r.y2),n>1)?t:(i(r.x2,r.y,r.x2,r.y2),n===0?-1:t)}function aD(r,e){let t=0;const n=Ol(r,new an(e.x,e.y,e.x2,e.y));t+=n.state===Pt.POINT?1:0;const i=Ol(r,new an(e.x,e.y,e.x,e.y2));t+=i.state===Pt.POINT?1:0;const s=Ol(r,new an(e.x,e.y2,e.x2,e.y2));t+=s.state===Pt.POINT?1:0;const a=Ol(r,new an(e.x2,e.y,e.x2,e.y2));return t+=a.state===Pt.POINT?1:0,{top:n,left:i,bottom:s,right:a,count:t}}class xn{constructor(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new xn(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new xn(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),s=Math.max(this.y2,e.y+e.height);this.x=t,this.y=n,this.width=i-t,this.height=s-n}addPoint(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),s=Math.max(this.y2,e.y);this.x=t,this.y=n,this.width=i-t,this.height=s-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const n=$l(this,e,t);return n.has(_t.TOP)?n.has(_t.LEFT)?Ii(e,t,this.x,this.y):n.has(_t.RIGHT)?Ii(e,t,this.x2,this.y):(this.y-t)*(this.y-t):n.has(_t.BOTTOM)?n.has(_t.LEFT)?Ii(e,t,this.x,this.y2):n.has(_t.RIGHT)?Ii(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):n.has(_t.LEFT)?(this.x-e)*(this.x-e):n.has(_t.RIGHT)?(e-this.x2)*(e-this.x2):0}}function oD(r){if(r.length===0)return null;const e=r[0],t=new xn(e.x,e.y,0,0);for(const n of r)t.addPoint(n);return t}class bu{constructor(e,t,n){this.cx=e,this.cy=t,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new bu(e.cx,e.cy,e.radius)}containsPt(e,t){return Ii(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const n=Ii(this.cx,this.cy,e,t);if(n<this.radius*this.radius)return 0;const i=Math.sqrt(n)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class ws{constructor(e,t=0,n=0,i=0,s=0,a=10,o=10,l=new Float32Array(Math.max(0,a*o)).fill(0)){this.pixelGroup=e,this.i=t,this.j=n,this.pixelX=i,this.pixelY=s,this.width=a,this.height=o,this.area=l}createSub(e,t){return new ws(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new ws(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new ws(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),n=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),s=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),a=i-t,o=s-n;return new xn(t,n,a,o)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const n=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-n),s=this.boundY(e.y-n),a=this.boundX(e.x2+n),o=this.boundY(e.y2+n),l=a-i,u=o-s;return new xn(i,s,l,u)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=n)}set(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=n)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const n=this.width,i=e.width,s=Math.max(0,e.i),a=Math.max(0,e.j),o=Math.min(e.i+e.width,n),l=Math.min(e.j+e.height,this.height);if(!(l<=0||o<=0||s>=n||l>=this.height))for(let u=a;u<l;u++){const c=(u-e.j)*i,d=u*n;for(let h=s;h<o;h++){const f=e.area[h-e.i+c];f!==0&&(this.area[h+d]+=t*f)}}}fill(e){this.area.fill(e)}fillArea(e,t){const n=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const s=n+i*this.width;this.area.fill(t,s,s+e.width)}}fillHorizontalLine(e,t,n,i){const s=e+t*this.width;this.area.fill(i,s,s+n)}fillVerticalLine(e,t,n,i){const s=e+t*this.width;for(let a=0;a<n;a++)this.area[s+a*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const n=t*this.width;for(let i=0;i<this.width;i++){const s=this.area[n+i];e+=s.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const n=this.area.reduce((a,o)=>Math.min(a,o),Number.POSITIVE_INFINITY),i=this.area.reduce((a,o)=>Math.max(a,o),Number.NEGATIVE_INFINITY),s=a=>(a-n)/(i-n);e.scale(this.pixelGroup,this.pixelGroup);for(let a=0;a<this.width;a++)for(let o=0;o<this.height;o++){const l=this.area[a+o*this.width];e.fillStyle=`rgba(0, 0, 0, ${s(l)})`,e.fillRect(a,o,1,1)}e.restore()}drawThreshold(e,t,n=!0){if(!(this.width<=0||this.height<=0)){e.save(),n&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let s=0;s<this.height;s++){const a=this.area[i+s*this.width];e.fillStyle=a>t?"black":"white",e.fillRect(i,s,1,1)}e.restore()}}}function zb(r,e){const t=n=>({x:n.x-e,y:n.y-e,width:n.width+2*e,height:n.height+2*e});return Array.isArray(r)?r.map(t):t(r)}function t0(r,e,t){return Fb(Object.assign(Rb(r),{distSquare:(n,i)=>hg(r.x1,r.y1,r.x2,r.y2,n,i)}),e,t)}function Fb(r,e,t){const n=zb(r,t),i=e.scale(n),s=e.createSub(i,n);return lD(s,e,t,(a,o)=>r.distSquare(a,o)),s}function lD(r,e,t,n){const i=t*t;for(let s=0;s<r.height;s++)for(let a=0;a<r.width;a++){const o=e.invertScaleX(r.i+a),l=e.invertScaleY(r.j+s),u=n(o,l);if(u===0){r.set(a,s,i);continue}if(u<i){const c=t-Math.sqrt(u);r.set(a,s,c*c)}}return r}function uD(r,e,t){const n=e.scale(r),i=e.addPadding(n,t),s=e.createSub(i,{x:r.x-t,y:r.y-t}),a=n.x-i.x,o=n.y-i.y,l=i.x2-n.x2,u=i.y2-n.y2,c=i.width-a-l,d=i.height-o-u,h=t*t;s.fillArea({x:a,y:o,width:c+1,height:d+1},h);const f=[0],g=Math.max(o,a,l,u);{const b=e.invertScaleX(n.x+n.width/2);for(let E=1;E<g;E++){const T=e.invertScaleY(n.y-E),S=r.distSquare(b,T);if(S<h){const k=t-Math.sqrt(S);f.push(k*k)}else break}}const v=[],p=Math.max(a,l),y=Math.max(o,l);for(let b=1;b<p;b++){const E=e.invertScaleX(n.x-b),T=[];for(let S=1;S<y;S++){const k=e.invertScaleY(n.y-S),A=r.distSquare(E,k);if(A<h){const O=t-Math.sqrt(A);T.push(O*O)}else T.push(0)}v.push(T)}for(let b=1;b<Math.min(o,f.length);b++){const E=f[b];s.fillHorizontalLine(a,o-b,c+1,E)}for(let b=1;b<Math.min(u,f.length);b++){const E=f[b];s.fillHorizontalLine(a,o+d+b,c+1,E)}for(let b=1;b<Math.min(a,f.length);b++){const E=f[b];s.fillVerticalLine(a-b,o,d+1,E)}for(let b=1;b<Math.min(u,f.length);b++){const E=f[b];s.fillVerticalLine(a+c+b,o,d+1,E)}for(let b=1;b<a;b++){const E=v[b-1],T=a-b;for(let S=1;S<o;S++)s.set(T,o-S,E[S-1]);for(let S=1;S<u;S++)s.set(T,o+d+S,E[S-1])}for(let b=1;b<l;b++){const E=v[b-1],T=a+c+b;for(let S=1;S<o;S++)s.set(T,o-S,E[S-1]);for(let S=1;S<u;S++)s.set(T,o+d+S,E[S-1])}return s}function mt(r,e){return{x:r,y:e}}function cD(r,e,t,n){if(r.length===0)return[];const i=pD(r);return i.map((s,a)=>{const o=i.slice(0,a);return dD(e,s,o,t,n)}).flat()}function dD(r,e,t,n,i){const s=mt(e.cx,e.cy),a=gD(s,t,r);if(a==null)return[];const o=new an(s.x,s.y,a.cx,a.cy),l=hD(o,r,n,i);return fD(l,r)}function hD(r,e,t,n){const i=[],s=[];s.push(r);let a=!0;for(let o=0;o<t&&a;o++)for(a=!1;!a&&s.length>0;){const l=s.pop(),u=$b(e,l),c=u?aD(l,u):null;if(!u||!c||c.count!==2){a||i.push(l);continue}let d=n,h=Nl(u,d,c,!0),f=bi(h,s)||bi(h,i),g=kl(h,e);for(;!f&&g&&d>=1;)d/=1.5,h=Nl(u,d,c,!0),f=bi(h,s)||bi(h,i),g=kl(h,e);if(h&&!f&&!g&&(s.push(new an(l.x1,l.y1,h.x,h.y)),s.push(new an(h.x,h.y,l.x2,l.y2)),a=!0),a)continue;d=n,h=Nl(u,d,c,!1);let v=bi(h,s)||bi(h,i);for(g=kl(h,e);!v&&g&&d>=1;)d/=1.5,h=Nl(u,d,c,!1),v=bi(h,s)||bi(h,i),g=kl(h,e);h&&!v&&(s.push(new an(l.x1,l.y1,h.x,h.y)),s.push(new an(h.x,h.y,l.x2,l.y2)),a=!0),a||i.push(l)}for(;s.length>0;)i.push(s.pop());return i}function fD(r,e){const t=[];for(;r.length>0;){const n=r.pop();if(r.length===0){t.push(n);break}const i=r.pop(),s=new an(n.x1,n.y1,i.x2,i.y2);$b(e,s)?(t.push(n),r.push(i)):r.push(s)}return t}function gD(r,e,t){let n=Number.POSITIVE_INFINITY;return e.reduce((i,s)=>{const a=Ii(r.x,r.y,s.cx,s.cy);if(a>n)return i;const o=new an(r.x,r.y,s.cx,s.cy),l=vD(t,o);return a*(l+1)*(l+1)<n&&(i=s,n=a*(l+1)*(l+1)),i},null)}function pD(r){if(r.length<2)return r;let e=0,t=0;return r.forEach(n=>{e+=n.cx,t+=n.cy}),e/=r.length,t/=r.length,r.map(n=>{const i=e-n.cx,s=t-n.cy,a=i*i+s*s;return[n,a]}).sort((n,i)=>n[1]-i[1]).map(n=>n[0])}function kl(r,e){return e.some(t=>t.containsPt(r.x,r.y))}function bi(r,e){return e.some(t=>!!(e0(t.x1,t.y1,r.x,r.y,.001)||e0(t.x2,t.y2,r.x,r.y,.001)))}function $b(r,e){let t=Number.POSITIVE_INFINITY,n=null;for(const i of r){if(!Bb(i,e))continue;const s=sD(i,e);s>=0&&s<t&&(n=i,t=s)}return n}function vD(r,e){return r.reduce((t,n)=>Bb(n,e)&&iD(n,e)?t+1:t,0)}function Nl(r,e,t,n){const i=t.top,s=t.left,a=t.bottom,o=t.right;if(n){if(s.state===Pt.POINT){if(i.state===Pt.POINT)return mt(r.x-e,r.y-e);if(a.state===Pt.POINT)return mt(r.x-e,r.y2+e);const h=r.width*r.height;return r.width*((s.y-r.y+(o.y-r.y))*.5)<h*.5?s.y>o.y?mt(r.x-e,r.y-e):mt(r.x2+e,r.y-e):s.y<o.y?mt(r.x-e,r.y2+e):mt(r.x2+e,r.y2+e)}if(o.state===Pt.POINT){if(i.state===Pt.POINT)return mt(r.x2+e,r.y-e);if(a.state===Pt.POINT)return mt(r.x2+e,r.y2+e)}const c=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<c*.5?i.x>a.x?mt(r.x-e,r.y-e):mt(r.x-e,r.y2+e):i.x<a.x?mt(r.x2+e,r.y-e):mt(r.x2+e,r.y2+e)}if(s.state===Pt.POINT){if(i.state===Pt.POINT)return mt(r.x2+e,r.y2+e);if(a.state===Pt.POINT)return mt(r.x2+e,r.y-e);const c=r.height*r.width;return r.width*((s.y-r.y+(o.y-r.y))*.5)<c*.5?s.y>o.y?mt(r.x2+e,r.y2+e):mt(r.x-e,r.y2+e):s.y<o.y?mt(r.x2+e,r.y-e):mt(r.x-e,r.y-e)}if(o.state===Pt.POINT){if(i.state===Pt.POINT)return mt(r.x-e,r.y2+e);if(a.state===Pt.POINT)return mt(r.x-e,r.y-e)}const l=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<l*.5?i.x>a.x?mt(r.x2+e,r.y2+e):mt(r.x2+e,r.y-e):i.x<a.x?mt(r.x-e,r.y2+e):mt(r.x-e,r.y-e)}function mD(r,e,t,n){if(!(r.closed?t<r.length:t<r.length-1))return!1;const s=r.get(e),a=r.get(t+1);for(let o=e+1;o<=t;o++){const l=r.get(o);if(hg(s.x,s.y,a.x,a.y,l.x,l.y)>n)return!1}return!0}function yD(r=0){return e=>{if(r<0||e.length<3)return e;const t=[];let n=0;const i=r*r;for(;n<e.length;){let s=n+1;for(;mD(e,n,s,i);)s++;t.push(e.get(n)),n=s}return new xa(t)}}function bD(r,e){switch(r){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function wD(r=6){function s(a,o,l){let u=0,c=0;for(let d=-2;d<=1;d++){const h=a.get(o+d),f=bD(d,l);u+=f*h.x,c+=f*h.y}return{x:u,y:c}}return a=>{if(a.length<3)return a;const o=[],l=a.closed,u=a.length+3-1+(l?0:2);o.push(s(a,2-(l?0:2),0));for(let c=2-(l?0:2);c<u;c++)for(let d=1;d<=r;d++)o.push(s(a,c,d/r));return new xa(o)}}function xD(r=8){return e=>{let t=r,n=e.length;if(t>1)for(n=Math.floor(e.length/t);n<3&&t>1;)t-=1,n=Math.floor(e.length/t);const i=[];for(let s=0,a=0;a<n;a++,s+=t)i.push(e.get(s));return new xa(i)}}class xa{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,n=this.points.length;return e<0?this.closed?this.get(e+n):this.points[0]:e>=n?this.closed?this.get(e-n):this.points[n-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const n=typeof e=="function"?e:rD(e);let i="M";for(const s of t)i+=`${n(s.x)},${n(s.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const n of t)e.lineTo(n.x,n.y);this.closed&&e.closePath()}}sample(e){return xD(e)(this)}simplify(e){return yD(e)(this)}bSplines(e){return wD(e)(this)}apply(e){return e(this)}containsElements(e){const t=oD(this.points);return t?e.every(n=>t.containsPt(n.cx,n.cy)&&this.withinArea(n.cx,n.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let n=0;const i=this.points[0],s=new an(i.x,i.y,i.x,i.y);for(let a=1;a<this.points.length;a++){const o=this.points[a];s.x1=s.x2,s.y1=s.y2,s.x2=o.x,s.y2=o.y,s.cuts(e,t)&&n++}return s.x1=s.x2,s.y1=s.y2,s.x2=i.x,s.y2=i.y,s.cuts(e,t)&&n++,n%2===1}}class ED{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new xa(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const Pa=0,Al=1,Cl=2,Kd=3;function MD(r,e){const t=(Math.floor(r.width)+Math.floor(r.height))*2,n=new ED(t);function i(l,u,c,d){const h=r.get(l,u);return Number.isNaN(h)?Number.NaN:h>e?c+d:c}function s(l,u){let c=Pa;return c=i(l,u,c,1),c=i(l+1,u,c,2),c=i(l,u+1,c,4),c=i(l+1,u+1,c,8),Number.isNaN(c)?-1:c}let a=Al;function o(l,u){let c=l,d=u,h=r.invertScaleX(c),f=r.invertScaleY(d);for(let g=0;g<r.width*r.height;g++){const v={x:h,y:f};if(n.contains(v)){if(n.isFirst(v))return!0}else n.add(v);const p=s(c,d);switch(p){case-1:return!0;case 0:case 3:case 2:case 7:a=Cl;break;case 12:case 14:case 4:a=Kd;break;case 6:a=a===Pa?Kd:Cl;break;case 1:case 13:case 5:a=Pa;break;case 9:a=a===Cl?Pa:Al;break;case 10:case 8:case 11:a=Al;break;default:return console.warn("Marching squares invalid state: "+p),!0}switch(a){case Pa:d--,f-=r.pixelGroup;break;case Al:d++,f+=r.pixelGroup;break;case Kd:c--,h-=r.pixelGroup;break;case Cl:c++,h+=r.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+p),!0}}return!0}for(let l=0;l<r.width;l++)for(let u=0;u<r.height;u++){if(r.get(l,u)<=e)continue;const c=s(l,u);if(!(c<0||c===15)&&o(l,u))return n.path()}return null}const dc={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Za(r){return r!=null&&typeof r.radius=="number"}function n0(r,e){if(Za(r)!==Za(e))return!1;if(Za(r)){const n=e;return r.cx===n.cx&&r.cy===n.cy&&r.radius===n.radius}const t=e;return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}var br;(function(r){r[r.MEMBERS=0]="MEMBERS",r[r.NON_MEMBERS=1]="NON_MEMBERS",r[r.EDGES=2]="EDGES"})(br||(br={}));let r0=class{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new xn(0,0,0,0),this.potentialArea=new ws(1,0,0,0,0,0,0),this.o=Object.assign({},dc,e)}pushMember(...e){if(e.length!==0){this.dirty.add(br.MEMBERS);for(const t of e)this.members.push({raw:t,obj:Za(t)?bu.from(t):xn.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(n=>n0(n.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(br.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(n=>n0(n.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(br.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(n=>n.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(br.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(br.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:Za(t)?bu.from(t):xn.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(br.EDGES);for(const t of e)this.edges.push({raw:t,obj:an.from(t),area:null})}}update(){const e=this.dirty.has(br.MEMBERS),t=this.dirty.has(br.NON_MEMBERS);let n=this.dirty.has(br.EDGES);this.dirty.clear();const i=this.members.map(u=>u.obj);if(this.o.virtualEdges&&(e||t)){const u=this.nonMembers.map(h=>h.obj),c=cD(i,u,this.o.maxRoutingIterations,this.o.morphBuffer),d=new Map(this.virtualEdges.map(h=>[h.obj.toString(),h.area]));this.virtualEdges=c.map(h=>{var f;return{raw:h,obj:h,area:(f=d.get(h.toString()))!==null&&f!==void 0?f:null}}),n=!0}let s=!1;if(e||n){const u=this.virtualEdges.concat(this.edges).map(f=>f.obj),c=TD(i,u),d=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,h=xn.from(zb(c,d));h.equals(this.activeRegion)||(s=!0,this.activeRegion=h)}if(s){const u=Math.ceil(this.activeRegion.width/this.o.pixelGroup),c=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=ws.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(d=>d.area=null),this.nonMembers.forEach(d=>d.area=null),this.edges.forEach(d=>d.area=null),this.virtualEdges.forEach(d=>d.area=null)):(u!==this.potentialArea.width||c!==this.potentialArea.height)&&(this.potentialArea=ws.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const a=new Map,o=u=>{if(u.area){const c=`${u.obj.width}x${u.obj.height}x${u.obj instanceof xn?"R":"C"}`;a.set(c,u.area)}},l=u=>{if(u.area)return;const c=`${u.obj.width}x${u.obj.height}x${u.obj instanceof xn?"R":"C"}`;if(a.has(c)){const h=a.get(c);u.area=this.potentialArea.copy(h,{x:u.obj.x-this.o.nodeR1,y:u.obj.y-this.o.nodeR1});return}const d=u.obj instanceof xn?uD(u.obj,this.potentialArea,this.o.nodeR1):Fb(u.obj,this.potentialArea,this.o.nodeR1);u.area=d,a.set(c,d)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(l),this.nonMembers.forEach(u=>{this.activeRegion.intersects(u.obj)?l(u):u.area=null}),this.edges.forEach(u=>{u.area||(u.area=t0(u.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(u=>{u.area||(u.area=t0(u.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new xa([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,n=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),s=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),a=this.members.map(o=>o.obj);return SD(t,n,i,s,o=>o.containsElements(a),e)}};function SD(r,e,t,n,i,s={}){const a=Object.assign({},dc,s);let o=a.threshold,l=a.memberInfluenceFactor,u=a.edgeInfluenceFactor,c=a.nonMemberInfluenceFactor;const d=(a.nodeR0-a.nodeR1)*(a.nodeR0-a.nodeR1),h=(a.edgeR0-a.edgeR1)*(a.edgeR0-a.edgeR1);for(let f=0;f<a.maxMarchingIterations;f++){if(r.clear(),l!==0){const v=l/d;for(const p of e)r.incArea(p,v)}if(u!==0){const v=u/h;for(const p of t)r.incArea(p,v)}if(c!==0){const v=c/d;for(const p of n)r.incArea(p,v)}const g=MD(r,o);if(g&&i(g))return g;if(o*=.95,f<=a.maxMarchingIterations*.5)l*=1.2,u*=1.2;else if(c!==0&&n.length>0)c*=.8;else break}return new xa([])}function TD(r,e){if(r.length===0)return new xn(0,0,0,0);const t=xn.from(r[0]);for(const n of r)t.add(n);for(const n of e)t.add(Rb(n));return t}var OD=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class hc extends mn{constructor(e,t){super(e,Ln({},hc.defaultOptions,t)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:n,bubbleSetOptions:i}=this.parseOptions();Ct(this.bubbleSetOptions,i)||this.init(),this.bubbleSetOptions=Object.assign({},i);const s=Object.assign(Object.assign({},n),{d:this.getPath()});this.shape?this.shape.update(s):(this.shape=new To({style:s}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=n=>{if(!this.shape)return;const i=q(n.data);[...this.options.members,...this.options.avoidMembers].includes(i)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(i)}))},this.getPath=n=>{const{graph:i}=this.context,s=this.options.members,a=[...this.members.keys()],o=this.options.avoidMembers,l=[...this.avoidMembers.keys()];if(!n&&Ct(s,a)&&Ct(o,l))return this.path;const{enter:u=[],exit:c=[]}=zi(a,s,p=>p),{enter:d=[],exit:h=[]}=zi(l,o,p=>p);n&&(c.push(n),u.push(n));const f=(p,y,b)=>{p.forEach(E=>{const T=b?this.members:this.avoidMembers,S=b?"pushMember":"pushNonMember",k=b?"removeMember":"removeNonMember";if(y){let A;i.getElementType(E)==="edge"?([A]=ND(i,E),this.bubbleSets.pushEdge(A)):([A]=kD(i,E),this.bubbleSets[S](A)),T.set(E,A)}else{const A=T.get(E);A&&(i.getElementType(E)==="edge"?this.bubbleSets.removeEdge(A):this.bubbleSets[k](A),T.delete(E))}})};f(c,!1,!0),f(u,!0,!0),f(h,!1,!1),f(d,!0,!1);const v=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=C1(v.points.map(fn)),this.path},this.bindEvents(),this.bubbleSets=new r0(this.options)}bindEvents(){this.context.graph.on(fe.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(fe.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new r0(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const e=this.options,{type:t,key:n,members:i,avoidMembers:s}=e,a=OD(e,["type","key","members","avoidMembers"]),o=Object.keys(a).reduce((l,u)=>(u in dc?l.bubbleSetOptions[u]=a[u]:l.style[u]=a[u],l),{style:{},bubbleSetOptions:{}});return Object.assign({type:t,key:n,members:i,avoidMembers:s},o)}addMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.avoidMembers.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n))),this.options.members=[...new Set([...this.options.members,...t])],this.drawBubbleSets()}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),this.drawBubbleSets()}updateMember(e){this.options.members=Ee(e)?e(this.options.members):e,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.members.includes(n))&&(this.options.members=this.options.members.filter(n=>!t.includes(n))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...t])],this.drawBubbleSets()}removeAvoidMember(e){const t=Array.isArray(e)?e:[e];this.options.avoidMembers.some(n=>t.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n)),this.drawBubbleSets())}updateAvoidMember(e){this.options.avoidMembers=Array.isArray(e)?e:[e],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(fe.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(fe.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}hc.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},dc);const kD=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getElementRenderBounds(n);return new xn(i.min[0],i.min[1],Ur(i),Hr(i))}),ND=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getEdgeData(n),s=r.getElementPosition(i.source),a=r.getElementPosition(i.target);return an.from({x1:s[0],y1:s[1],x2:a[0],y2:a[1]})});function AD(r){return`
    <ul class="g6-contextmenu-ul">
      ${r.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const CD=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var i0=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class fc extends mn{constructor(e,t){super(e,Object.assign({},fc.defaultOptions,t)),this.targetElement=null,this.onTriggerEvent=n=>{var i;(i=n.preventDefault)===null||i===void 0||i.call(n),this.show(n)},this.onMenuItemClick=n=>{const{onClick:i,trigger:s}=this.options;if(n.target instanceof HTMLElement&&n.target.className.includes("g6-contextmenu-li")){const a=n.target.getAttribute("value");i==null||i(a,n.target,this.targetElement),this.hide()}s!=="click"&&this.hide()},this.initElement(),this.update(t)}initElement(){this.$element=wa("contextmenu",!1,{zIndex:"99"});const{className:e}=this.options;e&&this.$element.classList.add(e),this.context.canvas.getContainer().appendChild(this.$element),hf("g6-contextmenu-css","style",{},CD,document.head)}show(e){return i0(this,void 0,void 0,function*(){const{enable:t,offset:n}=this.options;if(typeof t=="function"&&!t(e)||!t){this.hide();return}const i=yield this.getDOMContent(e);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const s=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${e.client.x-s.left+n[0]}px`,this.$element.style.top=`${e.client.y-s.top+n[1]}px`,this.$element.style.display="block",this.targetElement=e.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(e){return i0(this,void 0,void 0,function*(){const{getContent:t,getItems:n}=this.options;return n?AD(yield n(e)):yield t(e)})}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`canvas:${t}`,this.onTriggerEvent),e.on(`node:${t}`,this.onTriggerEvent),e.on(`edge:${t}`,this.onTriggerEvent),e.on(`combo:${t}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`canvas:${t}`,this.onTriggerEvent),e.off(`node:${t}`,this.onTriggerEvent),e.off(`edge:${t}`,this.onTriggerEvent),e.off(`combo:${t}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}fc.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class gc extends mn{constructor(e,t){super(e,Object.assign({},gc.defaultOptions,t)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:n,element:i}=this.context,s=n.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:a,iterRate:o,divRate:l}=this.options;let{lambda:u,divisions:c,iterations:d}=this.options;for(let h=0;h<a;h++){for(let f=0;f<d;f++){const g={};s.forEach(v=>{var p;if(v.source===v.target)return;const y=q(v);g[y]=this.getEdgeForces(v,c,u);for(let b=0;b<c+1;b++)(p=this.edgePoints)[y]||(p[y]=[]),this.edgePoints[y][b]=ze(this.edgePoints[y][b],g[y][b])})}u/=2,c*=l,d*=o,this.divideEdges(c)}s.forEach(h=>{const f=q(h),g=i.getElement(f);g==null||g.update({d:tg(this.edgePoints[f])})})},this.bindEvents()}get nodeMap(){const e=this.context.model.getNodeData();return Object.fromEntries(e.map(t=>[q(t),Os(Kt(t))]))}divideEdges(e){this.context.model.getEdgeData().forEach(n=>{var i;const s=q(n);(i=this.edgePoints)[s]||(i[s]=[]);const a=this.nodeMap[n.source],o=this.nodeMap[n.target];if(e===1)this.edgePoints[s].push(a),this.edgePoints[s].push(Tr(ze(a,o),2)),this.edgePoints[s].push(o);else{const u=(this.edgePoints[s].length===0?ft(a,o):ID(this.edgePoints[s]))/(e+1);let c=u;const d=[a];for(let h=1;h<this.edgePoints[s].length;h++){const f=this.edgePoints[s][h-1],g=this.edgePoints[s][h];let v=ft(g,f);for(;v>c;){const p=c/v,y=ze(f,ni(it(g,f),p));d.push(y),v-=c,c=u}c-=v}d.push(o),this.edgePoints[s]=d}})}getVectorPosition(e){const t=this.nodeMap[e.source],n=this.nodeMap[e.target],[i,s]=it(n,t),a=ft(t,n);return{source:t,target:n,vx:i,vy:s,length:a}}measureEdgeCompatibility(e,t){const n=this.getVectorPosition(e),i=this.getVectorPosition(t),s=PD(n,i),a=_D(n,i),o=LD(n,i),l=DD(n,i);return s*a*o*l}getEdgeBundles(){const e={},t=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((i,s)=>{n.forEach((a,o)=>{var l,u;if(o<=s)return;this.measureEdgeCompatibility(i,a)>=t&&(e[l=q(i)]||(e[l]=[]),e[q(i)].push(a),e[u=q(a)]||(e[u]=[]),e[q(a)].push(i))})}),e}getSpringForce(e,t){const{pre:n,cur:i,next:s}=e;return ni(it(ze(n,s),ni(i,2)),t)}getElectrostaticForce(e,t){Ir(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[q(t)];let i=[0,0];return n==null||n.forEach(s=>{const a=this.edgePoints[q(s)][e],o=this.edgePoints[q(t)][e],l=it(a,o),u=ft(a,o);i=ze(i,ni(l,1/u))}),i}getEdgeForces(e,t,n){const i=this.nodeMap[e.source],s=this.nodeMap[e.target],a=this.options.K/(ft(i,s)*(t+1)),o=[[0,0]],l=q(e);for(let u=1;u<t;u++){const c=this.getSpringForce({pre:this.edgePoints[l][u-1],cur:this.edgePoints[l][u],next:this.edgePoints[l][u+1]||[0,0]},a),d=this.getElectrostaticForce(u,e);o.push(ni(ze(c,d),n))}return o.push([0,0]),o}bindEvents(){const{graph:e}=this.context;e.on(fe.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:e}=this.context;e.off(fe.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}gc.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const PD=(r,e)=>Math.abs(aN([r.vx,r.vy],[e.vx,e.vy])/(r.length*e.length)),_D=(r,e)=>{const t=(r.length+e.length)/2;return 2/(t/Math.min(r.length,e.length)+Math.max(r.length,e.length)/t)},LD=(r,e)=>{const t=(r.length+e.length)/2,n=Tr(ze(r.source,r.target),2),i=Tr(ze(e.source,e.target),2);return t/(t+ft(n,i))},s0=(r,e)=>{if(e.source[0]===e.target[0])return[e.source[0],r[1]];if(e.source[1]===e.target[1])return[r[0],e.source[1]];const t=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),n=(t*t*e.source[0]+t*(r[1]-e.source[1])+r[0])/(t*t+1),i=t*(n-e.source[0])+e.source[1];return[n,i]},a0=(r,e)=>{const t=s0(e.source,r),n=s0(e.target,r),i=Tr(ze(t,n),2),s=Tr(ze(r.source,r.target),2);return ft(t,n)===0?0:Math.max(0,1-2*ft(s,i)/ft(t,n))},DD=(r,e)=>Math.min(a0(r,e),a0(e,r)),ID=r=>{let e=0;for(let t=1;t<r.length;t++)e+=ft(r[t],r[t-1]);return e},RD={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},o0=.05;class pc extends mn{constructor(e,t){super(e,Object.assign({},pc.defaultOptions,t)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=fn(n.canvas);this.renderLens(i),this.renderFocusElements()},this.renderLens=n=>{const i=Object.assign({},RD,this.options.style);this.isLensOn||(this.lens=new Oo({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,xr(n),{size:this.r*2}),this.lens.update(i)},this.getFilterData=()=>{const{filter:n}=this.options,{model:i}=this.context,s=i.getData();if(!n)return s;const{nodes:a,edges:o,combos:l}=s;return{nodes:a.filter(u=>n(q(u),"node")),edges:o.filter(u=>n(q(u),"edge")),combos:l.filter(u=>n(q(u),"combo"))}},this.getFocusElements=n=>{const{nodes:i,edges:s}=this.getFilterData(),a=i.filter(u=>ft(Kt(u),n)<this.r),o=a.map(u=>q(u)),l=s.filter(u=>{const{source:c,target:d}=u,h=o.includes(c),f=o.includes(d);switch(this.options.nodeType){case"both":return h&&f;case"either":return h!==f;case"source":return h&&!f;case"target":return!h&&f;default:return!1}});return{nodes:a,edges:l}},this.renderFocusElements=()=>{const{element:n,graph:i}=this.context;if(!this.isLensOn)return;const s=this.lens.getCenter(),{nodes:a,edges:o}=this.getFocusElements(s),l=new Set,u=c=>{const d=q(c);l.add(d);const h=n.getElement(d);if(!h)return;const f=this.shapes.get(d)||h.cloneNode();f.setPosition(h.getPosition()),f.id=h.id,this.shapes.has(d)?Object.entries(h.attributes).forEach(([p,y])=>{f.style[p]!==y&&(f.style[p]=y)}):(this.canvas.appendChild(f),this.shapes.set(d,f));const g=i.getElementType(d),v=this.getElementStyle(g,c);f.update(v)};a.forEach(u),o.forEach(u),this.shapes.forEach((c,d)=>{l.has(d)||(c.destroy(),this.shapes.delete(d))})},this.scaleRByWheel=n=>{var i;this.options.preventDefault&&n.preventDefault();const{clientX:s,clientY:a,deltaX:o,deltaY:l}=n,{graph:u,canvas:c}=this.context,d=u.getCanvasByClient([s,a]),h=(i=this.lens)===null||i===void 0?void 0:i.getCenter();if(!this.isLensOn||ft(d,h)>this.r)return;const{maxR:f,minR:g}=this.options,v=o+l>0?1/(1-o0):1-o0,p=Math.min(...c.getSize())/2;this.r=Math.max(g||0,Math.min(f||p,this.r*v)),this.renderLens(h),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=n=>{var i;const s=fn(n.canvas),a=(i=this.lens)===null||i===void 0?void 0:i.getCenter();!this.isLensOn||ft(s,a)>this.r||(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=fn(n.canvas);this.renderLens(i),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(e,t){const n=e==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof n=="function"?n(t):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,s=t.getCanvas().getLayer();["click","drag"].includes(n)&&s.addEventListener(te.CLICK,this.onEdgeFilter),n==="pointermove"?s.addEventListener(te.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(s.addEventListener(te.DRAG_START,this.onDragStart),s.addEventListener(te.DRAG,this.onDrag),s.addEventListener(te.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.addEventListener(te.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,s=t.getCanvas().getLayer();["click","drag"].includes(n)&&s.removeEventListener(te.CLICK,this.onEdgeFilter),n==="pointermove"?s.removeEventListener(te.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(s.removeEventListener(te.DRAG_START,this.onDragStart),s.removeEventListener(te.DRAG,this.onDrag),s.removeEventListener(te.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.removeEventListener(te.WHEEL,this.scaleRByWheel))}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((e,t)=>{e.destroy(),this.shapes.delete(t)}),super.destroy()}}pc.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const jD={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},l0=.05,u0=.1;class vc extends mn{constructor(e,t){super(e,Object.assign({},vc.defaultOptions,t)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=fn(n.canvas);this.onMagnify(i)},this.onMagnify=n=>{n.some(isNaN)||(this.renderLens(n),this.renderFocusElements())},this.renderLens=n=>{const i=Object.assign({},jD,this.options.style);this.isLensOn||(this.lens=new Oo({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,xr(n),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(i)},this.getDPercent=()=>{const{minD:n,maxD:i}=this.options;return`${Math.round((this.d-n)/(i-n)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:n}=this.context,i=this.lens.getCenter(),s=(this.d+1)*this.r,a=new Map,o=new Map;n.getNodeData().forEach(u=>{const c=Kt(u),d=ft(c,i);if(d>this.r)return;const h=s*d/(this.d*d+this.r),[f,g]=c,[v,p]=i,y=(f-v)/d,b=(g-p)/d,E=[v+h*y,p+h*b],T=q(u),S=this.getNodeStyle(u),k=xs(n.getElementRenderStyle(T),Object.keys(S));a.set(T,Object.assign(Object.assign({},xr(E)),S)),o.set(T,Object.assign(Object.assign({},xr(c)),k))}),this.updateStyle(a,o)},this.getNodeStyle=n=>{const{nodeStyle:i}=this.options;return typeof i=="function"?i(n):i},this.updateStyle=(n,i)=>{const{graph:s,element:a}=this.context,{enter:o,exit:l,keep:u}=zi(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(n.keys()),h=>h),c=new Set,d=(h,f)=>{const g=a.getElement(h);g==null||g.update(f),s.getRelatedEdgesData(h).forEach(v=>{c.add(q(v))})};[...o,...u].forEach(h=>{d(h,n.get(h))}),l.forEach(h=>{d(h,this.prevOriginStyleMap.get(h)),this.prevOriginStyleMap.delete(h)}),c.forEach(h=>{const f=a.getElement(h);f==null||f.update({})}),this.prevMagnifiedStyleMap=n,i.forEach((h,f)=>{this.prevOriginStyleMap.has(f)||this.prevOriginStyleMap.set(f,h)})},this.isWheelValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const{clientX:i,clientY:s}=n,a=this.context.graph.getCanvasByClient([i,s]),o=this.lens.getCenter();return!(ft(a,o)>this.r)},this.scaleR=n=>{const{maxR:i,minR:s}=this.options,a=n?1/(1-l0):1-l0,o=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(s||0,Math.min(i||o,this.r*a))},this.scaleD=n=>{const{maxD:i,minD:s}=this.options,a=n?this.d+u0:this.d-u0;this.d=Math.max(s,Math.min(i,a))},this.scaleRByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:s}=n;this.scaleR(i+s>0);const a=this.lens.getCenter();this.onMagnify(a)},this.scaleDByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:s}=n;this.scaleD(i+s>0);const a=this.lens.getCenter();this.onMagnify(a)},this.isDragValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const i=fn(n.canvas),s=this.lens.getCenter();return!(ft(i,s)>this.r)},this.isLensDragging=!1,this.onDragStart=n=>{this.isDragValid(n)&&(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=fn(n.canvas);this.onMagnify(i)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:s}=n;this.scaleR(i-s>0);const a=this.lens.getCenter();this.onMagnify(a)},this.scaleDByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:s}=n;this.scaleD(i-s>0);const a=this.lens.getCenter();this.onMagnify(a)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:s}=this.options,a=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&a.addEventListener(te.CLICK,this.onCreateFisheye),n==="pointermove"&&a.addEventListener(te.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||s==="drag"){a.addEventListener(te.DRAG_START,this.onDragStart),a.addEventListener(te.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;a.addEventListener(te.DRAG,o)}if(i==="wheel"||s==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.addEventListener(te.WHEEL,o,{passive:!1})}}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:s}=this.options,a=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&a.removeEventListener(te.CLICK,this.onCreateFisheye),n==="pointermove"&&a.removeEventListener(te.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||s==="drag"){a.removeEventListener(te.DRAG_START,this.onDragStart),a.removeEventListener(te.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;a.removeEventListener(te.DRAG,o)}if(i==="wheel"||s==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.removeEventListener(te.WHEEL,o)}}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){var e;this.unbindEvents(),this.isLensOn&&((e=this.lens)===null||e===void 0||e.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}vc.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class mc extends mn{constructor(e,t){super(e,Object.assign({},mc.defaultOptions,t)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var n,i,s,a;const o=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(o),o?(i=(n=this.options).onEnter)===null||i===void 0||i.call(n):(a=(s=this.options).onExit)===null||a===void 0||a.call(s)},this.shortcut=new va(e.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:e=[],exit:t=[]}=this.options.trigger;this.shortcut.bind(e,this.request),this.shortcut.bind(t,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(i=>{document.addEventListener(i,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(e=!0){var t,n;let i,s;e?(i=((t=globalThis.screen)===null||t===void 0?void 0:t.width)||0,s=((n=globalThis.screen)===null||n===void 0?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[i,s]=this.graphSize,this.context.graph.setSize(i,s),this.context.graph.render()}request(){document.fullscreenElement||!BD()||this.$el.requestFullscreen().catch(e=>{Yr.warn(`Error attempting to enable full-screen: ${e.message} (${e.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}mc.defaultOptions={trigger:{},autoFit:!0};function BD(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class yc extends mn{constructor(e,t){super(e,Object.assign({},yc.defaultOptions,t)),this.$element=wa("grid-line",!0),this.offset=[0,0],this.onTransform=i=>{if(!this.options.follow)return;const{data:{translate:s}}=i;s&&this.updateOffset(s)},this.context.canvas.getContainer().prepend(this.$element),this.updateStyle(),this.bindEvents()}update(e){super.update(e),this.updateStyle()}bindEvents(){const{graph:e}=this.context;e.on(fe.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:e,stroke:t,lineWidth:n,border:i,borderLineWidth:s,borderStroke:a,borderStyle:o}=this.options;Object.assign(this.$element.style,{border:i?`${s}px ${o} ${a}`:"none",backgroundImage:`linear-gradient(${t} ${n}px, transparent ${n}px), linear-gradient(90deg, ${t} ${n}px, transparent ${n}px)`,backgroundSize:`${e}px ${e}px`,backgroundRepeat:"repeat"})}updateOffset(e){this.offset=lN(ze(this.offset,e),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(fe.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}yc.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};function fg(r){const e={Added:new Map,Updated:new Map,Removed:new Map};return r.forEach(t=>{const{type:n,value:i}=t,s=q(i);if(n==="NodeAdded"||n==="EdgeAdded"||n==="ComboAdded")e.Added.set(s,t);else if(n==="NodeUpdated"||n==="EdgeUpdated"||n==="ComboUpdated")if(e.Added.has(s))e.Added.set(s,{type:n.replace("Updated","Added"),value:i});else if(e.Updated.has(s)){const{original:a}=e.Updated.get(s);e.Updated.set(s,{type:n,value:i,original:a})}else e.Removed.has(s)||e.Updated.set(s,t);else(n==="NodeRemoved"||n==="EdgeRemoved"||n==="ComboRemoved")&&(e.Added.has(s)?e.Added.delete(s):(e.Updated.has(s)&&e.Updated.delete(s),e.Removed.set(s,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function Wb(r){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:n=[],EdgeAdded:i=[],EdgeUpdated:s=[],EdgeRemoved:a=[],ComboAdded:o=[],ComboUpdated:l=[],ComboRemoved:u=[]}=ku(r,c=>c.type);return{add:{nodes:e,edges:i,combos:o},update:{nodes:t,edges:s,combos:l},remove:{nodes:n,edges:a,combos:u}}}function Gb(r,e){for(const t in r)Bt(r[t])&&!Array.isArray(r[t])&&r[t]!==null?(e[t]||(e[t]={}),Gb(r[t],e[t])):e[t]===void 0&&(e[t]=ro(t))}function zD(r,e=!1,t){const n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:s,remove:a}=Wb(fg(r));return["nodes","edges","combos"].forEach(o=>{s[o]&&s[o].forEach(l=>{var u,c;const d=Object.assign({},l.value);let h=Object.assign({},l.original);if(t){const f=t.graph.getElementType(q(l.original)),g=f==="edge"?"stroke":"fill",v=t.element.getElementComputedStyle(f,l.original);h=Object.assign(Object.assign({},l.original),{style:Object.assign({[g]:v[g]},l.original.style)})}Gb(d,h),(u=n.current.update)[o]||(u[o]=[]),n.current.update[o].push(d),(c=n.original.update)[o]||(c[o]=[]),n.original.update[o].push(h)}),i[o]&&i[o].forEach(l=>{var u,c;const d=Object.assign({},l.value);(u=n.current.add)[o]||(u[o]=[]),n.current.add[o].push(d),(c=n.original.remove)[o]||(c[o]=[]),n.original.remove[o].push(d)}),a[o]&&a[o].forEach(l=>{var u,c;const d=Object.assign({},l.value);(u=n.current.remove)[o]||(u[o]=[]),n.current.remove[o].push(d),(c=n.original.add)[o]||(c[o]=[]),n.original.add[o].push(d)})}),n}class bc extends mn{constructor(e,t){super(e,Object.assign({},bc.defaultOptions,t)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(i,s=!0)=>{var a,o,l;this.freezed=!0,(o=(a=this.options).executeCommand)===null||o===void 0||o.call(a,i);const u=s?i.original:i.current;this.context.graph.addData(u.add),this.context.graph.updateData(u.update),this.context.graph.removeData(g1(u.remove,!1)),(l=this.context.element)===null||l===void 0||l.draw({silence:!0,animation:i.animation}),this.freezed=!1},this.addCommand=i=>{var s;if(!this.freezed){if(i.type===fe.AFTER_DRAW){const{dataChanges:a=[],animation:o=!0}=i.data;if(!((s=this.context.batch)===null||s===void 0)&&s.isBatching){if(!this.batchChanges)return;this.batchChanges.push(a),this.batchAnimation&&(this.batchAnimation=o);return}this.batchChanges=[a],this.batchAnimation=o}this.undoStackPush(zD(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Ti.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=i=>{const{initiate:s}=i.data;this.batchAnimation=!1,s?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new Zu;const{graph:n}=this.context;n.on(fe.AFTER_DRAW,this.addCommand),n.on(fe.BATCH_START,this.initBatchCommand),n.on(fe.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var e,t,n,i;const s=this.undoStack.pop();if(s){if(this.executeCommand(s),((t=(e=this.options).beforeAddCommand)===null||t===void 0?void 0:t.call(e,s,!1))===!1)return;this.redoStack.push(s),(i=(n=this.options).afterAddCommand)===null||i===void 0||i.call(n,s,!1),this.notify(Ti.UNDO,s)}return this}redo(){const e=this.redoStack.pop();return e&&(this.executeCommand(e,!1),this.undoStackPush(e),this.notify(Ti.REDO,e)),this}undoAndCancel(){const e=this.undoStack.pop();return e&&(this.executeCommand(e,!1),this.redoStack=[],this.notify(Ti.CANCEL,e)),this}undoStackPush(e){var t,n,i,s;const{stackSize:a}=this.options;a!==0&&this.undoStack.length>=a&&this.undoStack.shift(),((n=(t=this.options).beforeAddCommand)===null||n===void 0?void 0:n.call(t,e,!0))!==!1&&(this.undoStack.push(e),(s=(i=this.options).afterAddCommand)===null||s===void 0||s.call(i,e,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Ti.CLEAR,null)}notify(e,t){this.emitter.emit(e,{cmd:t}),this.emitter.emit(Ti.CHANGE,{cmd:t})}on(e,t){this.emitter.on(e,t)}destroy(){const{graph:e}=this.context;e.off(fe.AFTER_DRAW,this.addCommand),e.off(fe.BATCH_START,this.initBatchCommand),e.off(fe.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}bc.defaultOptions={stackSize:0};var Qd,c0;function FD(){if(c0)return Qd;c0=1;function r(t,n,i,s,a,o){const l=(o-n)*(i-t)-(s-n)*(a-t);return l>0?!0:!(l<0)}function e(t,n){const i=t[0][0],s=t[0][1],a=t[1][0],o=t[1][1],l=n[0][0],u=n[0][1],c=n[1][0],d=n[1][1];return r(i,s,l,u,c,d)!==r(a,o,l,u,c,d)&&r(i,s,a,o,l,u)!==r(i,s,a,o,c,d)}return Qd=e,Qd}var Jd,d0;function $D(){if(d0)return Jd;d0=1;function r(t,n){this._cells=[],this._cellSize=n,this._reverseCellSize=1/n;for(let i=0;i<t.length;i++){const s=t[i],a=this.coordToCellNum(s[0]),o=this.coordToCellNum(s[1]);if(this._cells[a])this._cells[a][o]?this._cells[a][o].push(s):this._cells[a][o]=[s];else{const l=[];l[o]=[s],this._cells[a]=l}}}r.prototype={cellPoints:function(t,n){return this._cells[t]!==void 0&&this._cells[t][n]!==void 0?this._cells[t][n]:[]},rangePoints:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),s=this.coordToCellNum(t[2]),a=this.coordToCellNum(t[3]),o=[];for(let l=n;l<=s;l++)for(let u=i;u<=a;u++)for(let c=0;c<this.cellPoints(l,u).length;c++)o.push(this.cellPoints(l,u)[c]);return o},removePoint:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),s=this._cells[n][i];let a;for(let o=0;o<s.length;o++)if(s[o][0]===t[0]&&s[o][1]===t[1]){a=o;break}return s.splice(a,1),s},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,n){return[t[0]-n*this._cellSize,t[1]-n*this._cellSize,t[2]+n*this._cellSize,t[3]+n*this._cellSize]}};function e(t,n){return new r(t,n)}return Jd=e,Jd}var eh,h0;function WD(){return h0||(h0=1,eh={toXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}}),eh}var th,f0;function GD(){if(f0)return th;f0=1;function r(i,s,a){return(s[0]-i[0])*(a[1]-i[1])-(s[1]-i[1])*(a[0]-i[0])}function e(i){const s=[];for(let a=0;a<i.length;a++){for(;s.length>=2&&r(s[s.length-2],s[s.length-1],i[a])<=0;)s.pop();s.push(i[a])}return s.pop(),s}function t(i){const s=i.reverse(),a=[];for(let o=0;o<s.length;o++){for(;a.length>=2&&r(a[a.length-2],a[a.length-1],s[o])<=0;)a.pop();a.push(s[o])}return a.pop(),a}function n(i){const s=e(i),o=t(i).concat(s);return o.push(i[0]),o}return th=n,th}var nh,g0;function YD(){if(g0)return nh;g0=1;const r=FD(),e=$D(),t=WD(),n=GD();function i(p){const y=[p[0]];let b=p[0];for(let E=1;E<p.length;E++){const T=p[E];(b[0]!==T[0]||b[1]!==T[1])&&y.push(T),b=T}return y}function s(p){return p.sort(function(y,b){return y[0]-b[0]||y[1]-b[1]})}function a(p,y){return Math.pow(y[0]-p[0],2)+Math.pow(y[1]-p[1],2)}function o(p,y,b){const E=[y[0]-p[0],y[1]-p[1]],T=[b[0]-p[0],b[1]-p[1]],S=a(p,y),k=a(p,b);return(E[0]*T[0]+E[1]*T[1])/Math.sqrt(S*k)}function l(p,y){for(let b=0;b<y.length-1;b++){const E=[y[b],y[b+1]];if(!(p[0][0]===E[0][0]&&p[0][1]===E[0][1]||p[0][0]===E[1][0]&&p[0][1]===E[1][1])&&r(p,E))return!0}return!1}function u(p){let y=1/0,b=1/0,E=-1/0,T=-1/0;for(let S=p.length-1;S>=0;S--)p[S][0]<y&&(y=p[S][0]),p[S][1]<b&&(b=p[S][1]),p[S][0]>E&&(E=p[S][0]),p[S][1]>T&&(T=p[S][1]);return[E-y,T-b]}function c(p){return[Math.min(p[0][0],p[1][0]),Math.min(p[0][1],p[1][1]),Math.max(p[0][0],p[1][0]),Math.max(p[0][1],p[1][1])]}function d(p,y,b){let E=null,T=g,S=g,k,A;for(let O=0;O<y.length;O++)k=o(p[0],p[1],y[O]),A=o(p[1],p[0],y[O]),k>T&&A>S&&!l([p[0],y[O]],b)&&!l([p[1],y[O]],b)&&(T=k,S=A,E=y[O]);return E}function h(p,y,b,E,T){let S=!1;for(let k=0;k<p.length-1;k++){const A=[p[k],p[k+1]],O=A[0][0]+","+A[0][1]+","+A[1][0]+","+A[1][1];if(a(A[0],A[1])<y||T.has(O))continue;let C=0,P=c(A),L,R,z;do P=E.extendBbox(P,C),L=P[2]-P[0],R=P[3]-P[1],z=d(A,E.rangePoints(P),p),C++;while(z===null&&(b[0]>L||b[1]>R));L>=b[0]&&R>=b[1]&&T.add(O),z!==null&&(p.splice(k+1,0,z),E.removePoint(z),S=!0)}return S?h(p,y,b,E,T):p}function f(p,y,b){let E=y||20;const T=i(s(t.toXy(p,b)));if(T.length<4){const L=T.concat([T[0]]);return b?t.fromXy(L,b):L}const S=u(T),k=[S[0]*v,S[1]*v],A=n(T),O=T.filter(function(L){return A.indexOf(L)<0}),C=Math.ceil(1/(T.length/(S[0]*S[1]))),P=h(A,Math.pow(E,2),k,e(O,C),new Set);return b?t.fromXy(P,b):P}const g=Math.cos(90/(180/Math.PI)),v=.6;return nh=f,nh}var VD=YD();const UD=Ou(VD);function HD(r,e,t){if(r.length===1)return XD(r[0],e,t);if(r.length===2)return p0(r,e,t);if(r.length===3){const[n,i,s]=qf(r);if(x1(n,i,s))return p0([n,s],e,t)}switch(t){case"smooth":return ZD(r,e);case"sharp":return KD(r,e);case"rounded":default:return qD(r,e)}}const XD=(r,e,t)=>{if(t==="sharp")return[["M",r[0]-e,r[1]-e],["L",r[0]+e,r[1]-e],["L",r[0]+e,r[1]+e],["L",r[0]-e,r[1]+e],["Z"]];const n=[e,e,0,0,0];return[["M",r[0],r[1]-e],["A",...n,r[0],r[1]+e],["A",...n,r[0],r[1]-e]]},p0=(r,e,t)=>{const n=[e,e,0,0,0],i=t==="sharp"?ze(r[0],Pi(ui(it(r[0],r[1])),e)):r[0],s=t==="sharp"?ze(r[1],Pi(ui(it(r[1],r[0])),e)):r[1],a=Pi(ui(Lu(it(i,s),!1)),e),o=Pi(a,-1),l=ze(i,a),u=ze(s,a),c=ze(s,o),d=ze(i,o);return t==="sharp"?[["M",l[0],l[1]],["L",u[0],u[1]],["L",c[0],c[1]],["L",d[0],d[1]],["Z"]]:[["M",l[0],l[1]],["L",u[0],u[1]],["A",...n,c[0],c[1]],["L",d[0],d[1]],["A",...n,l[0],l[1]]]},qD=(r,e)=>{const t=qf(r).map((o,l)=>{const u=(l-2+r.length)%r.length,c=(l-1+r.length)%r.length,d=(l+1)%r.length,h=r[u],f=r[c],g=r[d],v=it(h,f),p=it(f,o),y=it(o,g),b=(A,O)=>Hf(A,O,!0)<Math.PI,E=b(v,p),T=b(p,y),S=A=>Pi(ui(Lu(A,!1)),e),k=S(p);return[{p:Os(E?ze(f,S(v)):ze(f,k)),concave:E&&f},{p:Os(T?ze(o,S(y)):ze(o,k)),concave:T&&o}]}),n=[e,e,0,0,0],i=t.findIndex((o,l)=>!t[(l-1+t.length)%t.length][0].concave&&!t[(l-1+t.length)%t.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),s=t.slice(i).concat(t.slice(0,i));let a=[];return s.flatMap((o,l)=>{const u=[],c=s[t.length-1];return l===0&&u.push(["M",...c[1].p]),o[0].concave?a.push(o[0].p,o[1].p):u.push(["A",...n,...o[0].p]),o[1].concave?a.unshift(o[1].p):u.push(["L",...o[1].p]),a.length===3&&(u.pop(),u.push(["C",...a.flat()]),a=[]),u})},ZD=(r,e)=>{const t=qf(r).map((n,i)=>{const s=r[(i+1)%r.length];return{p:n,v:ui(it(s,n))}});return t.forEach((n,i)=>{const s=i>0?i-1:r.length-1,a=t[s].v,o=ui(ze(a,Pi(n.v,Hf(a,n.v,!0)<Math.PI?1:-1)));n.p=ze(n.p,Pi(o,e))}),C1(t.map(n=>n.p))},KD=(r,e)=>{const n=r.map((s,a)=>{const o=r[a===0?r.length-1:a-1],l=io(Pi(ui(Lu(it(o,s),!1)),e));return[ze(o,l),ze(s,l)]}).flat();return n.map((s,a)=>{if(a%2===0)return null;const o=[n[(a-1)%n.length],n[a%n.length]],l=[n[(a+1)%n.length],n[(a+2)%n.length]];return Xf(o,l,!0)}).filter(Boolean).map((s,a)=>[a===0?"M":"L",s[0],s[1]]).concat([["Z"]])};var QD=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class wc extends mn{constructor(e,t){super(e,Object.assign({},wc.defaultOptions,t)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new To({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const n=!Ct(this.optionsCache,this.options);this.shape.update(this.getHullStyle(n))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=n=>{this.shape&&this.options.members.includes(q(n.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(n=!1)=>{const{graph:i}=this.context,s=this.getMember();if(s.length===0)return"";const a=s.map(u=>i.getNodeData(u)),o=UD(a.map(Kt),this.options.concavity).slice(1).reverse(),l=o.flatMap(u=>a.filter(c=>Ct(Kt(c),u)).map(q));return Ct(l,this.hullMemberIds)&&!n?this.path:(this.hullMemberIds=l,this.path=HD(o,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(fe.AFTER_RENDER,this.drawHull),this.context.graph.on(fe.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(e){const t=this.options,{members:n,padding:i,corner:s}=t,a=QD(t,["members","padding","corner"]);return Object.assign(Object.assign({},a),{d:this.getHullPath(e)})}getPadding(){const{graph:e}=this.context;return this.hullMemberIds.reduce((n,i)=>{const{halfExtents:s}=e.getElementRenderBounds(i),a=Math.max(s[0],s[1]);return Math.max(n,a)},0)+this.options.padding}addMember(e){const t=Array.isArray(e)?e:[e];this.options.members=[...new Set([...this.options.members,...t])],this.shape.update({d:this.getHullPath()})}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),t.some(n=>this.hullMemberIds.includes(n))&&this.shape.update({d:this.getHullPath()})}updateMember(e){this.options.members=Ee(e)?e(this.options.members):e,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(fe.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}wc.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function Yb(r,e){e(r),r.children&&r.children.forEach(function(t){t&&Yb(t,e)})}function Co(r){xc(r,!0)}function Er(r){xc(r,!1)}function xc(r,e){var t=e?"visible":"hidden";Yb(r,function(n){n.attr("visibility",t)})}var JD=function(r){Ye(e,r);function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=r.apply(this,ke([],$(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(Ue.INSERTED,function(){Er(i)}),i}return e}(Jt);function Vb(r){var e=r.appendChild(new JD({class:"offscreen"}));return Er(e),e}function eI(r){for(var e=r;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}var gg=function(r){Ye(e,r);function e(t){t===void 0&&(t={});var n=t.style,i=Vt(t,["style"]);return r.call(this,ue({style:ue({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Vb(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(_s);function fa(r){return r*Math.PI/180}function Ub(r){return Number((r*180/Math.PI).toPrecision(5))}var _n=function(){function r(e,t,n,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=n,this.height=i}return Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},r.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},r}();function fr(r,e){return Ee(r)?r.apply(void 0,ke([],$(e),!1)):r}var kr=function(r,e){var t=function(i){return"".concat(e,"-").concat(i)},n=Object.fromEntries(Object.entries(r).map(function(i){var s=$(i,2),a=s[0],o=s[1],l=t(o);return[a,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(n,{prefix:t}),n},tI=5,Hb=function(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=tI),Object.entries(e).forEach(function(i){var s=$(i,2),a=s[0],o=s[1],l=r;Object.prototype.hasOwnProperty.call(e,a)&&(o?ua(o)?(ua(r[a])||(l[a]={}),t<n?Hb(r[a],o,t+1,n):l[a]=e[a]):nr(o)?(l[a]=[],l[a]=l[a].concat(o)):l[a]=o:l[a]=o)})},on=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)Hb(r,e[n]);return r},Xb=function(r){return r!==void 0&&r!=null&&!Number.isNaN(r)},Pl,nI=Sh(function(r,e){var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,s=e.fontStyle,a=e.fontVariant;return Pl||(Pl=ce.offscreenCanvasCreator.getOrCreateContext(void 0)),Pl.font=[s,a,i,"".concat(t,"px"),n].join(" "),Pl.measureText(r).width},function(r,e){return[r,Object.values(e||qb(r)).join()].join("")},4096),qb=function(r){var e=r.style.fontFamily||"sans-serif",t=r.style.fontWeight||"normal",n=r.style.fontStyle||"normal",i=r.style.fontVariant,s=r.style.fontSize;return s=typeof s=="object"?s.value:s,{fontSize:s,fontFamily:e,fontWeight:t,fontStyle:n,fontVariant:i}};function Zb(r){return r.nodeName==="text"?r:r.nodeName==="g"&&r.children.length===1&&r.children[0].nodeName==="text"?r.children[0]:null}function Kb(r,e){var t=Zb(r);t&&t.attr(e)}function ff(r,e,t){t===void 0&&(t="..."),Kb(r,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}function rI(r,e,t,n){t===void 0&&(t=2),n===void 0&&(n="top"),Kb(r,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:n})}function v0(r){var e=r.canvas,t=r.touches,n=r.offsetX,i=r.offsetY;if(e){var s=e.x,a=e.y;return[s,a]}if(t){var o=t[0],l=o.clientX,u=o.clientY;return[l,u]}return n&&i?[n,i]:[0,0]}function fi(r){return typeof r=="function"?r():Ke(r)||ye(r)?new gg({style:{text:String(r)}}):r}function iI(r,e){return r.reduce(function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t},{})}function tr(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=function(s){s.node().removeChildren()}),r?t(e):(n&&i(e),null)}function dn(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=!1),n&&r===e||i&&r===t?!0:r>e&&r<t}var sI=function(r,e){return function(t){return r*(1-t)+e*t}};function aI(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0;return function(i){var s=new Array(n),a=new Array(t),o=0;for(o=0;o<n;++o)s[o]=pg(r[o],e[o]);for(;o<t;++o)a[o]=e[o];for(o=0;o<n;++o)a[o]=s[o](i);return a}}function oI(r,e){r===void 0&&(r={}),e===void 0&&(e={});var t={},n={};return Object.entries(e).forEach(function(i){var s=$(i,2),a=s[0],o=s[1];a in r?t[a]=pg(r[a],o):n[a]=o}),function(i){return Object.entries(t).forEach(function(s){var a=$(s,2),o=a[0],l=a[1];return n[o]=l(i)}),n}}function pg(r,e){return typeof r=="number"&&typeof e=="number"?sI(r,e):Array.isArray(r)&&Array.isArray(e)?aI(r,e):typeof r=="object"&&typeof e=="object"?oI(r,e):function(t){return r}}function lI(r,e,t,n){if(!n)return r.attr("__keyframe_data__",t),null;var i=n.duration,s=i===void 0?0:i,a=pg(e,t),o=Math.ceil(+s/16),l=new Array(o).fill(0).map(function(u,c,d){return{__keyframe_data__:a(c/(d.length-1))}});return r.animate(l,ue({fill:"both"},n))}function si(r,e){return[r[0]*e,r[1]*e]}function Fa(r,e){return[r[0]+e[0],r[1]+e[1]]}function rh(r,e){return[r[0]-e[0],r[1]-e[1]]}function as(r,e){return[Math.min(r[0],e[0]),Math.min(r[1],e[1])]}function os(r,e){return[Math.max(r[0],e[0]),Math.max(r[1],e[1])]}function co(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2))}function Qb(r){if(r[0]===0&&r[1]===0)return[0,0];var e=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));return[r[0]/e,r[1]/e]}function uI(r,e){return e?[r[1],-r[0]]:[-r[1],r[0]]}function m0(r,e){return+r.toPrecision(e)}function y0(r,e){var t={},n=Array.isArray(e)?e:[e];for(var i in r)n.includes(i)||(t[i]=r[i]);return t}function cI(r,e,t,n){var i,s=[],a=!!n,o,l,u=[1/0,1/0],c=[-1/0,-1/0],d,h,f;if(a){i=$(n,2),u=i[0],c=i[1];for(var g=0,v=r.length;g<v;g+=1){var p=r[g];u=as(u,p),c=os(c,p)}}for(var g=0,y=r.length;g<y;g+=1){var p=r[g];if(g===0)f=p;else if(g===y-1)h=p,s.push(f),s.push(h);else{var b=[g?g-1:y-1,g-1][1];o=r[b],l=r[g+1];var E=[0,0];E=rh(l,o),E=si(E,e);var T=co(p,o),S=co(p,l),k=T+S;k!==0&&(T/=k,S/=k);var A=si(E,-T),O=si(E,S);h=Fa(p,A),d=Fa(p,O),d=as(d,os(l,p)),d=os(d,as(l,p)),A=rh(d,p),A=si(A,-T/S),h=Fa(p,A),h=as(h,os(o,p)),h=os(h,as(o,p)),O=rh(p,h),O=si(O,S/T),d=Fa(p,O),a&&(h=os(h,u),h=as(h,c),d=os(d,u),d=as(d,c)),s.push(f),s.push(h),f=d}}return s}function dI(r,e,t){t===void 0&&(t=[[0,0],[1,1]]);for(var n=!1,i=[],s=0,a=r.length;s<a;s+=2)i.push([r[s],r[s+1]]);for(var o=cI(i,.4,n,t),l=i.length,u=[],c,d,h,s=0;s<l-1;s+=1)c=o[s*2],d=o[s*2+1],h=i[s+1],u.push(["C",c[0],c[1],d[0],d[1],h[0],h[1]]);return u}var hI=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function fI(r){return hI.includes(r)}function b0(r){var e={};for(var t in r)fI(t)&&(e[t]=r[t]);return e}function gI(r,e){if(r.length<=e)return r;for(var t=Math.floor(r.length/e),n=[],i=0;i<r.length;i+=t)n.push(r[i]);return n}function vg(r,e,t){var n=r.getBBox(),i=n.width,s=n.height,a=e/Math.max(i,s);return r.style.transform="scale(".concat(a,")"),a}function pI(r,e){var t=new Map;return r.forEach(function(n){var i=e(n);t.has(i)||t.set(i,[]),t.get(i).push(n)}),t}function vI(r){throw new Error(r)}var mI=function(){function r(i,s,a,o,l,u,c){i===void 0&&(i=null),s===void 0&&(s=null),a===void 0&&(a=null),o===void 0&&(o=null),l===void 0&&(l=[null,null,null,null,null]),u===void 0&&(u=[]),c===void 0&&(c=[]),e.add(this),this._elements=Array.from(i),this._data=s,this._parent=a,this._document=o,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=u,this._facetElements=c}r.prototype.selectAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(s,null,this._elements[0],this._document)},r.prototype.selectFacetAll=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,s)},r.prototype.select=function(i){var s=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([s],null,s,this._document)},r.prototype.append=function(i){var s=this,a=typeof i=="function"?i:function(){return s.createElement(i)},o=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var u=this._data[l],c=$(Array.isArray(u)?u:[u,null],2),d=c[0],h=c[1],f=a(d,l);f.__data__=d,h!==null&&(f.__fromElements__=h),this._parent.appendChild(f),o.push(f)}return new t(o,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var g=this._elements[l],d=g.__data__,f=a(d,l);g.appendChild(f),o.push(f)}return new t(o,null,o[0],this._document)},r.prototype.maybeAppend=function(i,s){var a=Xc(this,e,"m",n).call(this,i[0]==="#"?i:"#".concat(i),s);return a.attr("id",i),a},r.prototype.maybeAppendByClassName=function(i,s){var a=i.toString(),o=Xc(this,e,"m",n).call(this,a[0]==="."?a:".".concat(a),s);return o.attr("className",a),o},r.prototype.maybeAppendByName=function(i,s){var a=Xc(this,e,"m",n).call(this,'[name="'.concat(i,'"]'),s);return a.attr("name",i),a},r.prototype.data=function(i,s,a){var o,l;s===void 0&&(s=function(P){return P}),a===void 0&&(a=function(){return null});for(var u=[],c=[],d=new Set(this._elements),h=[],f=new Set,g=new Map(this._elements.map(function(P,L){return[s(P.__data__,L),P]})),v=new Map(this._facetElements.map(function(P,L){return[s(P.__data__,L),P]})),p=pI(this._elements,function(P){return a(P.__data__)}),y=0;y<i.length;y++){var b=i[y],E=s(b,y),T=a(b,y);if(g.has(E)){var S=g.get(E);S.__data__=b,S.__facet__=!1,c.push(S),d.delete(S),g.delete(E)}else if(v.has(E)){var S=v.get(E);S.__data__=b,S.__facet__=!0,c.push(S),v.delete(E)}else if(p.has(E)){var k=p.get(E);h.push([b,k]);try{for(var A=(o=void 0,po(k)),O=A.next();!O.done;O=A.next()){var S=O.value;d.delete(S)}}catch(P){o={error:P}}finally{try{O&&!O.done&&(l=A.return)&&l.call(A)}finally{if(o)throw o.error}}p.delete(E)}else if(g.has(T)){var S=g.get(T);S.__toData__?S.__toData__.push(b):S.__toData__=[b],f.add(S),d.delete(S)}else u.push(b)}var C=[new t([],u,this._parent,this._document),new t(c,null,this._parent,this._document),new t(d,null,this._parent,this._document),new t([],h,this._parent,this._document),new t(f,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,C)},r.prototype.merge=function(i){var s=ke(ke([],$(this._elements),!1),$(i._elements),!1),a=ke(ke([],$(this._transitions),!1),$(i._transitions),!1);return new t(s,null,this._parent,this._document,void 0,a)},r.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var s=t.registry[i];return s?new s:vI("Unknown node type: ".concat(i))},r.prototype.join=function(i,s,a,o,l){i===void 0&&(i=function(g){return g}),s===void 0&&(s=function(g){return g}),a===void 0&&(a=function(g){return g.remove()}),o===void 0&&(o=function(g){return g}),l===void 0&&(l=function(g){return g.remove()});var u=i(this._enter),c=s(this._update),d=a(this._exit),h=o(this._merge),f=l(this._split);return c.merge(u).merge(d).merge(h).merge(f)},r.prototype.remove=function(){for(var i=function(o){var l=s._elements[o],u=s._transitions[o];u?u.then(function(){return l.remove()}):l.remove()},s=this,a=0;a<this._elements.length;a++)i(a);return new t([],null,this._parent,this._document,void 0,this._transitions)},r.prototype.each=function(i){for(var s=0;s<this._elements.length;s++){var a=this._elements[s],o=a.__data__;i.call(a,o,s)}return this},r.prototype.attr=function(i,s){var a=typeof s!="function"?function(){return s}:s;return this.each(function(o,l){s!==void 0&&(this[i]=a.call(this,o,l))})},r.prototype.style=function(i,s,a){a===void 0&&(a=!0);var o=typeof s!="function"||!a?function(){return s}:s;return this.each(function(l,u){s!==void 0&&(this.style[i]=o.call(this,l,u))})},r.prototype.styles=function(i,s){return i===void 0&&(i={}),s===void 0&&(s=!0),this.each(function(a,o){var l=this;Object.entries(i).forEach(function(u){var c=$(u,2),d=c[0],h=c[1],f=typeof h!="function"||!s?function(){return h}:h;h!==void 0&&l.attr(d,f.call(l,a,o))})})},r.prototype.update=function(i,s){s===void 0&&(s=!0);var a=typeof i!="function"||!s?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(a.call(this,o,l))})},r.prototype.maybeUpdate=function(i,s){s===void 0&&(s=!0);var a=typeof i!="function"||!s?function(){return i}:i;return this.each(function(o,l){i&&this.update&&this.update(a.call(this,o,l))})},r.prototype.transition=function(i){var s=this._transitions;return this.each(function(a,o){s[o]=i.call(this,a,o)})},r.prototype.on=function(i,s){return this.each(function(){this.addEventListener(i,s)}),this},r.prototype.call=function(i){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];return i.call.apply(i,ke([this._parent,this],$(s),!1)),this},r.prototype.node=function(){return this._elements[0]},r.prototype.nodes=function(){return this._elements},r.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},r.prototype.parent=function(){return this._parent};var e,t,n;return t=r,e=new WeakSet,n=function(s,a){var o=this._elements[0],l=o.querySelector(s);if(l)return new t([l],null,this._parent,this._document);var u=typeof a=="string"?this.createElement(a):a();return o.appendChild(u),new t([u],null,this._parent,this._document)},r.registry={g:Jt,rect:pn,circle:pi,path:Kn,text:gg,ellipse:bo,image:xo,line:Ss,polygon:Ps,polyline:Cu,html:wo},r}();function Me(r){return new mI([r],null,r,r.ownerDocument)}function yI(r,e,t){return r.querySelector(e)?Me(r).select(e):Me(r).append(t)}function vn(r){if(ye(r))return[r,r,r,r];if(nr(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function w0(r){var e=r.getLocalBounds(),t=e.min,n=e.max,i=$([t,n],2),s=$(i[0],2),a=s[0],o=s[1],l=$(i[1],2),u=l[0],c=l[1];return{x:a,y:o,width:u-a,height:c-o,left:a,bottom:c,top:o,right:u}}function bI(r,e){var t=$(r,2),n=t[0],i=t[1],s=$(e,2),a=s[0],o=s[1];return n!==a&&i===o}function wI(r,e){var t,n,i=e.attributes;try{for(var s=po(Object.entries(i)),a=s.next();!a.done;a=s.next()){var o=$(a.value,2),l=o[0],u=o[1];l!=="id"&&l!=="className"&&r.attr(l,u)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}function mg(r){return r.toString().charAt(0).toUpperCase()+r.toString().slice(1)}function xI(r){return r.toString().charAt(0).toLowerCase()+r.toString().slice(1)}function EI(r,e){return"".concat(e).concat(mg(r))}function x0(r,e,t){var n;t===void 0&&(t=!0);var i=e||((n=r.match(/^([a-z][a-z0-9]+)/))===null||n===void 0?void 0:n[0])||"",s=r.replace(new RegExp("^(".concat(i,")")),"");return t?xI(s):s}function MI(r,e){Object.entries(e).forEach(function(t){var n=$(t,2),i=n[0],s=n[1];ke([r],$(r.querySelectorAll(i)),!1).filter(function(a){return a.matches(i)}).forEach(function(a){if(a){var o=a;o.style.cssText+=Object.entries(s).reduce(function(l,u){return"".concat(l).concat(u.join(":"),";")},"")}})})}var _l=function(r,e){if(!(r!=null&&r.startsWith(e)))return!1;var t=r[e.length];return t>="A"&&t<="Z"};function Re(r,e,t){t===void 0&&(t=!1);var n={};return Object.entries(r).forEach(function(i){var s=$(i,2),a=s[0],o=s[1];if(!(a==="className"||a==="class")){if(_l(a,"show")&&_l(x0(a,"show"),e)!==t)a===EI(e,"show")?n[a]=o:n[a.replace(new RegExp(mg(e)),"")]=o;else if(!_l(a,"show")&&_l(a,e)!==t){var l=x0(a,e);l==="filter"&&typeof o=="function"||(n[l]=o)}}}),n}function Ks(r,e){return Object.entries(r).reduce(function(t,n){var i=$(n,2),s=i[0],a=i[1];return s.startsWith("show")?t["show".concat(e).concat(s.slice(4))]=a:t["".concat(e).concat(mg(s))]=a,t},{})}function gi(r,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],n={},i={};return Object.entries(r).forEach(function(s){var a=$(s,2),o=a[0],l=a[1];e.includes(o)||(t.indexOf(o)!==-1?i[o]=l:n[o]=l)}),[n,i]}function jn(r,e){var t={YYYY:r.getFullYear(),MM:r.getMonth()+1,DD:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds()},n=e;return Object.keys(t).forEach(function(i){var s=t[i];n=n.replace(i,i==="YYYY"?"".concat(s):"".concat(s).padStart(2,"0"))}),n}function SI(r,e,t){var n=r.getBBox(),i=n.width,s=n.height,a=$([e,t].map(function(u,c){var d;return u.includes("%")?parseFloat(((d=u.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||d===void 0?void 0:d[0])||"0")/100*(c===0?i:s):u}),2),o=a[0],l=a[1];return[o,l]}function Jb(r,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,n=e.replace(t,function(i,s,a){return"translate(".concat(SI(r,s,a),")")});r.attr("transform",n)}catch{}}function TI(r){var e;return((e=r[0])===null||e===void 0?void 0:e.map(function(t,n){return r.map(function(i){return i[n]})}))||[]}var E0=function(r,e){if(e==null){r.innerHTML="";return}r.replaceChildren?Array.isArray(e)?r.replaceChildren.apply(r,ke([],$(e),!1)):r.replaceChildren(e):(r.innerHTML="",Array.isArray(e)?e.forEach(function(t){return r.appendChild(t)}):r.appendChild(e))};function OI(){xc(this,this.attributes.visibility!=="hidden")}var Lt=function(r){Ye(e,r);function e(t,n){n===void 0&&(n={});var i=r.call(this,on({},{style:n},t))||this;return i.initialized=!1,i._defaultOptions=n,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Vb(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&OI.call(this)},e.prototype.update=function(t,n){var i;return this.attr(on({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,n)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,n){},e.prototype.getSubShapeStyle=function(t){t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex;var n=Vt(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return n},e}(Bf),ew=function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e],["Z"]]},kI=ew,NI=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},AI=function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},CI=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+n],["L",r,e-n],["L",r+t,e+n],["Z"]]},PI=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-n],["L",r+t,e-n],["L",r,e+n],["Z"]]},_I=function(r,e,t){var n=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+n,e-t/2],["L",r+n,e+t/2],["L",r,e+t],["L",r-n,e+t/2],["L",r-n,e-t/2],["Z"]]},LI=function(r,e,t){var n=t-1.5;return[["M",r-t,e-n],["L",r+t,e+n],["L",r+t,e-n],["L",r-t,e+n],["Z"]]},tw=function(r,e,t){return[["M",r,e+t],["L",r,e-t]]},DI=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},II=function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},RI=function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},jI=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},nw=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},BI=nw,zI=function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},FI=function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},$I=function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},WI=function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]};function GI(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}var YI=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e],["L",r-t,e+t],["Z"]]};function VI(r){var e="default";if(Bt(r)&&r instanceof Image)e="image";else if(Ee(r))e="symbol";else if(Ke(r)){var t=new RegExp("data:(image|text)");r.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(r)?e="url":e="symbol"}return e}function UI(r){var e=VI(r);return["base64","url","image"].includes(e)?"image":r&&e==="symbol"?"path":null}var at=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,s=i===void 0?0:i,a=t.y,o=a===void 0?0:a,l=this.getSubShapeStyle(t),u=l.symbol,c=l.size,d=c===void 0?16:c,h=Vt(l,["symbol","size"]),f=UI(u);tr(!!f,Me(n),function(g){g.maybeAppendByClassName("marker",f).attr("className","marker ".concat(f,"-marker")).call(function(v){if(f==="image"){var p=d*2;v.styles({img:u,width:p,height:p,x:s-d,y:o-d})}else{var p=d/2,y=Ee(u)?u:e.getSymbol(u);v.styles(ue({d:y==null?void 0:y(s,o,p)},h))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Lt);at.registerSymbol("cross",DI);at.registerSymbol("hyphen",jI);at.registerSymbol("line",tw);at.registerSymbol("plus",RI);at.registerSymbol("tick",II);at.registerSymbol("circle",ew);at.registerSymbol("point",kI);at.registerSymbol("bowtie",LI);at.registerSymbol("hexagon",_I);at.registerSymbol("square",NI);at.registerSymbol("diamond",AI);at.registerSymbol("triangle",CI);at.registerSymbol("triangle-down",PI);at.registerSymbol("line",tw);at.registerSymbol("dot",nw);at.registerSymbol("dash",BI);at.registerSymbol("smooth",zI);at.registerSymbol("hv",FI);at.registerSymbol("vh",$I);at.registerSymbol("hvh",WI);at.registerSymbol("vhv",GI);function wu(r,...e){return e.reduce((t,n)=>i=>t(n(i)),r)}function gf(r,e){return e-r?t=>(t-r)/(e-r):t=>.5}function HI(r,e){const t=e<r?e:r,n=r>e?r:e;return i=>Math.min(Math.max(t,i),n)}function XI(r,e,t,n,i){let s=t,a=n||r.length;const o=l=>l;for(;s<a;){const l=Math.floor((s+a)/2);o(r[l])>e?a=l:s=l+1}return s}const M0=Math.sqrt(50),S0=Math.sqrt(10),T0=Math.sqrt(2);function Wl(r,e,t){const n=(e-r)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),s=n/10**i;return i>=0?(s>=M0?10:s>=S0?5:s>=T0?2:1)*10**i:-(10**-i)/(s>=M0?10:s>=S0?5:s>=T0?2:1)}const qI=(r,e,t=5)=>{const n=[r,e];let i=0,s=n.length-1,a=n[i],o=n[s],l;return o<a&&([a,o]=[o,a],[i,s]=[s,i]),l=Wl(a,o,t),l>0?(a=Math.floor(a/l)*l,o=Math.ceil(o/l)*l,l=Wl(a,o,t)):l<0&&(a=Math.ceil(a*l)/l,o=Math.floor(o*l)/l,l=Wl(a,o,t)),l>0?(n[i]=Math.floor(a/l)*l,n[s]=Math.ceil(o/l)*l):l<0&&(n[i]=Math.ceil(a*l)/l,n[s]=Math.floor(o*l)/l),n};function O0(r){return!Ie(r)&&!g2(r)&&!Number.isNaN(r)}var ih={exports:{}},sh,k0;function ZI(){return k0||(k0=1,sh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),sh}var ah={exports:{}},oh,N0;function KI(){return N0||(N0=1,oh=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),oh}var A0;function QI(){if(A0)return ah.exports;A0=1;var r=KI(),e=Array.prototype.concat,t=Array.prototype.slice,n=ah.exports=function(s){for(var a=[],o=0,l=s.length;o<l;o++){var u=s[o];r(u)?a=e.call(a,t.call(u)):a.push(u)}return a};return n.wrap=function(i){return function(){return i(n(arguments))}},ah.exports}var C0;function JI(){if(C0)return ih.exports;C0=1;var r=ZI(),e=QI(),t=Object.hasOwnProperty,n=Object.create(null);for(var i in r)t.call(r,i)&&(n[r[i]]=i);var s=ih.exports={to:{},get:{}};s.get=function(l){var u=l.substring(0,3).toLowerCase(),c,d;switch(u){case"hsl":c=s.get.hsl(l),d="hsl";break;case"hwb":c=s.get.hwb(l),d="hwb";break;default:c=s.get.rgb(l),d="rgb";break}return c?{model:d,value:c}:null},s.get.rgb=function(l){if(!l)return null;var u=/^#([a-f0-9]{3,4})$/i,c=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,d=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,h=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,g=[0,0,0,1],v,p,y;if(v=l.match(c)){for(y=v[2],v=v[1],p=0;p<3;p++){var b=p*2;g[p]=parseInt(v.slice(b,b+2),16)}y&&(g[3]=parseInt(y,16)/255)}else if(v=l.match(u)){for(v=v[1],y=v[3],p=0;p<3;p++)g[p]=parseInt(v[p]+v[p],16);y&&(g[3]=parseInt(y+y,16)/255)}else if(v=l.match(d)){for(p=0;p<3;p++)g[p]=parseInt(v[p+1],0);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else if(v=l.match(h)){for(p=0;p<3;p++)g[p]=Math.round(parseFloat(v[p+1])*2.55);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else return(v=l.match(f))?v[1]==="transparent"?[0,0,0,0]:t.call(r,v[1])?(g=r[v[1]],g[3]=1,g):null:null;for(p=0;p<3;p++)g[p]=a(g[p],0,255);return g[3]=a(g[3],0,1),g},s.get.hsl=function(l){if(!l)return null;var u=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(u);if(c){var d=parseFloat(c[4]),h=(parseFloat(c[1])%360+360)%360,f=a(parseFloat(c[2]),0,100),g=a(parseFloat(c[3]),0,100),v=a(isNaN(d)?1:d,0,1);return[h,f,g,v]}return null},s.get.hwb=function(l){if(!l)return null;var u=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=l.match(u);if(c){var d=parseFloat(c[4]),h=(parseFloat(c[1])%360+360)%360,f=a(parseFloat(c[2]),0,100),g=a(parseFloat(c[3]),0,100),v=a(isNaN(d)?1:d,0,1);return[h,f,g,v]}return null},s.to.hex=function(){var l=e(arguments);return"#"+o(l[0])+o(l[1])+o(l[2])+(l[3]<1?o(Math.round(l[3]*255)):"")},s.to.rgb=function(){var l=e(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},s.to.rgb.percent=function(){var l=e(arguments),u=Math.round(l[0]/255*100),c=Math.round(l[1]/255*100),d=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+u+"%, "+c+"%, "+d+"%)":"rgba("+u+"%, "+c+"%, "+d+"%, "+l[3]+")"},s.to.hsl=function(){var l=e(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},s.to.hwb=function(){var l=e(arguments),u="";return l.length>=4&&l[3]!==1&&(u=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+u+")"},s.to.keyword=function(l){return n[l.slice(0,3)]};function a(l,u,c){return Math.min(Math.max(u,l),c)}function o(l){var u=Math.round(l).toString(16).toUpperCase();return u.length<2?"0"+u:u}return ih.exports}var eR=JI();const tR=Ou(eR);function lh(r,e,t){let n=t;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*(2/3-n)*6:r}function nR(r){const e=r[0]/360,t=r[1]/100,n=r[2]/100,i=r[3];if(t===0)return[n*255,n*255,n*255,i];const s=n<.5?n*(1+t):n+t-n*t,a=2*n-s,o=lh(a,s,e+1/3),l=lh(a,s,e),u=lh(a,s,e-1/3);return[o*255,l*255,u*255,i]}function P0(r){const e=tR.get(r);if(!e)return null;const{model:t,value:n}=e;return t==="rgb"?n:t==="hsl"?nR(n):null}const xu=(r,e)=>t=>r*(1-t)+e*t,rR=(r,e)=>{const t=P0(r),n=P0(e);return t===null||n===null?t?()=>r:()=>e:i=>{const s=new Array(4);for(let c=0;c<4;c+=1){const d=t[c],h=n[c];s[c]=d*(1-i)+h*i}const[a,o,l,u]=s;return`rgba(${Math.round(a)}, ${Math.round(o)}, ${Math.round(l)}, ${u})`}},iR=(r,e)=>typeof r=="number"&&typeof e=="number"?xu(r,e):typeof r=="string"&&typeof e=="string"?rR(r,e):()=>r,sR=(r,e)=>{const t=xu(r,e);return n=>Math.round(t(n))};function _0({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):t}function aR({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}function oR({map:r,initKey:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}function lR(r){return typeof r=="object"?r.valueOf():r}class L0 extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=lR,e!==null)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(_0({map:this.map,initKey:this.initKey},e))}has(e){return super.has(_0({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(aR({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete(oR({map:this.map,initKey:this.initKey},e))}}class rw{constructor(e){this.options=Ln({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Ln({},this.options,e),this.rescale(e)}rescale(e){}}const yg=Symbol("defaultUnknown");function D0(r,e,t){for(let n=0;n<e.length;n+=1)r.has(e[n])||r.set(t(e[n]),n)}function I0(r){const{value:e,from:t,to:n,mapper:i,notFoundReturn:s}=r;let a=i.get(e);if(a===void 0){if(s!==yg)return s;a=t.push(e)-1,i.set(e,a)}return n[a%n.length]}function R0(r){return r instanceof Date?e=>`${e}`:typeof r=="object"?e=>JSON.stringify(e):e=>e}class bg extends rw{getDefaultOptions(){return{domain:[],range:[],unknown:yg}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&D0(this.domainIndexMap,this.getDomain(),this.domainKey),I0({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&D0(this.rangeIndexMap,this.getRange(),this.rangeKey),I0({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[n]=this.options.range;if(this.domainKey=R0(t),this.rangeKey=R0(n),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new bg(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function uR(r){const e=Math.min(...r);return r.map(t=>t/e)}function cR(r,e){const t=r.length,n=e-t;return n>0?[...r,...new Array(n).fill(1)]:n<0?r.slice(0,e):r}function dR(r){return Math.round(r*1e12)/1e12}function hR(r){const{domain:e,range:t,paddingOuter:n,paddingInner:i,flex:s,round:a,align:o}=r,l=e.length,u=cR(s,l),[c,d]=t,h=d-c,f=2/l*n+1-1/l*i,g=h/f,v=g*i/l,p=g-l*v,y=uR(u),b=y.reduce((R,z)=>R+z),E=p/b,T=new L0(e.map((R,z)=>{const Y=y[z]*E;return[R,a?Math.floor(Y):Y]})),S=new L0(e.map((R,z)=>{const U=y[z]*E+v;return[R,a?Math.floor(U):U]})),k=Array.from(S.values()).reduce((R,z)=>R+z),O=(h-(k-k/l*i))*o,C=c+O;let P=a?Math.round(C):C;const L=new Array(l);for(let R=0;R<l;R+=1){L[R]=dR(P);const z=e[R];P+=S.get(z)}return{valueBandWidth:T,valueStep:S,adjustedRange:L}}function fR(r){var e;const{domain:t}=r,n=t.length;if(n===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=r.flex)===null||e===void 0)&&e.length))return hR(r);const{range:s,paddingOuter:a,paddingInner:o,round:l,align:u}=r;let c,d,h=s[0];const g=s[1]-h,v=a*2,p=n-o;c=g/Math.max(1,v+p),l&&(c=Math.floor(c)),h+=(g-c*(n-o))*u,d=c*(1-o),l&&(h=Math.round(h),d=Math.round(d));const y=new Array(n).fill(0).map((b,E)=>h+E*c);return{valueStep:c,valueBandWidth:d,adjustedRange:y}}class wg extends bg{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:yg,flex:[]}}constructor(e){super(e)}clone(){return new wg(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:n,round:i,flex:s}=this.options,{adjustedRange:a,valueBandWidth:o,valueStep:l}=fR({align:e,range:n,round:i,flex:s,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=l,this.valueBandWidth=o,this.adjustedRange=a}}const gR=(r,e,t)=>{let n,i,s=r,a=e;if(s===a&&t>0)return[s];let o=Wl(s,a,t);if(o===0||!Number.isFinite(o))return[];if(o>0){s=Math.ceil(s/o),a=Math.floor(a/o),i=new Array(n=Math.ceil(a-s+1));for(let l=0;l<n;l+=1)i[l]=(s+l)*o}else{o=-o,s=Math.ceil(s*o),a=Math.floor(a*o),i=new Array(n=Math.ceil(a-s+1));for(let l=0;l<n;l+=1)i[l]=(s+l)/o}return i},pR=(r,e,t)=>{const[n,i]=r,[s,a]=e;let o,l;return n<i?(o=gf(n,i),l=t(s,a)):(o=gf(i,n),l=t(a,s)),wu(l,o)},vR=(r,e,t)=>{const n=Math.min(r.length,e.length)-1,i=new Array(n),s=new Array(n),a=r[0]>r[n],o=a?[...r].reverse():r,l=a?[...e].reverse():e;for(let u=0;u<n;u+=1)i[u]=gf(o[u],o[u+1]),s[u]=t(l[u],l[u+1]);return u=>{const c=XI(r,u,1,n)-1,d=i[c],h=s[c];return wu(h,d)(u)}},j0=(r,e,t,n)=>(Math.min(r.length,e.length)>2?vR:pR)(r,e,n?sR:t);class mR extends rw{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:xu,tickCount:5}}map(e){return O0(e)?this.output(e):this.options.unknown}invert(e){return O0(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,n,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,n,...i)}getTicks(){const{tickMethod:e}=this.options,[t,n,i,...s]=this.getTickMethodOptions();return e(t,n,i,...s)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,n=e[0],i=e[e.length-1];return[n,i,t]}chooseNice(){return qI}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:n}=this.options,i=this.options.domain.map(e),s=Math.min(i.length,n.length);return t?HI(i[0],i[s-1]):Th}composeOutput(e,t){const{domain:n,range:i,round:s,interpolate:a}=this.options,o=j0(n.map(e),i,a,s);this.output=wu(o,t,e)}composeInput(e,t,n){const{domain:i,range:s}=this.options,a=j0(s,i.map(e),xu);this.input=wu(t,n,a)}}class Ka extends mR{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:iR,tickMethod:gR,tickCount:5}}chooseTransforms(){return[Th,Th]}clone(){return new Ka(this.options)}}var yR=function(r){Ye(e,r);function e(t){var n=this,i=t.style,s=Vt(t,["style"]);return n=r.call(this,Ln({},{type:"column"},ue({style:i},s)))||this,n.columnsGroup=new Jt({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.columns,i=t.x,s=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(s,")"),Me(this.columnsGroup).selectAll(".column").data(n.flat()).join(function(a){return a.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(a){return a.each(function(o){this.attr(o)})},function(a){return a.remove()})},e.prototype.update=function(t){this.attr(on({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(gt),bR=function(r){Ye(e,r);function e(t){var n=this,i=t.style,s=Vt(t,["style"]);return n=r.call(this,Ln({},{type:"lines"},ue({style:i},s)))||this,n.linesGroup=n.appendChild(new Jt),n.areasGroup=n.appendChild(new Jt),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.lines,i=t.areas,s=t.x,a=t.y;this.style.transform="translate(".concat(s,", ").concat(a,")"),n&&this.renderLines(n),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(on({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Me(this.linesGroup).selectAll(".line").data(t).join(function(n){return n.append("path").attr("className","line").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.attr(i)})},function(n){return n.remove()})},e.prototype.renderAreas=function(t){Me(this.linesGroup).selectAll(".area").data(t).join(function(n){return n.append("path").attr("className","area").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.style(i)})},function(n){return n.remove()})},e}(gt);function wR(r,e){var t,n=e.x,i=e.y,s=$(i.getOptions().range||[0,0],2),a=s[0],o=s[1];return o>a&&(t=$([a,o],2),o=t[0],a=t[1]),r.map(function(l){var u=l.map(function(c,d){return[n.map(d),At(i.map(c),o,a)]});return u})}function ho(r,e){e===void 0&&(e=!1);var t=e?r.length-1:0,n=r.map(function(i,s){return ke([s===t?"M":"L"],$(i),!1)});return e?n.reverse():n}function Eu(r,e){if(e===void 0&&(e=!1),r.length<=2)return ho(r);for(var t=[],n=r.length,i=0;i<n;i+=1){var s=e?r[n-i-1]:r[i];Ct(s,t.slice(-2))||t.push.apply(t,ke([],$(s),!1))}var a=dI(t);return e?a.unshift(ke(["M"],$(r[n-1]),!1)):a.unshift(ke(["M"],$(r[0]),!1)),a}function xg(r,e,t){var n=Gi(r);return n.push(["L",e,t],["L",0,t],["Z"]),n}function xR(r,e,t,n){return r.map(function(i){return xg(e?Eu(i):ho(i),t,n)})}function ER(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var s=r[i],a=ho(s),o=void 0;if(i===0)o=xg(a,e,t);else{var l=r[i-1],u=ho(l,!0);u[0][0]="L",o=ke(ke(ke([],$(a),!1),$(u),!1),[["Z"]],!1)}n.push(o)}return n}function MR(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var s=r[i],a=Eu(s),o=void 0;if(i===0)o=xg(a,e,t);else{var l=r[i-1],u=Eu(l,!0),c=s[0];u[0][0]="L",o=ke(ke(ke([],$(a),!1),$(u),!1),[ke(["M"],$(c),!1),["Z"]],!1)}n.push(o)}return n}function B0(r){return r.length===0?[0,0]:[Zl(l2(r,function(e){return Zl(e)||0})),ql(o2(r,function(e){return ql(e)||0}))]}function z0(r){for(var e=Gi(r),t=e[0].length,n=$([Array(t).fill(0),Array(t).fill(0)],2),i=n[0],s=n[1],a=0;a<e.length;a+=1)for(var o=e[a],l=0;l<t;l+=1)o[l]>=0?(o[l]+=i[l],i[l]=o[l]):(o[l]+=s[l],s[l]=o[l]);return e}var SR=function(r){Ye(e,r);function e(t){return r.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var n=Gi(t);return ye(n[0])?[n]:n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?z0(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,n=$(t.getOptions().domain||[0,0],2),i=n[0],s=n[1];return s<0?t.map(s):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,n=t.width,i=t.height;return{width:n,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,n=this.attributes,i=n.type,s=n.isStack,a=n.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=Re(this.attributes,"area"),l=Re(this.attributes,"line"),u=this.containerShape.width,c=this.data;if(c[0].length===0)return{lines:[],areas:[]};var d=this.scales,h=d.x,f=d.y,g=wR(c,{x:h,y:f}),v=[];if(o){var p=this.baseline;s?v=a?MR(g,u,p):ER(g,u,p):v=xR(g,a,u,p)}return{lines:g.map(function(y,b){return ue({stroke:t.getColor(b),d:a?Eu(y):ho(y)},l)}),areas:v.map(function(y,b){return ue({d:y,fill:t.getColor(b)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,n=Re(this.attributes,"column"),i=this.attributes,s=i.isStack,a=i.type,o=i.scale;if(a!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,u=this.rawData;if(!u)return{columns:[]};s&&(u=z0(u));var c=this.createScales(u),d=c.x,h=c.y,f=$(B0(u),2),g=f[0],v=f[1],p=new Ka({domain:[0,v-(g>0?0:g)],range:[0,l*o]}),y=d.getBandWidth(),b=this.rawData;return{columns:u.map(function(E,T){return E.map(function(S,k){var A=y/u.length,O=function(){return{x:d.map(k)+A*T,y:S>=0?h.map(S):h.map(0),width:A,height:p.map(Math.abs(S))}},C=function(){return{x:d.map(k),y:h.map(S),width:y,height:p.map(b[T][k])}};return ue(ue({fill:t.getColor(T)},n),s?C():O())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){yI(n,".container","rect").attr("className","container").node();var i=t.type,s=t.x,a=t.y,o="spark".concat(i),l=ue({x:s,y:a},i==="line"?this.linesStyle:this.columnsStyle);Me(n).selectAll(".spark").data([i]).join(function(u){return u.append(function(c){return c==="line"?new bR({className:o,style:l}):new yR({className:o,style:l})}).attr("className","spark ".concat(o))},function(u){return u.update(l)},function(u){return u.remove()})},e.prototype.getColor=function(t){var n=this.attributes.color;return nr(n)?n[t%n.length]:Ee(n)?n.call(null,t):n},e.prototype.createScales=function(t){var n,i,s=this.attributes,a=s.type,o=s.scale,l=s.range,u=l===void 0?[]:l,c=s.spacing,d=this.containerShape,h=d.width,f=d.height,g=$(B0(t),2),v=g[0],p=g[1],y=new Ka({domain:[(n=u[0])!==null&&n!==void 0?n:v,(i=u[1])!==null&&i!==void 0?i:p],range:[f,f*(1-o)]});return a==="line"?{type:a,x:new Ka({domain:[0,t[0].length-1],range:[0,h]}),y}:{type:a,x:new wg({domain:t[0].map(function(b,E){return E}),range:[0,h],paddingInner:c,paddingOuter:c/2,align:.5}),y}},e.tag="sparkline",e}(Lt);function TR(r){return typeof r=="boolean"?!1:"enter"in r&&"update"in r&&"exit"in r}function F0(r){if(!r)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(r).filter(function(n){var i=$(n,1),s=i[0];return!e.includes(s)}));return Object.fromEntries(e.map(function(n){return TR(r)?r[n]===!1?[n,!1]:[n,ue(ue({},r[n]),t)]:[n,t]}))}function Ea(r,e){r?r.finished.then(e):e()}function OR(r,e){r.length===0?e():Promise.all(r.map(function(t){return t==null?void 0:t.finished})).then(e)}function iw(r,e){"update"in r?r.update(e):r.attr(e)}function sw(r,e,t){if(e.length===0)return null;if(!t){var n=e.slice(-1)[0];return iw(r,{style:n}),null}return r.animate(e,t)}function kR(r,e){return!(r.nodeName!=="text"||e.nodeName!=="text"||r.attributes.text!==e.attributes.text)}function NR(r,e,t,n){if(n===void 0&&(n="destroy"),kR(r,e))return r.remove(),[null];var i=function(){n==="destroy"?r.destroy():n==="hide"&&Er(r),e.isVisible()&&Co(e)};if(!t)return i(),[null];var s=t.duration,a=s===void 0?0:s,o=t.delay,l=o===void 0?0:o,u=Math.ceil(+a/2),c=+a/4,d=$(r.getGeometryBounds().center,2),h=d[0],f=d[1],g=$(e.getGeometryBounds().center,2),v=g[0],p=g[1],y=$([(h+v)/2-h,(f+p)/2-f],2),b=y[0],E=y[1],T=r.style.opacity,S=T===void 0?1:T,k=e.style.opacity,A=k===void 0?1:k,O=r.style.transform||"",C=e.style.transform||"",P=r.animate([{opacity:S,transform:"translate(0, 0) ".concat(O)},{opacity:0,transform:"translate(".concat(b,", ").concat(E,") ").concat(O)}],ue(ue({fill:"both"},t),{duration:l+u+c})),L=e.animate([{opacity:0,transform:"translate(".concat(-b,", ").concat(-E,") ").concat(C),offset:.01},{opacity:A,transform:"translate(0, 0) ".concat(C)}],ue(ue({fill:"both"},t),{duration:u+c,delay:l+u-c}));return Ea(L,i),[P,L]}function Mr(r,e,t){var n={},i={};return Object.entries(e).forEach(function(s){var a=$(s,2),o=a[0],l=a[1];if(!Ae(l)){var u=r.style[o]||r.parsedStyle[o]||0;u!==l&&(n[o]=u,i[o]=l)}}),t?sw(r,[n,i],ue({fill:"both"},t)):(iw(r,i),null)}function Ec(r,e){return r.style.opacity||(r.style.opacity=1),Mr(r,{opacity:0},e)}var aw={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},ow={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},lw={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Lr=kr({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),ki=kr({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),AR=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,s=t.y,a=t.size,o=a===void 0?10:a,l=t.radius,u=l===void 0?o/4:l,c=t.orientation,d=Vt(t,["x","y","size","radius","orientation"]),h=o,f=h*2.4,g=Me(n).maybeAppendByClassName(ki.iconRect,"rect").styles(ue(ue({},d),{width:h,height:f,radius:u,x:i-h/2,y:s-f/2,transformOrigin:"center"})),v=i+1/3*h-h/2,p=i+2/3*h-h/2,y=s+1/4*f-f/2,b=s+3/4*f-f/2;g.maybeAppendByClassName("".concat(ki.iconLine,"-1"),"line").styles(ue({x1:v,x2:v,y1:y,y2:b},d)),g.maybeAppendByClassName("".concat(ki.iconLine,"-2"),"line").styles(ue({x1:p,x2:p,y1:y,y2:b},d)),c==="vertical"&&(g.node().style.transform="rotate(90)")},e}(Lt),CR=function(r){Ye(e,r);function e(t){return r.call(this,t,lw)||this}return e.prototype.renderLabel=function(t){var n=this,i=this.attributes,s=i.x,a=i.y,o=i.showLabel,l=Re(this.attributes,"label"),u=l.x,c=u===void 0?0:u,d=l.y,h=d===void 0?0:d,f=l.transform,g=l.transformOrigin,v=Vt(l,["x","y","transform","transformOrigin"]),p=$(gi(v,[]),2),y=p[0],b=p[1],E=Me(t).maybeAppendByClassName(ki.labelGroup,"g").styles(b),T=ue(ue({},ow),y),S=T.text,k=Vt(T,["text"]);tr(!!o,E,function(A){n.label=A.maybeAppendByClassName(ki.label,"text").styles(ue(ue({},k),{x:s+c,y:a+h,transform:f,transformOrigin:g,text:"".concat(S)})),n.label.on("mousedown",function(O){O.stopPropagation()}),n.label.on("touchstart",function(O){O.stopPropagation()})})},e.prototype.renderIcon=function(t){var n=this.attributes,i=n.x,s=n.y,a=n.orientation,o=n.type,l=ue(ue({x:i,y:s,orientation:a},aw),Re(this.attributes,"icon")),u=this.attributes.iconShape,c=u===void 0?function(){return new AR({style:l})}:u,d=Me(t).maybeAppendByClassName(ki.iconGroup,"g");d.selectAll(ki.icon.class).data([c]).join(function(h){return h.append(typeof c=="string"?c:function(){return c(o)}).attr("className",ki.icon.name)},function(h){return h.update(l)},function(h){return h.remove()})},e.prototype.render=function(t,n){this.renderIcon(n),this.renderLabel(n)},e}(Lt),PR=function(r){Ye(e,r);function e(t){var n=r.call(this,t,ue(ue(ue({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Ks(lw,"handle")),Ks(aw,"handleIcon")),Ks(ow,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(i){return function(s){s.stopPropagation(),n.target=i,n.prevPos=n.getOrientVal(v0(s));var a=n.availableSpace,o=a.x,l=a.y,u=n.getBBox(),c=u.x,d=u.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([o,l])-n.getOrientVal([+c,+d])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(i){var s=n.attributes,a=s.slidable,o=s.brushable,l=s.type;i.stopPropagation();var u=n.getOrientVal(v0(i)),c=u-n.prevPos;if(c){var d=n.getRatio(c);switch(n.target){case"start":a&&n.setValuesOffset(d);break;case"end":a&&n.setValuesOffset(0,d);break;case"selection":a&&n.setValuesOffset(d,d);break;case"track":if(!o)return;n.selectionWidth+=d,l==="range"?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0);break}n.prevPos=u}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(i){var s=n.attributes,a=s.onChange,o=s.type,l=o==="range"?i:i[1],u=o==="range"?n.getValues():n.getValues()[1],c=new Wt("valuechange",{detail:{oldValue:l,value:u}});n.dispatchEvent(c),a==null||a(u)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var n=Re(this.attributes,"sparkline");return ue(ue({zIndex:0},this.availableSpace),n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,n=t.trackLength,i=t.trackSize,s=$(this.getOrientVal([[n,i],[i,n]]),2),a=s[0],o=s[1];return{width:a,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var n=t.padding,i=$(vn(n),4),s=i[0],a=i[1],o=i[2],l=i[3],u=this.shape,c=u.width,d=u.height;return{x:l,y:s,width:c-(l+a),height:d-(s+o)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1),this.attributes.values=t;var i=n===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var n=this.calcSelectionArea();this.foregroundGroup.selectAll(Lr.selection.class).each(function(i,s){Mr(this,n[s],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&Mr(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&Mr(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1);var i=this.values,s=this.clampValues(t);this.attributes.values=s,this.setValues(s),n&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var n=this.attributes,i=n.x,s=n.y,a=Re(this.attributes,"track");this.trackShape=Me(t).maybeAppendByClassName(Lr.track,"rect").styles(ue(ue({x:i,y:s},this.shape),a))},e.prototype.renderBrushArea=function(t){var n=this.attributes,i=n.x,s=n.y,a=n.brushable;this.brushArea=Me(t).maybeAppendByClassName(Lr.brushArea,"rect").styles(ue({x:i,y:s,fill:"transparent",cursor:a?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var n=this,i=this.attributes,s=i.x,a=i.y,o=i.orientation,l=Me(t).maybeAppendByClassName(Lr.sparklineGroup,"g");tr(o==="horizontal",l,function(u){var c=ue(ue({},n.sparklineStyle),{x:s,y:a});u.maybeAppendByClassName(Lr.sparkline,function(){return new SR({style:c})}).update(c)})},e.prototype.renderHandles=function(){var t=this,n,i=this.attributes,s=i.showHandle,a=i.type,o=a==="range"?["start","end"]:["end"],l=s?o:[],u=this;(n=this.foregroundGroup)===null||n===void 0||n.selectAll(Lr.handle.class).data(l.map(function(c){return{type:c}}),function(c){return c.type}).join(function(c){return c.append(function(d){var h=d.type;return new CR({style:t.getHandleStyle(h)})}).each(function(d){var h=d.type;this.attr("class","".concat(Lr.handle.name," ").concat(h,"-handle"));var f="".concat(h,"Handle");u[f]=this,this.addEventListener("pointerdown",u.onDragStart(h))})},function(c){return c.each(function(d){var h=d.type;this.update(u.getHandleStyle(h))})},function(c){return c.each(function(d){var h=d.type,f="".concat(h,"Handle");u[f]=void 0}).remove()})},e.prototype.renderSelection=function(t){var n=this.attributes,i=n.x,s=n.y,a=n.type,o=n.selectionType;this.foregroundGroup=Me(t).maybeAppendByClassName(Lr.foreground,"g");var l=Re(this.attributes,"selection"),u=function(d){return d.style("visibility",function(h){return h.show?"visible":"hidden"}).style("cursor",function(h){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(ue(ue({},l),{transform:"translate(".concat(i,", ").concat(s,")")}))},c=this;this.foregroundGroup.selectAll(Lr.selection.class).data(a==="value"?[]:this.calcSelectionArea().map(function(d,h){return{style:ue({},d),index:h,show:o==="select"?h===1:h!==1}}),function(d){return d.index}).join(function(d){return d.append("rect").attr("className",Lr.selection.name).call(u).each(function(h,f){var g=this;f===1?(c.selectionShape=Me(this),this.on("pointerdown",function(v){g.attr("cursor","grabbing"),c.onDragStart("selection")(v)}),c.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),c.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),c.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){g.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){g.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){g.attr("cursor","pointer")})):this.on("pointerdown",c.onDragStart("track"))})},function(d){return d.call(u)},function(d){return d.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,n){this.renderTrack(n),this.renderSparkline(n),this.renderBrushArea(n),this.renderSelection(n)},e.prototype.clampValues=function(t,n){var i;n===void 0&&(n=4);var s=$(this.range,2),a=s[0],o=s[1],l=$(this.getValues().map(function(p){return m0(p,n)}),2),u=l[0],c=l[1],d=Array.isArray(t)?t:[u,t??c],h=$((d||[u,c]).map(function(p){return m0(p,n)}),2),f=h[0],g=h[1];if(this.attributes.type==="value")return[0,At(g,a,o)];f>g&&(i=$([g,f],2),f=i[0],g=i[1]);var v=g-f;return v>o-a?[a,o]:f<a?u===a&&c===g?[a,g]:[a,v+a]:g>o?c===o&&u===f?[f,o]:[o-v,o]:[f,g]},e.prototype.calcSelectionArea=function(t){var n=$(this.clampValues(t),2),i=n[0],s=n[1],a=this.availableSpace,o=a.x,l=a.y,u=a.width,c=a.height;return this.getOrientVal([[{y:l,height:c,x:o,width:i*u},{y:l,height:c,x:i*u+o,width:(s-i)*u},{y:l,height:c,x:s*u,width:(1-s)*u}],[{x:o,width:u,y:l,height:i*c},{x:o,width:u,y:i*c+l,height:(s-i)*c},{x:o,width:u,y:s*c,height:(1-s)*c}]])},e.prototype.calcHandlePosition=function(t){var n=this.attributes.handleIconOffset,i=this.availableSpace,s=i.x,a=i.y,o=i.width,l=i.height,u=$(this.clampValues(),2),c=u[0],d=u[1],h=t==="start"?-n:n,f=(t==="start"?c:d)*this.getOrientVal([o,l])+h;return{x:s+this.getOrientVal([f,o/2]),y:a+this.getOrientVal([l/2,f])}},e.prototype.inferTextStyle=function(t){var n=this.attributes.orientation;return n==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var n,i=this.attributes,s=i.type,a=i.orientation,o=i.formatter,l=i.autoFitLabel,u=Re(this.attributes,"handle"),c=Re(u,"label"),d=u.spacing,h=this.getHandleSize(),f=this.clampValues(),g=t==="start"?f[0]:f[1],v=o(g),p=new gg({style:ue(ue(ue({},c),this.inferTextStyle(t)),{text:v})}),y=p.getBBox(),b=y.width,E=y.height;if(p.destroy(),!l){if(s==="value")return{text:v,x:0,y:-E-d};var T=d+h+(a==="horizontal"?b/2:0);return n={text:v},n[a==="horizontal"?"x":"y"]=t==="start"?-T:T,n}var S=0,k=0,A=this.availableSpace,O=A.width,C=A.height,P=this.calcSelectionArea()[1],L=P.x,R=P.y,z=P.width,Y=P.height,U=d+h;if(a==="horizontal"){var V=U+b/2;if(t==="start"){var W=L-U-b;S=W>0?-V:V}else{var F=O-L-z-U>b;S=F?V:-V}}else{var K=U,re=E+U;t==="start"?k=R-h>E?-re:K:k=C-(R+Y)-h>E?re:-K}return{x:S,y:k,text:v}},e.prototype.getHandleLabelStyle=function(t){var n=Re(this.attributes,"handleLabel");return ue(ue(ue({},n),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,n=Re(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),s=this.getHandleSize();return ue({cursor:i,shape:t,size:s},n)},e.prototype.getHandleStyle=function(t){var n=this.attributes,i=n.x,s=n.y,a=n.showLabel,o=n.showLabelOnInteraction,l=n.orientation,u=this.calcHandlePosition(t),c=u.x,d=u.y,h=this.calcHandleText(t),f=a;return!a&&o&&(this.target?f=!0:f=!1),ue(ue(ue({},Ks(this.getHandleIconStyle(),"icon")),Ks(ue(ue({},this.getHandleLabelStyle(t)),h),"label")),{transform:"translate(".concat(c+i,", ").concat(d+s,")"),orientation:l,showLabel:f,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,n=t.handleIconSize,i=t.width,s=t.height;return n||Math.floor((this.getOrientVal([+s,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var n=$(t,2),i=n[0],s=n[1],a=this.attributes.orientation;return a==="horizontal"?i:s},e.prototype.setValuesOffset=function(t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var s=this.attributes.type,a=$(this.getValues(),2),o=a[0],l=a[1],u=s==="range"?t:0,c=[o+u,l+n].sort();i?this.setValues(c):this.innerSetValues(c,!0)},e.prototype.getRatio=function(t){var n=this.availableSpace,i=n.width,s=n.height;return t/this.getOrientVal([i,s])},e.prototype.dispatchCustomEvent=function(t,n,i){var s=this;t.on(n,function(a){a.stopPropagation(),s.dispatchEvent(new Wt(i,{detail:a}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var n=this.attributes.scrollable;if(n){var i=t.deltaX,s=t.deltaY,a=s||i,o=this.getRatio(a);this.setValuesOffset(o,o,!0)}},e.tag="slider",e}(Lt),Eg={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Kn({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};Ln({},Eg,{style:{type:"arc"}});Ln({},Eg,{style:{}});var rt=kr({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),ga=kr({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function uw(r){return r.reduce(function(e,t,n){return e.push(ke([n===0?"M":"L"],$(t),!1)),e},[])}function _R(r,e,t){var n=e.connect,i=n===void 0?"line":n,s=e.center;if(i==="line")return uw(r);if(!s)return[];var a=co(r[0],s),o=t?0:1;return r.reduce(function(l,u,c){return c===0?l.push(ke(["M"],$(u),!1)):l.push(ke(["A",a,a,0,0,o],$(u),!1)),l},[])}function pf(r,e,t){return e.type==="surround"?_R(r,e,t):uw(r)}function LR(r,e,t){var n=t.type,i=t.connect,s=t.center,a=t.closed,o=a?[["Z"]]:[],l=$([pf(r,t),pf(e.slice().reverse(),t,!0)],2),u=l[0],c=l[1],d=$([r[0],e.slice(-1)[0]],2),h=d[0],f=d[1],g=function(b,E){return[u,b,c,E,o].flat()};if(i==="line"||n==="surround")return g([ke(["L"],$(f),!1)],[ke(["L"],$(h),!1)]);if(!s)throw new Error("Arc grid need to specified center");var v=$([co(f,s),co(h,s)],2),p=v[0],y=v[1];return g([ke(["A",p,p,0,0,1],$(f),!1),ke(["L"],$(f),!1)],[ke(["A",y,y,0,0,0],$(h),!1),ke(["L"],$(h),!1)])}function DR(r,e,t,n){var i=t.animate,s=t.isBillboard,a=e.map(function(o,l){return{id:o.id||"grid-line-".concat(l),d:pf(o.points,t)}});return r.selectAll(ga.line.class).data(a,function(o){return o.id}).join(function(o){return o.append("path").each(function(l,u){var c=fr(b0(ue({d:l.d},n)),[l,u,a]);this.attr(ue({class:ga.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:s},c))})},function(o){return o.transition(function(l,u){var c=fr(b0(ue({d:l.d},n)),[l,u,a]);return Mr(this,c,i.update)})},function(o){return o.transition(function(){var l=this,u=Ec(this,i.exit);return Ea(u,function(){return l.remove()}),u})}).transitions()}function IR(r,e,t){var n=t.animate,i=t.connect,s=t.areaFill;if(e.length<2||!s||!i)return[];for(var a=Array.isArray(s)?s:[s,"transparent"],o=function(g){return a[g%a.length]},l=[],u=0;u<e.length-1;u++){var c=$([e[u].points,e[u+1].points],2),d=c[0],h=c[1],f=LR(d,h,t);l.push({d:f,fill:o(u)})}return r.selectAll(ga.region.class).data(l,function(g,v){return v}).join(function(g){return g.append("path").each(function(v,p){var y=fr(v,[v,p,l]);this.attr(y)}).attr("className",ga.region.name)},function(g){return g.transition(function(v,p){var y=fr(v,[v,p,l]);return Mr(this,y,n.update)})},function(g){return g.transition(function(){var v=this,p=Ec(this,n.exit);return Ea(p,function(){return v.remove()}),p})}).transitions()}function RR(r){var e=r.data,t=e===void 0?[]:e,n=r.closed;return n?t.map(function(i){var s=i.points,a=$(s,1),o=a[0];return ue(ue({},i),{points:ke(ke([],$(s),!1),[o],!1)})}):t}var jR=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){t.type,t.center,t.areaFill,t.closed;var i=Vt(t,["type","center","areaFill","closed"]),s=RR(t),a=Me(n).maybeAppendByClassName(ga.lineGroup,"g"),o=Me(n).maybeAppendByClassName(ga.regionGroup,"g"),l=DR(a,s,t,i),u=IR(o,s,t);return ke(ke([],$(l),!1),$(u),!1)},e}(Lt);function cw(r,e){return Object.fromEntries(Object.entries(r).map(function(t){var n=$(t,2),i=n[0],s=n[1];return[i,fr(s,e)]}))}function Mg(r,e){return e&&Ee(e)?r.filter(e):r}function dw(r,e){var t=e.startAngle,n=e.endAngle;return(n-t)*r+t}function Mc(r,e){if(e.type==="linear"){var t=$(e.startPos,2),n=t[0],i=t[1],s=$(e.endPos,2),a=s[0],o=s[1],l=$([a-n,o-i],2),u=l[0],c=l[1];return Qb([u,c])}var d=fa(dw(r,e));return[-Math.sin(d),Math.cos(d)]}function Sg(r,e,t){var n=Mc(r,t);return uI(n,e!=="positive")}function Po(r,e){return Sg(r,e.labelDirection,e)}function BR(r,e){var t=$(e.startPos,2),n=t[0],i=t[1],s=$(e.endPos,2),a=s[0],o=s[1],l=$([a-n,o-i],2),u=l[0],c=l[1];return[n+u*r,i+c*r]}function zR(r,e){var t=e.radius,n=$(e.center,2),i=n[0],s=n[1],a=fa(dw(r,e));return[i+t*Math.cos(a),s+t*Math.sin(a)]}function Sc(r,e){return e.type==="linear"?BR(r,e):zR(r,e)}function hw(r){return Mc(0,r)[1]===0}function fw(r){return Mc(0,r)[0]===0}function gw(r,e){return e-r===360}function $0(r,e,t,n,i){var s=e-r,a=$([i,i],2),o=a[0],l=a[1],u=$([fa(r),fa(e)],2),c=u[0],d=u[1],h=function(C){return[t+i*Math.cos(C),n+i*Math.sin(C)]},f=$(h(c),2),g=f[0],v=f[1],p=$(h(d),2),y=p[0],b=p[1];if(gw(r,e)){var E=(d+c)/2,T=$(h(E),2),S=T[0],k=T[1];return[["M",g,v],["A",o,l,0,1,0,S,k],["A",o,l,0,1,0,y,b]]}var A=s>180?1:0,O=r>e?0:1;return"M".concat(g,",").concat(v,",A").concat(o,",").concat(l,",0,").concat(A,",").concat(O,",").concat(y,",").concat(b)}function FR(r){var e=r.attributes,t=e.startAngle,n=e.endAngle,i=e.center,s=e.radius;return ke(ke([t,n],$(i),!1),[s],!1)}function $R(r,e,t,n){var i=e.startAngle,s=e.endAngle,a=e.center,o=e.radius;return r.selectAll(rt.line.class).data([{d:$0.apply(void 0,ke(ke([i,s],$(a),!1),[o],!1))}],function(l,u){return u}).join(function(l){return l.append("path").attr("className",rt.line.name).styles(e).styles({d:function(u){return u.d}})},function(l){return l.transition(function(){var u=this,c=lI(this,FR(this),ke(ke([i,s],$(a),!1),[o],!1),n.update);if(c){var d=function(){var h=An(u.attributes,"__keyframe_data__");u.style.d=$0.apply(void 0,ke([],$(h),!1))};c.onframe=d,c.onfinish=d}return c}).styles(e)},function(l){return l.remove()}).styles(t).transitions()}function WR(r,e){e.truncRange,e.truncShape,e.lineExtension}function GR(r,e,t){t===void 0&&(t=[0,0]);var n=$([r,e,t],3),i=$(n[0],2),s=i[0],a=i[1],o=$(n[1],2),l=o[0],u=o[1],c=$(n[2],2),d=c[0],h=c[1],f=$([l-s,u-a],2),g=f[0],v=f[1],p=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),y=$([-d/p,h/p],2),b=y[0],E=y[1];return[b*g,b*v,E*g,E*v]}function W0(r){var e=$(r,2),t=$(e[0],2),n=t[0],i=t[1],s=$(e[1],2),a=s[0],o=s[1];return{x1:n,y1:i,x2:a,y2:o}}function YR(r,e,t,n){var i=e.showTrunc,s=e.startPos,a=e.endPos,o=e.truncRange,l=e.lineExtension,u=$([s,a],2),c=$(u[0],2),d=c[0],h=c[1],f=$(u[1],2),g=f[0],v=f[1],p=$(l?GR(s,a,l):new Array(4).fill(0),4),y=p[0],b=p[1],E=p[2],T=p[3],S=function(F){return r.selectAll(rt.line.class).data(F,function(K,re){return re}).join(function(K){return K.append("line").attr("className",function(re){return"".concat(rt.line.name," ").concat(re.className)}).styles(t).transition(function(re){return Mr(this,W0(re.line),!1)})},function(K){return K.styles(t).transition(function(re){var se=re.line;return Mr(this,W0(se),n.update)})},function(K){return K.remove()}).transitions()};if(!i||!o)return S([{line:[[d+y,h+b],[g+E,v+T]],className:rt.line.name}]);var k=$(o,2),A=k[0],O=k[1],C=g-d,P=v-h,L=$([d+C*A,h+P*A],2),R=L[0],z=L[1],Y=$([d+C*O,h+P*O],2),U=Y[0],V=Y[1],W=S([{line:[[d+y,h+b],[R,z]],className:rt.lineFirst.name},{line:[[U,V],[g+E,v+T]],className:rt.lineSecond.name}]);return WR(r,e),W}function VR(r,e,t,n){var i=t.showArrow,s=t.showTrunc,a=t.lineArrow,o=t.lineArrowOffset,l=t.lineArrowSize,u;if(e==="arc"?u=r.select(rt.line.class):s?u=r.select(rt.lineSecond.class):u=r.select(rt.line.class),!i||!a||t.type==="arc"&&gw(t.startAngle,t.endAngle)){var c=u.node();c&&(c.style.markerEnd=void 0);return}var d=fi(a);d.attr(n),vg(d,l),u.style("markerEnd",d).style("markerEndOffset",-o)}function UR(r,e,t){var n=e.type,i,s=Re(e,"line");return n==="linear"?i=YR(r,e,y0(s,"arrow"),t):i=$R(r,e,y0(s,"arrow"),t),VR(r,n,e,s),i}function HR(r,e){return Sg(r,e.gridDirection,e)}function pw(r){var e=r.type,t=r.gridCenter;return e==="linear"?t:t||r.center}function XR(r,e){var t=e.gridLength;return r.map(function(n,i){var s=n.value,a=$(Sc(s,e),2),o=a[0],l=a[1],u=$(si(HR(s,e),t),2),c=u[0],d=u[1];return{id:i,points:[[o,l],[o+c,l+d]]}})}function qR(r,e){var t=e.gridControlAngles,n=pw(e);if(!n)throw new Error("grid center is not provide");if(r.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=$(n,2),s=i[0],a=i[1];return r.map(function(o,l){var u=o.value,c=$(Sc(u,e),2),d=c[0],h=c[1],f=$([d-s,h-a],2),g=f[0],v=f[1],p=[];return t.forEach(function(y){var b=fa(y),E=$([Math.cos(b),Math.sin(b)],2),T=E[0],S=E[1],k=g*T-v*S+s,A=g*S+v*T+a;p.push([k,A])}),{points:p,id:l}})}function ZR(r,e,t,n){var i=Re(t,"grid"),s=i.type,a=i.areaFill,o=pw(t),l=Mg(e,t.gridFilter),u=s==="segment"?XR(l,t):qR(l,t),c=ue(ue({},i),{center:o,areaFill:Ee(a)?l.map(function(d,h){return fr(a,[d,h,l])}):a,animate:n,data:u});return r.selectAll(rt.grid.class).data([1]).join(function(d){return d.append(function(){return new jR({style:c})}).attr("className",rt.grid.name)},function(d){return d.transition(function(){return this.update(c)})},function(d){return d.remove()}).transitions()}var vf=function(){function r(e,t,n,i){this.set(e,t,n,i)}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),r.prototype.rotatedPoints=function(e,t,n){var i=this,s=i.x1,a=i.y1,o=i.x2,l=i.y2,u=Math.cos(e),c=Math.sin(e),d=t-t*u+n*c,h=n-t*c-n*u,f=[[u*s-c*l+d,c*s+u*l+h],[u*o-c*l+d,c*o+u*l+h],[u*s-c*a+d,c*s+u*a+h],[u*o-c*a+d,c*o+u*a+h]];return f},r.prototype.set=function(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},r.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},r}();function mf(r,e){var t=r.getEulerAngles()||0;r.setEulerAngles(0);var n=r.getBounds(),i=$(n.min,2),s=i[0],a=i[1],o=$(n.max,2),l=o[0],u=o[1],c=r.getBBox(),d=c.width,h=c.height,f=h,g=0,v=0,p=s,y=a,b=Zb(r);if(b){f-=1.5;var E=b.style.textAlign,T=b.style.textBaseline;E==="center"?p=(s+l)/2:(E==="right"||E==="end")&&(p=l),T==="middle"?y=(a+u)/2:T==="bottom"&&(y=u)}var S=$(vn(e),4),k=S[0],A=k===void 0?0:k,O=S[1],C=O===void 0?0:O,P=S[2],L=P===void 0?A:P,R=S[3],z=R===void 0?C:R,Y=new vf((g+=s)-z,(v+=a)-A,g+d+C,v+f+L);return r.setEulerAngles(t),Y.rotatedPoints(fa(t),p,y)}function $a(r,e){return e[0]<=Math.max(r[0][0],r[1][0])&&e[0]<=Math.min(r[0][0],r[1][0])&&e[1]<=Math.max(r[0][1],r[1][1])&&e[1]<=Math.min(r[0][1],r[1][1])}function Wa(r,e,t){var n=(e[1]-r[1])*(t[0]-e[0])-(e[0]-r[0])*(t[1]-e[1]);return n===0?0:n<0?2:1}function KR(r,e){var t=Wa(r[0],r[1],e[0]),n=Wa(r[0],r[1],e[1]),i=Wa(e[0],e[1],r[0]),s=Wa(e[0],e[1],r[1]);return!!(t!==n&&i!==s||t===0&&$a(r,e[0])||n===0&&$a(r,e[1])||i===0&&$a(e,r[0])||s===0&&$a(e,r[1]))}function QR(r,e){var t=r.length;if(t<3)return!1;var n=[e,[9999,e[1]]],i=0,s=0;do{var a=[r[s],r[(s+1)%t]];if(KR(a,n)){if(Wa(a[0],e,a[1])===0)return $a(a,e);i++}s=(s+1)%t}while(s!==0);return!!(i&1)}function JR(r,e){return e.every(function(t){return QR(r,t)})}function e4(r,e,t){var n=r.x1,i=r.x2,s=r.y1,a=r.y2,o=[[n,s],[i,s],[i,a],[n,a]],l=mf(e,t);return JR(o,l)}function t4(r,e){var t=$(r,4),n=t[0],i=t[1],s=t[2],a=t[3],o=$(e,4),l=o[0],u=o[1],c=o[2],d=o[3],h=s-n,f=a-i,g=c-l,v=d-u,p=h*v-g*f;if(p===0)return!1;var y=p>0,b=n-l,E=i-u,T=h*E-f*b;if(T<0===y)return!1;var S=g*E-v*b;return!(S<0===y||T>p===y||S>p===y)}function n4(r,e){var t=[[r[0],r[1],r[2],r[3]],[r[2],r[3],r[4],r[5]],[r[4],r[5],r[6],r[7]],[r[6],r[7],r[0],r[1]]];return t.some(function(n){return t4(e,n)})}function r4(r,e,t){var n,i,s=mf(r,t).flat(1),a=mf(e,t).flat(1),o=[[s[0],s[1],s[2],s[3]],[s[0],s[1],s[4],s[5]],[s[4],s[5],s[6],s[7]],[s[2],s[3],s[6],s[7]]];try{for(var l=po(o),u=l.next();!u.done;u=l.next()){var c=u.value;if(n4(a,c))return!0}}catch(d){n={error:d}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return!1}function i4(r,e){var t=r.type,n=r.labelDirection,i=r.crossSize;if(!i)return!1;if(t==="arc"){var s=r.center,a=r.radius,o=$(s,2),l=o[0],u=o[1],c=n==="negative"?0:i,d=-a-c,h=a+c,f=$(vn(e),4),g=f[0],v=f[1],p=f[2],y=f[3];return new vf(l+d-y,u+d-g,l+h+v,u+h+p)}var b=$(r.startPos,2),E=b[0],T=b[1],S=$(r.endPos,2),k=S[0],A=S[1],O=$(fw(r)?[-e,0,e,0]:[0,e,0,-e],4),C=O[0],P=O[1],L=O[2],R=O[3],z=Po(0,r),Y=si(z,i),U=new vf(E,T,k,A);return U.x1+=R,U.y1+=C,U.x2+=P+Y[0],U.y2+=L+Y[1],U}function Tc(r,e,t){var n,i,s=e.crossPadding,a=new Set,o=null,l=i4(e,s),u=function(g){return l?e4(l,g):!0},c=function(g,v){return!g||!g.firstChild?!0:!r4(g.firstChild,v.firstChild,vn(t))};try{for(var d=po(r),h=d.next();!h.done;h=d.next()){var f=h.value;u(f)?!o||c(o,f)?o=f:(a.add(o),a.add(f)):a.add(f)}}catch(g){n={error:g}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return Array.from(a)}function uh(r,e){return e===void 0&&(e={}),Ae(r)?0:typeof r=="number"?r:Math.floor(nI(r,e))}function s4(r,e,t,n){if(!(r.length<=1)){var i=e.suffix,s=i===void 0?"...":i,a=e.minLength,o=e.maxLength,l=o===void 0?1/0:o,u=e.step,c=u===void 0?" ":u,d=e.margin,h=d===void 0?[0,0,0,0]:d,f=qb(n.getTextShape(r[0])),g=uh(c,f),v=a?uh(a,f):g,p=uh(l,f);(Ae(p)||p===1/0)&&(p=Math.max.apply(null,r.map(function(k){return k.getBBox().width})));var y=r.slice(),b=$(h,4);b[0],b[1],b[2],b[3];for(var E=function(k){if(y.forEach(function(A){n.ellipsis(n.getTextShape(A),k,s)}),y=Tc(r,t,h),y.length<1)return{value:void 0}},T=p;T>v+g;T-=g){var S=E(T);if(typeof S=="object")return S.value}}}var a4={parity:function(r,e){var t=e.seq,n=t===void 0?2:t;return r.filter(function(i,s){return s%n?(Er(i),!1):!0})}},o4=function(r){return r.filter(Xb)};function l4(r,e,t,n){var i=r.length,s=e.keepHeader,a=e.keepTail;if(!(i<=1||i===2&&s&&a)){var o=a4.parity,l=function(E){return E.forEach(n.show),E},u=2,c=r.slice(),d=r.slice(),h=Math.min.apply(Math,ke([1],$(r.map(function(E){return E.getBBox().width})),!1));if(t.type==="linear"&&(hw(t)||fw(t))){var f=w0(r[0]).left,g=w0(r[i-1]).right,v=Math.abs(g-f)||1;u=Math.max(Math.floor(i*h/v),u)}var p,y;for(s&&(p=c.splice(0,1)[0]),a&&(y=c.splice(-1,1)[0],c.reverse()),l(c);u<r.length&&Tc(o4(y?ke(ke([y],$(d),!1),[p],!1):ke([p],$(d),!1)),t,e==null?void 0:e.margin).length;){if(y&&!p&&u%2===0){var b=c.splice(0,1);b.forEach(n.hide)}else if(y&&p){var b=c.splice(0,1);b.forEach(n.hide)}d=o(l(c),{seq:u}),u++}}}function u4(r,e,t,n){var i,s,a=e.optionalAngles,o=a===void 0?[0,45,90]:a,l=e.margin,u=e.recoverWhenFailed,c=u===void 0?!0:u,d=r.map(function(y){return y.getLocalEulerAngles()}),h=function(){return Tc(r,t,l).length<1},f=function(y){return r.forEach(function(b,E){var T=Array.isArray(y)?y[E]:y;n.rotate(b,+T)})};try{for(var g=po(o),v=g.next();!v.done;v=g.next()){var p=v.value;if(f(p),h())return}}catch(y){i={error:y}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}c&&f(d)}function c4(r){var e=r.type,t=r.labelDirection;return e==="linear"&&hw(r)?t==="negative"?"bottom":"top":"middle"}function d4(r,e,t,n){var i=e.wordWrapWidth,s=i===void 0?50:i,a=e.maxLines,o=a===void 0?3:a,l=e.recoverWhenFailed,u=l===void 0?!0:l,c=e.margin,d=c===void 0?[0,0,0,0]:c,h=r.map(function(b){return b.attr("maxLines")||1}),f=Math.min.apply(Math,ke([],$(h),!1)),g=function(){return Tc(r,t,d).length<1},v=c4(t),p=function(b){return r.forEach(function(E,T){var S=Array.isArray(b)?b[T]:b;n.wrap(E,s,S,v)})};if(!(f>o)){for(var y=f;y<=o;y++)if(p(y),g())return;u&&p(h)}}var h4=new Map([["hide",l4],["rotate",u4],["ellipsis",s4],["wrap",d4]]);function f4(r,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!eI(r[0]):t==="rotate"?!r.some(function(n){var i;return!!(!((i=n.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?r.filter(function(n){return n.querySelector("text")}).length>1:!0}function g4(r,e,t){var n=e.labelOverlap,i=n===void 0?[]:n;i.length&&i.forEach(function(s){var a=s.type,o=h4.get(a);f4(r,e,a)&&(o==null||o(r,s,e,t))})}function p4(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=function(n){return n==="positive"?-1:1};return r.reduce(function(n,i){return n*t(i)},1)}function G0(r){for(var e=r;e<0;)e+=360;return Math.round(e%360)}function yf(r,e){var t=$(r,2),n=t[0],i=t[1],s=$(e,2),a=s[0],o=s[1],l=$([n*a+i*o,n*o-i*a],2),u=l[0],c=l[1];return Math.atan2(c,u)}function v4(r){var e=(r+360)%180;return dn(e,-90,90)||(e+=180),e}function m4(r,e,t){var n,i=t.labelAlign,s=(n=e.style.transform)===null||n===void 0?void 0:n.includes("rotate");if(s)return e.getLocalEulerAngles();var a=0,o=Po(r.value,t),l=Mc(r.value,t);return i==="horizontal"?0:(i==="perpendicular"?a=yf([1,0],o):a=yf([l[0]<0?-1:1,0],l),v4(Ub(a)))}function vw(r,e,t){var n=t.type,i=t.labelAlign,s=Po(r,t),a=G0(e),o=G0(Ub(yf([1,0],s))),l="center",u="middle";return n==="linear"?[90,270].includes(o)&&a===0?(l="center",u=s[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(a)?l="center":o===0?(dn(a,0,90,!1,!0)||dn(a,0,90)||dn(a,270,360))&&(l="start"):o===90?dn(a,0,90,!1,!0)?l="start":(dn(a,90,180)||dn(a,270,360))&&(l="end"):o===270?dn(a,0,90,!1,!0)?l="end":(dn(a,90,180)||dn(a,270,360))&&(l="start"):o===180&&(a===90?l="start":(dn(a,0,90)||dn(a,270,360))&&(l="end")):i==="parallel"?dn(o,0,180,!0)?u="top":u="bottom":i==="horizontal"?dn(o,90,270,!1)?l="end":(dn(o,270,360,!1)||dn(o,0,90))&&(l="start"):i==="perpendicular"&&(dn(o,90,270)?l="end":l="start"),{textAlign:l,textBaseline:u}}function y4(r,e,t){e.setLocalEulerAngles(r);var n=e.__data__.value,i=vw(n,r,t),s=e.querySelector(rt.labelItem.class);s&&mw(s,i)}function Y0(r,e,t){var n=t.showTick,i=t.tickLength,s=t.tickDirection,a=t.labelDirection,o=t.labelSpacing,l=e.indexOf(r),u=fr(o,[r,l,e]),c=$([Po(r.value,t),p4(a,s)],2),d=c[0],h=c[1],f=h===1?fr(n?i:0,[r,l,e]):0,g=$(Fa(si(d,u+f),Sc(r.value,t)),2),v=g[0],p=g[1];return{x:v,y:p}}function b4(r,e,t,n){var i=n.labelFormatter,s=Ee(i)?function(){return fi(fr(i,[r,e,t,Po(r.value,n)]))}:function(){return fi(r.label||"")};return s}function mw(r,e){r.nodeName==="text"&&r.attr(e)}function V0(r){g4(this.node().childNodes,r,{hide:Er,show:Co,rotate:function(e,t){y4(+t,e,r)},ellipsis:function(e,t,n){e&&ff(e,t||1/0,n)},wrap:function(e,t,n){e&&rI(e,t,n)},getTextShape:function(e){return e.querySelector("text")}})}function U0(r,e,t,n,i){var s=t.indexOf(e),a=Me(r).append(b4(e,s,t,i)).attr("className",rt.labelItem.name).node(),o=$(gi(cw(n,[e,s,t])),2),l=o[0],u=o[1],c=u.transform,d=Vt(u,["transform"]);Jb(a,c);var h=m4(e,a,i);return a.getLocalEulerAngles()||a.setLocalEulerAngles(h),mw(a,ue(ue({},vw(e.value,h,i)),l)),r.attr(d),a}function w4(r,e,t,n){var i=Mg(e,t.labelFilter),s=Re(t,"label");return r.selectAll(rt.label.class).data(i,function(a,o){return o}).join(function(a){return a.append("g").attr("className",rt.label.name).transition(function(o){U0(this,o,e,s,t);var l=Y0(o,e,t),u=l.x,c=l.y;return this.style.transform="translate(".concat(u,", ").concat(c,")"),null}).call(function(){V0.call(r,t)})},function(a){return a.transition(function(o){var l=this.querySelector(rt.labelItem.class),u=U0(this,o,e,s,t),c=NR(l,u,n.update),d=Y0(o,e,t),h=d.x,f=d.y,g=Mr(this,{transform:"translate(".concat(h,", ").concat(f,")")},n.update);return ke(ke([],$(c),!1),[g],!1)}).call(function(o){var l=An(o,"_transitions").flat().filter(Xb);OR(l,function(){V0.call(r,t)})})},function(a){return a.transition(function(){var o=this,l=Ec(this.childNodes[0],n.exit);return Ea(l,function(){return Me(o).remove()}),l})}).transitions()}function yw(r,e){return Sg(r,e.tickDirection,e)}function x4(r,e){var t=$(r,2),n=t[0],i=t[1];return[[0,0],[n*e,i*e]]}function E4(r,e,t,n,i){var s=i.tickLength,a=$(x4(n,fr(s,[r,e,t])),2),o=$(a[0],2),l=o[0],u=o[1],c=$(a[1],2),d=c[0],h=c[1];return{x1:l,x2:d,y1:u,y2:h}}function M4(r,e,t,n,i){var s=i.tickFormatter,a=yw(e.value,i),o="line";return Ee(s)&&(o=function(){return fr(s,[e,t,n,a])}),r.append(o).attr("className",rt.tickItem.name)}function S4(r,e,t,n,i,s,a){var o=yw(r.value,s),l=E4(r,e,t,o,s),u=l.x1,c=l.x2,d=l.y1,h=l.y2,f=$(gi(cw(a,[r,e,t,o])),2),g=f[0],v=f[1];n.node().nodeName==="line"&&n.styles(ue({x1:u,x2:c,y1:d,y2:h},g)),i.attr(v),n.styles(g)}function H0(r,e,t,n,i,s){var a=M4(Me(this),r,e,t,n);S4(r,e,t,a,this,n,i);var o=$(Sc(r.value,n),2),l=o[0],u=o[1];return Mr(this,{transform:"translate(".concat(l,", ").concat(u,")")},s)}function T4(r,e,t,n){var i=Mg(e,t.tickFilter),s=Re(t,"tick");return r.selectAll(rt.tick.class).data(i,function(a){return a.id||a.label}).join(function(a){return a.append("g").attr("className",rt.tick.name).transition(function(o,l){return H0.call(this,o,l,i,t,s,!1)})},function(a){return a.transition(function(o,l){return this.removeChildren(),H0.call(this,o,l,i,t,s,n.update)})},function(a){return a.transition(function(){var o=this,l=Ec(this.childNodes[0],n.exit);return Ea(l,function(){return o.remove()}),l})}).transitions()}var X0=kr({text:"text"},"title");function Oc(r){return/\S+-\S+/g.test(r)?r.split("-").map(function(e){return e[0]}):r.length>2?[r[0]]:r.split("")}function O4(r,e){var t=r.attributes,n=t.position,i=t.spacing,s=t.inset,a=t.text,o=r.getBBox(),l=e.getBBox(),u=Oc(n),c=$(vn(a?i:0),4),d=c[0],h=c[1],f=c[2],g=c[3],v=$(vn(s),4),p=v[0],y=v[1],b=v[2],E=v[3],T=$([g+h,d+f],2),S=T[0],k=T[1],A=$([E+y,p+b],2),O=A[0],C=A[1];if(u[0]==="l")return new _n(o.x,o.y,l.width+o.width+S+O,Math.max(l.height+C,o.height));if(u[0]==="t")return new _n(o.x,o.y,Math.max(l.width+O,o.width),l.height+o.height+k+C);var P=$([e.attributes.width||l.width,e.attributes.height||l.height],2),L=P[0],R=P[1];return new _n(l.x,l.y,L+o.width+S+O,R+o.height+k+C)}function k4(r,e){var t=Object.entries(e).reduce(function(n,i){var s=$(i,2),a=s[0],o=s[1],l=r.node().attr(a);return l||(n[a]=o),n},{});r.styles(t)}function N4(r){var e,t,n,i,s=r,a=s.width,o=s.height,l=s.position,u=$([+a/2,+o/2],2),c=u[0],d=u[1],h=$([+c,+d,"center","middle"],4),f=h[0],g=h[1],v=h[2],p=h[3],y=Oc(l);return y.includes("l")&&(e=$([0,"start"],2),f=e[0],v=e[1]),y.includes("r")&&(t=$([+a,"end"],2),f=t[0],v=t[1]),y.includes("t")&&(n=$([0,"top"],2),g=n[0],p=n[1]),y.includes("b")&&(i=$([+o,"bottom"],2),g=i[0],p=i[1]),{x:f,y:g,textAlign:v,textBaseline:p}}var A4=function(r){Ye(e,r);function e(t){return r.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,n=this.attributes,i=n.width,s=n.height,a=n.position,o=n.spacing,l=n.inset,u=t.querySelector(X0.text.class);if(!u)return new _n(0,0,+i,+s);var c=u.getBBox(),d=c.width,h=c.height,f=$(vn(o),4),g=f[0],v=f[1],p=f[2],y=f[3],b=$([0,0,+i,+s],4),E=b[0],T=b[1],S=b[2],k=b[3],A=Oc(a);if(A.includes("i"))return new _n(E,T,S,k);A.forEach(function(V,W){var F,K,re,se;V==="t"&&(F=$(W===0?[h+p,+s-h-p]:[0,+s],2),T=F[0],k=F[1]),V==="r"&&(K=$([+i-d-y],1),S=K[0]),V==="b"&&(re=$([+s-h-g],1),k=re[0]),V==="l"&&(se=$(W===0?[d+v,+i-d-v]:[0,+i],2),E=se[0],S=se[1])});var O=$(vn(l),4),C=O[0],P=O[1],L=O[2],R=O[3],z=$([R+P,C+L],2),Y=z[0],U=z[1];return new _n(E+R,T+C,S-Y,k-U)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new _n(0,0,0,0)},e.prototype.render=function(t,n){var i=this;t.width,t.height,t.position,t.spacing;var s=Vt(t,["width","height","position","spacing"]),a=$(gi(s),1),o=a[0],l=N4(t),u=l.x,c=l.y,d=l.textAlign,h=l.textBaseline;tr(!!s.text,Me(n),function(f){i.title=f.maybeAppendByClassName(X0.text,"text").styles(o).call(k4,{x:u,y:c,textAlign:d,textBaseline:h}).node()})},e}(Lt);function C4(r,e,t){var n=t.titlePosition,i=n===void 0?"lb":n,s=t.titleSpacing,a=Oc(i),o=r.node().getLocalBounds(),l=$(o.min,2),u=l[0],c=l[1],d=$(o.halfExtents,2),h=d[0],f=d[1],g=$(e.node().getLocalBounds().halfExtents,2),v=g[0],p=g[1],y=$([u+h,c+f],2),b=y[0],E=y[1],T=$(vn(s),4),S=T[0],k=T[1],A=T[2],O=T[3];if(["start","end"].includes(i)&&t.type==="linear"){var C=t.startPos,P=t.endPos,L=$(i==="start"?[C,P]:[P,C],2),R=L[0],z=L[1],Y=Qb([-z[0]+R[0],-z[1]+R[1]]),U=$(si(Y,S),2),V=U[0],W=U[1];return{x:R[0]+V,y:R[1]+W}}return a.includes("t")&&(E-=f+p+S),a.includes("r")&&(b+=h+v+k),a.includes("l")&&(b-=h+v+O),a.includes("b")&&(E+=f+p+A),{x:b,y:E}}function P4(r,e,t){var n=r.getGeometryBounds().halfExtents,i=n[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function q0(r,e,t,n,i){var s=Re(n,"title"),a=$(gi(s),2),o=a[0],l=a[1],u=l.transform,c=l.transformOrigin,d=Vt(l,["transform","transformOrigin"]);e.styles(d);var h=u||P4(r.node(),o.direction,o.position);r.styles(ue(ue({},o),{transformOrigin:c})),Jb(r.node(),h);var f=C4(Me(t._offscreen||t.querySelector(rt.mainGroup.class)),e,n),g=f.x,v=f.y,p=Mr(e.node(),{transform:"translate(".concat(g,", ").concat(v,")")},i);return p}function _4(r,e,t,n){var i=t.titleText;return r.selectAll(rt.title.class).data([{title:i}].filter(function(s){return!!s.title}),function(s,a){return s.title}).join(function(s){return s.append(function(){return fi(i)}).attr("className",rt.title.name).transition(function(){return q0(Me(this),r,e,t,n.enter)})},function(s){return s.transition(function(){return q0(Me(this),r,e,t,n.update)})},function(s){return s.remove()}).transitions()}function Z0(r,e,t,n){var i=r.showLine,s=r.showTick,a=r.showLabel,o=e.maybeAppendByClassName(rt.lineGroup,"g"),l=tr(i,o,function(f){return UR(f,r,n)})||[],u=e.maybeAppendByClassName(rt.tickGroup,"g"),c=tr(s,u,function(f){return T4(f,t,r,n)})||[],d=e.maybeAppendByClassName(rt.labelGroup,"g"),h=tr(a,d,function(f){return w4(f,t,r,n)})||[];return ke(ke(ke([],$(l),!1),$(c),!1),$(h),!1).filter(function(f){return!!f})}var L4=function(r){Ye(e,r);function e(t){return r.call(this,t,Eg)||this}return e.prototype.render=function(t,n,i){var s=this,a=t.titleText,o=t.data,l=t.animate,u=t.showTitle,c=t.showGrid,d=t.dataThreshold,h=t.truncRange,f=gI(o,d).filter(function(S){var k=S.value;return!(h&&k>h[0]&&k<h[1])}),g=F0(i===void 0?l:i),v=Me(n).maybeAppendByClassName(rt.gridGroup,"g"),p=tr(c,v,function(S){return ZR(S,f,t,g)})||[],y=Me(n).maybeAppendByClassName(rt.mainGroup,"g");a&&(!this.initialized&&g.enter||this.initialized&&g.update)&&Z0(t,Me(this.offscreenGroup),f,F0(!1));var b=Z0(t,Me(y.node()),f,g),E=Me(n).maybeAppendByClassName(rt.titleGroup,"g"),T=tr(u,E,function(S){return _4(S,s,t,g)})||[];return ke(ke(ke([],$(p),!1),$(b),!1),$(T),!1).flat().filter(function(S){return!!S})},e}(Lt),lr=kr({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),D4=function(r){Ye(e,r);function e(t){var n=r.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:YI(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,s){return"".concat(i,"/").concat(s)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new Jt({class:lr.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new Jt({class:lr.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return At(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,n=$(TI(t.map(function(d){var h=d.getBBox(),f=h.width,g=h.height;return[f,g]})).map(function(d){return Math.max.apply(Math,ke([],$(d),!1))}),2),i=n[0],s=n[1],a=this.attributes,o=a.pageWidth,l=o===void 0?i:o,u=a.pageHeight,c=u===void 0?s:u;return{pageWidth:l,pageHeight:c}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=r.prototype.getBBox.call(this),n=t.x,i=t.y,s=this.controllerShape,a=this.pageShape,o=a.pageWidth,l=a.pageHeight;return new _n(n,i,o+s.width,l)},e.prototype.goTo=function(t){var n=this,i=this.attributes.animate,s=this,a=s.currPage,o=s.playState,l=s.playWindow,u=s.pageViews;if(o!=="idle"||t<0||u.length<=0||t>=u.length)return null;u[a].setLocalPosition(0,0),this.prepareFollowingPage(t);var c=$(this.getFollowingPageDiff(t),2),d=c[0],h=c[1];this.playState="running";var f=sw(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-d,", ").concat(-h,")")}],i);return Ea(f,function(){n.innerCurrPage=t,n.playState="idle",n.setVisiblePages([t]),n.updatePageInfo()}),f},e.prototype.prev=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var s=t?(i-1+n)%n:At(i-1,0,n);return this.goTo(s)},e.prototype.next=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i>=n-1)return null;var s=t?(i+1)%n:At(i+1,0,n);return this.goTo(s)},e.prototype.renderClipPath=function(t){var n=this.pageShape,i=n.pageWidth,s=n.pageHeight;if(!i||!s){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(lr.clipPath,"rect").styles({width:i,height:s}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(n,i){t.includes(i)?Co(n):Er(n)})},e.prototype.adjustControllerLayout=function(){var t=this,n=t.prevBtnGroup,i=t.nextBtnGroup,s=t.pageInfoGroup,a=this.attributes,o=a.orientation,l=a.controllerPadding,u=s.getBBox(),c=u.width;u.height;var d=$(o==="horizontal"?[-180,0]:[-90,90],2),h=d[0],f=d[1];n.setLocalEulerAngles(h),i.setLocalEulerAngles(f);var g=n.getBBox(),v=g.width,p=g.height,y=i.getBBox(),b=y.width,E=y.height,T=Math.max(v,c,b),S=o==="horizontal"?{offset:[[0,0],[v/2+l,0],[v+c+l*2,0]],textAlign:"start"}:{offset:[[T/2,-p-l],[T/2,0],[T/2,E+l]],textAlign:"center"},k=$(S.offset,3),A=$(k[0],2),O=A[0],C=A[1],P=$(k[1],2),L=P[0],R=P[1],z=$(k[2],2),Y=z[0],U=z[1],V=S.textAlign,W=s.querySelector("text");W&&(W.style.textAlign=V),n.setLocalPosition(O,C),s.setLocalPosition(L,R),i.setLocalPosition(Y,U)},e.prototype.updatePageInfo=function(){var t,n=this,i=n.currPage,s=n.pageViews,a=n.attributes.formatter;s.length<2||((t=this.pageInfoGroup.querySelector(lr.pageInfo.class))===null||t===void 0||t.attr("text",a(i+1,s.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var n=this.currPage;if(n===t)return[0,0];var i=this.attributes.orientation,s=this.pageShape,a=s.pageWidth,o=s.pageHeight,l=t<n?-1:1;return i==="horizontal"?[l*a,0]:[0,l*o]},e.prototype.prepareFollowingPage=function(t){var n=this,i=n.currPage,s=n.pageViews;if(this.setVisiblePages([t,i]),t!==i){var a=$(this.getFollowingPageDiff(t),2),o=a[0],l=a[1];s[t].setLocalPosition(o,l)}},e.prototype.renderController=function(t){var n=this,i=this.attributes.controllerSpacing,s=this.pageShape,a=s.pageWidth,o=s.pageHeight,l=this.pageViews.length>=2,u=t.maybeAppendByClassName(lr.controller,"g");if(xc(u.node(),l),!!l){var c=Re(this.attributes,"button"),d=Re(this.attributes,"pageNum"),h=$(gi(c),2),f=h[0],g=h[1],v=f.size,p=Vt(f,["size"]),y=!u.select(lr.prevBtnGroup.class).node(),b=u.maybeAppendByClassName(lr.prevBtnGroup,"g").styles(g);this.prevBtnGroup=b.node();var E=b.maybeAppendByClassName(lr.prevBtn,"path"),T=u.maybeAppendByClassName(lr.nextBtnGroup,"g").styles(g);this.nextBtnGroup=T.node();var S=T.maybeAppendByClassName(lr.nextBtn,"path");[E,S].forEach(function(A){A.styles(ue(ue({},p),{transformOrigin:"center"})),vg(A.node(),v)});var k=u.maybeAppendByClassName(lr.pageInfoGroup,"g");this.pageInfoGroup=k.node(),k.maybeAppendByClassName(lr.pageInfo,"text").styles(d),this.updatePageInfo(),u.node().setLocalPosition(a+i,o/2),y&&(this.prevBtnGroup.addEventListener("click",function(){n.prev()}),this.nextBtnGroup.addEventListener("click",function(){n.next()}))}},e.prototype.render=function(t,n){var i=t.x,s=i===void 0?0:i,a=t.y,o=a===void 0?0:a;this.attr("transform","translate(".concat(s,", ").concat(o,")"));var l=Me(n);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,n=vo(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(Ue.INSERTED,n),this.playWindow.addEventListener(Ue.REMOVED,n)},e}(Lt);function I4(r,e,t){var n=1.4,i=n*t;return[["M",r-t,e-i],["L",r+t,e-i],["L",r+t,e+i],["L",r-t,e+i],["Z"]]}var bw=1.4,ww=.4;function R4(r,e,t){var n=t,i=n*bw,s=n/2,a=n/6,o=r+i*ww;return[["M",r,e],["L",o,e+s],["L",r+i,e+s],["L",r+i,e-s],["L",o,e-s],["Z"],["M",o,e+a],["L",r+i-2,e+a],["M",o,e-a],["L",r+i-2,e-a]]}function j4(r,e,t){var n=t,i=n*bw,s=n/2,a=n/6,o=e+i*ww;return[["M",r,e],["L",r-s,o],["L",r-s,e+i],["L",r+s,e+i],["L",r+s,o],["Z"],["M",r-a,o],["L",r-a,e+i-2],["M",r+a,o],["L",r+a,e+i-2]]}at.registerSymbol("hiddenHandle",I4);at.registerSymbol("verticalHandle",R4);at.registerSymbol("horizontalHandle",j4);function bf(r,e,t){return r===void 0&&(r="horizontal"),r==="horizontal"?e:t}var Hn=kr({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function B4(r){var e=r.querySelector(Hn.marker.class);return e?e.style:{}}var z4=function(r){Ye(e,r);function e(t){return r.call(this,t,{span:[1,1],marker:function(){return new pi({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,n=this.valueGroup,i=this.attributes.markerSize,s=t.node().getBBox(),a=s.width,o=s.height,l=n.node().getBBox(),u=l.width,c=l.height;return{markerWidth:i,labelWidth:a,valueWidth:u,height:Math.max(i,o,c)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var n=$(vn(t),2),i=n[0],s=n[1],a=this.showValue?s:0,o=i+a;return[i/o,a/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,n=this.attributes,i=n.markerSize,s=n.width,a=this.actualSpace,o=a.markerWidth,l=a.height,u=this.actualSpace,c=u.labelWidth,d=u.valueWidth,h=$(this.spacing,2),f=h[0],g=h[1];if(s){var v=s-i-f-g,p=$(this.span,2),y=p[0],b=p[1];t=$([y*v,b*v],2),c=t[0],d=t[1]}var E=o+c+d+f+g;return{width:E,height:l,markerWidth:o,labelWidth:c,valueWidth:d}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var n=$(vn(t),2),i=n[0],s=n[1];return this.showValue?[i,s]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,n=t.markerWidth,i=t.labelWidth,s=t.valueWidth,a=t.width,o=t.height,l=$(this.spacing,2),u=l[0],c=l[1];return{height:o,width:a,markerWidth:n,labelWidth:i,valueWidth:s,position:[n/2,n+u,n+i+u+c]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=B4(this.markerGroup.node()),n=this.attributes,i=n.markerSize,s=n.markerStrokeWidth,a=s===void 0?t.strokeWidth:s,o=n.markerLineWidth,l=o===void 0?t.lineWidth:o,u=n.markerStroke,c=u===void 0?t.stroke:u,d=+(a||l||(c?1:0))*Math.sqrt(2),h=this.markerGroup.node().getBBox(),f=h.width,g=h.height;return(1-d/Math.max(f,g))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var n=this,i=this.attributes.marker,s=Re(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(Hn.markerGroup,"g").style("zIndex",0),tr(!!i,this.markerGroup,function(){var a,o=n.markerGroup.node(),l=(a=o.childNodes)===null||a===void 0?void 0:a[0],u=typeof i=="string"?new at({style:{symbol:i},className:Hn.marker.name}):i();l?u.nodeName===l.nodeName?l instanceof at?l.update(ue(ue({},s),{symbol:i})):(wI(l,u),Me(l).styles(s)):(l.remove(),Me(u).attr("className",Hn.marker.name).styles(s),o.appendChild(u)):(u instanceof at||Me(u).attr("className",Hn.marker.name).styles(s),o.appendChild(u)),n.markerGroup.node().scale(1/n.markerGroup.node().getScale()[0]);var c=vg(n.markerGroup.node(),n.scaleSize);n.markerGroup.node().style._transform="scale(".concat(c,")")})},e.prototype.renderLabel=function(t){var n=Re(this.attributes,"label"),i=n.text,s=Vt(n,["text"]);this.labelGroup=t.maybeAppendByClassName(Hn.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(Hn.label,function(){return fi(i)}).styles(s)},e.prototype.renderValue=function(t){var n=this,i=Re(this.attributes,"value"),s=i.text,a=Vt(i,["text"]);this.valueGroup=t.maybeAppendByClassName(Hn.valueGroup,"g").style("zIndex",0),tr(this.showValue,this.valueGroup,function(){n.valueGroup.maybeAppendByClassName(Hn.value,function(){return fi(s)}).styles(a)})},e.prototype.renderBackground=function(t){var n=this.shape,i=n.width,s=n.height,a=Re(this.attributes,"background");this.background=t.maybeAppendByClassName(Hn.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(Hn.background,"rect").styles(ue({width:i,height:s},a))},e.prototype.adjustLayout=function(){var t=this.layout,n=t.labelWidth,i=t.valueWidth,s=t.height,a=$(t.position,3),o=a[0],l=a[1],u=a[2],c=s/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(c,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(c,")")}),ff(this.labelGroup.select(Hn.label.class).node(),Math.ceil(n)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(u,", ").concat(c,")")}),ff(this.valueGroup.select(Hn.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,n){var i=Me(n),s=t.x,a=s===void 0?0:s,o=t.y,l=o===void 0?0:o;i.styles({transform:"translate(".concat(a,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(Lt),ls=kr({page:"item-page",navigator:"navigator",item:"item"},"items"),K0=function(r,e,t){return t===void 0&&(t=!0),r?e(r):t},F4=function(r){Ye(e,r);function e(t){var n=r.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:td,mouseenter:td,mouseleave:td})||this;return n.navigatorShape=[0,0],n}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,n=t.gridRow,i=t.gridCol,s=t.data;if(!n&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return n&&i?[n,i]:n?[n,s.length]:[s.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,n=t.data,i=t.layout,s=Re(this.attributes,"item"),a=n.map(function(o,l){var u=o.id,c=u===void 0?l:u,d=o.label,h=o.value;return{id:"".concat(c),index:l,style:ue({layout:i,labelText:d,valueText:h},Object.fromEntries(Object.entries(s).map(function(f){var g=$(f,2),v=g[0],p=g[1];return[v,fr(p,[o,l,n])]})))}});return a},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,n=this.attributes,i=n.orientation,s=n.width,a=n.rowPadding,o=n.colPadding,l=$(this.navigatorShape,1),u=l[0],c=$(this.grid,2),d=c[0],h=c[1],f=h*d,g=0;return this.pageViews.children.map(function(v,p){var y,b,E=Math.floor(p/f),T=p%f,S=t.ifHorizontal(h,d),k=[Math.floor(T/S),T%S];i==="vertical"&&k.reverse();var A=$(k,2),O=A[0],C=A[1],P=(s-u-(h-1)*o)/h,L=v.getBBox().height,R=$([0,0],2),z=R[0],Y=R[1];return i==="horizontal"?(y=$([g,O*(L+a)],2),z=y[0],Y=y[1],g=C===h-1?0:g+P+o):(b=$([C*(P+o),g],2),z=b[0],Y=b[1],g=O===d-1?0:g+L+a),{page:E,index:p,row:O,col:C,pageIndex:T,width:P,height:L,x:z,y:Y}})},e.prototype.getFlexLayout=function(){var t=this.attributes,n=t.width,i=t.height,s=t.rowPadding,a=t.colPadding,o=$(this.navigatorShape,1),l=o[0],u=$(this.grid,2),c=u[0],d=u[1],h=$([n-l,i],2),f=h[0],g=h[1],v=$([0,0,0,0,0,0,0,0],8),p=v[0],y=v[1],b=v[2],E=v[3],T=v[4],S=v[5],k=v[6],A=v[7];return this.pageViews.children.map(function(O,C){var P,L,R,z,Y=O.getBBox(),U=Y.width,V=Y.height,W=k===0?0:a,F=k+W+U;if(F<=f&&K0(T,function(re){return re<d}))return P=$([k+W,A,F],3),p=P[0],y=P[1],k=P[2],{width:U,height:V,x:p,y,page:b,index:C,pageIndex:E++,row:S,col:T++};L=$([S+1,0,0,A+V+s],4),S=L[0],T=L[1],k=L[2],A=L[3];var K=A+V;return K<=g&&K0(S,function(re){return re<c})?(R=$([k,A,U],3),p=R[0],y=R[1],k=R[2],{width:U,height:V,x:p,y,page:b,index:C,pageIndex:E++,row:S,col:T++}):(z=$([0,0,U,0,b+1,0,0,0],8),p=z[0],y=z[1],k=z[2],A=z[3],b=z[4],E=z[5],S=z[6],T=z[7],{width:U,height:V,x:p,y,page:b,index:C,pageIndex:E++,row:S,col:T++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,n=t.call(this);return n.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):n},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,n){var i=this.attributes.orientation;return bf(i,t,n)},e.prototype.flattenPage=function(t){t.querySelectorAll(ls.item.class).forEach(function(n){t.appendChild(n)}),t.querySelectorAll(ls.page.class).forEach(function(n){var i=t.removeChild(n);i.destroy()})},e.prototype.renderItems=function(t){var n=this.attributes,i=n.click,s=n.mouseenter,a=n.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);Me(t).selectAll(ls.item.class).data(this.renderData,function(l){return l.id}).join(function(l){return l.append(function(u){var c=u.style;return new z4({style:c})}).attr("className",ls.item.name).on("click",function(){i==null||i(this),o("itemClick",{item:this})}).on("pointerenter",function(){s==null||s(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){a==null||a(this),o("itemMouseleave",{item:this})})},function(l){return l.each(function(u){var c=u.style;this.update(c)})},function(l){return l.remove()})},e.prototype.relayoutNavigator=function(){var t,n=this.attributes,i=n.layout,s=n.width,a=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,o=$(this.navigatorShape,2),l=o[0],u=o[1];this.navigator.update(i==="grid"?{pageWidth:s-l,pageHeight:a-u}:{})},e.prototype.adjustLayout=function(){var t=this,n=Object.entries(iI(this.itemsLayout,"page")).map(function(s){var a=$(s,2),o=a[0],l=a[1];return{page:o,layouts:l}}),i=ke([],$(this.navigator.getContainer().children),!1);n.forEach(function(s){var a=s.layouts,o=t.pageViews.appendChild(new Jt({className:ls.page.name}));a.forEach(function(l){var u=l.x,c=l.y,d=l.index,h=l.width,f=l.height,g=i[d];o.appendChild(g),eo(g,"__layout__",l),g.update({x:u,y:c,width:h,height:f})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var n=this.attributes.orientation,i=Re(this.attributes,"nav"),s=on({orientation:n},i),a=this;return t.selectAll(ls.navigator.class).data(["nav"]).join(function(o){return o.append(function(){return new D4({style:s})}).attr("className",ls.navigator.name).each(function(){a.navigator=this})},function(o){return o.each(function(){this.update(s)})},function(o){return o.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,n){var i=this.attributes.data;if(!(!i||i.length===0)){var s=this.renderNavigator(Me(n));this.renderItems(s.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,n){var i=new Wt(t,{detail:n});this.dispatchEvent(i)},e}(Lt),_a=kr({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),xw={showLabel:!0,formatter:function(r){return r.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};(function(r){Ye(e,r);function e(t){return r.call(this,t,xw)||this}return e.prototype.render=function(t,n){var i=Me(n).maybeAppendByClassName(_a.markerGroup,"g");this.renderMarker(i);var s=Me(n).maybeAppendByClassName(_a.labelGroup,"g");this.renderLabel(s)},e.prototype.renderMarker=function(t){var n=this,i=this.attributes,s=i.orientation,a=i.markerSymbol,o=a===void 0?bf(s,"horizontalHandle","verticalHandle"):a;tr(!!o,t,function(l){var u=Re(n.attributes,"marker"),c=ue({symbol:o},u);n.marker=l.maybeAppendByClassName(_a.marker,function(){return new at({style:c})}).update(c)})},e.prototype.renderLabel=function(t){var n=this,i=this.attributes,s=i.showLabel,a=i.orientation,o=i.spacing,l=o===void 0?0:o,u=i.formatter;tr(s,t,function(c){var d,h=Re(n.attributes,"label"),f=h.text,g=Vt(h,["text"]),v=((d=c.select(_a.marker.class))===null||d===void 0?void 0:d.node().getBBox())||{},p=v.width,y=p===void 0?0:p,b=v.height,E=b===void 0?0:b,T=$(bf(a,[0,E+l,"center","top"],[y+l,0,"start","middle"]),4),S=T[0],k=T[1],A=T[2],O=T[3];c.maybeAppendByClassName(_a.label,"text").styles(ue(ue({},g),{x:S,y:k,text:u(f).toString(),textAlign:A,textBaseline:O}))})},e})(Lt);var Ew={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},$4=on({},Ew,{});on({},Ew,Ks(xw,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var La=kr({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),W4=function(r){Ye(e,r);function e(t){return r.call(this,t,$4)||this}return e.prototype.renderTitle=function(t,n,i){var s=this.attributes,a=s.showTitle,o=s.titleText,l=Re(this.attributes,"title"),u=$(gi(l),2),c=u[0],d=u[1];this.titleGroup=t.maybeAppendByClassName(La.titleGroup,"g").styles(d);var h=ue(ue({width:n,height:i},c),{text:a?o:""});this.title=this.titleGroup.maybeAppendByClassName(La.title,function(){return new A4({style:h})}).update(h)},e.prototype.renderItems=function(t,n){var i=n.x,s=n.y,a=n.width,o=n.height,l=Re(this.attributes,"title",!0),u=$(gi(l),2),c=u[0],d=u[1],h=ue(ue({},c),{width:a,height:o,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(La.itemsGroup,"g").styles(ue(ue({},d),{transform:"translate(".concat(i,", ").concat(s,")")}));var f=this;this.itemsGroup.selectAll(La.items.class).data(["items"]).join(function(g){return g.append(function(){return new F4({style:h})}).attr("className",La.items.name).each(function(){f.items=Me(this)})},function(g){return g.update(h)},function(g){return g.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var n=this.title.node().getAvailableSpace(),i=n.x,s=n.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(s,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,n=t.showTitle,i=t.width,s=t.height;return n?this.title.node().getAvailableSpace():new _n(0,0,i,s)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,n,i=(t=this.title)===null||t===void 0?void 0:t.node(),s=(n=this.items)===null||n===void 0?void 0:n.node();return!i||!s?r.prototype.getBBox.call(this):O4(i,s)},e.prototype.render=function(t,n){var i=this.attributes,s=i.width,a=i.height,o=i.x,l=o===void 0?0:o,u=i.y,c=u===void 0?0:u,d=Me(n);n.style.transform="translate(".concat(l,", ").concat(c,")"),this.renderTitle(d,s,a),this.renderItems(d,this.availableSpace),this.adjustLayout()},e}(Lt),G4={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(r){return r.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},ch=kr({background:"background",labelGroup:"label-group",label:"label"},"indicator"),Y4=function(r){Ye(e,r);function e(t){var n=r.call(this,t,G4)||this;return n.point=[0,0],n.group=n.appendChild(new Jt({})),n.isMutationObserved=!0,n}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,n=t.position,i=t.padding,s=$(vn(i),4),a=s[0],o=s[1],l=s[2],u=s[3],c=this.label.node().getLocalBounds(),d=c.min,h=c.max,f=new _n(d[0]-u,d[1]-a,h[0]+o-d[0]+u,h[1]+l-d[1]+a),g=this.getPath(n,f),v=Re(this.attributes,"background");this.background=Me(this.group).maybeAppendByClassName(ch.background,"path").styles(ue(ue({},v),{d:g})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,n=t.formatter,i=t.labelText,s=Re(this.attributes,"label"),a=$(gi(s),2),o=a[0],l=a[1];o.text;var u=Vt(o,["text"]);if(this.label=Me(this.group).maybeAppendByClassName(ch.labelGroup,"g").styles(l),!!i){var c=this.label.maybeAppendByClassName(ch.label,function(){return fi(n(i))}).style("text",n(i).toString());c.selectAll("text").styles(u)}},e.prototype.adjustLayout=function(){var t=$(this.point,2),n=t[0],i=t[1],s=this.attributes,a=s.x,o=s.y;this.group.attr("transform","translate(".concat(a-n,", ").concat(o-i,")"))},e.prototype.getPath=function(t,n){var i=this.attributes.radius,s=n.x,a=n.y,o=n.width,l=n.height,u=[["M",s+i,a],["L",s+o-i,a],["A",i,i,0,0,1,s+o,a+i],["L",s+o,a+l-i],["A",i,i,0,0,1,s+o-i,a+l],["L",s+i,a+l],["A",i,i,0,0,1,s,a+l-i],["L",s,a+i],["A",i,i,0,0,1,s+i,a],["Z"]],c={top:4,right:6,bottom:0,left:2},d=c[t],h=this.createCorner([u[d].slice(-2),u[d+1].slice(-2)]);return u.splice.apply(u,ke([d+1,1],$(h),!1)),u[0][0]="M",u},e.prototype.createCorner=function(t,n){n===void 0&&(n=10);var i=.8,s=bI.apply(void 0,ke([],$(t),!1)),a=$(t,2),o=$(a[0],2),l=o[0],u=o[1],c=$(a[1],2),d=c[0],h=c[1],f=$(s?[d-l,[l,d]]:[h-u,[u,h]],2),g=f[0],v=$(f[1],2),p=v[0],y=v[1],b=g/2,E=g/Math.abs(g),T=n*E,S=T/2,k=T*Math.sqrt(3)/2*i,A=$([p,p+b-S,p+b,p+b+S,y],5),O=A[0],C=A[1],P=A[2],L=A[3],R=A[4];return s?(this.point=[P,u-k],[["L",O,u],["L",C,u],["L",P,u-k],["L",L,u],["L",R,u]]):(this.point=[l+k,P],[["L",l,O],["L",l,C],["L",l+k,P],["L",l,L],["L",l,R]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?Er(this):Co(this)},e.prototype.bindEvents=function(){this.label.on(Ue.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Lt);function wf(r){return r===void 0&&(r=""),{CONTAINER:"".concat(r,"tooltip"),TITLE:"".concat(r,"tooltip-title"),LIST:"".concat(r,"tooltip-list"),LIST_ITEM:"".concat(r,"tooltip-list-item"),NAME:"".concat(r,"tooltip-list-item-name"),MARKER:"".concat(r,"tooltip-list-item-marker"),NAME_LABEL:"".concat(r,"tooltip-list-item-name-label"),VALUE:"".concat(r,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(r,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(r,"tooltip-crosshair-y")}}var Q0={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function V4(r){var e;r===void 0&&(r="");var t=wf(r);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=ue({flex:1},Q0),e[".".concat(t.VALUE)]=ue({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},Q0),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var U4=function(r){Ye(e,r);function e(t){var n=this,i,s,a=(s=(i=t.style)===null||i===void 0?void 0:i.template)===null||s===void 0?void 0:s.prefixCls,o=wf(a);return n=r.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:V4(a)})||this,n.timestamp=-1,n.prevCustomContentKey=n.attributes.contentKey,n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,n=this.element.offsetHeight;return{width:t,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,n=t.data,i=t.template;return n.map(function(s,a){var o=s.name,l=o===void 0?"":o,u=s.color,c=u===void 0?"black":u,d=s.index,h=Vt(s,["name","color","index"]),f=ue({name:l,color:c,index:d??a},h);return Nh(c2(i.item,f))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),r.prototype.destroy.call(this)},e.prototype.show=function(t,n){var i=this;if(t!==void 0&&n!==void 0){var s=this.element.style.visibility==="hidden",a=function(){i.attributes.x=t??i.attributes.x,i.attributes.y=n??i.attributes.y,i.updatePosition()};s?this.closeTransition(a):a()}this.element.style.visibility="visible"},e.prototype.hide=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,n)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=Nh(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:E0(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,n,i=this.attributes,s=i.template,a=i.title,o=i.enterable,l=i.style,u=i.content,c=wf(s.prefixCls),d=this.element;if(this.element.style.pointerEvents=o?"auto":"none",u)this.renderCustomContent();else{a?(d.innerHTML=s.title,d.getElementsByClassName(c.TITLE)[0].innerHTML=a):(n=(t=d.getElementsByClassName(c.TITLE))===null||t===void 0?void 0:t[0])===null||n===void 0||n.remove();var h=this.HTMLTooltipItemsElements,f=document.createElement("ul");f.className=c.LIST,E0(f,h);var g=this.element.querySelector(".".concat(c.LIST));g?g.replaceWith(f):d.appendChild(f)}MI(d,l)},e.prototype.getRelativeOffsetFromCursor=function(t){var n=this.attributes,i=n.position,s=n.offset,a=t||i,o=a.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},u=this.elementSize,c=u.width,d=u.height,h=[-c/2,-d/2];return o.forEach(function(f){var g=$(h,2),v=g[0],p=g[1],y=$(l[f],2),b=y[0],E=y[1];h=[v+(c/2+s[0])*b,p+(d/2+s[1])*E]}),h},e.prototype.setOffsetPosition=function(t){var n=$(t,2),i=n[0],s=n[1],a=this.attributes,o=a.x,l=o===void 0?0:o,u=a.y,c=u===void 0?0:u,d=a.container,h=d.x,f=d.y;this.element.style.left="".concat(+l+h+i,"px"),this.element.style.top="".concat(+c+f+s,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,n=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<n||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var n=$(t,2),i=n[0],s=n[1],a=this.attributes,o=a.x,l=a.y,u=a.bounding,c=a.position;if(!u)return[i,s];var d=this.element,h=d.offsetWidth,f=d.offsetHeight,g=$([+o+i,+l+s],2),v=g[0],p=g[1],y={left:"right",right:"left",top:"bottom",bottom:"top"},b=u.x,E=u.y,T=u.width,S=u.height,k={left:v<b,right:v+h>b+T,top:p<E,bottom:p+f>E+S},A=[];c.split("-").forEach(function(C){k[C]?A.push(y[C]):A.push(C)});var O=A.join("-");return this.getRelativeOffsetFromCursor(O)},e.prototype.isCursorEntered=function(t,n){if(this.element){var i=this.element.getBoundingClientRect(),s=i.x,a=i.y,o=i.width,l=i.height;return new _n(s,a,o,l).isPointIn(t,n)}return!1},e.prototype.closeTransition=function(t){var n=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){n.element.style.transition=i},10)},e.tag="tooltip",e}(Lt),H4=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},e.defaultOptions,t))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new pn({})),n.label=n.background.appendChild(new Jt({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return vn(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,n=t.label,i=t.value,s=Re(this.attributes,"label");Me(this.label).maybeAppend(".label",function(){return fi(n)}).attr("className","label").styles(s),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),n=$(this.padding,4),i=n[0],s=n[1],a=n[2],o=n[3],l=t.width,u=t.height,c=l+o+s,d=u+i+a,h=Re(this.attributes,"background"),f=this.style,g=f.width,v=g===void 0?0:g,p=f.height,y=p===void 0?0:p,b=f.selected;this.background.attr(ue(ue({},h),{width:Math.max(c,v),height:Math.max(d,y),fill:b?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((d-u)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var n=this;this.addEventListener("click",function(){var i=t.style,s=i.label,a=i.value,o=i.onClick;o==null||o(a,{label:s,value:a},n)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(Lt),X4=function(r){Ye(e,r);function e(t){var n,i,s=r.call(this,on({},e.defaultOptions,t))||this;s.currentValue=(n=e.defaultOptions.style)===null||n===void 0?void 0:n.defaultValue,s.isPointerInSelect=!1,s.select=s.appendChild(new pn({className:"select",style:{cursor:"pointer",width:0,height:0}})),s.dropdown=s.appendChild(new pn({className:"dropdown"}));var a=s.style.defaultValue;return a&&(!((i=s.style.options)===null||i===void 0)&&i.some(function(o){return o.value===a}))&&(s.currentValue=a),s}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return vn(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,n,i=this.style,s=i.x,a=i.y,o=i.width,l=i.height,u=i.bordered,c=i.showDropdownIcon,d=Re(this.attributes,"select"),h=Re(this.attributes,"placeholder");this.select.attr(ue(ue({x:s,y:a,width:o,height:l},d),{fill:"#fff",strokeWidth:u?1:0}));var f=this.dropdownPadding,g=10;c&&Me(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(s+o-g-f[1]-f[3],", ").concat(a+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(n=this.style.options)===null||n===void 0?void 0:n.find(function(E){return E.value===t.currentValue}),p=ue({x:s+f[3]},h);Me(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(E){return E.append("text").attr("className","placeholder").styles(p).style("y",function(){var T=this.getBBox();return a+(l-T.height)/2})},function(E){return E.styles(p)},function(E){return E.remove()});var y=Re(this.attributes,"optionLabel"),b=ue({x:s+f[3]},y);Me(this.select).selectAll(".value").data(v?[v]:[]).join(function(E){return E.append(function(T){return fi(T.label)}).attr("className","value").styles(b).style("y",function(){var T=this.getBBox();return a+(l-T.height)/2})},function(E){return E.styles(b)},function(E){return E.remove()})},e.prototype.renderDropdown=function(){var t=this,n,i,s=this.style,a=s.x,o=s.y,l=s.width,u=s.height,c=s.options,d=s.onSelect,h=s.open,f=Re(this.attributes,"dropdown"),g=Re(this.attributes,"option"),v=this.dropdownPadding;Me(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(c,function(b){return b.value}).join(function(b){return b.append(function(E){return new H4({className:"dropdown-item",style:ue(ue(ue({},E),g),{width:l-v[1]-v[3],selected:E.value===t.currentValue,onClick:function(T,S,k){t.setValue(T),d==null||d(T,S,k),t.dispatchEvent(new Wt("change",{detail:{value:T,option:S,item:k}})),Er(t.dropdown)}})})}).each(function(E,T){var S,k=(S=this.parentNode)===null||S===void 0?void 0:S.children,A=k.reduce(function(O,C,P){return P<T&&(O+=C.getBBox().height),O},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+A,")"))})},function(b){return b.update(function(E){return{selected:E.value===t.currentValue}})},function(b){return b.remove()});var p=(i=(n=this.dropdown.getElementsByClassName("dropdown-container"))===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.getBBox(),y=f.spacing;this.dropdown.attr(ue({transform:"translate(".concat(a,", ").concat(o+u+y,")"),width:p.width+v[1]+v[3],height:p.height+v[0]+v[2]},f)),!h&&Er(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(n){n.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?Er(t.dropdown):Co(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||Er(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(Lt),Nr=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return n.showBackground=!0,n.background=n.appendChild(new pn({})),n.icon=n.appendChild(new Jt({})),n}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return vn(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,n=$(this.padding,4),i=n[0],s=n[1],a=n[2],o=n[3];return Math.max(t-Math.max(o+s,i+a),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,s=t.size,a=s/2,o=Re(this.attributes,"background");this.background.attr(ue({x:n-a,y:i-a,width:s,height:s},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,n=this.background.getBBox(),i=n.x,s=n.y;this.indicator.update({x:i+t/2,y:s-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;r.prototype.connectedCallback.call(this);var n=this.attributes.size,i=this.background.getBBox(),s=i.x,a=i.y,o=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;o&&(this.indicator=o.appendChild(new Y4({style:{x:s+n/2,y:a-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){n==null||n(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},s=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){s(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){a()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(Lt),fo=function(r,e){return e===void 0&&(e="#565758"),new Kn({style:{fill:e,d:"M ".concat(r,",").concat(r," L -").concat(r,",0 L ").concat(r,",-").concat(r," Z"),transformOrigin:"center"}})},q4=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.arcPath=function(t,n,i){var s=$([i,i],2),a=s[0],o=s[1],l=function(v){return[t+i*Math.cos(v),n+i*Math.sin(v)]},u=$(l(-5/4*Math.PI),2),c=u[0],d=u[1],h=$(l(1/4*Math.PI),2),f=h[0],g=h[1];return"M".concat(c,",").concat(d,",A").concat(a,",").concat(o,",0,1,1,").concat(f,",").concat(g)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this.iconSize,o=this.lineWidth,l=o+.5;Me(this.icon).maybeAppend(".reset","path").styles({stroke:s,lineWidth:o,d:this.arcPath(n,i,a/2-o),markerStart:fo(l,s)})},e}(Nr),Z4=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this.iconSize,o=a/2,l=a/2/Math.pow(3,.5),u=[[n,i],[n,i-l],[n-o,i],[n,i+l],[n,i],[n+o,i-l],[n+o,i+l],[n,i]];Me(this.icon).maybeAppend(".backward","polygon").styles({points:u,fill:s})},e}(Nr),K4=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this.iconSize,o=a/2,l=a/2/Math.pow(3,.5),u=[[n,i],[n,i-l],[n+o,i],[n,i+l],[n,i],[n-o,i-l],[n-o,i+l],[n,i]];Me(this.icon).maybeAppend(".forward","polygon").styles({points:u,fill:s})},e}(Nr),Q4=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this.iconSize,o=a/3*Math.pow(3,.5)*.8,l=[[n+o,i],[n-o/2,i-a/2*.8],[n-o/2,i+a/2*.8],[n+o,i]];Me(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:s})},e}(Nr),J4=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this.iconSize,o=a/3,l=[[n-o,i-a/2],[n-o,i+a/2],[n-o/2,i+a/2],[n-o/2,i-a/2],[n-o,i-a/2],[n+o/2,i-a/2],[n+o/2,i+a/2],[n+o,i+a/2],[n+o,i-a/2]];Me(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:s})},e}(Nr),e5=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this,o=a.iconSize,l=a.lineWidth,u=l;Me(this.icon).maybeAppend(".left-line","line").styles({x1:n-o/2,y1:i-o/2,x2:n-o/2,y2:i+o/2,stroke:s,lineWidth:l}),Me(this.icon).maybeAppend(".right-line","line").styles({x1:n+o/2,y1:i-o/2,x2:n+o/2,y2:i+o/2,stroke:s,lineWidth:l}),Me(this.icon).maybeAppend(".left-arrow","line").styles({x1:n,y1:i,x2:n-o/2+u*2,y2:i,stroke:s,lineWidth:l,markerEnd:fo(l*2,s)}),Me(this.icon).maybeAppend(".right-arrow","line").styles({x1:n,y1:i,x2:n+o/2-u*2,y2:i,stroke:s,lineWidth:l,markerEnd:fo(l*2,s)})},e}(Nr),t5=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this,o=a.iconSize,l=a.lineWidth;Me(this.icon).maybeAppend(".line","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:s,lineWidth:l});var u=l;Me(this.icon).maybeAppend(".left-arrow","line").styles({x1:n-o/2-u*2,y1:i,x2:n-u*2,y2:i,stroke:s,lineWidth:l,markerEnd:fo(l*2,s)}),Me(this.icon).maybeAppend(".right-arrow","line").styles({x1:n+o/2+u*2,y1:i,x2:n+u*2,y2:i,stroke:s,lineWidth:l,markerEnd:fo(l*2,s)})},e}(Nr),Mw=function(r){return[[-r/2,-r/2],[-r/2,r/2],[r/2,r/2]]},n5=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this,o=a.iconSize,l=a.lineWidth,u=l,c=(o-u*2-l)/4,d=(o-u*2-l)/2,h=$([n-o/2+u,i+o/2-u*2],2),f=h[0],g=h[1];Me(this.icon).maybeAppend(".coordinate","polyline").styles({points:Mw(o).map(function(v){var p=$(v,2),y=p[0],b=p[1];return[y+n,b+i]}),stroke:s,lineWidth:l}),Me(this.icon).maybeAppend(".line","polyline").styles({points:[[f,g],[f+c,g-d],[f+c*2,g],[f+c*4,g-d*2]],stroke:s,lineWidth:l})},e}(Nr),r5=function(r){Ye(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,n=this.attributes,i=n.x,s=n.y,a=n.color,o=this,l=o.iconSize,u=o.lineWidth,c=u,d=(l-c)/t.length,h=(l-c*2)/4,f=$([i-l/2+c*2,s+l/2-c],2),g=f[0],v=f[1];Me(this.icon).maybeAppend(".coordinate","polyline").styles({points:Mw(l).map(function(p){var y=$(p,2),b=y[0],E=y[1];return[b+i,E+s]}),stroke:a,lineWidth:u}),Me(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(p,y){return{value:p,index:y}})).join(function(p){return p.append("line").attr("className","column").style("x1",function(y){var b=y.index;return g+d*b}).style("y1",v).style("x2",function(y){var b=y.index;return g+d*b}).style("y2",function(y){var b=y.value;return v-h*b}).styles({y1:v,stroke:a,lineWidth:u})})},e}(Nr),i5=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},{style:{color:"#d8d9d9"}},t))||this;return n.showBackground=!1,n}return e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.color,a=this,o=a.iconSize,l=a.lineWidth;Me(this.icon).maybeAppend(".split","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:s,lineWidth:l})},e}(Nr),xf=function(r){Ye(e,r);function e(){var t=r.apply(this,ke([],$(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return vn(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,n=this.attributes,i=n.x,s=n.y,a=n.speed,o=a===void 0?1:a,l=Cf(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),u=At(t,20,1/0),c=20,d=ue(ue({},l),{x:i-u/2,y:s-c/2,width:u,height:c,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Me(this.icon).maybeAppend(".speed",function(){return new X4({style:d})}).attr("className","speed").each(function(){this.update(d)})},e.tag="SpeedSelect",e}(Nr),Tg=function(r){Ye(e,r);function e(t){var n=r.call(this,t)||this;return n.icon=n.appendChild(new Jt({})),n.currentType=n.attributes.type,n}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,n=this.attributes;n.onChange;var i=Vt(n,["onChange"]);Me(this.icon).selectAll(".icon").data([this.currentType]).join(function(s){return s.append(function(a){var o,l=(o=t.toggles.find(function(u){var c=$(u,1),d=c[0];return d===a}))===null||o===void 0?void 0:o[1];if(!l)throw new Error("Invalid type: ".concat(a));return new l({})}).attr("className","icon").styles(i,!1).update({})},function(s){return s.styles({restStyles:i}).update({})},function(s){return s.remove()})},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var s=(t.toggles.findIndex(function(o){var l=$(o,1),u=l[0];return u===t.currentType})+1)%t.toggles.length,a=t.toggles[s][0];n==null||n(t.currentType),t.currentType=a,t.render()})},e.tag="ToggleIcon",e}(Lt),Ef=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},{style:{type:"play"}},t))||this;return n.toggles=[["play",Q4],["pause",J4]],n}return e}(Tg),Mf=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},{style:{type:"range"}},t))||this;return n.toggles=[["range",e5],["value",t5]],n}return e}(Tg),Sf=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},{style:{type:"column"}},t))||this;return n.toggles=[["line",n5],["column",r5]],n}return e}(Tg),s5={reset:q4,speed:xf,backward:Z4,playPause:Ef,forward:K4,selectionType:Mf,chartType:Sf,split:i5},a5=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},e.defaultOptions,t))||this;return n.background=n.appendChild(new pn({})),n.functions=n.appendChild(new Jt({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return vn(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,n=t.x,i=t.y,s=t.width,a=t.height,o=Re(this.attributes,"background");this.background.attr(ue({x:n,y:i,width:s,height:a},o))},e.prototype.renderFunctions=function(){var t=this,n,i=this.attributes,s=i.functions,a=i.iconSize,o=i.iconSpacing,l=i.x,u=i.y,c=i.width,d=i.height,h=i.align,f=$(this.padding,4),g=f[1],v=f[3],p=s.reduce(function(E,T){return E.length&&T.length?E.concat.apply(E,ke(["split"],$(T),!1)):E.concat.apply(E,ke([],$(T),!1))},[]),y=p.length*(a+o)-o,b={left:v+a/2,center:(c-y)/2+a/2,right:c-y-v-g+a/2}[h]||0;(n=this.speedSelect)===null||n===void 0||n.destroy(),this.functions.removeChildren(),p.forEach(function(E,T){var S,k=s5[E],A={x:l+T*(a+o)+b,y:u+d/2,size:a};if(k===xf?(A.speed=t.attributes.speed,A.onSelect=function(C){return t.handleFunctionChange(E,{value:C})}):[Ef,Mf,Sf].includes(k)?(A.onChange=function(C){return t.handleFunctionChange(E,{value:C})},k===Ef&&(A.type=t.attributes.state==="play"?"pause":"play"),k===Mf&&(A.type=t.attributes.selectionType==="range"?"value":"range"),k===Sf&&(A.type=t.attributes.chartType==="line"?"column":"line")):A.onClick=function(){return t.handleFunctionChange(E,{value:E})},k===xf){var O=(S=t.ownerDocument)===null||S===void 0?void 0:S.defaultView;O&&(t.speedSelect=new k({style:ue(ue({},A),{zIndex:100})}),O.appendChild(t.speedSelect))}else t.functions.appendChild(new k({style:A}))})},e.prototype.disconnectedCallback=function(){var t;r.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,n){var i=this.attributes.onChange;i==null||i(t,n)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(Lt),o5=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},e.defaultOptions,t))||this;return n.bindEvents(),n}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(pi),l5=function(r){Ye(e,r);function e(t){return r.call(this,on({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,s=t.width,a=t.height,o=Re(this.attributes,"background");Me(this).maybeAppend("background","rect").attr("className","background").styles(ue({x:n-s/2,y:i-a/2,width:s,height:a},o))},e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,s=t.iconSize,a=Re(this.attributes,"icon"),o=1,l=s/2;Me(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(ue({x1:n-o,y1:i-l,x2:n-o,y2:i+l},a)),Me(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(ue({x1:n+o,y1:i-l,x2:n+o,y2:i+l},a))},e.prototype.renderBorder=function(){var t=this.attributes,n=t.x,i=t.y,s=t.width,a=t.height,o=t.type,l=Re(this.attributes,"border"),u=o==="start"?+s/2:-s/2;Me(this).maybeAppend("border","line").attr("className","border").styles(ue({x1:u+n,y1:i-a/2,x2:u+n,y2:i+a/2},l))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(Lt);function u5(r,e){return typeof r=="number"?Sw(r):c5(r,e)}function c5(r,e){var t=new Date(r);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?jn(t,`HH:mm
YYYY-MM-DD`):jn(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(jn(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?jn(t,`DD
YYYY-MM`):jn(t,"DD");case"week":return t.getDate()<=7?jn(t,`DD
YYYY-MM`):jn(t,"DD");case"month":return[0,6].includes(t.getMonth())?jn(t,`MM
YYYY`):jn(t,"MM");case"season":return[0].includes(t.getMonth())?jn(t,`MM
YYYY`):jn(t,"MM");case"year":return jn(t,"YYYY");default:return jn(t,"YYYY-MM-DD HH:mm")}}function Sw(r){var e=String(Math.floor(r/3600)).padStart(2,"0"),t=String(Math.floor(r%3600/60)).padStart(2,"0"),n=String(Math.floor(r%60)).padStart(2,"0");return r<3600?"".concat(t,":").concat(n):"".concat(e,":").concat(t,":").concat(n)}var d5=function(r){Ye(e,r);function e(t){var n=r.call(this,on({},e.defaultOptions,t))||this;n.axis=n.appendChild(new L4({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new PR({style:{onChange:function(d){n.handleSliderChange(d)}}})),n.controller=n.appendChild(new a5({})),n.states={},n.handleSliderChange=function(d){var h=function(){var f=n.states.values;return Array.isArray(f)?ke([],$(f),!1):f}();n.setBySliderValues(d),n.dispatchOnChange(h)};var i=n.attributes,s=i.selectionType,a=i.chartType,o=i.speed,l=i.state,u=i.playMode,c=i.values;return n.states={chartType:a,playMode:u,selectionType:s,speed:o,state:l},n.setByTimebarValues(c),n}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,n=function(i,s){return i.time<s.time?-1:i.time>s.time?1:0};return t.sort(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,n=t.x,i=t.y,s=t.width,a=t.height,o=t.type,l=t.controllerHeight,u=At(+a-l,0,+a),c=new _n(n,i+ +a-l,+s,l),d,h=0;o==="chart"?(h=35,d=new _n(n,i+u-h,+s,h)):d=new _n;var f=o==="time"?10:u,g=new _n(n,i+(o==="time"?u:u-f),+s,f-h);return{axisBBox:d,controllerBBox:c,timelineBBox:g}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var n,i,s=this.data,a=$(Array.isArray(t)?t:[0,t],2),o=a[0],l=a[1],u=s.length,c=s[Math.floor(o*u)],d=s[Math.ceil(l*u)-(Array.isArray(t)?0:1)];this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:s[0].time,(i=d==null?void 0:d.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var n,i,s,a=this.data,o=$(Array.isArray(t)?t:[void 0,t],2),l=o[0],u=o[1],c=a.find(function(h){var f=h.time;return f===l}),d=a.find(function(h){var f=h.time;return f===u});this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:(i=a[0])===null||i===void 0?void 0:i.time,(s=d==null?void 0:d.time)!==null&&s!==void 0?s:1/0]},e.prototype.setByIndex=function(t){var n,i,s,a,o=this.data,l=$(t,2),u=l[0],c=l[1];this.states.values=[(i=(n=o[u])===null||n===void 0?void 0:n.time)!==null&&i!==void 0?i:o[0].time,(a=(s=this.data[c])===null||s===void 0?void 0:s.time)!==null&&a!==void 0?a:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,n=t.values,i=t.selectionType,s=$(Array.isArray(n)?n:[void 0,n],2),a=s[0],o=s[1],l=this.data,u=l.length,c=i==="value",d=function(){var f=l.findIndex(function(g){var v=g.time;return v===a});return c?0:f>-1?f/u:0},h=function(){if(o===1/0)return 1;var f=l.findIndex(function(g){var v=g.time;return v===o});return f>-1?f/u:c?.5:1};return[d(),h()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,n=t.values,i=t.selectionType,s=$(Array.isArray(n)?n:[this.data[0].time,n],2),a=s[0],o=s[1];return i==="value"?o:[a,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var n=this.data,i=n.length,s=Math.floor(t*(i-1));return n[s]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,n=this.space.timelineBBox.height;return t==="range"?function(i){return new l5({style:{type:i,height:n,iconSize:n/6}})}:function(){return new Ss({style:{x1:0,y1:-n/2,x2:0,y2:n/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var n=this,i=t.x,s=t.y,a=t.width,o=t.height,l=this.states,u=l.selectionType,c=l.chartType,d=this.data,h=this.attributes,f=h.type,g=h.labelFormatter,v=Re(this.attributes,"chart");v.type;var p=Vt(v,["type"]),y=u==="range";if(f==="time")return ue({handleIconShape:function(){return new o5({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:y?-15:0,autoFitLabel:y,handleSpacing:y?-15:0,trackFill:"#edeeef",trackLength:a,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:u,values:this.sliderValues,formatter:function(T){if(g)return g(T);var S=n.getDatumByRatio(T).time;return typeof S=="number"?Sw(S):jn(S,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(s,")"),zIndex:1},p);var b=u==="range"?5:0,E=d.map(function(T){var S=T.value;return S});return ue({handleIconOffset:b,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:E,sparklineType:c,sparklineScale:.8,trackLength:a,trackSize:o,type:u,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(s,")"),zIndex:1},p)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var n=this.data,i=this.attributes,s=i.interval,a=i.labelFormatter,o=Re(this.attributes,"axis"),l=t.x,u=t.y,c=t.width,d=ke(ke([],$(n),!1),[{time:0}],!1).map(function(f,g,v){var p=f.time;return{label:"".concat(p),value:g/(v.length-1),time:p}}),h=ue({startPos:[l,u],endPos:[l+c,u],data:d,labelFilter:function(f,g){return g<d.length-1},labelFormatter:function(f){var g=f.time;return a?a(g):u5(g,s)}},o);return h},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var n=this.attributes.type;n==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var n=this.attributes.type,i=this.states,s=i.state,a=i.speed,o=i.selectionType,l=i.chartType,u=Re(this.attributes,"controller"),c=this,d=ue(ue(ue({},t),{iconSize:20,speed:a,state:s,selectionType:o,chartType:l,onChange:function(h,f){var g=f.value;switch(h){case"reset":c.internalReset();break;case"speed":c.handleSpeedChange(g);break;case"backward":c.internalBackward();break;case"playPause":g==="play"?c.internalPlay():c.internalPause();break;case"forward":c.internalForward();break;case"selectionType":c.handleSelectionTypeChange(g);break;case"chartType":c.handleChartTypeChange(g);break}}}),u);n==="time"&&(d.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(d)},e.prototype.dispatchOnChange=function(t){var n=this.data,i=this.attributes.onChange,s=this.states,a=s.values,o=s.selectionType,l=$(a,2),u=l[0],c=l[1],d=c===1/0?n.at(-1).time:c,h=o==="range"?[u,d]:d,f=function(g,v){return Array.isArray(g)?Array.isArray(v)?g[0]===v[0]&&(g[1]===v[1]||g[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:g===v};(!t||!f(t,h))&&(i==null||i(o==="range"?[u,d]:d))},e.prototype.internalReset=function(t){var n,i,s=this.states.selectionType;this.internalPause(),this.setBySliderValues(s==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onReset)===null||i===void 0||i.call(n),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,n){var i=this.data,s=i.length,a=this.states,o=a.values,l=a.selectionType,u=a.playMode,c=$(o,2),d=c[0],h=c[1],f=i.findIndex(function(E){var T=E.time;return T===d}),g=i.findIndex(function(E){var T=E.time;return T===h});g===-1&&(g=s);var v=t==="backward"?-1:1,p;l==="range"?u==="acc"?(p=[f,g+v],v===-1&&f===g&&(p=[f,s])):p=[f+v,g+v]:p=[f,g+v];var y=function(E){var T=$(E.sort(function(O,C){return O-C}),2),S=T[0],k=T[1],A=function(O){return At(O,0,s)};return k>s?l==="value"?[0,0]:u==="acc"?[A(S),A(S)]:[0,A(k-S)]:S<0?u==="acc"?[0,A(k)]:[A(S+s-k),s]:[A(S),A(k)]},b=y(p);return this.setByIndex(b),this.updateSelection(),b},e.prototype.internalBackward=function(t){var n,i,s=this.moveSelection("backward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onBackward)===null||i===void 0||i.call(n),this.dispatchOnChange()),s},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var n=this,i,s,a=this.data,o=this.attributes.loop,l=this.states.speed,u=l===void 0?1:l;this.playInterval=window.setInterval(function(){var c=n.internalForward();c[1]===a.length&&!o&&(n.internalPause(),n.renderController())},1e3/u),this.states.state="play",!t&&((s=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||s===void 0||s.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var n,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(n=this.attributes)===null||n===void 0?void 0:n.onPause)===null||i===void 0||i.call(n))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var n,i,s=this.moveSelection("forward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onForward)===null||i===void 0||i.call(n),this.dispatchOnChange()),s},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var n,i;this.states.speed=t;var s=this.states.state;s==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSpeedChange)===null||i===void 0||i.call(n,t)},e.prototype.handleSelectionTypeChange=function(t){var n,i;this.states.selectionType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSelectionTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.handleChartTypeChange=function(t){var n,i;this.states.chartType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onChartTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.render=function(){var t=this.space,n=t.axisBBox,i=t.controllerBBox,s=t.timelineBBox;this.renderController(i),this.renderAxis(n),this.renderChart(s),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(Lt);function Og(r){const{width:e,height:t,renderer:n}=r,i=h5(r),s=new Yh({width:e,height:t,container:i,renderer:n||new so});return[i,s]}function h5(r){var e;const{container:t,className:n,graphCanvas:i}=r;if(t)return typeof t=="string"?document.getElementById(t):t;const s=wa(n,!1),{width:a,height:o,containerStyle:l}=r,[u,c]=f5(r);return Object.assign(s.style,Object.assign({position:"absolute",left:u+"px",top:c+"px",width:a+"px",height:o+"px"},l)),(e=i.getContainer())===null||e===void 0||e.appendChild(s),s}function f5(r){const{width:e,height:t,placement:n,graphCanvas:i}=r,[s,a]=i.getSize(),[o,l]=b1(n);return[o*(s-e),l*(a-t)]}var g5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class kc extends mn{constructor(e,t){super(e,Object.assign({},kc.defaultOptions,t)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:n}=this.context;n.on(fe.AFTER_DRAW,this.createElement)},this.changeState=(n,i)=>{const{graph:s}=this.context,{typePrefix:a}=this,o=An(n,[a,"id"]),l=An(n,[a,"style","labelText"]),[u]=o.split("__"),c=this.fieldMap[u].get(l)||[];s.setElementState(Object.fromEntries(c==null?void 0:c.map(d=>[d,i])))},this.click=n=>{if(this.options.trigger==="hover")return;const i=An(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?(this.selectedItems=this.selectedItems.filter(s=>s!==i),this.changeState(n,[])):(this.selectedItems.push(i),this.changeState(n,"selected"))},this.mouseleave=n=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(n,[]))},this.mouseenter=n=>{if(this.options.trigger==="click")return;const i=An(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?this.selectedItems=this.selectedItems.filter(s=>s!==i):(this.selectedItems.push(i),this.changeState(n,"active"))},this.setFieldMap=(n,i,s)=>{if(!n)return;const a=this.fieldMap[s];if(a)if(!a.has(n))a.set(n,[i]);else{const o=a.get(n);o&&(o.push(i),a.set(n,o))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(n,i)=>{if(!n)return[];const{model:s,element:a}=this.context,{nodes:o,edges:l,combos:u}=s.getData(),c={},d=p=>Ee(n)?n(p):n,h={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(p,y)=>a==null?void 0:a.getElementComputedStyle(p,y),v=(p,y)=>{p.forEach(b=>{const{id:E}=b,T=An(b,["data",d(b)]),S=(a==null?void 0:a.getElementType(y,b))||"circle",k=g(y,b),A=(y==="edge"?k==null?void 0:k.stroke:k==null?void 0:k.fill)||"#1783ff";E&&T&&T.replace(/\s+/g,"")&&(this.setFieldMap(T,E,y),c[T]||(c[T]={id:`${y}__${E}`,label:T,marker:f[S]||h[y],elementType:y,lineWidth:1,stroke:A,fill:A}))})};switch(i){case"node":v(o,"node");break;case"edge":v(l,"edge");break;case"combo":v(u,"combo");break;default:return[]}return Object.values(c)},this.createElement=()=>{if(this.draw){this.updateElement();return}const n=this.options,{width:i,height:s,nodeField:a,edgeField:o,comboField:l,trigger:u,position:c,container:d,containerStyle:h,className:f}=n,g=g5(n,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),v=this.getMarkerData(a,"node"),p=this.getMarkerData(o,"edge"),y=this.getMarkerData(l,"combo"),b=[...v,...y,...p],E=Object.assign({width:i,height:s,data:b,itemMarkerLineWidth:({lineWidth:k})=>k,itemMarker:({marker:k})=>k,itemMarkerStroke:({stroke:k})=>k,itemMarkerFill:({fill:k})=>k,gridCol:v.length},g,this.getEvents()),T=new W4({className:"legend",style:E});this.category=T,this.upsertCanvas().appendChild(T),this.draw=!0},this.bindEvents()}update(e){super.update(e),this.clear(),this.createElement()}clear(){var e,t;(e=this.canvas)===null||e===void 0||e.destroy(),(t=this.container)===null||t===void 0||t.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5,itemLabelOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const e=this.context.canvas,[t,n]=e.getSize(),{width:i=t,height:s=n,position:a,container:o,containerStyle:l,className:u}=this.options,[c,d]=Og({width:i,height:s,graphCanvas:e,container:o,containerStyle:l,placement:a,className:"legend"});return this.container=c,u&&c.classList.add(u),this.canvas=d,this.canvas}destroy(){this.clear(),this.context.graph.off(fe.AFTER_DRAW,this.createElement),super.destroy()}}kc.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Nc extends mn{constructor(e,t){super(e,Object.assign({},Nc.defaultOptions,t)),this.onDraw=n=>{var i;!((i=n==null?void 0:n.data)===null||i===void 0)&&i.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=n=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(n.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=n=>{if(!this.mask||!this.isMaskDragging)return;const{size:[i,s]}=this.options,{movementX:a,movementY:o}=n,{left:l,top:u,width:c,height:d}=this.mask.style,[,,h,f]=this.maskBBox;let g=parseInt(l)+a,v=parseInt(u)+o,p=parseInt(c),y=parseInt(d);g<0&&(g=0),v<0&&(v=0),g+p>i&&(g=xi(i-p,0)),v+y>s&&(v=xi(s-y,0)),p<h&&(a>0?(g=xi(g-a,0),p=wi(p+a,i)):a<0&&(p=wi(p-a,i))),y<f&&(o>0?(v=xi(v-o,0),y=wi(y+o,s)):o<0&&(y=wi(y-o,s))),Object.assign(this.mask.style,{left:g+"px",top:v+"px",width:p+"px",height:y+"px"});const b=parseInt(l)-g,E=parseInt(u)-v;if(b===0&&E===0)return;const T=this.context.canvas.getCamera().getZoom(),S=this.canvas.getCamera().getZoom(),k=T/S;this.context.graph.translateBy([b*k,E*k],!1)},this.onMaskDragEnd=n=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(n.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=ry(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),"delay"in e&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=vo(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){const{graph:e}=this.context;e.on(fe.AFTER_DRAW,this.onDraw),e.on(fe.AFTER_RENDER,this.onRender),e.on(fe.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(fe.AFTER_DRAW,this.onDraw),e.off(fe.AFTER_RENDER,this.onRender),e.off(fe.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const e=this.getElements(),t=this.initCanvas();this.setShapes(t,e)}getElements(){const{filter:e}=this.options,{model:t}=this.context,n=t.getData();if(!e)return n;const{nodes:i,edges:s,combos:a}=n;return{nodes:i.filter(o=>e(q(o),"node")),edges:s.filter(o=>e(q(o),"edge")),combos:a.filter(o=>e(q(o),"combo"))}}setShapes(e,t){const{nodes:n,edges:i,combos:s}=t,{shape:a}=this.options,{element:o}=this.context;if(a==="key"){const u=new Set,c=d=>{const h=q(d);u.add(h);const f=o.getElement(h);if(!f)return;const g=f.getShape("key"),v=this.shapes.get(h)||g.cloneNode();v.setPosition(g.getPosition()),f.style.zIndex&&(v.style.zIndex=f.style.zIndex),v.id=f.id,this.shapes.has(h)?Object.entries(g.attributes).forEach(([p,y])=>{v.style[p]!==y&&(v.style[p]=y)}):(e.appendChild(v),this.shapes.set(h,v))};i.forEach(c),s.forEach(c),n.forEach(c),this.shapes.forEach((d,h)=>{u.has(h)||(e.removeChild(d),this.shapes.delete(h))});return}const l=(u,c)=>{const h=o.getElement(u).getPosition();return c.setPosition(h),c};e.removeChildren(),i.forEach(u=>e.appendChild(a(q(u),"edge"))),s.forEach(u=>{e.appendChild(l(q(u),a(q(u),"combo")))}),n.forEach(u=>{e.appendChild(l(q(u),a(q(u),"node")))})}initCanvas(){const{renderer:e,size:[t,n]}=this.options;if(this.canvas){const{width:i,height:s}=this.canvas.getConfig();(t!==i||n!==s)&&this.canvas.resize(t,n),e&&this.canvas.setRenderer(e)}else{const{className:i,position:s,container:a,containerStyle:o}=this.options,[l,u]=Og({renderer:e,width:t,height:n,placement:s,className:"minimap",container:a,containerStyle:o,graphCanvas:this.context.canvas});i&&l.classList.add(i),this.container=l,this.canvas=u}return this.setCamera(),this.canvas}createLandmark(e,t,n){const i=`${e.join(",")}-${t.join(",")}-${n}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const a=this.canvas.getCamera().createLandmark(i,{position:e,focalPoint:t,zoom:n});return this.landmarkMap.set(i,a),a}setCamera(){var e;const{canvas:t}=this.context,n=(e=this.canvas)===null||e===void 0?void 0:e.getCamera();if(!n)return;const{size:[i,s],padding:a}=this.options,[o,l,u,c]=Vr(a),{min:d,max:h,center:f}=t.getBounds("elements"),g=h[0]-d[0],v=h[1]-d[1],p=i-c-l,y=s-o-u,b=p/g,E=y/v,T=Math.min(b,E),S=this.createLandmark(f,f,T);n.gotoLandmark(S,0)}get maskBBox(){const{canvas:e}=this.context,t=e.getSize(),n=e.getCanvasByViewport([0,0]),i=e.getCanvasByViewport(t),s=this.canvas.canvas2Viewport(xr(n)),a=this.canvas.canvas2Viewport(xr(i)),o=a.x-s.x,l=a.y-s.y;return[s.x,s.y,o,l]}calculateMaskBBox(){const{size:[e,t]}=this.options;let[n,i,s,a]=this.maskBBox;return n<0&&(s=wi(s+n,e),n=0),i<0&&(a=wi(a+i,t),i=0),n+s>e&&(s=xi(e-n,0)),i+a>t&&(a=xi(t-i,0)),[wi(n,e),wi(i,t),xi(s,0),xi(a,0)]}renderMask(){const{maskStyle:e}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},e),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[e,t,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:t+"px",left:e+"px",width:n+"px",height:i+"px"})}destroy(){var e;this.unbindEvents(),this.canvas.destroy(),(e=this.mask)===null||e===void 0||e.remove(),super.destroy()}}Nc.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const wi=(r,e)=>Math.min(r,e),xi=(r,e)=>Math.max(r,e);var dh=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};const hh={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class Ac extends mn{constructor(e,t){super(e,Object.assign({},Ac.defaultOptions,t)),this.initSnapline=()=>{const n=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=n.appendChild(new Ss({style:Object.assign(Object.assign({},hh),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=n.appendChild(new Ss({style:Object.assign(Object.assign({},hh),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(n,i,s)=>dh(this,void 0,void 0,function*(){const{verticalX:a,horizontalY:o}=s,{tolerance:l}=this.options,{min:[u,c],max:[d,h],center:[f,g]}=i;let v=0,p=0;a!==null&&(bn(d,a)<l&&(v=a-d),bn(u,a)<l&&(v=a-u),bn(f,a)<l&&(v=a-f),v!==0&&(this.isVerticalSticking=!0)),o!==null&&(bn(h,o)<l&&(p=o-h),bn(c,o)<l&&(p=o-c),bn(g,o)<l&&(p=o-g),p!==0&&(this.isHorizontalSticking=!0)),(v!==0||p!==0)&&(yield this.context.graph.translateElementBy({[n]:[v,p]},!1))}),this.enableSnap=n=>{const{target:i}=n,s=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[a,o]=this.getDelta(n);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(a)<=s&&Math.abs(o)<=s)return this.context.graph.translateElementBy({[i.id]:[-a,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=s)return this.context.graph.translateElementBy({[i.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(a)<=s)return this.context.graph.translateElementBy({[i.id]:[-a,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(n,i)=>{const{tolerance:s,shape:a}=this.options,{min:[o,l],max:[u,c],center:[d,h]}=i;let f=null,g=null,v=null,p=null,y=null,b=null;return this.getNodes().some(E=>{if(Ct(n.id,E.id))return!1;const T=J0(E,a).getRenderBounds(),{min:[S,k],max:[A,O],center:[C,P]}=T;return f===null&&(bn(C,d)<s?f=C:bn(S,o)<s||bn(S,u)<s?f=S:(bn(A,u)<s||bn(A,o)<s)&&(f=A),f!==null&&(g=Math.min(k,l),v=Math.max(O,c))),p===null&&(bn(P,h)<s?p=P:bn(k,l)<s||bn(k,c)<s?p=k:(bn(O,c)<s||bn(O,l)<s)&&(p=O),p!==null&&(y=Math.min(S,o),b=Math.max(A,u))),f!==null&&p!==null}),{verticalX:f,verticalMinY:g,verticalMaxY:v,horizontalY:p,horizontalMinX:y,horizontalMaxX:b}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=n=>dh(this,void 0,void 0,function*(){const{target:i}=n;if(this.options.autoSnap&&!this.enableSnap(n))return;const s=J0(i,this.options.shape).getRenderBounds(),a=this.calcSnaplineMetadata(i,s);this.hideSnapline(),(a.verticalX!==null||a.horizontalY!==null)&&this.updateSnapline(a),this.options.autoSnap&&(yield this.autoSnapToLine(i.id,s,a))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var e;const{filter:t}=this.options,i=(((e=this.context.element)===null||e===void 0?void 0:e.getNodes())||[]).filter(s=>{var a;return wC(s)&&((a=this.context.viewport)===null||a===void 0?void 0:a.isInViewport(s.getRenderBounds()))});return t?i.filter(s=>t(s)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(e){const{lineWidth:t}=this.options[`${e}LineStyle`];return+(t||hh.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(e){const{verticalX:t,verticalMinY:n,verticalMaxY:i,horizontalY:s,horizontalMinX:a,horizontalMaxX:o}=e,[l,u]=this.context.canvas.getSize(),{offset:c}=this.options;s!==null?Object.assign(this.horizontalLine.style,{x1:c===1/0?0:a-c,y1:s,x2:c===1/0?l:o+c,y2:s,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",t!==null?Object.assign(this.verticalLine.style,{x1:t,y1:c===1/0?0:n-c,x2:t,y2:c===1/0?u:i+c,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(e){const t=this.context.graph.getZoom();return Tr([e.dx,e.dy],t)}bindEvents(){return dh(this,void 0,void 0,function*(){const{graph:e}=this.context;e.on(hr.DRAG_START,this.onDragStart),e.on(hr.DRAG,this.onDrag),e.on(hr.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:e}=this.context;e.off(hr.DRAG_START,this.onDragStart),e.off(hr.DRAG,this.onDrag),e.off(hr.DRAG_END,this.onDragEnd)}destroyElements(){var e,t;(e=this.horizontalLine)===null||e===void 0||e.destroy(),(t=this.verticalLine)===null||t===void 0||t.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}Ac.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const bn=(r,e)=>Math.abs(r-e),J0=(r,e)=>typeof e=="function"?e(r):r.getShape(e);var p5=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},v5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const m5=["timestamp","time","date","datetime"];class Cc extends mn{get padding(){return Vr(this.options.padding)}constructor(e,t){super(e,Object.assign({},Cc.defaultOptions,t)),this.backup(),this.upsertTimebar()}play(){var e;(e=this.timebar)===null||e===void 0||e.play()}pause(){var e;(e=this.timebar)===null||e===void 0||e.pause()}forward(){var e;(e=this.timebar)===null||e===void 0||e.forward()}backward(){var e;(e=this.timebar)===null||e===void 0||e.backward()}reset(){var e;(e=this.timebar)===null||e===void 0||e.reset()}update(e){super.update(e),this.backup(),this.upsertTimebar()}backup(){this.originalData=em(this.context.graph.getData())}upsertTimebar(){const{canvas:e}=this.context,t=this.options,{onChange:n,timebarType:i,data:s,x:a,y:o,width:l,height:u,mode:c}=t,d=v5(t,["onChange","timebarType","data","x","y","width","height","mode"]),h=e.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Object.assign(Object.assign({x:h[0]/2-l/2,y:f,onChange:p=>{const y=(nr(p)?p:[p,p]).map(b=>f2(b)?b.getTime():b);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),n==null||n(y)}},d),{data:s.map(p=>ye(p)?{time:p,value:0}:p),width:l,height:u,type:i});this.timebar?this.timebar.update(v):(this.timebar=new d5({style:v}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:e,height:t,position:n}=this.options,i=this.context.canvas,[s]=i.getSize(),[a,,o]=this.padding,[l,u]=Og({width:s,height:t+a+o,graphCanvas:i,className:"timebar",placement:n});return this.container=l,e&&l.classList.add(e),this.canvas=u,this.canvas}filterElements(e){return p5(this,void 0,void 0,function*(){var t;if(!this.originalData)return;const{elementTypes:n,getTime:i}=this.options,{graph:s,element:a}=this.context,o=em(this.originalData);n.forEach(u=>{const c=`${u}s`;o[c]=(this.originalData[c]||[]).filter(d=>{const h=i(d);return!!tm(h,e)})});const l=[...o.nodes,...o.combos].map(u=>q(u));o.edges=o.edges.filter(u=>{const c=u.source,d=u.target;return l.includes(c)&&l.includes(d)}),s.setData(o),yield(t=a.draw({animation:!1,silence:!0}))===null||t===void 0?void 0:t.finished})}hiddenElements(e){const{graph:t}=this.context,{elementTypes:n,getTime:i}=this.options,s=[],a=[];n.forEach(o=>{var l;const u=`${o}s`;(((l=this.originalData)===null||l===void 0?void 0:l[u])||[]).forEach(d=>{const h=q(d),f=i(d);tm(f,e)?a.push(h):s.push(h)})}),t.hideElement(s,!1),t.showElement(a,!1)}destroy(){var e,t,n;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),(e=this.timebar)===null||e===void 0||e.destroy(),(t=this.canvas)===null||t===void 0||t.destroy(),(n=this.container)===null||n===void 0||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}Cc.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:r=>y5(r,m5,void 0),loop:!1};const em=r=>{const{nodes:e=[],edges:t=[],combos:n=[]}=r;return{nodes:[...e],edges:[...t],combos:[...n]}},tm=(r,e)=>{if(ye(e))return r===e;const[t,n]=e;return r>=t&&r<=n},y5=(r,e,t)=>{var n;for(let i=0;i<e.length;i++){const s=e[i],a=(n=r.data)===null||n===void 0?void 0:n[s];if(a)return a}return t};function b5(r){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return r.split("-").forEach(n=>{e[n]="8px"}),e.flexDirection=r.startsWith("top")||r.startsWith("bottom")?"row":"column",e}const w5=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,x5=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var nm=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Pc extends mn{constructor(e,t){super(e,Object.assign({},Pc.defaultOptions,t)),this.$element=wa("toolbar",!1),this.onToolbarItemClick=i=>{const{onClick:s}=this.options;if(i.target instanceof Element&&i.target.className.includes("g6-toolbar-item")){const a=i.target.getAttribute("value");s==null||s(a,i.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),hf("g6-toolbar-css","style",{},w5,document.head),hf("g6-toolbar-svgicon","div",{display:"none"},x5),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return nm(this,void 0,void 0,function*(){t.update.call(this,e);const{className:n,position:i,style:s}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,s,b5(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return nm(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(t=>`
          <div class="g6-toolbar-item" value="${t.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${t.id}"></use>
            </svg>
          </div>`).join("")})}}Pc.defaultOptions={position:"top-left"};var rm=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class _c extends mn{constructor(e,t){super(e,Object.assign({},_c.defaultOptions,t)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(n,i)=>{const{enable:s}=this.options;return typeof s=="function"?s(n,i):s},this.onClick=n=>{const{target:{id:i}}=n;this.currentTarget===i?this.hide(n):this.show(n)},this.onPointerMove=n=>{const{target:i}=n;!this.currentTarget||i.id===this.currentTarget||this.show(n)},this.onPointerLeave=n=>{this.hide(n)},this.onCanvasMove=n=>{this.hide(n)},this.onPointerEnter=n=>{this.show(n)},this.showById=n=>rm(this,void 0,void 0,function*(){const i={target:{id:n}};yield this.show(i)}),this.getElementData=(n,i)=>{const{model:s}=this.context;switch(i){case"node":return s.getNodeData([n]);case"edge":return s.getEdgeData([n]);case"combo":return s.getComboData([n]);default:return[]}},this.show=n=>rm(this,void 0,void 0,function*(){var i,s;const{client:a,target:{id:o}}=n;if(Uu(n.target))return;const l=this.context.graph.getElementType(o),{getContent:u,title:c}=this.options,d=this.getElementData(o,l);if(!this.tooltipElement||!this.isEnable(n,d))return;let h={};if(u){if(h.content=yield u(n,d),!h.content)return}else{const v=this.context.graph.getElementRenderStyle(o),p=l==="node"?v.fill:v.stroke;h={title:c||l,data:d.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:p}))}}this.currentTarget=o;let f,g;if(a)f=a.x,g=a.y;else{const v=An(d,"0.style",{x:0,y:0});f=v.x,g=v.y}(s=(i=this.options).onOpenChange)===null||s===void 0||s.call(i,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:f,y:g,style:{".tooltip":{visibility:"visible"}}}),h))}),this.hide=n=>{var i,s,a,o,l;if(!n){(s=(i=this.options).onOpenChange)===null||s===void 0||s.call(i,!1),(a=this.tooltipElement)===null||a===void 0||a.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:u,y:c}}=n;(l=(o=this.options).onOpenChange)===null||l===void 0||l.call(o,!1),this.tooltipElement.hide(u,c),this.currentTarget=null},this.initTooltip=()=>{var n;const i=new U4({className:"tooltip",style:this.tooltipStyleProps});return(n=this.container)===null||n===void 0||n.appendChild(i.HTMLTooltipElement),i},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(e){var t;this.unbindEvents(),super.update(e),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:e}=this.context,t=e.getContainer();t&&(this.container=t,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.off(n,t[n])})}bindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.on(n,t[n])})}get tooltipStyleProps(){const{canvas:e}=this.context,{center:t}=e.getBounds(),n=e.getContainer(),{top:i,left:s}=n.getBoundingClientRect(),{style:a,position:o,enterable:l,container:u={x:-s,y:-i},title:c,offset:d}=this.options,[h,f]=t,[g,v]=e.getSize();return{x:h,y:f,container:u,title:c,bounding:{x:0,y:0,width:g,height:v},position:o,enterable:l,offset:d,style:a}}destroy(){var e;this.unbindEvents(),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}_c.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var Tw=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};let Ys;function Ow(r,e){return Ys||(Ys=document.createElement("canvas")),Ys.width=r,Ys.height=e,Ys.getContext("2d").clearRect(0,0,r,e),Ys}function E5(r,e,t,n){return Tw(this,void 0,void 0,function*(){const i=Ow(r,e),s=i.getContext("2d"),{rotate:a,opacity:o,textFill:l,textFontSize:u,textFontFamily:c,textFontVariant:d,textFontWeight:h,textAlign:f,textBaseline:g}=n;return s.textAlign=f,s.textBaseline=g,s.translate(r/2,e/2),s.font=`${u}px ${c} ${d} ${h}`,a&&s.rotate(a),o&&(s.globalAlpha=o),l&&(s.fillStyle=l,s.fillText(`${t}`,0,0)),i.toDataURL()})}function M5(r,e,t,n){return Tw(this,void 0,void 0,function*(){const i=Ow(r,e),s=i.getContext("2d"),{rotate:a,opacity:o}=n;a&&s.rotate(a),o&&(s.globalAlpha=o);const l=new Image;return l.crossOrigin="anonymous",l.src=t,new Promise(u=>{l.onload=function(){const c=r>l.width?(r-l.width)/2:0,d=e>l.height?(e-l.height)/2:0;s.drawImage(l,0,0,l.width,l.height,c,d,r-c*2,e-d*2),u(i.toDataURL())}})})}var S5=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},T5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Lc extends mn{constructor(e,t){super(e,Object.assign({},Lc.defaultOptions,t)),this.$element=wa("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return S5(this,void 0,void 0,function*(){t.update.call(this,e);const n=this.options,{width:i,height:s,text:a,imageURL:o}=n,l=T5(n,["width","height","text","imageURL"]);Object.keys(l).forEach(c=>{c.startsWith("background")&&(this.$element.style[c]=e[c])});const u=o?yield M5(i,s,o,l):yield E5(i,s,a,l);this.$element.style.backgroundImage=`url(${u})`})}destroy(){super.destroy(),this.$element.remove()}}Lc.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const O5=["#7E92B5","#F4664A","#FFBE3A"],k5={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},N5={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function kw(r){const{bgColor:e,textColor:t,nodeColor:n,nodeColorDisabled:i,nodeStroke:s,nodeHaloStrokeOpacityActive:a=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:u=.85,nodeOpacityInactive:c=.25,nodeBadgePalette:d=O5,nodePaletteOptions:h=k5,edgeColor:f,edgeColorDisabled:g,edgePaletteOptions:v=N5,comboColor:p,comboColorDisabled:y,comboStroke:b,comboStrokeDisabled:E,edgeColorInactive:T}=r;return{background:e,node:{palette:h,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:d,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:s,portStrokeOpacity:.65,size:32,stroke:s,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:s},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:a},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:s,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:c,donutOpacity:c,fillOpacity:c,iconOpacity:u,labelFill:t,labelFillOpacity:c,strokeOpacity:c},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:T,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:b,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:b},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:E,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const A5={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},C5={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:A5,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},P5=kw(C5),_5={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},L5=kw(_5);class es extends Uf{beforeDraw(e,t){return e}afterLayout(e,t){}}class D5 extends es{beforeDraw(e){const{model:t}=this.context,n=e.add.combos,i=s=>{const a=[];return s.forEach((o,l)=>{const c=t.getAncestorsData(l,"combo").map(d=>q(d)).reverse();a.push([l,o,c.length])}),new Map(a.sort(([,,o],[,,l])=>l-o).map(([o,l])=>[o,l]))};return e.add.combos=i(n),e.update.combos=i(e.update.combos),e}}function Jn(r,e,t,n,i){const s=q(n),a=`${t}s`,o=i?n:r.add[a].get(s)||r.update[a].get(s)||r.remove[a].get(s)||n;Object.entries(r).forEach(([l,u])=>{e===l?u[a].set(s,o):u[a].delete(s)})}function Gl(r,e){return Object.keys(r).every(t=>r[t]===e[t])}class I5 extends es{beforeDraw(e,t){if(t.stage==="visibility"||!this.context.model.model.hasTreeStructure(st))return e;const{model:n}=this.context,{add:i,update:s}=e,a=[...e.update.combos.entries(),...e.add.combos.entries()];for(;a.length;){const[o,l]=a.pop();if(Wn(l)){const u=n.getDescendantsData(o),c=u.map(q),{internal:d,external:h}=Jh(c,f=>n.getRelatedEdgesData(f));u.forEach(f=>{const g=q(f),v=a.findIndex(([y])=>y===g);v!==-1&&a.splice(v,1);const p=n.getElementType(g);Jn(e,"remove",p,f)}),d.forEach(f=>Jn(e,"remove","edge",f)),h.forEach(f=>{var g;const v=q(f);((g=this.context.element)===null||g===void 0?void 0:g.getElement(v))?s.edges.set(v,f):i.edges.set(v,f)})}else{const u=n.getChildrenData(o),c=u.map(q),{edges:d}=Jh(c,h=>n.getRelatedEdgesData(h));[...u,...d].forEach(h=>{var f;const g=q(h),v=n.getElementType(g);((f=this.context.element)===null||f===void 0?void 0:f.getElement(g))?Jn(e,"update",v,h):Jn(e,"add",v,h),v==="combo"&&a.push([g,h])})}}return e}}const im=(r,e,t,n)=>{const i=`${t}s`,s=q(n);!r.add[i].has(s)&&!r.update[i].has(s)&&r[e][i].set(q(n),n)};class R5 extends es{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(im(t,"add","node",e),Wn(e))return;const n=q(e);im(t,"add","node",e),this.context.model.getRelatedEdgesData(n,"out").forEach(a=>{Jn(t,"add","edge",a)}),this.context.model.getChildrenData(n).forEach(a=>{this.handleExpand(a,t)})}beforeDraw(e){const{graph:t,model:n}=this.context;if(!n.model.hasTreeStructure(Zn))return e;const{add:{nodes:i,edges:s},update:{nodes:a}}=e,o=new Map,l=new Map;i.forEach((c,d)=>{Wn(c)&&o.set(d,c)}),s.forEach(c=>{if(t.getElementType(c.source)!=="node")return;const d=t.getNodeData(c.source);Wn(d)&&o.set(c.source,d)}),a.forEach((c,d)=>{const h=this.getElement(d);if(!h)return;const f=h.attributes.collapsed;Wn(c)?f||o.set(d,c):f&&l.set(d,c)});const u=new Set;return o.forEach((c,d)=>{n.getDescendantsData(d).forEach(f=>{const g=q(f);if(u.has(g))return;Jn(e,"remove","node",f),n.getRelatedEdgesData(g).forEach(p=>{Jn(e,"remove","edge",p)}),u.add(g)})}),l.forEach((c,d)=>{if(n.getAncestorsData(d,Zn).some(Wn)){Jn(e,"remove","node",c);return}this.handleExpand(c,e)}),e}}function j5(r,e,t,n=!1){const i=Vh[r][e];!n&&i?i!==t&&Yr.warn(`The extension ${e} of ${r} has been registered before.`):Object.assign(Vh[r],{[e]:t})}/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.25
 * @date 11/27/2024, 2:17:21 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Nw=function(){function r(e){oe(this,r),this.dragndropPluginOptions=e}return le(r,[{key:"apply",value:function(t){var n=this,i=t.renderingService,s=t.renderingContext,a=s.root.ownerDocument,o=a.defaultView,l=function(c){var d=c.target,h=d===a,f=h&&n.dragndropPluginOptions.isDocumentDraggable?a:d.closest&&d.closest("[draggable=true]");if(f){var g=!1,v=c.timeStamp,p=[c.clientX,c.clientY],y=null,b=[c.clientX,c.clientY],E=function(){var S=Vi(gn().mark(function k(A){var O,C,P,L,R,z;return gn().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(g){U.next=8;break}if(O=A.timeStamp-v,C=zn([A.clientX,A.clientY],p),!(O<=n.dragndropPluginOptions.dragstartTimeThreshold||C<=n.dragndropPluginOptions.dragstartDistanceThreshold)){U.next=5;break}return U.abrupt("return");case 5:A.type="dragstart",f.dispatchEvent(A),g=!0;case 8:if(A.type="drag",A.dx=A.clientX-b[0],A.dy=A.clientY-b[1],f.dispatchEvent(A),b=[A.clientX,A.clientY],h){U.next=21;break}return P=n.dragndropPluginOptions.overlap==="pointer"?[A.canvasX,A.canvasY]:d.getBounds().center,U.next=17,a.elementsFromPoint(P[0],P[1]);case 17:L=U.sent,R=L[L.indexOf(d)+1],z=(R==null?void 0:R.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?a:null),y!==z&&(y&&(A.type="dragleave",A.target=y,y.dispatchEvent(A)),z&&(A.type="dragenter",A.target=z,z.dispatchEvent(A)),y=z,y&&(A.type="dragover",A.target=y,y.dispatchEvent(A)));case 21:case"end":return U.stop()}},k)}));return function(A){return S.apply(this,arguments)}}();o.addEventListener("pointermove",E);var T=function(k){if(g){k.detail={preventClick:!0};var A=k.clone();y&&(A.type="drop",A.target=y,y.dispatchEvent(A)),A.type="dragend",f.dispatchEvent(A),g=!1}o.removeEventListener("pointermove",E)};d.addEventListener("pointerup",T,{once:!0}),d.addEventListener("pointerupoutside",T,{once:!0})}};i.hooks.init.tap(r.tag,function(){o.addEventListener("pointerdown",l)}),i.hooks.destroy.tap(r.tag,function(){o.removeEventListener("pointerdown",l)})}}])}();Nw.tag="Dragndrop";var B5=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return oe(this,e),t=Fe(this,e),t.name="dragndrop",t.options=n,t}return $e(e,r),le(e,[{key:"init",value:function(){this.addRenderingPlugin(new Nw(We({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)}}])}(Xi),sm=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},am=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const om=["main"],lm=["background","main","label","transient"];function z5(r){return r.main}class um{getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]||z5(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(e){this.config={enableMultiLayer:!0},Object.assign(this.config,e);const t=this.config,{renderer:n,background:i,cursor:s,enableMultiLayer:a}=t,o=am(t,["renderer","background","cursor","enableMultiLayer"]),l=a?lm:om,u=cm(n,l),c=Object.fromEntries(l.map(d=>{const h=new Yh(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:a,renderer:u[d],background:a?d==="background"?i:void 0:i}));return[d,h]}));dm(c),this.extends={config:this.config,renderer:n,renderers:u,layers:c}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(n=>{const i=n.getCamera(),s=i.getPosition(),a=i.getFocalPoint();n.resize(e,t),i.setPosition(s),i.setFocalPoint(a)})}getBounds(e){return Eo(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(i=>i.classList.includes(e)):t.getRoot()).filter(t=>(t==null?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var n;const i=((n=e.style)===null||n===void 0?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=cm(e,this.config.enableMultiLayer?lm:om);this.extends.renderers=t,Object.entries(t).forEach(([n,i])=>this.getLayer(n).setRenderer(i)),dm(this.getLayers())}getCanvasByViewport(e){return fn(this.getLayer().viewport2Canvas(xr(e)))}getViewportByCanvas(e){return fn(this.getLayer().canvas2Viewport(xr(e)))}getViewportByClient(e){return fn(this.getLayer().client2Viewport(xr(e)))}getClientByViewport(e){return fn(this.getLayer().viewport2Client(xr(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),n=t.client2Viewport(xr(e));return fn(t.viewport2Canvas(n))}toDataURL(){return sm(this,arguments,void 0,function*(e={}){const t=globalThis.devicePixelRatio||1,{mode:n="viewport"}=e,i=am(e,["mode"]);let[s,a,o,l]=[0,0,0,0];if(n==="viewport")[o,l]=this.getSize();else if(n==="overall"){const y=this.getBounds(),b=qi(y);[s,a]=y.min,[o,l]=b}const u=Nh('<div id="virtual-image"></div>'),c=new Yh({width:o,height:l,renderer:new so,devicePixelRatio:t,container:u,background:this.extends.config.background});yield c.ready,c.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),c.appendChild(this.getRoot().cloneNode(!0));const d=this.getLayer("label").getRoot().cloneNode(!0),h=c.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);d.translate([f[0]-h.x,f[1]-h.y]),d.scale(1/this.getCamera().getZoom()),c.appendChild(d),c.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),v=c.getCamera();if(n==="viewport")v.setZoom(g.getZoom()),v.setPosition(g.getPosition()),v.setFocalPoint(g.getFocalPoint());else if(n==="overall"){const[y,b,E]=v.getPosition(),[T,S,k]=v.getFocalPoint();v.setPosition([y+s,b+a,E]),v.setFocalPoint([T+s,S+a,k])}const p=c.getContextService();return new Promise(y=>{c.addEventListener(qn.RERENDER,()=>sm(this,void 0,void 0,function*(){yield new Promise(E=>setTimeout(E,300));const b=yield p.toDataURL(i);y(b)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}function cm(r,e){return Object.fromEntries(e.map(t=>{const n=(r==null?void 0:r(t))||new so;return n instanceof so&&n.setConfig({enableDirtyRectangleRendering:!1}),t==="main"?n.registerPlugin(new B5({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[t,n]}))}function dm(r){Object.entries(r).forEach(([e,t])=>{const n=t.getContextService().getDomElement();n!=null&&n.style&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,e!=="main"&&(n.style.pointerEvents="none")),n!=null&&n.parentElement&&(n.parentElement.style.display="grid")})}const Vs=r=>r?parseInt(r):0;function F5(r){const e=getComputedStyle(r),t=r.clientWidth||Vs(e.width),n=r.clientHeight||Vs(e.height),i=Vs(e.paddingLeft)+Vs(e.paddingRight),s=Vs(e.paddingTop)+Vs(e.paddingBottom);return[t-i,n-s]}function hm(r){if(!r)return[0,0];let e=640,t=480;const[n,i]=F5(r);e=n||e,t=i||t;const s=1,a=1;return[Math.max(ye(e)?e:s,s),Math.max(ye(t)?t:a,a)]}class Dc{constructor(e){this.type=e}}class Gt extends Dc{constructor(e,t){super(e),this.data=t}}class cr extends Dc{constructor(e,t,n,i){super(e),this.animationType=t,this.animation=n,this.data=i}}class Us extends Dc{constructor(e,t,n){super(e),this.elementType=t,this.data=n}}class Ll extends Dc{constructor(e,t){super(e),this.data=t}}function Zt(r,e){r.emit(e.type,e)}function $5(r){if(!r)return null;if(r instanceof Vy)return{type:"canvas",element:r};let e=r;for(;e;){if(ko(e))return{type:"node",element:e};if(Q1(e))return{type:"edge",element:e};if(ng(e))return{type:"combo",element:e};e=e.parentElement}return null}function fm(r){var e;return((e=r==null?void 0:r.style)===null||e===void 0?void 0:e.zIndex)||0}const Qa="cachedStyle",kg=r=>`__${r}__`;function W5(r,e){const t=Array.isArray(e)?e:[e];An(r,Qa)||eo(r,Qa,{}),t.forEach(n=>{eo(An(r,Qa),kg(n),r.attributes[n])})}function gm(r,e){return An(r,[Qa,kg(e)])}function G5(r,e){return kg(e)in(An(r,Qa)||{})}class Y5{constructor(e){this.tasks=[],this.animations=new Set,this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,n){var i,s,a;(i=t==null?void 0:t.before)===null||i===void 0||i.call(t);const o=this.getTasks().map(([u,c])=>{var d,h,f;const{element:g,elementType:v,stage:p}=u,y=Ek(this.context.options,v,p,e);(d=c==null?void 0:c.before)===null||d===void 0||d.call(c);const b=y.length?Sk(g,this.inferStyle(u,n),y):null;return b?((h=c==null?void 0:c.beforeAnimate)===null||h===void 0||h.call(c,b),b.finished.then(()=>{var E,T;(E=c==null?void 0:c.afterAnimate)===null||E===void 0||E.call(c,b),(T=c==null?void 0:c.after)===null||T===void 0||T.call(c),this.animations.delete(b)})):(f=c==null?void 0:c.after)===null||f===void 0||f.call(c),b}).filter(Boolean);o.forEach(u=>this.animations.add(u));const l=Wf(o);return l?((s=t==null?void 0:t.beforeAnimate)===null||s===void 0||s.call(t,l),l.finished.then(()=>{var u,c;(u=t==null?void 0:t.afterAnimate)===null||u===void 0||u.call(t,l),(c=t==null?void 0:t.after)===null||c===void 0||c.call(t),this.release()})):(a=t==null?void 0:t.after)===null||a===void 0||a.call(t),l}inferStyle(e,t){var n,i;const{element:s,elementType:a,stage:o,originalStyle:l,updatedStyle:u={}}=e;e.modifiedStyle||(e.modifiedStyle=Object.assign(Object.assign({},l),u));const{modifiedStyle:c}=e,d={},h={};if(o==="enter")Object.assign(d,{opacity:0});else if(o==="exit")Object.assign(h,{opacity:0});else if(o==="show")Object.assign(d,{opacity:0}),Object.assign(h,{opacity:(n=gm(s,"opacity"))!==null&&n!==void 0?n:ro("opacity")});else if(o==="hide")Object.assign(d,{opacity:(i=gm(s,"opacity"))!==null&&i!==void 0?i:ro("opacity")}),Object.assign(h,{opacity:0});else if(o==="collapse"){const{collapse:f}=t||{},{target:g,descendants:v,position:p}=f;if(a==="node"){if(v.includes(s.id)){const[y,b,E]=p;Object.assign(h,{x:y,y:b,z:E})}}else if(a==="combo"){if(s.id===g||v.includes(s.id)){const[y,b]=p;Object.assign(h,{x:y,y:b,childrenNode:l.childrenNode})}}else a==="edge"&&Object.assign(h,{sourceNode:c.sourceNode,targetNode:c.targetNode})}else if(o==="expand"){const{expand:f}=t||{},{target:g,descendants:v,position:p}=f;if(a==="node"){if(s.id===g||v.includes(s.id)){const[y,b,E]=p;Object.assign(d,{x:y,y:b,z:E})}}else if(a==="combo"){if(s.id===g||v.includes(s.id)){const[y,b,E]=p;Object.assign(d,{x:y,y:b,z:E,childrenNode:c.childrenNode})}}else a==="edge"&&Object.assign(d,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[Object.keys(d).length>0?Object.assign({},l,d):l,Object.keys(h).length>0?Object.assign({},c,h):c]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var e,t;const{canvas:n}=this.context,i=(t=(e=n.document)===null||e===void 0?void 0:e.timeline)===null||t===void 0?void 0:t.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter(s=>s.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class V5{constructor(e){this.batchCount=0,this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Gt(fe.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Gt(fe.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class U5 extends Vf{constructor(e){super(e),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{const{target:n}=t,i=$5(n);if(!i)return;const{graph:s,canvas:a}=this.context,{type:o,element:l}=i;if("destroyed"in l&&(Uu(l)||l.destroyed))return;const{type:u,detail:c,button:d}=t,h=Object.assign(Object.assign({},t),{target:l,targetType:o,originalTarget:n});u===te.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&s.emit(`${this.currentTargetType}:${te.POINTER_LEAVE}`,Object.assign(Object.assign({},h),{type:te.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),l&&(Object.assign(h,{type:te.POINTER_ENTER}),s.emit(`${o}:${te.POINTER_ENTER}`,h))),this.currentTarget=l,this.currentTargetType=o),u===te.CLICK&&d===2||(s.emit(`${o}:${u}`,h),s.emit(u,h)),u===te.CLICK&&c===2&&(Object.assign(h,{type:te.DBLCLICK}),s.emit(`${o}:${te.DBLCLICK}`,h),s.emit(te.DBLCLICK,h)),u===te.POINTER_DOWN&&d===2&&(Object.assign(h,{type:te.CONTEXT_MENU,preventDefault:()=>{var f;(f=a.getContainer())===null||f===void 0||f.addEventListener(te.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),s.emit(`${o}:${te.CONTEXT_MENU}`,h),s.emit(te.CONTEXT_MENU,h))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(e){this.setExtensions(e)}forwardEvents(){const e=this.context.canvas.getContainer();e&&[Qs.KEY_DOWN,Qs.KEY_UP].forEach(n=>{e.addEventListener(n,this.forwardContainerEvents)});const t=this.context.canvas.document;t&&[te.CLICK,te.DBLCLICK,te.POINTER_OVER,te.POINTER_LEAVE,te.POINTER_ENTER,te.POINTER_MOVE,te.POINTER_OUT,te.POINTER_DOWN,te.POINTER_UP,te.CONTEXT_MENU,te.DRAG_START,te.DRAG,te.DRAG_END,te.DRAG_ENTER,te.DRAG_OVER,te.DRAG_LEAVE,te.DROP,te.WHEEL].forEach(n=>{t.addEventListener(n,this.forwardCanvasEvents)})}destroy(){const e=this.context.canvas.getContainer();e&&[Qs.KEY_DOWN,Qs.KEY_UP].forEach(t=>{e.removeEventListener(t,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var go=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Ei(r,e){const{data:t,style:n}=r,i=go(r,["data","style"]),{data:s,style:a}=e,o=go(e,["data","style"]),l=Object.assign(Object.assign({},i),o);return(t||s)&&Object.assign(l,{data:Object.assign(Object.assign({},t),s)}),(n||a)&&Object.assign(l,{style:Object.assign(Object.assign({},n),a)}),l}function fh(r){const{data:e,style:t}=r,i=go(r,["data","style"]);return e&&(i.data=Object.assign({},e)),t&&(i.style=Object.assign({},t)),i}function Hs(r={},e={}){const{states:t=[],data:n={},style:i={},children:s=[]}=r,a=go(r,["states","data","style","children"]),{states:o=[],data:l={},style:u={},children:c=[]}=e,d=go(e,["states","data","style","children"]),h=(g,v)=>g.length!==v.length?!1:g.every((p,y)=>p===v[y]),f=(g,v)=>{const p=Object.keys(g),y=Object.keys(v);return p.length!==y.length?!1:p.every(b=>g[b]===v[b])};return!(!f(a,d)||!h(s,c)||!h(t,o)||!f(n,l)||!f(i,u))}var H5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function gh(r){const{id:e=q(r),style:t,data:n}=r,i=H5(r,["id","style","data"]),s=Object.assign(Object.assign({},r),{style:Object.assign({},t),data:Object.assign({},n)});return Ck(r)?Object.assign({id:e,data:s},i):{id:e,data:s}}function nn(r){return r.data}function X5(r){if(r.hasTreeStructure(Zn))return;r.attachTreeStructure(Zn);const e=r.getAllEdges();for(const t of e){const{source:n,target:i}=t;r.setParent(i,n,Zn)}}class q5{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new en}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===yt.NodeUpdated||t===yt.EdgeUpdated||t===yt.ComboUpdated){const{value:n,original:i}=e;this.changes.push({value:fh(n),original:fh(i),type:t})}else this.changes.push({value:fh(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}isBatching(){return this.batchCount>0}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=nn(n);return this.isCombo(q(i))||(e===void 0||e.includes(q(i)))&&t.push(i),t},[])}getEdgeDatum(e){return nn(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,n)=>{const i=nn(n);return(e===void 0||e.includes(q(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=nn(n);return this.isCombo(q(i))&&(e===void 0||e.includes(q(i)))&&t.push(i),t},[])}getRootsData(e=Zn){return this.model.getRoots(e).map(nn)}getAncestorsData(e,t){const{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getAncestors(e,t).map(nn)}getDescendantsData(e){const t=this.getElementDataById(e),n=[];return sa(t,i=>{i!==t&&n.push(i)},i=>this.getChildrenData(q(i)),"TB"),n}getParentData(e,t){const{model:n}=this;if(!t){Yr.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(e)||!n.hasTreeStructure(t))return;const i=n.getParent(e,t);return i?nn(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?Zn:st,{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getChildren(e,t).map(nn)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return nn(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=nn(n);return e?e.includes(q(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var s;return(s=i.states)===null||s===void 0?void 0:s.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))===null||t===void 0?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(nn)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(nn)}setData(e){const{nodes:t=[],edges:n=[],combos:i=[]}=e,{nodes:s,edges:a,combos:o}=this.getData(),l=zi(s,t,d=>q(d),Hs),u=zi(a,n,d=>q(d),Hs),c=zi(o,i,d=>q(d),Hs);this.batch(()=>{const d={nodes:l.enter,edges:u.enter,combos:c.enter};this.addData(d),this.computeZIndex(d,"add",!0);const h={nodes:l.update,edges:u.update,combos:c.update};this.updateData(h),this.computeZIndex(h,"update",!0);const f={nodes:l.exit.map(q),edges:u.exit.map(q),combos:c.exit.map(q)};this.removeData(f)})}addData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(n)}),this.computeZIndex(e,"add")}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:yt.NodeAdded}),gh(t)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({nodes:e},"add"))}addEdgeData(e=[]){e.length&&(this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:yt.EdgeAdded}),gh(t)))),this.computeZIndex({edges:e},"add"))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(st)||t.attachTreeStructure(st),t.addNodes(e.map(n=>(this.comboIds.add(q(n)),this.pushChange({value:n,type:yt.ComboAdded}),gh(n)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({combos:e},"add")}addChildrenData(e,t){const n=this.getNodeLikeDatum(e),i=t.map(q);this.addNodeData(t),this.updateNodeData([{id:e,children:[...n.children||[],...i]}]),this.addEdgeData(i.map(s=>({source:e,target:s})))}computeZIndex(e,t,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:i=[],edges:s=[],combos:a=[]}=e;a.forEach(o=>{var l,u,c;const d=q(o);if(t==="add"&&ye((l=o.style)===null||l===void 0?void 0:l.zIndex)||t==="update"&&!("combo"in o))return;const h=this.getParentData(d,st),f=h?((c=(u=h.style)===null||u===void 0?void 0:u.zIndex)!==null&&c!==void 0?c:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:d,style:{zIndex:f}}])})}),i.forEach(o=>{var l,u,c;const d=q(o);if(t==="add"&&ye((l=o.style)===null||l===void 0?void 0:l.zIndex)||t==="update"&&!("combo"in o)&&!("children"in o))return;let h=0;const f=this.getParentData(d,st);if(f)h=(((u=f.style)===null||u===void 0?void 0:u.zIndex)||0)+1;else{const g=this.getParentData(d,Zn);g&&(h=((c=g==null?void 0:g.style)===null||c===void 0?void 0:c.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:d,style:{zIndex:h}}])})}),s.forEach(o=>{var l,u,c,d,h;if(ye((l=o.style)===null||l===void 0?void 0:l.zIndex))return;let{id:f,source:g,target:v}=o;if(!f)f=q(o);else{const b=this.getEdgeDatum(f);g=b.source,v=b.target}if(!g||!v)return;const p=((c=(u=this.getNodeLikeDatum(g))===null||u===void 0?void 0:u.style)===null||c===void 0?void 0:c.zIndex)||0,y=((h=(d=this.getNodeLikeDatum(v))===null||d===void 0?void 0:d.style)===null||h===void 0?void 0:h.zIndex)||0;this.updateEdgeData([{id:q(o),style:{zIndex:Math.max(p,y)-1}}])})})}getFrontZIndex(e){var t;const n=this.getElementType(e),i=this.getElementDataById(e),s=this.getData();if(Object.assign(s,{[`${n}s`]:s[`${n}s`].filter(a=>q(a)!==e)}),n==="combo"&&!Wn(i)){const a=new Set(this.getAncestorsData(e,st).map(q));s.nodes=s.nodes.filter(o=>!a.has(q(o))),s.combos=s.combos.filter(o=>!a.has(q(o))),s.edges=s.edges.filter(({source:o,target:l})=>!a.has(o)&&!a.has(l))}return Math.max(((t=i.style)===null||t===void 0?void 0:t.zIndex)||0,0,...Object.values(s).flat().map(a=>{var o;return(((o=a==null?void 0:a.style)===null||o===void 0?void 0:o.zIndex)||0)+1}))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(n=>{const i=q(n),s=dl(n);s!==void 0&&(t.hasTreeStructure(st)||t.attachTreeStructure(st),s===null&&this.refreshComboData(i),this.setParent(i,dl(n),st));const a=n.children||[];if(a.length){t.hasTreeStructure(Zn)||t.attachTreeStructure(Zn);const o=a.filter(l=>t.hasNode(l));o.forEach(l=>this.setParent(l,i,Zn)),o.length!==a.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(n)}),this.computeZIndex(e,"update")}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const n=[];e.forEach(i=>{const s=q(i),a=nn(t.getNode(s));if(Hs(a,i))return;const o=Ei(a,i);this.pushChange({value:o,original:a,type:yt.NodeUpdated}),t.mergeNodeData(s,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:e},"update")}refreshData(){const{nodes:e,edges:t,combos:n}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:yt.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:yt.EdgeUpdated})}),n.forEach(i=>{this.pushChange({value:i,original:i,type:yt.ComboUpdated})})}syncNodeLikeDatum(e){const{model:t}=this,n=q(e);if(!t.hasNode(n))return;const i=nn(t.getNode(n)),s=Ei(i,e);t.mergeNodeData(n,s)}syncEdgeDatum(e){const{model:t}=this,n=q(e);if(!t.hasEdge(n))return;const i=nn(t.getEdge(n)),s=Ei(i,e);t.mergeEdgeData(n,s)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(n=>{const i=q(n),s=nn(t.getEdge(i));if(Hs(s,n))return;n.source&&s.source!==n.source&&t.updateEdgeSource(i,n.source),n.target&&s.target!==n.target&&t.updateEdgeTarget(i,n.target);const a=Ei(s,n);this.pushChange({value:a,original:s,type:yt.EdgeUpdated}),t.mergeEdgeData(i,a)})}),this.computeZIndex({edges:e},"update")}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const n=[];e.forEach(i=>{const s=q(i),a=nn(t.getNode(s));if(Hs(a,i))return;const o=Ei(a,i);this.pushChange({value:o,original:a,type:yt.ComboUpdated}),t.mergeNodeData(s,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:e},"update")}setParent(e,t,n,i=!0){if(e===t)return;const s=this.getNodeLikeDatum(e),a=dl(s);if(a!==t&&n===st){const o={id:e,combo:t};this.isCombo(e)?this.syncNodeLikeDatum(o):this.syncNodeLikeDatum(o)}this.model.setParent(e,t,n),i&&n===st&&i2([a,t]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(e){const t=this.getComboData([e])[0],n=this.getAncestorsData(e,st);t&&this.pushChange({value:t,original:t,type:yt.ComboUpdated}),n.forEach(i=>{this.pushChange({value:i,original:i,type:yt.ComboUpdated})})}getElementPosition(e){const t=this.getElementDataById(e);return Kt(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const n=this.getElementPosition(e),i=ze(n,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[n=0,i=0,s=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:n,y:i,z:s}}])})}translateComboBy(e,t){const[n=0,i=0,s=0]=t;if([n,i,s].some(isNaN)||[n,i,s].every(l=>l===0))return;const a=this.getComboData([e])[0];if(!a)return;const o=new Set;sa(a,l=>{const u=q(l);if(o.has(u))return;o.add(u);const[c,d,h]=Kt(l),f=Ei(l,{style:{x:c+n,y:d+i,z:h+s}});this.pushChange({value:f,original:l,type:this.isCombo(u)?yt.ComboUpdated:yt.NodeUpdated}),this.model.mergeNodeData(u,f)},l=>this.getChildrenData(q(l)),"BT")}translateComboTo(e,t){var n;if(t.some(isNaN))return;const[i=0,s=0,a=0]=t,o=(n=this.getComboData([e]))===null||n===void 0?void 0:n[0];if(!o)return;const[l,u,c]=Kt(o),d=i-l,h=s-u,f=a-c;sa(o,g=>{const v=q(g),[p,y,b]=Kt(g),E=Ei(g,{style:{x:p+d,y:y+h,z:b+f}});this.pushChange({value:E,original:g,type:this.isCombo(v)?yt.ComboUpdated:yt.NodeUpdated}),this.model.mergeNodeData(v,E)},g=>this.getChildrenData(q(g)),"BT")}removeData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(q)),this.pushChange({value:this.getNodeData([t])[0],type:yt.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:yt.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:yt.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(st)){const t=dl(this.getNodeLikeDatum(e));this.setParent(e,void 0,st,!1),this.model.getChildren(e,st).forEach(n=>{const i=nn(n),s=q(i);this.setParent(q(i),t,st,!1);const a=Ei(i,{id:q(i),combo:t});this.pushChange({value:a,original:i,type:this.isCombo(s)?yt.ComboUpdated:yt.NodeUpdated}),this.model.mergeNodeData(q(i),a)}),Ae(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(oi(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),n=e.getAllEdges();e.removeEdges(n.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}var Da=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Z5{constructor(e){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=e}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:e}=this.context;this.container=e.appendChild(new Jt({className:"elements"}))}}emit(e,t){t.silence||Zt(this.context.graph,e)}forEachElementData(e){ks.forEach(t=>{const n=this.context.model.getElementsDataByType(t);e(t,n)})}getElementType(e,t){var n;const{options:i,graph:s}=this.context,a=((n=i[e])===null||n===void 0?void 0:n.type)||t.type;return a?typeof a=="string"?a:a.call(s,t):e==="edge"?"line":"circle"}getTheme(e){return r1(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:n={}}=this.getTheme(e);return Object.assign({},...t.map(i=>n[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,n)=>{var i,s;const a=Object.assign({},zp((i=this.getTheme(t))===null||i===void 0?void 0:i.palette),zp((s=e[t])===null||s===void 0?void 0:s.palette));a!=null&&a.field&&Object.assign(this.paletteStyle,TN(n,a))})}getPaletteStyle(e,t){const n=this.paletteStyle[t];return n?e==="edge"?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(e,t){var n;const{options:i}=this.context,s=((n=i[e])===null||n===void 0?void 0:n.style)||{};"transform"in s&&Array.isArray(s.transform)&&(s.transform=[...s.transform]),this.defaultStyle[q(t.datum)]=Bp(s,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const s=i.length;for(let a=0;a<s;a++){const o=i[a];(e===void 0||e.includes(q(o)))&&this.computeElementDefaultStyle(n,{datum:o,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch{return[]}}getElementStateStyle(e,t,n){var i,s;const{options:a}=this.context,o=((s=(i=a[e])===null||i===void 0?void 0:i.state)===null||s===void 0?void 0:s[t])||{};return Bp(o,n)}computeElementStatesStyle(e,t,n){this.stateStyle[q(n.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,n)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const s=i.length;for(let a=0;a<s;a++){const o=i[a];if(e===void 0||e.includes(q(o))){const l=this.getElementState(q(o));this.computeElementStatesStyle(n,l,{datum:o,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[q(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const n=q(t),i=this.getThemeStyle(e),s=this.getPaletteStyle(e,n),a=t.style||{},o=this.getDefaultStyle(n),l=this.getThemeStateStyle(e,this.getElementState(n)),u=this.getStateStyle(n),c=Object.assign({},i,s,a,o,l,u);if(e==="combo"){const d=this.context.model.getChildrenData(n),f=!!c.collapsed?[]:d.map(q).filter(g=>this.getElement(g));Object.assign(c,{childrenNode:f,childrenData:d})}return c}getDrawData(e){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{type:n="draw",stage:i=n}=e;return this.markDestroyElement(t.drawData),this.computeStyle(i),{type:n,stage:i,data:t}}draw(e={animation:!0}){const t=this.getDrawData(e);if(!t)return;const{data:{drawData:{add:n,update:i,remove:s}}}=t;return this.destroyElements(s,e),this.createElements(n,e),this.updateElements(i,e),this.setAnimationTask(e,t)}preLayoutDraw(){return Da(this,arguments,void 0,function*(e={animation:!0}){var t,n;const i=this.getDrawData(e);if(!i)return;const{data:{drawData:s}}=i;yield(n=(t=this.context.layout)===null||t===void 0?void 0:t.preLayout)===null||n===void 0?void 0:n.call(t,s);const{add:a,update:o,remove:l}=s;return this.destroyElements(l,e),this.createElements(a,e),this.updateElements(o,e),this.setAnimationTask(e,i)})}setAnimationTask(e,t){const{animation:n,silence:i}=e,{data:{dataChanges:s,drawData:a},stage:o,type:l}=t;return this.context.animation.animate(n,i?{}:{before:()=>this.emit(new Gt(fe.BEFORE_DRAW,{dataChanges:s,animation:n,stage:o,render:l==="render"}),e),beforeAnimate:u=>this.emit(new cr(fe.BEFORE_ANIMATE,Bn.DRAW,u,a),e),afterAnimate:u=>this.emit(new cr(fe.AFTER_ANIMATE,Bn.DRAW,u,a),e),after:()=>this.emit(new Gt(fe.AFTER_DRAW,{dataChanges:s,animation:n,stage:o,render:l==="render",firstRender:this.context.graph.rendered===!1}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,n=t.getChanges(),i=fg(n);if(i.length===0)return null;const{NodeAdded:s=[],NodeUpdated:a=[],NodeRemoved:o=[],EdgeAdded:l=[],EdgeUpdated:u=[],EdgeRemoved:c=[],ComboAdded:d=[],ComboUpdated:h=[],ComboRemoved:f=[]}=ku(i,y=>y.type),g=y=>new Map(y.map(b=>{const E=b.value;return[q(E),E]})),v={add:{nodes:g(s),edges:g(l),combos:g(d)},update:{nodes:g(a),edges:g(u),combos:g(h)},remove:{nodes:g(o),edges:g(c),combos:g(f)}},p=this.transformData(v,e);return t.clearChanges(),{dataChanges:n,drawData:p}}transformData(e,t){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((i,s)=>s.beforeDraw(i,t),e)}createElement(e,t,n){var i;const s=q(t);if(this.getElement(s))return;const o=this.getElementType(e,t),l=this.getElementComputedStyle(e,t),u=di(e,o);if(!u)return Yr.warn(`The element ${o} of ${e} is not registered.`);this.emit(new Us(fe.BEFORE_ELEMENT_CREATE,e,t),n);const c=this.container.appendChild(new u({id:s,context:this.context,style:l}));this.shapeTypeMap[s]=o,this.elementMap[s]=c;const{stage:d="enter"}=n;(i=this.context.animation)===null||i===void 0||i.add({element:c,elementType:e,stage:d,originalStyle:Object.assign({},c.attributes),updatedStyle:l},{after:()=>{var h;this.emit(new Us(fe.AFTER_ELEMENT_CREATE,e,t),n),(h=c.onCreate)===null||h===void 0||h.call(c)}})}createElements(e,t){const{nodes:n,edges:i,combos:s}=e;[["node",n],["combo",s],["edge",i]].forEach(([o,l])=>{l.forEach(u=>this.createElement(o,u,t))})}getUpdateStageStyle(e,t,n){const{stage:i="update"}=n;if(i==="translate")if(e==="node"||e==="combo"){const{style:{x:s=0,y:a=0,z:o=0}={}}=t;return{x:s,y:a,z:o}}else return{};return this.getElementComputedStyle(e,t)}updateElement(e,t,n){var i;const s=q(t),{stage:a="update"}=n,o=this.getElement(s);if(!o)return()=>null;this.emit(new Us(fe.BEFORE_ELEMENT_UPDATE,e,t),n);const l=this.getElementType(e,t),u=this.getUpdateStageStyle(e,t,n);this.shapeTypeMap[s]!==l&&(o.destroy(),delete this.shapeTypeMap[s],delete this.elementMap[s],this.createElement(e,t,{animation:!1,silence:!0}));const c=a!=="visibility"?a:u.visibility==="hidden"?"hide":"show";c==="hide"&&delete u.visibility,(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:c,originalStyle:Object.assign({},o.attributes),updatedStyle:u},{before:()=>{const d=this.elementMap[s];a!=="collapse"&&tf(d,u),a==="visibility"&&(G5(d,"opacity")||W5(d,"opacity"),this.visibilityCache.set(d,c==="show"?"visible":"hidden"),c==="show"&&Ts(d,"visible"))},after:()=>{var d;const h=this.elementMap[s];a==="collapse"&&tf(h,u),c==="hide"&&Ts(h,this.visibilityCache.get(h)),this.emit(new Us(fe.AFTER_ELEMENT_UPDATE,e,t),n),(d=h.onUpdate)===null||d===void 0||d.call(h)}})}updateElements(e,t){const{nodes:n,edges:i,combos:s}=e;[["node",n],["combo",s],["edge",i]].forEach(([o,l])=>{l.forEach(u=>this.updateElement(o,u,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(n=>{const i=q(n),s=this.getElement(i);s&&MC(s)})})}destroyElement(e,t,n){var i;const{stage:s="exit"}=n,a=q(t),o=this.elementMap[a];if(!o)return()=>null;this.emit(new Us(fe.BEFORE_ELEMENT_DESTROY,e,t),n),(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:s,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var l;this.clearElement(a),o.destroy(),(l=o.onDestroy)===null||l===void 0||l.call(o),this.emit(new Us(fe.AFTER_ELEMENT_DESTROY,e,t),n)}})}destroyElements(e,t){const{nodes:n,edges:i,combos:s}=e;[["combo",s],["edge",i],["node",n]].forEach(([o,l])=>{l.forEach(u=>this.destroyElement(o,u,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}alignLayoutResultToElement(e,t){var n,i;const s=(n=e.nodes)===null||n===void 0?void 0:n.find(a=>q(a)===t);if(s){const a=Kt(this.context.model.getNodeLikeDatum(t)),o=Kt(s),l=it(a,o);(i=e.nodes)===null||i===void 0||i.forEach(u=>{var c,d,h;!((c=u.style)===null||c===void 0)&&c.x&&(u.style.x+=l[0]),!((d=u.style)===null||d===void 0)&&d.y&&(u.style.y+=l[1]),!((h=u.style)===null||h===void 0)&&h.z&&(u.style.z+=l[2]||0)})}}collapseNode(e,t){return Da(this,void 0,void 0,function*(){var n;const{animation:i,align:s}=t,{model:a,layout:o}=this.context,l=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!l)return;this.markDestroyElement(l.drawData);const u=yield o.simulate();s&&this.alignLayoutResultToElement(u,e),a.updateData(u);const c=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!c)return;const{drawData:d}=c,{add:h,remove:f,update:g}=d;this.markDestroyElement(d);const v={animation:i,stage:"collapse",data:d};this.destroyElements(f,v),this.createElements(h,v),this.updateElements(g,v),yield(n=this.context.animation.animate(i,{beforeAnimate:p=>this.emit(new cr(fe.BEFORE_ANIMATE,Bn.COLLAPSE,p,d),v),afterAnimate:p=>this.emit(new cr(fe.AFTER_ANIMATE,Bn.COLLAPSE,p,d),v)},{collapse:{target:e,descendants:Array.from(f.nodes).map(([,p])=>q(p)),position:Kt(g.nodes.get(e))}}))===null||n===void 0?void 0:n.finished})}expandNode(e,t){return Da(this,void 0,void 0,function*(){var n;const{model:i,layout:s}=this.context,{animation:a,align:o}=t,l=Kt(i.getNodeData([e])[0]),u=this.computeChangesAndDrawData({stage:"expand",animation:a});if(!u)return;const{drawData:{add:c}}=u;this.createElements(c,{animation:!1,stage:"expand",target:e}),this.context.animation.clear();const d=yield s.simulate();o&&this.alignLayoutResultToElement(d,e),i.updateData(d),this.computeStyle("expand");const h=this.computeChangesAndDrawData({stage:"collapse",animation:a});if(!h)return;const{drawData:f}=h,{update:g}=f,v={animation:a,stage:"expand",data:f};c.edges.forEach(p=>g.edges.set(q(p),p)),c.nodes.forEach(p=>g.nodes.set(q(p),p)),this.updateElements(g,v),yield(n=this.context.animation.animate(a,{beforeAnimate:p=>this.emit(new cr(fe.BEFORE_ANIMATE,Bn.EXPAND,p,f),v),afterAnimate:p=>this.emit(new cr(fe.AFTER_ANIMATE,Bn.EXPAND,p,f),v)},{expand:{target:e,descendants:Array.from(c.nodes).map(([,p])=>q(p)),position:l}}))===null||n===void 0?void 0:n.finished})}collapseCombo(e,t){return Da(this,void 0,void 0,function*(){var n;const{model:i,element:s}=this.context;if(i.getAncestorsData(e,st).some(v=>Wn(v)))return;const a=s.getElement(e),o=a.getComboPosition(Object.assign(Object.assign({},a.attributes),{collapsed:!0})),l=this.computeChangesAndDrawData({stage:"collapse",animation:t});if(!l)return;const{dataChanges:u,drawData:c}=l;this.markDestroyElement(c);const{update:d,remove:h}=c,f={animation:t,stage:"collapse",data:c};this.destroyElements(h,f),this.updateElements(d,f);const g=v=>Array.from(v).map(([,p])=>q(p));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Gt(fe.BEFORE_DRAW,{dataChanges:u,animation:t}),f),beforeAnimate:v=>this.emit(new cr(fe.BEFORE_ANIMATE,Bn.COLLAPSE,v,c),f),afterAnimate:v=>this.emit(new cr(fe.AFTER_ANIMATE,Bn.COLLAPSE,v,c),f),after:()=>this.emit(new Gt(fe.AFTER_DRAW,{dataChanges:u,animation:t}),f)},{collapse:{target:e,descendants:[...g(h.nodes),...g(h.combos)],position:o}}))===null||n===void 0?void 0:n.finished})}expandCombo(e,t){return Da(this,void 0,void 0,function*(){var n;const{model:i}=this.context,s=Kt(i.getComboData([e])[0]);this.computeStyle("expand");const a=this.computeChangesAndDrawData({stage:"expand",animation:t});if(!a)return;const{dataChanges:o,drawData:l}=a,{add:u,update:c}=l,d={animation:t,stage:"expand",data:l,target:e};this.createElements(u,d),this.updateElements(c,d);const h=f=>Array.from(f).map(([,g])=>q(g));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Gt(fe.BEFORE_DRAW,{dataChanges:o,animation:t}),d),beforeAnimate:f=>this.emit(new cr(fe.BEFORE_ANIMATE,Bn.EXPAND,f,l),d),afterAnimate:f=>this.emit(new cr(fe.AFTER_ANIMATE,Bn.EXPAND,f,l),d),after:()=>this.emit(new Gt(fe.AFTER_DRAW,{dataChanges:o,animation:t}),d)},{expand:{target:e,descendants:[...h(u.nodes),...h(u.combos)],position:s}}))===null||n===void 0?void 0:n.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var Xs=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})},K5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Q5{get presetOptions(){return{animation:!!i1(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}constructor(e){this.instances=[],this.context=e}getLayoutInstance(){return this.instances}preLayout(e){return Xs(this,void 0,void 0,function*(){var t,n,i,s;const{graph:a,model:o}=this.context,{add:l}=e;Zt(a,new Gt(fe.BEFORE_LAYOUT,{type:"pre"}));const u=yield(t=this.context.layout)===null||t===void 0?void 0:t.simulate();(n=u==null?void 0:u.nodes)===null||n===void 0||n.forEach(c=>{const d=q(c),h=l.nodes.get(d);o.syncNodeLikeDatum(c),h&&Object.assign(h.style,c.style)}),(i=u==null?void 0:u.edges)===null||i===void 0||i.forEach(c=>{const d=q(c),h=l.edges.get(d);o.syncEdgeDatum(c),h&&Object.assign(h.style,c.style)}),(s=u==null?void 0:u.combos)===null||s===void 0||s.forEach(c=>{const d=q(c),h=l.combos.get(d);o.syncNodeLikeDatum(c),h&&Object.assign(h.style,c.style)}),Zt(a,new Gt(fe.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",e)})}postLayout(){return Xs(this,arguments,void 0,function*(e=this.options){if(!e)return;const t=Array.isArray(e)?e:[e],{graph:n}=this.context;Zt(n,new Gt(fe.BEFORE_LAYOUT,{type:"post"}));for(const i of t){const s=t.indexOf(i),a=this.getLayoutData(i),o=Object.assign(Object.assign({},this.presetOptions),i);Zt(n,new Gt(fe.BEFORE_STAGE_LAYOUT,{options:o,index:s}));const l=yield this.stepLayout(a,o,s);Zt(n,new Gt(fe.AFTER_STAGE_LAYOUT,{options:o,index:s})),i.animation||this.updateElementPosition(l,!1)}Zt(n,new Gt(fe.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(e,t){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(i=>i.afterLayout(e,t))}simulate(){return Xs(this,void 0,void 0,function*(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const n of e){const i=e.indexOf(n),s=this.getLayoutData(n);t=yield this.stepLayout(s,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),i)}return t})}stepLayout(e,t,n){return Xs(this,void 0,void 0,function*(){return CC(t)?yield this.treeLayout(e,t,n):yield this.graphLayout(e,t,n)})}graphLayout(e,t,n){return Xs(this,void 0,void 0,function*(){const{animation:i,enableWorker:s,iterations:a=300}=t,o=this.initGraphLayout(t);if(!o)return{};if(this.instances[n]=o,this.instance=o,s){const u=o;return this.supervisor=new HL(u.graphData2LayoutModel(e),u.instance,{iterations:a}),zl(yield this.supervisor.execute())}if(uf(o))return i?yield o.execute(e,{onTick:u=>{this.updateElementPosition(u,!1)}}):(o.execute(e),o.stop(),o.tick(a));const l=yield o.execute(e);if(i){const u=this.updateElementPosition(l,i);yield u==null?void 0:u.finished}return l})}treeLayout(e,t,n){return Xs(this,void 0,void 0,function*(){const{type:i,animation:s}=t,a=di("layout",i);if(!a)return{};const{nodes:o=[],edges:l=[]}=e,u=new en({nodes:o.map(g=>({id:q(g),data:g.data||{}})),edges:l.map(g=>({id:q(g),source:g.source,target:g.target,data:g.data||{}}))});X5(u);const c={nodes:[],edges:[]},d={nodes:[],edges:[]};u.getRoots(Zn).forEach(g=>{sa(g,E=>{E.children=u.getSuccessors(E.id)},E=>u.getSuccessors(E.id),"TB");const v=a(g,t),{x:p,y,z:b=0}=v;sa(v,E=>{const{id:T,x:S,y:k,z:A=0}=E;c.nodes.push({id:T,style:{x:p,y,z:b}}),d.nodes.push({id:T,style:{x:S,y:k,z:A}})},E=>E.children,"TB")});const f=this.inferTreeLayoutOffset(d);if(pm(d,f),s){pm(c,f),this.updateElementPosition(c,!1);const g=this.updateElementPosition(d,s);yield g==null?void 0:g.finished}return d})}inferTreeLayoutOffset(e){var t;let[n,i]=[1/0,-1/0],[s,a]=[1/0,-1/0];(t=e.nodes)===null||t===void 0||t.forEach(v=>{const{x:p=0,y=0}=v.style||{};n=Math.min(n,p),i=Math.max(i,p),s=Math.min(s,y),a=Math.max(a,y)});const{canvas:o}=this.context,l=o.getSize(),[u,c]=o.getCanvasByViewport([0,0]),[d,h]=o.getCanvasByViewport(l);if(n>=u&&i<=d&&s>=c&&a<=h)return[0,0];const f=(u+d)/2,g=(c+h)/2;return[f-(n+i)/2,g-(s+a)/2]}stopLayout(){this.instance&&uf(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:i=!1}=e,{nodes:s,edges:a,combos:o}=this.context.model.getData(),{element:l,model:u}=this.context,c=v=>l.getElement(v),d=n?v=>{var p;return!i&&(((p=v.style)===null||p===void 0?void 0:p.visibility)==="hidden"||u.getAncestorsData(v.id,Zn).some(Wn)||u.getAncestorsData(v.id,st).some(Wn))?!1:t(v)}:v=>{const p=q(v),y=c(p);return!y||Uu(y)?!1:t(v)},h=s.filter(d),f=new Map(h.map(v=>[q(v),v]));o.forEach(v=>f.set(q(v),v));const g=a.filter(({source:v,target:p})=>f.has(v)&&f.has(p));return{nodes:h,edges:g,combos:o}}initGraphLayout(e){var t;const{element:n,viewport:i}=this.context,{type:s,enableWorker:a,animation:o,iterations:l}=e,u=K5(e,["type","enableWorker","animation","iterations"]),[c,d]=i.getCanvasSize(),h=[c/2,d/2],f=(t=e==null?void 0:e.nodeSize)!==null&&t!==void 0?t:b=>{const E=n==null?void 0:n.getElement(b.id);return E?E.attributes.size:n==null?void 0:n.getElementComputedStyle("node",b).size},g=di("layout",s);if(!g)return Yr.warn(`The layout of ${s} is not registered.`);const v=Object.getPrototypeOf(g.prototype)===Ku.prototype?g:_C(g,this.context),p=new v(this.context),y={nodeSize:f,width:c,height:d,center:h};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:c/2,y:d/2,z:0}});break}return Ln(p.options,y,u),p}updateElementPosition(e,t){const{model:n,element:i}=this.context;return i?(n.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)===null||e===void 0||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const pm=(r,e)=>{var t;const[n,i]=e;(t=r.nodes)===null||t===void 0||t.forEach(s=>{if(s.style){const{x:a=0,y:o=0}=s.style;s.style.x=a+n,s.style.y=o+i}else s.style={x:n,y:i}})};function J5(r){return[e6].reduce((t,n)=>n(t),r)}function e6(r){return!r.layout||Array.isArray(r.layout)||"preLayout"in r.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(r.layout.type)&&(r.layout.preLayout=!0),r}class t6 extends Vf{constructor(e){super(e),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(e){this.setExtensions(e)}getPluginInstance(e){const t=this.extensionMap[e];if(t)return t;Yr.warn(`Cannot find the plugin ${e}, will try to find it by type.`);const n=this.extensions.find(i=>i.type===e);if(n)return this.extensionMap[n.key]}}const Dl=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class n6 extends Vf{constructor(e){super(e),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(e){this.setExtensions([...Dl.slice(0,Dl.length-1),...e,Dl[Dl.length-1]])}getTransformInstance(e){return e?this.extensionMap[e]:this.extensionMap}}var Ia=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class r6{get padding(){return Vr(this.context.options.padding)}get paddingOffset(){const[e,t,n,i]=this.padding,[s,a,o]=[(i-t)/2,(e-n)/2,0];return[s,a,o]}constructor(e){this.landmarkCounter=0,this.context=e;const[t,n]=this.paddingOffset,{zoom:i,rotation:s,x:a=t,y:o=n}=e.options;this.transform({mode:"absolute",scale:i,translate:[a,o],rotate:s},!1)}get camera(){const{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,n)=>{const s=Object.entries(e.getLayers()).filter(([o])=>!["main"].includes(o)).map(([,o])=>o.getCamera()),a=t[n];if(typeof a=="function")return(...o)=>{const l=a.apply(t,o);return s.forEach(u=>{u[n].apply(u,o)}),l}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=i1(this.context.options,e);return t?xs(Object.assign({},t),["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t,n]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t/2,n/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:n,translate:i=[]}=e,s=this.getZoom(),a=t.getPosition(),o=t.getFocalPoint(),[l,u]=this.getCanvasCenter(),[c=0,d=0,h=0]=i,f=Tr([-c,-d,-h],s);return n==="relative"?{position:ze(a,f),focalPoint:ze(o,f)}:{position:ze([l,u,a[2]],f),focalPoint:ze([l,u,o[2]],f)}}getRotateOptions(e){const{mode:t,rotate:n=0}=e;return{roll:t==="relative"?this.camera.getRoll()+n:n}}getZoomOptions(e){const{zoomRange:t}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:s=1}=e;return At(i==="relative"?n*s:s,...t)}transform(e,t){return Ia(this,void 0,void 0,function*(){const{graph:n}=this.context,{translate:i,rotate:s,scale:a,origin:o}=e;this.cancelAnimation();const l=this.getAnimation(t);if(Zt(n,new Ll(fe.BEFORE_TRANSFORM,e)),!s&&a&&!i&&o&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),o),Zt(n,new Ll(fe.AFTER_TRANSFORM,e));return}const u={};if(i&&Object.assign(u,this.getTranslateOptions(e)),ye(s)&&Object.assign(u,this.getRotateOptions(e)),ye(a)&&Object.assign(u,{zoom:this.getZoomOptions(e)}),l)return Zt(n,new cr(fe.BEFORE_ANIMATE,Bn.TRANSFORM,null,e)),new Promise(c=>{this.transformResolver=c,this.camera.gotoLandmark(this.createLandmark(u),Object.assign(Object.assign({},l),{onfinish:()=>{Zt(n,new cr(fe.AFTER_ANIMATE,Bn.TRANSFORM,null,e)),Zt(n,new Ll(fe.AFTER_TRANSFORM,e)),this.transformResolver=void 0,c()}}))});this.camera.gotoLandmark(this.createLandmark(u),{duration:0}),Zt(n,new Ll(fe.AFTER_TRANSFORM,e))})}fitView(e,t){return Ia(this,void 0,void 0,function*(){const[n,i,s,a]=this.padding,{when:o="always",direction:l="both"}=e||{},[u,c]=this.context.canvas.getSize(),d=u-a-i,h=c-n-s,f=this.context.canvas.getBounds(),g=this.getBBoxInViewport(f),[v,p]=qi(g),y=l==="x"&&v>=d||l==="y"&&p>=h||l==="both"&&v>=d&&p>=h;if(o==="overflow"&&!y)return yield this.fitCenter({animation:t});const b=d/v,E=h/p,T=l==="x"?b:l==="y"?E:Math.min(b,E),S=this.getAnimation(t);yield this.transform({mode:"relative",scale:T,translate:ze(it(this.getCanvasCenter(),this.getBBoxInViewport(f).center),Tr(this.paddingOffset,T))},S)})}fitCenter(e){return Ia(this,void 0,void 0,function*(){const t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e){return Ia(this,arguments,void 0,function*(t,n={}){const{element:i}=this.context;if(!i)return;const s=o=>n.shapes?o.getShape(n.shapes).getRenderBounds():o.getRenderBounds(),a=Eo(t.map(o=>s(i.getElement(o))));yield this.focus(a,n)})}focus(e,t){return Ia(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(e.center),i=t.position||this.getCanvasCenter(),s=it(i,n);yield this.transform({mode:"relative",translate:ze(s,this.paddingOffset)},t.animation)})}getBBoxInViewport(e){const{min:t,max:n}=e,{graph:i}=this.context,[s,a]=i.getViewportByCanvas(t),[o,l]=i.getViewportByCanvas(n),u=new ct;return u.setMinMax([s,a,0],[o,l,0]),u}isInViewport(e,t=!1,n=0){const{graph:i}=this.context,s=this.getCanvasSize(),[a,o]=i.getCanvasByViewport([0,0]),[l,u]=i.getCanvasByViewport(s);let c=new ct;return c.setMinMax([a,o,0],[l,u,0]),n&&(c=Zi(c,n)),ha(e)?Sr(e,c):t?Lk(e,c):c.intersects(e)}cancelAnimation(){var e,t;!((e=this.camera.landmarks)===null||e===void 0)&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)===null||t===void 0||t.call(this)}}var lt=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(c){try{u(n.next(c))}catch(d){a(d)}}function l(c){try{u(n.throw(c))}catch(d){a(d)}}function u(c){c.done?s(c.value):i(c.value).then(o,l)}u((n=n.apply(r,e||[])).next())})};class Ic extends Zu{constructor(e){var t;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new q5},this.isCollapsingExpanding=!1,this.onResize=vo(()=>{this.resize()},300),this._setOptions(Object.assign({},Ic.defaultOptions,e),!0),this.context.graph=this,this.options.autoResize&&((t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(e){this._setOptions(e,!1)}_setOptions(e,t){if(this.updateCanvas(e),Object.assign(this.options,J5(e)),t){const{data:h}=e;h&&this.addData(h);return}const{behaviors:n,combo:i,data:s,edge:a,layout:o,node:l,plugins:u,theme:c,transforms:d}=e;n&&this.setBehaviors(n),s&&this.setData(s),l&&this.setNode(l),a&&this.setEdge(a),i&&this.setCombo(i),o&&this.setLayout(o),c&&this.setTheme(c),u&&this.setPlugins(u),d&&this.setTransforms(d)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(e,t){e&&(this.options.width=e),t&&(this.options.height=t),this.resize(e,t)}setZoomRange(e){this.options.zoomRange=e}getZoomRange(){return this.options.zoomRange}setNode(e){this.options.node=e,this.context.model.refreshData()}setEdge(e){this.options.edge=e,this.context.model.refreshData()}setCombo(e){this.options.combo=e,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(e){this.options.theme=Ee(e)?e(this.getTheme()):e}setLayout(e){this.options.layout=Ee(e)?e(this.getLayout()):e}getLayout(){return this.options.layout}setBehaviors(e){var t;this.options.behaviors=Ee(e)?e(this.getBehaviors()):e,(t=this.context.behavior)===null||t===void 0||t.setBehaviors(this.options.behaviors)}updateBehavior(e){this.setBehaviors(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getBehaviors(){return this.options.behaviors||[]}setPlugins(e){var t;this.options.plugins=Ee(e)?e(this.getPlugins()):e,(t=this.context.plugin)===null||t===void 0||t.setPlugins(this.options.plugins)}updatePlugin(e){this.setPlugins(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getPlugins(){return this.options.plugins||[]}getPluginInstance(e){return this.context.plugin.getPluginInstance(e)}setTransforms(e){var t;this.options.transforms=Ee(e)?e(this.getTransforms()):e,(t=this.context.transform)===null||t===void 0||t.setTransforms(this.options.transforms)}updateTransform(e){this.setTransforms(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(e){return Array.isArray(e)?e.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(e)}getNodeData(e){return e===void 0?this.context.model.getNodeData():Array.isArray(e)?this.context.model.getNodeData(e):this.context.model.getNodeLikeDatum(e)}getEdgeData(e){return e===void 0?this.context.model.getEdgeData():Array.isArray(e)?this.context.model.getEdgeData(e):this.context.model.getEdgeDatum(e)}getComboData(e){return e===void 0?this.context.model.getComboData():Array.isArray(e)?this.context.model.getComboData(e):this.context.model.getNodeLikeDatum(e)}setData(e){this.context.model.setData(Ee(e)?e(this.getData()):e)}addData(e){this.context.model.addData(Ee(e)?e(this.getData()):e)}addNodeData(e){this.context.model.addNodeData(Ee(e)?e(this.getNodeData()):e)}addEdgeData(e){this.context.model.addEdgeData(Ee(e)?e(this.getEdgeData()):e)}addComboData(e){this.context.model.addComboData(Ee(e)?e(this.getComboData()):e)}addChildrenData(e,t){this.context.model.addChildrenData(e,t)}updateData(e){this.context.model.updateData(Ee(e)?e(this.getData()):e)}updateNodeData(e){this.context.model.updateNodeData(Ee(e)?e(this.getNodeData()):e)}updateEdgeData(e){this.context.model.updateEdgeData(Ee(e)?e(this.getEdgeData()):e)}updateComboData(e){this.context.model.updateComboData(Ee(e)?e(this.getComboData()):e)}removeData(e){this.context.model.removeData(Ee(e)?e(this.getData()):e)}removeNodeData(e){this.context.model.removeNodeData(Ee(e)?e(this.getNodeData()):e)}removeEdgeData(e){this.context.model.removeEdgeData(Ee(e)?e(this.getEdgeData()):e)}removeComboData(e){this.context.model.removeComboData(Ee(e)?e(this.getComboData()):e)}getElementType(e){return this.context.model.getElementType(e)}getRelatedEdgesData(e,t="both"){return this.context.model.getRelatedEdgesData(e,t)}getNeighborNodesData(e){return this.context.model.getNeighborNodesData(e)}getAncestorsData(e,t){return this.context.model.getAncestorsData(e,t)}getParentData(e,t){return this.context.model.getParentData(e,t)}getChildrenData(e){return this.context.model.getChildrenData(e)}getDescendantsData(e){return this.context.model.getDescendantsData(e)}getElementDataByState(e,t){return this.context.model.getElementDataByState(e,t)}initCanvas(){return lt(this,void 0,void 0,function*(){var e;if(this.context.canvas)return yield this.context.canvas.ready;const{container:t="container",width:n,height:i,renderer:s,cursor:a,background:o,canvas:l,devicePixelRatio:u=(e=globalThis.devicePixelRatio)!==null&&e!==void 0?e:1}=this.options;if(t instanceof um)this.context.canvas=t,a&&t.setCursor(a),s&&t.setRenderer(s),yield t.ready;else{const c=Ke(t)?document.getElementById(t):t,d=hm(c);this.emit(fe.BEFORE_CANVAS_INIT,{container:c,width:n,height:i});const h=Object.assign(Object.assign({},l),{container:c,width:n||d[0],height:i||d[1],background:o,renderer:s,cursor:a,devicePixelRatio:u}),f=new um(h);this.context.canvas=f,yield f.ready,this.emit(fe.AFTER_CANVAS_INIT,{canvas:f})}})}updateCanvas(e){var t,n;const{renderer:i,cursor:s,height:a,width:o}=e,l=this.context.canvas;l&&(i&&(this.emit(fe.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),l.setRenderer(i),this.emit(fe.AFTER_RENDERER_CHANGE,{renderer:i})),s&&l.setCursor(s),(ye(o)||ye(a))&&this.setSize((t=o??this.options.width)!==null&&t!==void 0?t:0,(n=a??this.options.height)!==null&&n!==void 0?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new V5(this.context)),this.context.plugin||(this.context.plugin=new t6(this.context)),this.context.viewport||(this.context.viewport=new r6(this.context)),this.context.transform||(this.context.transform=new n6(this.context)),this.context.element||(this.context.element=new Z5(this.context)),this.context.animation||(this.context.animation=new Y5(this.context)),this.context.layout||(this.context.layout=new Q5(this.context)),this.context.behavior||(this.context.behavior=new U5(this.context))}prepare(){return lt(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(oi("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return lt(this,void 0,void 0,function*(){if(yield this.prepare(),Zt(this,new Gt(fe.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&PC(this.options.layout)){const e=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}this.rendered=!0,Zt(this,new Gt(fe.AFTER_RENDER))})}draw(){return lt(this,void 0,void 0,function*(){var e;yield this.prepare(),yield(e=this.context.element.draw())===null||e===void 0?void 0:e.finished})}layout(e){return lt(this,void 0,void 0,function*(){yield this.context.layout.postLayout(e)})}stopLayout(){this.context.layout.stopLayout()}clear(){return lt(this,void 0,void 0,function*(){const{model:e,element:t}=this.context;e.setData({}),e.clearChanges(),t==null||t.clear()})}destroy(){var e;Zt(this,new Gt(fe.BEFORE_DESTROY));const{layout:t,animation:n,element:i,model:s,canvas:a,behavior:o,plugin:l}=this.context;l==null||l.destroy(),o==null||o.destroy(),t==null||t.destroy(),n==null||n.destroy(),i==null||i.destroy(),s.destroy(),a==null||a.destroy(),this.options={},this.context={},this.off(),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize),this.destroyed=!0,Zt(this,new Gt(fe.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(e,t){var n;const i=hm((n=this.context.canvas)===null||n===void 0?void 0:n.getContainer()),s=[e||i[0],t||i[1]];if(!this.context.canvas)return;const a=this.context.canvas.getSize();Ct(s,a)||(Zt(this,new Gt(fe.BEFORE_SIZE_CHANGE,{size:s})),this.context.canvas.resize(...s),Zt(this,new Gt(fe.AFTER_SIZE_CHANGE,{size:s})))}fitView(e,t){return lt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.fitView(e,t)})}fitCenter(e){return lt(this,void 0,void 0,function*(){var t;yield(t=this.context.viewport)===null||t===void 0?void 0:t.fitCenter({animation:e})})}autoFit(){return lt(this,void 0,void 0,function*(){const{autoFit:e}=this.context.options;if(e)if(Ke(e))e==="view"?yield this.fitView():e==="center"&&(yield this.fitCenter());else{const{type:t,animation:n}=e;t==="view"?yield this.fitView(e.options,n):t==="center"&&(yield this.fitCenter(n))}})}focusElement(e,t){return lt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.focusElements(Array.isArray(e)?e:[e],{animation:t})})}zoomBy(e,t,n){return lt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:e,origin:n},t)})}zoomTo(e,t,n){return lt(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:e,origin:n},t)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(e,t,n){return lt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:e,origin:n},t)})}rotateTo(e,t,n){return lt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:e,origin:n},t)})}getRotation(){return this.context.viewport.getRotation()}translateBy(e,t){return lt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:e},t)})}translateTo(e,t){return lt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:e},t)})}getPosition(){return it([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(e,t){return lt(this,arguments,void 0,function*(n,i,s=!0){var a,o;const[l,u]=Bt(n)?[n,(a=i)!==null&&a!==void 0?a:!0]:[{[n]:i},s];Object.entries(l).forEach(([c,d])=>this.context.model.translateNodeLikeBy(c,d)),yield(o=this.context.element.draw({animation:u,stage:"translate"}))===null||o===void 0?void 0:o.finished})}translateElementTo(e,t){return lt(this,arguments,void 0,function*(n,i,s=!0){var a,o;const[l,u]=Bt(n)?[n,(a=i)!==null&&a!==void 0?a:!0]:[{[n]:i},s];Object.entries(l).forEach(([c,d])=>this.context.model.translateNodeLikeTo(c,d)),yield(o=this.context.element.draw({animation:u,stage:"translate"}))===null||o===void 0?void 0:o.finished})}getElementPosition(e){return this.context.model.getElementPosition(e)}getElementRenderStyle(e){return Cf(this.context.element.getElement(e).attributes,["context"])}setElementVisibility(e,t){return lt(this,arguments,void 0,function*(n,i,s=!0){var a,o;const[l,u]=Bt(n)?[n,(a=i)!==null&&a!==void 0?a:!0]:[{[n]:i},s],c={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([f,g])=>{const v=this.getElementType(f);c[`${v}s`].push({id:f,style:{visibility:g}})});const{model:d,element:h}=this.context;d.preventUpdateNodeLikeHierarchy(()=>{d.updateData(c)}),yield(o=h.draw({animation:u,stage:"visibility"}))===null||o===void 0?void 0:o.finished})}showElement(e,t){return lt(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"visible"])),t)})}hideElement(e,t){return lt(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"hidden"])),t)})}getElementVisibility(e){var t,n;const i=this.context.element.getElement(e);return(n=(t=i==null?void 0:i.style)===null||t===void 0?void 0:t.visibility)!==null&&n!==void 0?n:"visible"}setElementZIndex(e,t){return lt(this,void 0,void 0,function*(){var n;const i={nodes:[],edges:[],combos:[]},s=Bt(e)?e:{[e]:t};Object.entries(s).forEach(([l,u])=>{const c=this.getElementType(l);i[`${c}s`].push({id:l,style:{zIndex:u}})});const{model:a,element:o}=this.context;a.preventUpdateNodeLikeHierarchy(()=>a.updateData(i)),yield(n=o.draw({animation:!1,stage:"zIndex"}))===null||n===void 0?void 0:n.finished})}frontElement(e){return lt(this,void 0,void 0,function*(){const t=Array.isArray(e)?e:[e],{model:n}=this.context,i={};t.map(s=>{const a=n.getFrontZIndex(s);if(n.getElementType(s)==="combo"){const l=n.getAncestorsData(s,st).at(-1)||this.getComboData(s),u=[l,...n.getDescendantsData(q(l))],c=a-fm(l);u.forEach(h=>{i[q(h)]=this.getElementZIndex(q(h))+c});const{internal:d}=Jh(u.map(q),h=>n.getRelatedEdgesData(h));d.forEach(h=>{const f=q(h);i[f]=this.getElementZIndex(f)+c})}else i[s]=a}),yield this.setElementZIndex(i)})}getElementZIndex(e){return fm(this.context.model.getElementDataById(e))}setElementState(e,t){return lt(this,arguments,void 0,function*(n,i,s=!0){var a,o;const[l,u]=Bt(n)?[n,(a=i)!==null&&a!==void 0?a:!0]:[{[n]:i},s],c=h=>h?Array.isArray(h)?h:[h]:[],d={nodes:[],edges:[],combos:[]};Object.entries(l).forEach(([h,f])=>{const g=this.getElementType(h);d[`${g}s`].push({id:h,states:c(f)})}),this.updateData(d),yield(o=this.context.element.draw({animation:u,stage:"state"}))===null||o===void 0?void 0:o.finished})}getElementState(e){return this.context.model.getElementState(e)}getElementRenderBounds(e){return this.context.element.getElement(e).getRenderBounds()}collapseElement(e){return lt(this,arguments,void 0,function*(t,n=!0){const{model:i,element:s}=this.context;if(Wn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const a=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),a==="node"?yield s.collapseNode(t,n):a==="combo"&&(yield s.collapseCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}expandElement(e){return lt(this,arguments,void 0,function*(t,n=!0){const{model:i,element:s}=this.context;if(!Wn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const a=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),a==="node"?yield s.expandNode(t,n):a==="combo"&&(yield s.expandCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(e,t){const n=this.getElementType(e);n==="node"?this.updateNodeData([{id:e,style:{collapsed:t}}]):n==="combo"&&this.updateComboData([{id:e,style:{collapsed:t}}])}toDataURL(){return lt(this,arguments,void 0,function*(e={}){return this.context.canvas.toDataURL(e)})}getCanvasByViewport(e){return this.context.canvas.getCanvasByViewport(e)}getViewportByCanvas(e){return this.context.canvas.getViewportByCanvas(e)}getClientByCanvas(e){return this.context.canvas.getClientByCanvas(e)}getCanvasByClient(e){return this.context.canvas.getCanvasByClient(e)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(e,t,n){return super.on(e,t,n)}once(e,t){return super.once(e,t)}off(e,t){return super.off(e,t)}}Ic.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};class i6 extends es{beforeDraw(e){const{add:t,update:n}=e,{model:i}=this.context;return[...t.edges.entries(),...n.edges.entries()].forEach(([,s])=>{Aw(i,s)}),e}}const Aw=(r,e)=>{const{source:t,target:n}=e,i=r.getElementDataById(t),s=r.getElementDataById(n),a=Kp(i,d=>r.getParentData(d,st)),o=Kp(s,d=>r.getParentData(d,st)),l=q(a),u=q(o),c={sourceNode:l,targetNode:u};return e.style?Object.assign(e.style,c):e.style=c,e},s6=(r,e,t)=>{const[n,i]=e,[s,a]=t;if(i===n)return s;const o=(r-n)/(i-n);return s+o*(a-s)},a6=(r,e,t)=>{const[n,i]=e,[s,a]=t,o=Math.log(r-n+1)/Math.log(i-n+1);return s+o*(a-s)},o6=(r,e,t,n=2)=>{const[i,s]=e,[a,o]=t,l=Math.pow((r-i)/(s-i),n);return a+l*(o-a)},l6=(r,e,t)=>{const[n,i]=e,[s,a]=t,o=Math.sqrt((r-n)/(i-n));return s+o*(a-s)};class Rc extends es{constructor(e,t){super(e,Ln({},Rc.defaultOptions,t)),this.assignSizeByCentrality=(n,i,s,a,o,l)=>{const u=[i,s],c=[a[0],o[0]],d=[a[1],o[1]],h=[a[2],o[2]],f=(g,v)=>{if(typeof l=="function")return l(g,u,v);switch(l){case"linear":return s6(g,u,v);case"log":return a6(g,u,v);case"pow":return o6(g,u,v,2);case"sqrt":return l6(g,u,v);default:return v[0]}};return[f(n,c),f(n,d),f(n,h)]}}beforeDraw(e){const{model:t}=this.context,n=t.getNodeData(),i=er(this.options.maxSize),s=er(this.options.minSize),a=this.getCentralities(this.options.centrality),o=a.size>0?Math.max(...a.values()):0,l=a.size>0?Math.min(...a.values()):0;return n.forEach(u=>{var c;const d=this.assignSizeByCentrality(a.get(q(u))||0,l,o,s,i,this.options.scale),h=(c=this.context.element)===null||c===void 0?void 0:c.getElement(q(u)),f={size:d};this.assignLabelStyle(f,d,u,h),(!h||!Gl(f,h.attributes))&&Jn(e,h?"update":"add","node",Ln(u,{style:f}),!0)}),e}assignLabelStyle(e,t,n,i){var s;const a=i?i.config.style:(s=this.context.element)===null||s===void 0?void 0:s.getElementComputedStyle("node",n);if(Object.assign(e,xs(a,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const o=this.getLabelSizeByNodeSize(t,1/0,Number(e.labelFontSize));Object.assign(e,{labelFontSize:o,labelLineHeight:o+_k(e.labelPadding)})}return e}getLabelSizeByNodeSize(e,t,n){const i=Math.min(...e)/2,[s,a]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,t];return Math.min(a,Math.max(i,s))}getCentralities(e){const{model:t}=this.context,n=t.getData();if(typeof e=="function")return e(n);const i=t.getRelatedEdgesData.bind(t);return p1(n,i,e)}}Rc.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class jc extends es{constructor(e,t){super(e,Object.assign({},jc.defaultOptions,t))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var e;const t=Kt(this.ref),{graph:n,model:i}=this.context;(e=i.getData().nodes)===null||e===void 0||e.forEach(a=>{var o;if(q(a)===q(this.ref))return;const l=m1(it(Kt(a),t)),u=Math.abs(l)>Math.PI/2,c=!a.children||a.children.length===0,d=q(a),h=(o=this.context.element)===null||o===void 0?void 0:o.getElement(d);if(!h||!h.isVisible())return;const f=er(n.getElementRenderStyle(d).size)[0]/2,g=(c?1:-1)*(f+this.options.offset),v=[["translate",g*Math.cos(l),g*Math.sin(l)],["rotate",u?Fn(l)+180:Fn(l)]];i.updateNodeData([{id:q(a),style:{labelTextAlign:u===c?"right":"left",labelTextBaseline:"middle",labelTransform:v}}])}),n.draw()}}jc.defaultOptions={offset:5};const u6="quadratic",vm=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class Bc extends es{constructor(e,t){super(e,Object.assign({},Bc.defaultOptions,t)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=n=>{const{add:{edges:i},update:{nodes:s,edges:a,combos:o},remove:{edges:l}}=n,{model:u}=this.context,c=new Map,d=(g,v)=>{u.getRelatedEdgesData(v).forEach(y=>!c.has(q(y))&&c.set(q(y),y))};s.forEach(d),o.forEach(d);const h=g=>{const v=u.getEdgeData().map(y=>Aw(u,y));c6(g,v).forEach(y=>!c.has(q(y))&&c.set(q(y),y))};if(l.size&&l.forEach(h),i.size&&i.forEach(h),a.size){const g=Wb(fg(u.getChanges())).update.edges;a.forEach(v=>{var p;h(v);const y=(p=g.find(b=>q(b.value)===q(v)))===null||p===void 0?void 0:p.original;y&&!Ng(v,y)&&h(y)})}Ir(this.options.edges)||c.forEach((g,v)=>!this.options.edges.includes(v)&&c.delete(v));const f=u.getEdgeData().map(q);return new Map([...c].sort((g,v)=>f.indexOf(g[0])-f.indexOf(v[0])))},this.applyBundlingStyle=(n,i,s)=>{const{edgeMap:a,reverses:o}=mm(i);a.forEach(l=>{l.forEach((u,c,d)=>{var h;const f=d.length,g=u.style||{};if(u.source===u.target){const y=vm.length;g.loopPlacement=vm[c%y],g.loopDist=Math.floor(c/y)*s+50}else if(f===1)g.curveOffset=0;else{const y=(c%2===0?1:-1)*(o[`${u.source}|${u.target}|${c}`]?-1:1);g.curveOffset=f%2===1?y*Math.ceil(c/2)*s*2:y*(Math.floor(c/2)*s*2+s)}const v=Object.assign(u,{type:u6,style:g}),p=(h=this.context.element)===null||h===void 0?void 0:h.getElement(q(u));(!p||!Gl(v.style,p.attributes))&&Jn(n,p?"update":"add","edge",v,!0)})})},this.resetEdgeStyle=n=>{const i=n.style||{},s=this.cacheMergeStyle.get(q(n))||{};return Object.keys(s).forEach(a=>{Ct(i[a],s[a])&&(n[a]?i[a]=n[a]:delete i[a])}),Object.assign(n,{style:i})},this.applyMergingStyle=(n,i)=>{const{edgeMap:s,reverses:a}=mm(i);s.forEach(o=>{var l;if(o.length===1){const c=o[0],d=(l=this.context.element)===null||l===void 0?void 0:l.getElement(q(c)),h=this.resetEdgeStyle(c);(!d||!Gl(h,d.attributes))&&Jn(n,d?"update":"add","edge",h);return}const u=o.map(({source:c,target:d,style:h={}},f)=>{const{startArrow:g,endArrow:v}=h,p={},[y,b]=a[`${c}|${d}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return Ql(g)&&(p[y]=g),Ql(v)&&(p[b]=v),p}).reduce((c,d)=>Object.assign(Object.assign({},c),d),{});o.forEach((c,d,h)=>{var f;if(d!==0){Jn(n,"remove","edge",c);return}const g=Object.assign({},Ee(this.options.style)?this.options.style(h):this.options.style,{childrenData:h});this.cacheMergeStyle.set(q(c),g);const v=Object.assign(Object.assign({},c),{type:"line",style:Object.assign(Object.assign(Object.assign({},c.style),u),g)}),p=(f=this.context.element)===null||f===void 0?void 0:f.getElement(q(c));(!p||!Gl(v.style,p.attributes))&&Jn(n,p?"update":"add","edge",v,!0)})})}}beforeDraw(e){const t=this.getAffectedParallelEdges(e);return t.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(e,t,this.options.distance):this.applyMergingStyle(e,t)),e}}Bc.defaultOptions={mode:"bundle",distance:15};const mm=r=>{const e=new Map,t=new Set,n={};for(const[i,s]of r){if(t.has(i))continue;const{source:a,target:o}=s,l=`${a}-${o}`;e.has(l)||e.set(l,[]),e.get(l).push(s),t.add(i);for(const[u,c]of r)t.has(u)||Ng(s,c)&&(e.get(l).push(c),t.add(u),a===c.target&&o===c.source&&(n[`${c.source}|${c.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:n}},c6=(r,e,t)=>e.filter(n=>Ng(n,r)),Ng=(r,e)=>{const{sourceNode:t,targetNode:n}=r.style||{},{sourceNode:i,targetNode:s}=e.style||{};return t===i&&n===s||t===s&&n===i};class d6 extends es{beforeDraw(e,t){const{stage:n}=t;if(n==="visibility")return e;const{model:i}=this.context,{update:{nodes:s,edges:a,combos:o}}=e,l=(u,c)=>{i.getRelatedEdgesData(c).forEach(h=>!a.has(q(h))&&a.set(q(h),h))};return s.forEach(l),o.forEach(l),e}}const h6={animation:{"combo-collapse":l1,"combo-expand":Ak,"node-collapse":a1,"node-expand":kk,"path-in":o1,"path-out":Nk,fade:Tk,translate:Ok},behavior:{"brush-select":Mo,"click-select":Iu,"collapse-expand":Hu,"create-edge":Xu,"drag-canvas":qu,"drag-element-force":DC,"drag-element":No,"fix-element-size":Qu,"focus-element":Ju,"hover-activate":ec,"lasso-select":RC,"auto-adapt-label":_u,"optimize-viewport-transform":tc,"scroll-canvas":nc,"zoom-canvas":rc},combo:{circle:LA,rect:DA},edge:{cubic:Ls,line:q1,polyline:Yu,quadratic:Vu,"cubic-horizontal":$u,"cubic-radial":Wu,"cubic-vertical":Gu},layout:{"antv-dagre":B_,"combo-combined":H3,"compact-box":El.compactBox,"d3-force":hL,"force-atlas2":gL,circular:$_,concentric:of,dagre:oc,dendrogram:El.dendrogram,fishbone:lc,force:Mb,fruchterman:mL,grid:bL,indented:El.indented,mds:Tb,mindmap:El.mindmap,radial:NL,random:IL,snake:uc},node:{circle:Oo,diamond:RN,ellipse:Bu,hexagon:$N,html:zu,image:W1,rect:PA,star:_A,donut:ju,triangle:Fu},palette:{spectral:KL,tableau:QL,oranges:JL,greens:eD,blues:tD},theme:{dark:P5,light:L5},plugin:{"bubble-sets":hc,"edge-bundling":gc,"edge-filter-lens":pc,"grid-line":yc,background:cc,contextmenu:fc,fisheye:vc,fullscreen:mc,history:bc,hull:wc,legend:kc,minimap:Nc,snapline:Ac,timebar:Cc,toolbar:Pc,tooltip:_c,watermark:Lc},transform:{"arrange-draw-order":D5,"collapse-expand-combo":I5,"collapse-expand-node":R5,"get-edge-actual-ends":i6,"map-node-size":Rc,"place-radial-labels":jc,"process-parallel-edges":Bc,"update-related-edges":d6},shape:{circle:pi,ellipse:bo,group:Jt,html:wo,image:Zf,line:Ss,path:Kn,polygon:Ps,polyline:Cu,rect:pn,text:_s,label:Ki,badge:ma}};function f6(){Object.entries(h6).forEach(([r,e])=>{Object.entries(e).forEach(([t,n])=>{j5(r,t,n)})})}f6();const Ag={MILESTONE:{type:"Milestone",color:"#5b5b5b",textColor:"",base64:"",flag64:""},NOT_STARTED:{type:"Not started",color:"#CCCDD0",textColor:"#5b5b5b",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0NERDAiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0NERDAiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},DELAYED:{type:"Deplayed",color:"#B81111",textColor:"#dccbcb",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNCODExMTEiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNCODExMTEiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},PAUSED:{type:"Paused",color:"#0E42D2",textColor:"#dae0f0",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMwRTQyRDIiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMwRTQyRDIiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},IN_PROGRESS:{type:"In progress",color:"#E1BE0D",textColor:"#4f4304",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNFMUJFMEQiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNFMUJFMEQiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED:{type:"Completed",color:"#33C73D",textColor:"#084e0c",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMzM0M3M0QiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMzM0M3M0QiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED_EARLY:{type:"Completed early",color:"#CCFF99",textColor:"#42681d",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0ZGOTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0ZGOTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED_LATE:{type:"Completed late",color:"#CC6699",textColor:"#4b092a",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQzY2OTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQzY2OTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="}};function ym(r){if(!r.status)return"";const e=r.milestone?"flag64":"base64";return Ag[r.status][e]}function g6(r){const e=ax(),t="rgb(158 163 171)",{container:n,autoFit:i="center",data:s,behaviors:a=[]}=r,o=new Ic({container:n,animation:!1,padding:16,theme:"light",autoFit:i,data:s,node:{type:"rect",style:l=>{const u=ym(l);let c="#000000";return l.taskState==="NOT_STARTED"&&(c="#787878"),{labelText:l.name,size:[120,26],radius:99,fill:"#FFFFFF",stroke:l.isDeleted?e.otherColor.error:t,lineDash:l.isDeleted?4:0,lineWidth:1,labelFill:c,labelX:2,labelY:2,labelTextBaseline:"middle",labelTextAlign:"center",labelLineHeight:13,labelWordWrap:!0,labelMaxWidth:72,iconSrc:u,iconWidth:16,iconHeight:16,iconX:-45,labelFontSize:12,labelPlacement:"center",badgeLineWidth:6,badgeFontSize:8,badges:[{text:"Postponement",placement:"top",offsetY:-11,visibility:l.isDelayed?"visible":"hidden"},{text:"Deleted",placement:"bottom",offsetY:11,visibility:l.isDeleted?"visible":"hidden"}],badgePalette:[e.otherColor.error,e.otherColor.error],ports:[{placement:"left"},{placement:"right"}]}},state:{selected:{lineWidth:2,stroke:e.themeColor,labelFill:e.themeColor,halo:!0,haloStroke:e.themeColor,haloLineWidth:6},active:l=>({halo:!0,haloStroke:l.isDeleted?e.otherColor.error:e.themeColor,haloLineWidth:6,zIndex:2})}},edge:{type:"cubic-horizontal",style:l=>({curveOffset:10,curvePosition:.5,stroke:l.isDeleted?e.otherColor.error:t,lineDash:l.isDeleted?4:0}),state:{active:l=>({lineWidth:2,stroke:l.isDeleted?e.otherColor.error:e.themeColor,halo:!0,haloStroke:l.isDeleted?e.otherColor.error:e.themeColor,haloLineWidth:6,zIndex:2})}},layout:{type:"antv-dagre",rankdir:"LR",ranksep:20,nodesep:-20,controlPoints:!0},behaviors:[{key:"hover-activate",type:"hover-activate",degree:1,direction:"both"},"drag-canvas",...a],plugins:[{type:"tooltip",enable:l=>l.targetType==="node",getContent:(l,u)=>{let c='<div style="display: flex; flex-direction: column; gap: 8px;">';return u==null||u.forEach(d=>{c+=`<h3 style="display: flex; align-items: center; gap: 8px;">${d.name}</h3>`,c+=`<div style="display: flex;"><b>Status: </b><div style="display: flex; gap: 4px;"><img src="${ym(d)}" /><span style="font-weight: 400 !important;">${Ag[d.status].type}</span></div></div>`,c+='<div style="display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); column-gap: 32px; row-gap: 4px;">',c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">Expected start</div><div style="font-weight: 700;">${d.startDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">Expected end</div><div style="font-weight: 700;">${d.endDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">Actual start</div><div style="font-weight: 700;">${d.actualStartDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">Actual end</div><div style="font-weight: 700;">${d.actualEndDate||"-"}</div></div>`,c+="</div>"}),c+="</div>",c}}]});return o.render(),{graph:o}}const p6={class:"relative"},v6={class:"absolute left-0 right-0 z-1 flex items-center items-stretch justify-between"},m6={class:"flex-center gap-12px"},y6={class:"flex-col gap-8px"},b6=Mu({name:"AntvFLow",__name:"antv-flow",props:{behaviors:{},data:{},selected:{},height:{},autoFit:{}},setup(r,{expose:e}){const t=r,n=Tm("containerRef"),i=Tu(null),s=cx(()=>{i.value&&i.value.resize()},5);async function a(){i.value&&i.value.destroy();const{graph:h}=g6({container:"antv-flow",data:t.data,behaviors:t.behaviors,autoFit:t.autoFit});i.value=h,await o()}async function o(){if(t.selected&&i.value)try{await i.value.setElementState(t.selected,"selected")}catch{}}function l(){var h;(h=i.value)==null||h.zoomBy(.9)}function u(){var h;(h=i.value)==null||h.zoomBy(1.1)}function c(){var h,f;(h=i.value)==null||h.zoomTo(1),(f=i.value)==null||f.fitCenter()}function d(){var h,f;(h=i.value)==null||h.fitView(),(f=i.value)==null||f.fitCenter()}return Su([()=>t.data,()=>t.selected],()=>{a()},{deep:!0}),e({selectNode:o,graph:i}),(h,f)=>{const g=Kx,v=Om,p=Xx,y=Vx,b=Wx,E=Ox,T=zx,S=Rx,k=Lx,A=xx,O=wx,C=bx,P=yx;return Nn(),$r("div",p6,[jt("div",v6,[$t(E,{size:"small",class:"bg-white!"},{default:rn(()=>[$t(v,{onClick:l},{default:rn(()=>[$t(g)]),_:1}),$t(v,{onClick:u},{default:rn(()=>[$t(p)]),_:1}),$t(v,{onClick:c},{default:rn(()=>[$t(y)]),_:1}),$t(v,{onClick:d},{default:rn(()=>[$t(b)]),_:1})]),_:1}),jt("div",m6,[$t(P,{placement:"bottom-end",animated:!1},{trigger:rn(()=>[$t(v,{size:"small",class:"bg-white!"},{default:rn(()=>[$t(T)]),_:1})]),default:rn(()=>[jt("div",y6,[f[1]||(f[1]=jt("div",{span:"2",class:"text-12px font-bold"}," Node Legend ",-1)),$t(C,{cols:2,"y-gap":8,class:"w-180px!"},{default:rn(()=>[(Nn(!0),$r(lx,null,ux(vs(Ag),(L,R)=>(Nn(),Ya(O,{key:R,class:"flex-center"},{default:rn(()=>[$t(A,{size:"small",round:"",bordered:!1},{icon:rn(()=>[R==="MILESTONE"?(Nn(),Ya(S,{key:0,style:Hc({color:L.color})},null,8,["style"])):(Nn(),Ya(k,{key:1,style:Hc({color:L.color})},null,8,["style"]))]),default:rn(()=>[Ra(" "+dx(L.type),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})])]),ox(jt("div",{id:"antv-flow",ref_key:"containerRef",ref:n,class:"w-full",style:Hc({height:t.height||"300px"}),onContextmenu:f[0]||(f[0]=L=>L.preventDefault())},null,36),[[vs(tE),vs(s)]])])}}});function w6(){return{nodes:[{id:"NS",name:"Start",status:"COMPLETED",startDate:"2024-10-01",endDate:"2024-10-07",actualStartDate:"2024-10-01",actualEndDate:"2024-10-07"},{id:"N1",name:"Node1",status:"COMPLETED_EARLY",startDate:"2024-10-08",endDate:"2024-10-10",actualStartDate:"2024-10-08",actualEndDate:"2024-10-09",milestone:!0},{id:"N2",name:"Node2",status:"COMPLETED_EARLY",startDate:"2024-10-11",endDate:"2024-10-13",actualStartDate:"2024-10-11",actualEndDate:"2024-10-12"},{id:"N3",name:"Node3",status:"IN_PROGRESS",isDeleted:!0},{id:"N4",name:"Node4",status:"COMPLETED_LATE"},{id:"N5",name:"Node5",status:"DELAYED",isDelayed:!0,milestone:!0},{id:"N6",name:"Node6",status:"PAUSED"},{id:"N7",name:"Node7",status:"NOT_STARTED"},{id:"N8",name:"Node8",status:"NOT_STARTED"},{id:"N9",name:"End",status:"NOT_STARTED"},{id:"NX",name:"NodeX",status:"NOT_STARTED",isDeleted:!0}],edges:[{id:"E1",source:"NS",target:"N1"},{id:"E2",source:"N1",target:"N2"},{id:"E3",source:"N1",target:"N3",isDeleted:!0},{id:"E4",source:"N1",target:"N4"},{id:"E5",source:"N2",target:"N5"},{id:"E6",source:"N3",target:"N5",isDeleted:!0},{id:"E7",source:"N4",target:"N5"},{id:"E8",source:"N5",target:"N6"},{id:"E9",source:"N6",target:"N7"},{id:"E10",source:"N6",target:"N8"},{id:"E11",source:"N7",target:"N9"},{id:"EX",source:"N8",target:"N9"},{id:"EO",source:"N5",target:"NX",isDeleted:!0}]}}const x6={class:"h-full"},Y6=Mu({__name:"antv",setup(r){const e=Tm("antvFlowRef"),t=jg({nodes:[],edges:[]}),n=jg("N2"),i=[{type:"click-select",enable:l=>l.targetType==="node",onClick:l=>{var d;const u=l.target,c=t.value.nodes.find(h=>h.id===u.id);n.value=c==null?void 0:c.id,(d=window.$message)==null||d.success(`Selected Node: [${u.id}]${c==null?void 0:c.name}`)}}],s=pa(()=>t.value.nodes.some(l=>l.id==="NN"));function a(){const{nodes:l,edges:u}=t.value;l.push({id:"NN",name:"New node",status:"NOT_STARTED"}),u.push({id:"EN",source:"N5",target:"NN"}),t.value={nodes:l,edges:u}}function o(l){const{nodes:u,edges:c}=t.value;t.value={nodes:u.filter(d=>d.id!==l),edges:c.filter(d=>d.source!==l&&d.target!==l)}}return Mm(()=>{t.value=w6()}),(l,u)=>{const c=Mx,d=Om,h=Cx,f=hx;return Nn(),$r("div",x6,[$t(f,{title:"AntV G6 Next",bordered:!1,class:"h-full card-wrapper"},{default:rn(()=>[$t(b6,{ref_key:"antvFlowRef",ref:e,data:vs(t),selected:vs(n),behaviors:i},null,8,["data","selected"]),$t(c),$t(h,null,{default:rn(()=>[$t(d,{onClick:u[0]||(u[0]=g=>n.value="N5")},{default:rn(()=>u[3]||(u[3]=[Ra(" Select node N5 (you need to handle the selection event yourself, it will not trigger the element click) ")])),_:1}),vs(s)?(Nn(),Ya(d,{key:1,onClick:u[1]||(u[1]=()=>o("NN"))},{default:rn(()=>u[5]||(u[5]=[Ra(" Delete the newly added node ")])),_:1})):(Nn(),Ya(d,{key:0,onClick:a},{default:rn(()=>u[4]||(u[4]=[Ra(" Add a node and connect it to Node 5 ")])),_:1})),$t(d,{onClick:u[2]||(u[2]=()=>o("NX"))},{default:rn(()=>u[6]||(u[6]=[Ra(" Delete NodeX ")])),_:1})]),_:1})]),_:1})])}}});export{Y6 as default};
