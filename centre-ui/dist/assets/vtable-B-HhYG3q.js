import{_ as jn}from"./web-site-link.vue_vue_type_script_setup_true_lang-DLgvku9w.js";import{d0 as dn,dU as lt,a as Le,am as an,bb as un,d as at,O as we,cZ as Mt,P as hn,a5 as kt,b as ke,o as Ke,h as st,u as Kt,l as B,r as Et,ao as Ot,F as tt,j as Wn,k as He,b8 as Un,g as M,Z as pt,c as mt}from"./index-D_-DzWhp.js";import{o as cn,V as qn}from"./vchart-all-B2R_2FnX.js";import{m as Gn,n as xe,o as jt,t as Qn,p as Wt,q as ze,r as yt,s as $n,u as Jn,w as Xn,x as ge,y as ot,H as Be,z as Yn,A as Ze,E as Zn,F as ei,J as ti,K as ni,M as ii,N as ri,O as si,Q as Ut,R as qt,U as _t,V as Ne,W as ee,X as li,Y as oi,Z as di,_ as ai,$ as ui,a0 as hi,a1 as ci,a2 as fi,a3 as gi,a4 as Te,a5 as Ci,a6 as pi,a7 as wt,a8 as fn,a9 as St,aa as ct,ab as Gt,ac as Oe,ad as Me,ae as mi,af as ht,ag as Ht,ah as nt,ai as gn,aj as yi,ak as Qt,al as $t,am as Jt,an as Cn,ao as pn,ap as mn,aq as yn,ar as _n,as as wn,at as Hn,au as Tn,av as vn,aw as bn,ax as Pn,ay as Sn,az as In,aA as Rn,aB as _i,aC as Ye,aD as ut,aE as Xt,aF as wi,aG as Hi,aH as Ti,I as vi,T as bi,aI as Pi,G as Si,aJ as Ii,aK as Ri,aL as Yt,k as Zt,j as It,aM as Di,l as it,D as rt}from"./index-Cu1hC02A.js";import{l as Rt,B as Bt,f as dt,g as Dn,a4 as Fn,j as Ee,e as Ce,i as x,I as ft,b9 as Fi,ao as Li}from"./linear-scale-E30nU8tb.js";import{g as Tt,c as en}from"./tslib.es6-BHeKr2nR.js";import{_ as xi}from"./Space-CoVGbzuR.js";import"./index-k_YsQNhl.js";import"./get-C9XpniJp.js";import"./isSymbol-DUeTwM-o.js";import"./get-slot-Bk_rJcZu.js";class Ai{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=Gn.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=e=>{try{const t=new e.constructor(e.type,e);this.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(t)}catch{return}}}activate(e){this.pluginService=e,e.stage.hooks.afterRender.tap(this.key,t=>{t&&t===this.pluginService.stage&&this.drawHTML([...e.stage.getChildren()])})}deactivate(e){e.stage.hooks.afterRender.taps=e.stage.hooks.afterRender.taps.filter(t=>t.name!==this.key),xe.graphicService.hooks.onRemove.unTap(this.key),xe.graphicService.hooks.onRelease.unTap(this.key),this.release()}getWrapContainer(e,t,n){let r;return r=t?typeof t=="string"?xe.global.getElementById(t):t:e.window.getContainer(),{wrapContainer:xe.global.createDom(Object.assign({tagName:"div",parent:r},n)),nativeContainer:r}}parseDefaultStyleFromGraphic(e){const t=e.type==="text"&&e.attribute?e.attribute:jt(e).text;return Qn(t)}getTransformOfText(e){const t=jt(e).text,{textAlign:n=t.textAlign,textBaseline:r=t.textBaseline}=e.attribute,i=e.globalTransMatrix.toTransformAttrs(),{rotateDeg:l,scaleX:s,scaleY:o}=i,d={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},a={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:n,transform:`translate(${d[n]},${d[r]}) rotate(${l}deg) scaleX(${s}) scaleY(${o})`,transformOrigin:`${a[n]} ${a[r]}`}}updateStyleOfWrapContainer(e,t,n,r,i){const{pointerEvents:l,penetrateEventList:s=[]}=i;let o=this.parseDefaultStyleFromGraphic(e);o.display=e.attribute.visible!==!1?"block":"none",o.pointerEvents=l===!0?"all":l||"none",o.pointerEvents!=="none"&&(this.removeWrapContainerEventListener(n),s.forEach(p=>{p==="wheel"&&n.addEventListener("wheel",this.onWheel)})),n.style.position||(n.style.position="absolute",r.style.position="relative");let d=0,a=0;const u=e.globalAABBBounds;let h=i.anchorType;if(Rt(h)&&(h=e.type==="text"?"position":"boundsLeftTop"),h==="boundsLeftTop"&&(h="top-left"),h==="position"||u.empty()){const p=e.globalTransMatrix;d=p.e,a=p.f}else{const p=cn(u,h);d=p.x,a=p.y}const c=xe.global.getElementTopLeft(r,!1),f=t.window.getTopLeft(!1),C=t.viewBox,T=d+f.left-c.left+C.x1,g=a+f.top-c.top+C.y1;if(o.left=`${T}px`,o.top=`${g}px`,e.type==="text"&&h==="position"&&(o=Object.assign(Object.assign({},o),this.getTransformOfText(e))),Bt(i.style)){const p=i.style({top:g,left:T,width:u.width(),height:u.height()},e,n);p&&(o=Object.assign(Object.assign({},o),p))}else dt(i.style)?o=Object.assign(Object.assign({},o),i.style):Dn(i.style)&&i.style&&(o=Object.assign(Object.assign({},o),Fn(i.style)));xe.global.updateDom(n,{width:i.width,height:i.height,style:o})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(e=>{this.htmlMap[e]&&this.htmlMap[e].renderId!==this.renderId&&this.removeElement(e)}),this.renderId+=1}drawHTML(e){xe.global.env==="browser"&&(e.sort((t,n)=>{var r,i;return((r=t.attribute.zIndex)!==null&&r!==void 0?r:Wt.zIndex)-((i=n.attribute.zIndex)!==null&&i!==void 0?i:Wt.zIndex)}).forEach(t=>{this.renderGroupHTML(t)}),this.clearCacheContainer())}renderGroupHTML(e){this.renderGraphicHTML(e),e.forEachChildren(t=>{t.isContainer?this.renderGroupHTML(t):this.renderGraphicHTML(t)})}removeElement(e){if(!this.htmlMap||!this.htmlMap[e])return;const{wrapContainer:t}=this.htmlMap[e];t&&xe.global.removeDom(t),this.htmlMap[e]=null}removeWrapContainerEventListener(e){e.removeEventListener("wheel",this.onWheel)}renderGraphicHTML(e){var t;const{html:n}=e.attribute;if(!n)return;const r=e.stage;if(!r)return;const{dom:i,container:l}=n;if(!i)return;const s=Rt(n.id)?`${(t=e.id)!==null&&t!==void 0?t:e._uid}_react`:n.id;if(this.htmlMap&&this.htmlMap[s]&&l&&l!==this.htmlMap[s].container&&this.removeElement(s),this.htmlMap&&this.htmlMap[s])typeof i=="string"?this.htmlMap[s].wrapContainer.innerHTML=i:i!==this.htmlMap[s].wrapContainer.firstChild&&(this.htmlMap[s].wrapContainer.removeChild(this.htmlMap[s].wrapContainer.firstChild),this.htmlMap[s].wrapContainer.appendChild(i));else{const{wrapContainer:a,nativeContainer:u}=this.getWrapContainer(r,l);a&&(typeof i=="string"?a.innerHTML=i:a.appendChild(i),this.htmlMap||(this.htmlMap={}),this.htmlMap[s]={wrapContainer:a,nativeContainer:u,container:l,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[s])return;const{wrapContainer:o,nativeContainer:d}=this.htmlMap[s];this.updateStyleOfWrapContainer(e,r,o,d,n),this.htmlMap[s].renderId=this.renderId}release(){xe.global.env==="browser"&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(e){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t)}),this.htmlMap=null)}}function Mi(I,e,t,n,r,i){const l=i.columnHeaderLevelCount,s=[],o=[];for(let h=0;h<t.length;h++)n.includes(t[h])||o.push(r[h]);for(let h=0;h<n.length;h++)if(!t.includes(n[h])){const c={col:I,row:l+h};s.push(c)}let d=i.getParentCellId(I,e),a=i.getRowHeaderCellAddressByCellId(d);const u=[];for(a&&u.push(a);d;)d=i.getParentCellId(a.col,a.row),d&&(a=i.getRowHeaderCellAddressByCellId(d),u.push(a));return{addCellPositionsRowDirection:s,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:u}}function Ki(I,e,t,n,r,i){const l=i.columnHeaderLevelCount,s=[],o=[];for(let f=0;f<t.length;f++)n.includes(t[f])||o.push(r[f]);for(let f=0;f<n.length;f++)if(!t.includes(n[f])){const C={col:I,row:l+f};s.push(C)}let d=i.getParentCellId(I,e),a=i.getRowHeaderCellAddressByCellId(d);const u=[];for(a&&u.push(a);d;)d=i.getParentCellId(a.col,a.row),d&&(a=i.getRowHeaderCellAddressByCellId(d),u.push(a));const h=[],c=[];if(i.rowHierarchyType==="grid-tree"&&i.cornerSetting.titleOnDimension==="column"&&i.rowHeaderLevelCount!==i._cornerHeaderCellIds[0].length)if(i.rowHeaderLevelCount>i._cornerHeaderCellIds[0].length)for(let f=i._cornerHeaderCellIds[0].length;f<i.rowHeaderLevelCount;f++)h.push({col:f,row:e});else for(let f=i.rowHeaderLevelCount;f<i._cornerHeaderCellIds[0].length;f++)c.push({col:f,row:e});return{addCellPositionsRowDirection:s,removeCellPositionsRowDirection:o,updateCellPositionsRowDirection:u,addCellPositionsColumnDirection:h,removeCellPositionsColumnDirection:c}}function Ei(I,e,t,n,r,i){const l=i.rowHeaderLevelCount,s=[],o=[];for(let f=0;f<t.length;f++)n.includes(t[f])||o.push(r[f]);for(let f=0;f<n.length;f++)if(!t.includes(n[f])){const C={col:l+f,row:e};s.push(C)}let d=i.getParentCellId(I,e),a=i.getRowHeaderCellAddressByCellId(d);const u=[];for(a&&u.push(a);a&&d;)d=i.getParentCellId(a.col,a.row),d&&(a=i.getRowHeaderCellAddressByCellId(d),u.push(a));const h=[],c=[];if(i.columnHierarchyType==="grid-tree"&&i.cornerSetting.titleOnDimension==="row"&&i.columnHeaderLevelCount!==i._cornerHeaderCellIds.length)if(i.columnHeaderLevelCount>i._cornerHeaderCellIds.length)for(let f=i._cornerHeaderCellIds.length;f<i.columnHeaderLevelCount;f++)h.push({col:I,row:f});else for(let f=i.columnHeaderLevelCount;f<i._cornerHeaderCellIds.length;f++)c.push({col:I,row:f});return{addCellPositionsColumnDirection:s,removeCellPositionsColumnDirection:o,updateCellPositionsColumnDirection:u,addCellPositionsRowDirection:h,removeCellPositionsRowDirection:c}}const tn={startInTotal:0,afterSpanLevel:0};class Ve{constructor(e,t,n,r){var i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=ze,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,this._table=e,e.options.rowHierarchyType==="tree"&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=(i=e.internalProps.rows)!==null&&i!==void 0?i:[],this.columnsDefine=(l=e.internalProps.columns)!==null&&l!==void 0?l:[],this.indicatorsDefine=(s=e.internalProps.indicators)!==null&&s!==void 0?s:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=(o=e.options.indicatorsAsCol)===null||o===void 0||o,this.hideIndicatorName=(d=e.options.hideIndicatorName)!==null&&d!==void 0&&d,this.showRowHeader=(a=e.options.showRowHeader)===null||a===void 0||a,this.showColumnHeader=(u=e.options.showColumnHeader)===null||u===void 0||u,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=(h=e.options.rowHierarchyType)!==null&&h!==void 0?h:"grid",this.columnHierarchyType=(c=e.options.columnHierarchyType)!==null&&c!==void 0?c:"grid",this.rowExpandLevel=(f=e.options.rowExpandLevel)!==null&&f!==void 0?f:1,this.columnExpandLevel=(C=e.options.columnExpandLevel)!==null&&C!==void 0?C:1,this.rowHierarchyIndent=(T=e.options.rowHierarchyIndent)!==null&&T!==void 0?T:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},e.options.corner),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),(g=this.indicatorsDefine)===null||g===void 0||g.forEach(v=>{typeof v=="string"?this.indicatorKeys.push(v):this.indicatorKeys.push(v.indicatorKey)}),this.columnDimensionTree=n,this.rowDimensionTree=r,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(v=>{var S,A;if(v.chartSpec&&v.chartSpec.series&&v.chartSpec.series.length>1){const F=(A=(S=v.chartSpec.axes)!==null&&S!==void 0?S:this._table.pivotChartAxes)!==null&&A!==void 0?A:[];if(!F.length||F.every(N=>N.orient!==(this.indicatorsAsCol?"top":"right")||N.visible!==!1))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=yt(this._rowHeaderCellFullPathIds_FULL),e.options.rowHierarchyType==="tree"&&((p=this.extensionRows)===null||p===void 0?void 0:p.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(v=>{const S=[];v.rows.forEach(A=>{typeof A=="string"?S.push(A):S.push(A.dimensionKey)}),this._extensionRowDimensionKeys.push(S),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(S)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let b,y=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||((m=(w=this.dataset.records)===null||w===void 0?void 0:w.length)!==null&&m!==void 0?m:0)!==0||this.dataset.customColTree||(y=this.columnsDefine.map(v=>typeof v=="string"?v:v.dimensionKey),this.indicatorsAsCol&&y.push(this.indicatorDimensionKey)),y=this.columnHeaderTitle?[""].concat(y):y;let R=[];if(this.rowHierarchyType==="tree"&&((H=this.extensionRows)===null||H===void 0?void 0:H.length)>=1){const v=[];v.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(S=>{v.push(S[0])}),R=this.extensionRows.reduce((S,A)=>S.concat(A.rows),[]),b=this.rowHeaderTitle?[""].concat(v):v}else b=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||((P=(_=this.dataset.records)===null||_===void 0?void 0:_.length)!==null&&P!==void 0?P:0)!==0||this.dataset.customRowTree||(b=this.rowsDefine.map(v=>typeof v=="string"?v:v.dimensionKey),this.indicatorsAsCol||b.push(this.indicatorDimensionKey)),b=this.rowHeaderTitle?[""].concat(b):b;this.cornerHeaderObjs=this._addCornerHeaders(y,b,this.columnsDefine.concat(...this.rowsDefine,...R)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((v,S)=>(v[S.id]=S,v),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(v=>{var S,A,F,N,K,O,L,E;!((S=v==null?void 0:v.style)===null||S===void 0)&&S.padding&&(this._chartPadding=v.style.padding),!((A=v.chartSpec)===null||A===void 0)&&A.barWidth&&typeof v.chartSpec.barWidth=="number"&&(this._chartItemSpanSize=(F=v.chartSpec)===null||F===void 0?void 0:F.barWidth);const $=(K=(N=v.chartSpec)===null||N===void 0?void 0:N.axes)===null||K===void 0?void 0:K.find(J=>J.type==="band");return $!=null&&$.bandSize&&(this._chartItemBandSize=$==null?void 0:$.bandSize,this._chartPaddingInner=(O=Ee($.paddingInner)?$.paddingInner[0]:$.paddingInner)!==null&&O!==void 0?O:0,this._chartPaddingOuter=(L=Ee($.paddingOuter)?$.paddingOuter[0]:$.paddingOuter)!==null&&L!==void 0?L:0),this._chartItemSpanSize>0||((E=v.chartSpec.series)===null||E===void 0||E.find(J=>(J.barWidth&&typeof J.barWidth=="number"&&(this._chartItemSpanSize=J.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t,n;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(r=>{var i,l;return{id:"",title:r.title,define:r,cellType:(i=r.cellType)!==null&&i!==void 0?i:"text",headerType:(l=r.cellType)!==null&&l!==void 0?l:"text",width:r.width,style:r.style,format:r.format,field:r.field,icon:r.icon}}):this.rowSeriesNumberColumn=[{id:"",title:e.title,define:e,cellType:(t=e.cellType)!==null&&t!==void 0?t:"text",headerType:(n=e.cellType)!==null&&n!==void 0?n:"text",style:e.style,width:e.width,format:e.format,field:"",icon:e.icon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(r=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(r=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t,n,r,i,l,s,o;if(((e=this.columnDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1)if(this.columnHierarchyType==="grid-tree")this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1);else{let d=0;if(this.dataset&&!this._table.isPivotChart()&&((n=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this._getColumnHeaderTreeExpandedMaxLevelCount()<this.columnHeaderLevelCount){d=this.columnHeaderLevelCount-this._getColumnHeaderTreeExpandedMaxLevelCount();for(let a=0;a<d;a++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,d,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const d=++this.sharedVar.seqId,a=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(d);this._columnHeaderCellFullPathIds.unshift(a);const u={id:d,title:typeof this.columnHeaderTitle.title=="string"?this.columnHeaderTitle.title:this.columnsDefine.reduce((h,c)=>typeof c=="string"?h:h+(h?`/${c.title}`:`${c.title}`),""),field:void 0,headerType:(i=(r=this.columnHeaderTitle)===null||r===void 0?void 0:r.headerType)!==null&&i!==void 0?i:"text",style:(l=this.columnHeaderTitle)===null||l===void 0?void 0:l.headerStyle,define:{id:d,disableHeaderHover:!!(!((s=this.columnHeaderTitle)===null||s===void 0)&&s.disableHeaderHover),disableHeaderSelect:!!(!((o=this.columnHeaderTitle)===null||o===void 0)&&o.disableHeaderSelect)}};this.columnHeaderObjs.push(u),this._headerObjects[d]=u}}_generateRowHeaderIds(){var e,t,n,r,i,l,s,o,d,a;if(((e=this.rowDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1)if(this.rowHierarchyType==="tree")this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else if(this.rowHierarchyType==="grid-tree")this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0);else{let u=0;if(this.dataset&&!this._table.isPivotChart()&&((n=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this._getRowHeaderTreeExpandedMaxLevelCount()<this.rowHeaderLevelCount){u=this.rowHeaderLevelCount-this._getRowHeaderTreeExpandedMaxLevelCount();for(let h=0;h<u;h++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,u,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const u=++this.sharedVar.seqId,h=Array((i=(r=this._rowHeaderCellFullPathIds_FULL[0])===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:this.rowDimensionTree.tree.size).fill(u);this._rowHeaderCellFullPathIds_FULL.unshift(h);const c={id:u,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((f,C)=>typeof C=="string"?f:f+(f?`/${C.title}`:`${C.title}`),""),field:void 0,headerType:(s=(l=this.rowHeaderTitle)===null||l===void 0?void 0:l.headerType)!==null&&s!==void 0?s:"text",style:(o=this.rowHeaderTitle)===null||o===void 0?void 0:o.headerStyle,define:{id:u,disableHeaderHover:!!(!((d=this.rowHeaderTitle)===null||d===void 0)&&d.disableHeaderHover),disableHeaderSelect:!!(!((a=this.rowHeaderTitle)===null||a===void 0)&&a.disableHeaderSelect)}};this.rowHeaderObjs.push(c),this._headerObjects[u]=c}}_getRowHeaderTreeExpandedMaxLevelCount(){return this.rowHierarchyType==="tree"?1:this.rowHierarchyType==="grid-tree"?this.cornerSetting.titleOnDimension==="row"?this.rowDimensionTree.totalLevel:this.indicatorsAsCol?this.rowDimensionTree.expandedMaxLevel:this.rowDimensionTree.expandedMaxLevel+1:this.rowDimensionTree.totalLevel}_getColumnHeaderTreeExpandedMaxLevelCount(){return this.columnHierarchyType==="grid-tree"?this.cornerSetting.titleOnDimension==="column"?this.columnDimensionTree.totalLevel:this.indicatorsAsCol===!1?this.columnDimensionTree.expandedMaxLevel:this.columnDimensionTree.expandedMaxLevel+1:this.columnDimensionTree.totalLevel}_addHeaders(e,t,n,r,i){const l=this;e[t]||function(s){const o=e[s]=[];if(l.colIndex===0)return o;const d=e[s-1];for(let a=0;a<(d==null?void 0:d.length);a++)o[a]=d[a]}(t);for(let s=0;s<n.length;s++){const o=n[s];$n(o,e,i,r,t,this)}}_addHeadersForTreeMode(e,t,n,r,i,l,s,o){const d=this;e[t]||function(a){const u=e[a]=[];if(d.colIndex===0)return u;const h=e[a-1];for(let c=0;c<(h==null?void 0:h.length);c++)u[c]=h[c]}(t);for(let a=0;a<n.length;a++){const u=n[a];Jn(u,e,o,r,t,i,l,s,this)}}_addHeadersForGridTreeMode(e,t,n,r,i,l,s,o,d,a){const u=this;e[t]||function(h){const c=e[h]=[];if(u.colIndex===0)return c;const f=e[h-1];for(let C=0;C<(f==null?void 0:f.length);C++)c[C]=f[C]}(t);for(let h=0;h<n.length;h++){const c=n[h];Xn(c,e,d,r,t,i,l,s,o,a,this.indicatorsAsCol,this)}}_addCornerHeaders(e,t,n){var r,i,l,s,o,d,a,u,h,c;this._cornerHeaderCellFullPathIds=[];const f=[],C=this.columnHierarchyType==="grid-tree"&&this._getColumnHeaderTreeExpandedMaxLevelCount()||this.columnHeaderLevelCount,T=this.rowHierarchyType==="grid-tree"&&this._getRowHeaderTreeExpandedMaxLevelCount()||this.rowHeaderLevelCount;if(this.cornerSetting.titleOnDimension==="all")if(this.indicatorsAsCol){if(e)for(let g=0;g<C;g++){const p=e[g],w=++this.sharedVar.seqId,m=n.find(_=>typeof _!="string"&&_.dimensionKey===p),H={id:w,title:p===this.indicatorDimensionKey?this.indicatorTitle:m?m.title:p==="axis"?"":p,field:p,style:this.cornerSetting.headerStyle,headerType:(r=this.cornerSetting.headerType)!==null&&r!==void 0?r:"text",showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,define:{showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,dimensionKey:p,id:w,value:p,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:m==null?void 0:m.cornerDropDownMenu,headerIcon:m==null?void 0:m.cornerHeaderIcon,pivotInfo:{value:(i=m==null?void 0:m.title)!==null&&i!==void 0?i:"",dimensionKey:p,isPivotCorner:!0},description:m==null?void 0:m.cornerDescription};f[w]=H,this._headerObjects[w]=H,this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]);for(let _=0;_<T;_++)this._cornerHeaderCellFullPathIds[g][_]=w}if(t)for(let g=0;g<T;g++){const p=t[g],w=++this.sharedVar.seqId,m=n.find(_=>typeof _!="string"&&_.dimensionKey===p),H={id:w,title:p===this.indicatorDimensionKey?this.indicatorTitle:m?m.title:p==="axis"?"":p,field:p,style:this.cornerSetting.headerStyle,headerType:(l=this.cornerSetting.headerType)!==null&&l!==void 0?l:"text",showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,define:{showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,dimensionKey:p,id:w,value:p,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:m==null?void 0:m.cornerDropDownMenu,headerIcon:m==null?void 0:m.cornerHeaderIcon,pivotInfo:{value:(s=m==null?void 0:m.title)!==null&&s!==void 0?s:"",dimensionKey:p,isPivotCorner:!0},description:m==null?void 0:m.cornerDescription};f[w]=H,this._headerObjects[w]=H,this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]||(this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]=[]),this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1][g]=w}}else{if(t)for(let g=0;g<T;g++){const p=t[g],w=++this.sharedVar.seqId,m=n.find(_=>typeof _!="string"&&_.dimensionKey===p),H={id:w,title:p===this.indicatorDimensionKey?this.indicatorTitle:m?m.title:p==="axis"?"":p,field:p,style:this.cornerSetting.headerStyle,headerType:(o=this.cornerSetting.headerType)!==null&&o!==void 0?o:"text",showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,define:{showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,dimensionKey:p,id:w,value:p,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:m==null?void 0:m.cornerDropDownMenu,headerIcon:m==null?void 0:m.cornerHeaderIcon,pivotInfo:{value:(d=m==null?void 0:m.title)!==null&&d!==void 0?d:"",dimensionKey:p,isPivotCorner:!0},description:m==null?void 0:m.cornerDescription};f[w]=H,this._headerObjects[w]=H;for(let _=0;_<C;_++)this._cornerHeaderCellFullPathIds[_]||(this._cornerHeaderCellFullPathIds[_]=[]),this._cornerHeaderCellFullPathIds[_][g]=w}if(e)for(let g=0;g<C;g++){const p=e[g],w=++this.sharedVar.seqId,m=n.find(_=>typeof _!="string"&&_.dimensionKey===p),H={id:w,title:p===this.indicatorDimensionKey?this.indicatorTitle:m?m.title:p==="axis"?"":p,field:p,style:this.cornerSetting.headerStyle,headerType:(a=this.cornerSetting.headerType)!==null&&a!==void 0?a:"text",showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,define:{showSort:m==null?void 0:m.showSortInCorner,sort:m==null?void 0:m.sort,dimensionKey:p,id:w,value:p,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:m==null?void 0:m.cornerDropDownMenu,headerIcon:m==null?void 0:m.cornerHeaderIcon,pivotInfo:{value:(u=m==null?void 0:m.title)!==null&&u!==void 0?u:"",dimensionKey:p,isPivotCorner:!0},description:m==null?void 0:m.cornerDescription};f[w]=H,this._headerObjects[w]=H,this._cornerHeaderCellFullPathIds[g][this._cornerHeaderCellFullPathIds[g].length-1]=w}}else if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="column"){const g=((h=this.cornerSetting)===null||h===void 0?void 0:h.titleOnDimension)==="row"?t:e;g&&g.forEach((p,w)=>{var m,H;const _=++this.sharedVar.seqId,P=n.find(y=>typeof y!="string"&&y.dimensionKey===p),b={id:_,title:p===this.indicatorDimensionKey?this.indicatorTitle:P?P.title:p==="axis"?"":p,field:p,style:this.cornerSetting.headerStyle,headerType:(m=this.cornerSetting.headerType)!==null&&m!==void 0?m:"text",showSort:P==null?void 0:P.showSortInCorner,sort:P==null?void 0:P.sort,define:{showSort:P==null?void 0:P.showSortInCorner,sort:P==null?void 0:P.sort,dimensionKey:p,id:_,value:p,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:P==null?void 0:P.cornerDropDownMenu,headerIcon:P==null?void 0:P.cornerHeaderIcon,pivotInfo:{value:(H=P==null?void 0:P.title)!==null&&H!==void 0?H:"",dimensionKey:p,isPivotCorner:!0},description:P==null?void 0:P.cornerDescription};if(f[_]=b,this._headerObjects[_]=b,this.cornerSetting.titleOnDimension==="column"){this._cornerHeaderCellFullPathIds[w]||(this._cornerHeaderCellFullPathIds[w]=[]);for(let y=0;y<this.rowHeaderLevelCount;y++)this._cornerHeaderCellFullPathIds[w][y]=_}else if(this.cornerSetting.titleOnDimension==="row")for(let y=0;y<this.columnHeaderLevelCount;y++)this._cornerHeaderCellFullPathIds[y]||(this._cornerHeaderCellFullPathIds[y]=[]),this._cornerHeaderCellFullPathIds[y][w]=_})}else{const g=++this.sharedVar.seqId,p={id:g,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:(c=this.cornerSetting.headerType)!==null&&c!==void 0?c:"text",define:{dimensionKey:"维度名称",id:g,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};f[g]=p,this._headerObjects[g]=p;for(let w=0;w<this.columnHeaderLevelCount;w++)for(let m=0;m<this.rowHeaderLevelCount;m++)this._cornerHeaderCellFullPathIds[w]||(this._cornerHeaderCellFullPathIds[w]=[]),this._cornerHeaderCellFullPathIds[w][m]=g}return f}generateExtensionRowTree(){this.extensionRows.forEach((e,t)=>{const n=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],n.forEach((r,i)=>{const l=r[r.length-1];let s,o;if(this.colIndex=0,typeof e.rowTree=="function"){const a=this.findFullCellIds(r);s=e.rowTree(a.map(u=>({dimensionKey:this._headerObjects[u].field,value:this._headerObjects[u].title})))}else s=Ce(e.rowTree);this._rowHeaderExtensionTree[l]?(this._rowHeaderExtensionTree[l].reset(this._rowHeaderExtensionTree[l].tree.children),o=this._rowHeaderExtensionTree[l]):(o=new ge(s??[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[l]=o);const d=[];this._addHeadersForTreeMode(d,0,o.tree.children,[],o.totalLevel,!0,e.rows,this.rowHeaderObjs);for(let a=0;a<d[0].length;a++)this._rowHeaderCellFullPathIds_FULL.push(r.concat(d[0][a]))})})}setColumnWidths(){var e,t,n;const r=new Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(r[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(r[0+this.leftRowSeriesNumberColumnCount]={}),this.rowHierarchyType==="tree"){const i=this.rowDimensionKeys[0];if(i){const l=(e=this.rowsDefine)===null||e===void 0?void 0:e.find(s=>typeof s!="string"&&s.dimensionKey===i);l&&(r[0+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth})}(t=this._extensionRowDimensionKeys)===null||t===void 0||t.forEach((l,s)=>{var o;const d=l[0];if(d){const a=(o=this.extensionRows[s].rows)===null||o===void 0?void 0:o.find(u=>typeof u!="string"&&u.dimensionKey===d);a&&(r[s+1+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:a.width,minWidth:a.minWidth,maxWidth:a.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(i=>typeof i=="string"?i:i.dimensionKey)).forEach((i,l)=>{var s;const o=(s=this.rowsDefine)===null||s===void 0?void 0:s.find(d=>typeof d!="string"&&d.dimensionKey===i);o&&(r[l+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:o.width,minWidth:o.minWidth,maxWidth:o.maxWidth})});if(this.indicatorsAsCol)for(let i=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;i<this.colCount;i++){const l=this.getBody(i,this.columnHeaderLevelCount);r[i]={width:l==null?void 0:l.width,minWidth:l==null?void 0:l.minWidth,maxWidth:l==null?void 0:l.maxWidth}}else{let i,l,s,o=0;(n=this._indicators)===null||n===void 0||n.forEach((d,a)=>{var u,h;typeof d.width=="number"?o=Math.max(d.width,o):d.width==="auto"&&(s=!0),typeof d.minWidth=="number"&&(l=Math.max(d.minWidth,(u=l)!==null&&u!==void 0?u:0)),typeof d.maxWidth=="number"&&(i=Math.min(d.maxWidth,(h=i)!==null&&h!==void 0?h:Number.MAX_VALUE))}),o=o>0?o:s?"auto":void 0,r.fill({width:o,minWidth:l,maxWidth:i},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=r}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?"cornerHeader":this.isColumnHeader(e,t)?"columnHeader":this.isRowHeader(e,t)?"rowHeader":"body"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=0&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return e>=0&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if(x(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(x(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(x(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(x(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=0&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var e,t,n,r,i,l,s,o,d,a,u;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(!((t=(e=this.dataset)===null||e===void 0?void 0:e.colKeys)===null||t===void 0)&&t.length)&&((r=(n=this.columnDimensionTree)===null||n===void 0?void 0:n.tree)===null||r===void 0?void 0:r.level)===0&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let h=this._getColumnHeaderTreeExpandedMaxLevelCount();return this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey&&h--,h===0&&this.dataset&&!(!((i=this.dataset.customColTree)===null||i===void 0)&&i.length)?this.cornerSetting.titleOnDimension==="row"&&this.cornerSetting.forceShowHeader?h=1:this._table.isPivotChart()||((s=(l=this.dataset.records)===null||l===void 0?void 0:l.length)!==null&&s!==void 0?s:0)!==0||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(h=(o=this.columnsDefine.length)!==null&&o!==void 0?o:0):!this.dataset||this._table.isPivotChart()||((a=(d=this.dataset.records)===null||d===void 0?void 0:d.length)!==null&&a!==void 0?a:0)!==0||this.dataset.customColTree||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(h=(u=this.columnsDefine.length)!==null&&u!==void 0?u:0,!this.hideIndicatorName&&this.indicatorsAsCol&&h++),this.columnHeaderTitle&&(h+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&ot(this.indicatorsDefine)&&(h-=1),void(this.columnHeaderLevelCount=h)}this.columnHeaderLevelCount=this.indicatorsAsCol?this.hideIndicatorName?0:1:0}resetRowHeaderLevelCount(){var e,t,n,r,i,l,s,o;if(this.showHeader&&this.showRowHeader){if(this.rowHierarchyType==="tree"){const u=(t=(e=this.extensionRows)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=2+u):void(this.rowHeaderLevelCount=1+u)}const d=this._getRowHeaderTreeExpandedMaxLevelCount();let a=d;return a===0&&this.dataset&&!(!((n=this.dataset.customRowTree)===null||n===void 0)&&n.length)?this.cornerSetting.titleOnDimension==="column"&&this.cornerSetting.forceShowHeader?a=1:this._table.isPivotChart()||((i=(r=this.dataset.records)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)!==0||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=(l=this.rowsDefine.length)!==null&&l!==void 0?l:0):!this.dataset||this._table.isPivotChart()||((o=(s=this.dataset.records)===null||s===void 0?void 0:s.length)!==null&&o!==void 0?o:0)!==0||this.dataset.customRowTree||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(a=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||a++),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(a=d-1),this.rowHeaderTitle&&(a+=1),void(this.rowHeaderLevelCount=a)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e,t,n;return(this._getColumnHeaderTreeExpandedMaxLevelCount()>0||this._table.isPivotChart()||((e=this.dataset.records)===null||e===void 0?void 0:e.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?(n=(t=this._columnHeaderCellIds[0])===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:this.columnDimensionTree.tree.size:0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e,t,n,r;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&((e=this._indicators)===null||e===void 0?void 0:e.length)>0&&!(!((t=this._rowHeaderCellIds)===null||t===void 0)&&t.length)?1:(r=(n=this._rowHeaderCellIds)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&ot(this.indicatorsDefine)){const e=this._table.pivotChartAxes.find(t=>t.orient==="bottom");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;const e=this._table.pivotChartAxes.find(t=>t.orient==="right");return(e==null?void 0:e.visible)===!1||this.indicatorsAsCol?0:this.hasTwoIndicatorAxes?1:0}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var n,r,i,l,s;if(t>=0&&e>=0){if(this.isSeriesNumber(e,t))return"";if(this.isCornerHeader(e,t))return(n=this._cornerHeaderCellIds[t])===null||n===void 0?void 0:n[e-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(e,t))return(r=this._columnHeaderCellIds[t])===null||r===void 0?void 0:r[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(e,t))return(i=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||i===void 0?void 0:i[e-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(e,t))return(l=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||l===void 0?void 0:l[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(e,t))return(s=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])===null||s===void 0?void 0:s[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(e,t){var n;if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);const r=this.getCellId(e,t);return(n=this._headerObjectMap[r])!==null&&n!==void 0?n:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(e,t){var n,r;const i=this.getCellId(e,t);return((n=this._headerObjectMap[i])===null||n===void 0?void 0:n.field)||((r=this.getBody(e,t))===null||r===void 0?void 0:r.field)}getHeaderCellAdressById(e){for(let t=0;t<this._columnHeaderCellIds.length;t++){const n=this._columnHeaderCellIds[t];for(let r=0;r<n.length;r++)if(n[r]===e)return{col:r+this._table.frozenColCount,row:t}}for(let t=0;t<this._rowHeaderCellIds.length;t++){const n=this._rowHeaderCellIds[t];for(let r=0;r<n.length;r++)if(n[r]===e)return{col:r,row:t+this._table.frozenRowCount}}for(let t=0;t<this._cornerHeaderCellIds.length;t++){const n=this._cornerHeaderCellIds[t];for(let r=0;r<n.length;r++)if(n[r]===e)return{col:r,row:t}}}getHeaderCellAddressByField(e){const t=this.headerObjects.find(n=>n&&n.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){var n,r,i,l,s,o,d,a,u,h;const c=this.getBodyWidthCache(e,t);if(c)return c;if(this.isSeriesNumber(e,t)){const g=this.getSeriesNumberBody(e,t);return this.setBodyWidthCache(e,t,g),g}const f=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){const g=(r=(n=f.colHeaderPaths)===null||n===void 0?void 0:n.find(w=>w.indicatorKey))===null||r===void 0?void 0:r.indicatorKey,p=x(g)&&(s=(l=(i=this._indicators)===null||i===void 0?void 0:i.find(w=>w.indicatorKey===g))!==null&&l!==void 0?l:this._indicators[0])!==null&&s!==void 0?s:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,p),p}const C=(d=(o=f.rowHeaderPaths)===null||o===void 0?void 0:o.find(g=>g.indicatorKey))===null||d===void 0?void 0:d.indicatorKey,T=x(C)&&(h=(u=(a=this._indicators)===null||a===void 0?void 0:a.find(g=>g.indicatorKey===C))!==null&&u!==void 0?u:this._indicators[0])!==null&&h!==void 0?h:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,T),T}getCellRange(e,t){var n,r;const i={start:{col:e,row:t},end:{col:e,row:t}};if(!this.isHeader(e,t)||e===-1||t===-1||this.isRightFrozenColumn(e,t)||this.isBottomFrozenRow(e,t))return i;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(e,t))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let l=0;l<this._largeCellRangeCache.length;l++){const s=this._largeCellRangeCache[l];if(e>=s.start.col&&e<=s.end.col&&t>=s.start.row&&t<=s.end.row)return s}if(this.isHeader(e,t)&&e!==-1&&t!==-1){const l=this.getCellId(e,t);for(let s=e-1;s>=0&&l===this.getCellId(s,t);s--)i.start.col=s;for(let s=e+1;s<((n=this.colCount)!==null&&n!==void 0?n:0)&&l===this.getCellId(s,t);s++)i.end.col=s;for(let s=t-1;s>=0&&l===this.getCellId(e,s);s--)i.start.row=s;for(let s=t+1;s<((r=this.rowCount)!==null&&r!==void 0?r:0)&&!(l!==this.getCellId(e,s)||this.isSeriesNumberInHeader(e,t)&&s>=this.columnHeaderLevelCount);s++)i.end.row=s}return(i.end.col-i.start.col>100||i.end.row-i.start.row>100)&&this._largeCellRangeCache.push(i),i}isCellRangeEqual(e,t,n,r){const i=this.getCellRange(e,t),l=this.getCellRange(n,r);return i.start.col===l.start.col&&i.end.col===l.end.col&&i.start.row===l.start.row&&i.end.row===l.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let s=0;s<this._largeCellRangeCache.length;s++){const o=this._largeCellRangeCache[s];if(e>=o.start.col&&e<=o.end.col&&t>=o.start.row&&t<=o.end.row)break}let n=this.getColHeaderPathCache(e,t),r=this.getRowHeaderPathCache(e,t);const i=this.getBodyIndexByCol(e),l=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!n&&t>=0&&i>=0){if(n=[],this.columnHierarchyType==="grid-tree"){const s=[];this._columnHeaderCellFullPathIds.map(d=>{s.push(d[i])});const o=this.getTreePathByCellIds(s);n.push(...o)}else n=this.columnDimensionTree.getTreePath(i,this.showHeader&&this.showColumnHeader?t-(this.columnHeaderTitle?1:0):this.columnDimensionTree.totalLevel);this.setColHeaderPathCache(e,t,n)}if(!r&&e>=0&&l>=0){if(r=[],this.rowHierarchyType==="tree"){const s=this._rowHeaderCellFullPathIds[l];let o=this.rowDimensionTree,d=0;for(;o;){const a=[];let u=s[d];for(a.push(u);;){const c=this._headerObjectMap[u];if(!(c!=null&&c.parentCellId))break;a.unshift(c.parentCellId),u=c.parentCellId}const h=this.getTreePathByCellIds(a);r.push(...h),o=this._rowHeaderExtensionTree[s[d]],d++}}else if(this.rowHierarchyType==="grid-tree"){const s=this._rowHeaderCellFullPathIds[l],o=this.getTreePathByCellIds(s);r.push(...o)}else r=this.rowDimensionTree.getTreePath(l,this.showHeader&&this.showRowHeader?e-(this.rowHeaderTitle?1:0)-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,r)}return{colHeaderPaths:n,rowHeaderPaths:r,cellLocation:this.getCellLocation(e,t)}}getTreePathByCellIds(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(n>0&&r===e[n-1])continue;const i=this._headerObjects[r];i!=null&&i.define&&t.push(i.define)}return t}getCellHeaderPaths(e,t){var n,r;const i=this.getCellHeaderPathsWithTreeNode(e,t),l={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:i.cellLocation};return(n=i.colHeaderPaths)===null||n===void 0||n.forEach(s=>{var o,d,a;const u={};u.dimensionKey=s.dimensionKey,u.indicatorKey=s.indicatorKey,u.value=(a=(o=s.value)!==null&&o!==void 0?o:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",u.virtual=s.virtual,l.colHeaderPaths.push(u)}),(r=i.rowHeaderPaths)===null||r===void 0||r.forEach(s=>{var o,d,a;if(s.dimensionKey!=="axis"){const u={};u.dimensionKey=s.dimensionKey,u.indicatorKey=s.indicatorKey,u.value=(a=(o=s.value)!==null&&o!==void 0?o:(d=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||d===void 0?void 0:d.title)!==null&&a!==void 0?a:"",u.virtual=s.virtual,l.rowHeaderPaths.push(u)}}),l}getIndicatorInfoByIndicatorKey(e){var t;return(t=this.indicatorsDefine)===null||t===void 0?void 0:t.find(n=>typeof n!="string"&&!!e&&n.indicatorKey===e)}findFullCellIds(e){const t=[];for(let n=0;n<e.length;n++){let r=e[n];for(t.push(r);;){const i=this._headerObjectMap[r];if(!(i!=null&&i.parentCellId))break;t.unshift(i.parentCellId),r=i.parentCellId}}return t}getHeaderDimension(e,t){var n,r,i;if(this.isHeader(e,t)){const l=this.getHeader(e,t);return(r=(n=this.rowsDefine)===null||n===void 0?void 0:n.find(s=>typeof s!="string"&&s.dimensionKey===l.field))!==null&&r!==void 0?r:(i=this.columnsDefine)===null||i===void 0?void 0:i.find(s=>typeof s!="string"&&s.dimensionKey===l.field)}}isColumnIndicatorHeader(e,t){return this._indicatorShowType==="column"&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return this._indicatorShowType==="row"&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}toggleHierarchyState(e,t){var n,r,i,l,s,o;this.colIndex=0;const d=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount,a=this._rowHeaderCellFullPathIds_FULL.slice(0),u=a.map((f,C)=>({col:e,row:C+this.columnHeaderLevelCount})),h=this.getHeader(e,t);if(h.define.hierarchyState=h.define.hierarchyState===Be.collapse?Be.expand:Be.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.rowHierarchyType==="tree"?this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs):this.rowHierarchyType==="grid-tree"&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle){const f=++this.sharedVar.seqId,C=Array(this.rowCount-this.columnHeaderLevelCount).fill(f);this._rowHeaderCellFullPathIds_FULL.unshift(C);const T={id:f,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((g,p)=>typeof p=="string"?g:g+(g?`/${p.title}`:`${p.title}`),""),field:void 0,headerType:(r=(n=this.rowHeaderTitle)===null||n===void 0?void 0:n.headerType)!==null&&r!==void 0?r:"text",style:(i=this.rowHeaderTitle)===null||i===void 0?void 0:i.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(!((l=this.rowHeaderTitle)===null||l===void 0)&&l.disableHeaderHover),disableHeaderSelect:!!(!((s=this.rowHeaderTitle)===null||s===void 0)&&s.disableHeaderSelect)}};this.rowHeaderObjs.push(T),this._headerObjects[f]=T}let c;if(this._rowHeaderCellFullPathIds_FULL=yt(this._rowHeaderCellFullPathIds_FULL),this.rowHierarchyType==="tree"&&((o=this.extensionRows)===null||o===void 0?void 0:o.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((f,C)=>(f[C.id]=C,f),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.rowHierarchyType==="tree")c=Mi(e,t,a.map(f=>f[e-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(f=>f[e-this.leftRowSeriesNumberColumnCount]),u,this);else{const f=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount;c=Ki(e,t,a.map(C=>C[d]),this._rowHeaderCellFullPathIds_FULL.map(C=>C[f]),u,this)}return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),this.rowHierarchyType==="grid-tree"&&this.setColumnWidths(),c}toggleHierarchyStateForColumnTree(e,t){var n,r,i,l,s;this.colIndex=0;const o=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,d=this._columnHeaderCellFullPathIds.slice(0),a=d[this.columnHeaderLevelCount-1].map((f,C)=>({col:C+this.rowHeaderLevelCount,row:t})),u=this.getHeader(e,t);if(u.define.hierarchyState=u.define.hierarchyState===Be.collapse?Be.expand:Be.collapse,this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.columnHierarchyType==="grid-tree"&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle){const f=++this.sharedVar.seqId,C=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(f);this._columnHeaderCellFullPathIds.unshift(C);const T={id:f,title:typeof this.columnHeaderTitle.title=="string"?this.columnHeaderTitle.title:this.columnsDefine.reduce((g,p)=>typeof p=="string"?g:g+(g?`/${p.title}`:`${p.title}`),""),field:void 0,headerType:(r=(n=this.columnHeaderTitle)===null||n===void 0?void 0:n.headerType)!==null&&r!==void 0?r:"text",style:(i=this.columnHeaderTitle)===null||i===void 0?void 0:i.headerStyle,define:{id:f,disableHeaderHover:!!(!((l=this.columnHeaderTitle)===null||l===void 0)&&l.disableHeaderHover),disableHeaderSelect:!!(!((s=this.columnHeaderTitle)===null||s===void 0)&&s.disableHeaderSelect)}};this.columnHeaderObjs.push(T),this._headerObjects[f]=T}this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((f,C)=>(f[C.id]=C,f),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;const h=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,c=Ei(e,t,d[o],this._columnHeaderCellFullPathIds[h],a,this);return this.generateCellIdsConsiderHideHeader(),this.columnHierarchyType==="grid-tree"&&this.setColumnWidths(),c}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(e){var t;if(!Array.isArray(e))return;let n,r,i=this.rowTree,l=this.columnTree;for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!x(a.value))&&d===e.length-1){if(((t=this==null?void 0:this.cornerSetting)===null||t===void 0?void 0:t.titleOnDimension)==="row"){let c=0;return this.rowHierarchyType==="grid"&&(c=this.rowDimensionKeys.indexOf(a.dimensionKey)),c===-1?void 0:{col:(this.rowHeaderTitle?c+1:c)+this.leftRowSeriesNumberColumnCount,row:0}}const h=this.colDimensionKeys.indexOf(a.dimensionKey);return h===-1?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?h+1:h}}let u=!1;for(let h=0;h<l.length;h++){const c=l[h];if((x(a.dimensionKey)&&c.dimensionKey===a.dimensionKey||x(a.indicatorKey)&&c.indicatorKey===a.indicatorKey)&&c.value===a.value){l=c.children,r=c,u=!0;break}}if(!u)for(let h=0;h<i.length;h++){const c=i[h];if((x(a.dimensionKey)&&c.dimensionKey===a.dimensionKey||x(a.indicatorKey)&&c.indicatorKey===a.indicatorKey)&&c.value===a.value){i=c.children,n=c;break}}}let s=0,o=0;if(n){o=this.columnHeaderLevelCount;const{startInTotal:d,afterSpanLevel:a}=n;return o+=d,s=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?a+1:a)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,{col:s,row:o}}if(r){s=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:d,afterSpanLevel:a}=r;return s+=d,o=this.columnHeaderTitle?a+1:a,{col:s,row:o}}}getPivotDimensionInfo(e,t){var n;const{colHeaderPaths:r,rowHeaderPaths:i}=this.getCellHeaderPaths(e,t),l=[];return r.length?r.forEach((s,o)=>{l.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):i.length?i.forEach((s,o)=>{l.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):this.isCornerHeader(e,t)&&(((n=this==null?void 0:this.cornerSetting)===null||n===void 0?void 0:n.titleOnDimension)==="row"?l.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):l.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),l}getIndicatorKey(e,t){var n;return(n=this.getBody(e,t))===null||n===void 0?void 0:n.indicatorKey}getParentCellId(e,t){if(t!==0)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(e){let t,n;if(this._rowHeaderCellIds.find((r,i)=>!!r.find((l,s)=>l===e&&(t=s,!0))&&(n=i,!0)),x(t)&&x(n))return{col:t,row:n+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)return!1;this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);const n=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,n.start.row)===this.getParentCellId(t.col,n.start.row);if(this.isRowHeader(e.col,e.row)){if(this.rowHierarchyType!=="tree")return this.getParentCellId(n.start.col,e.row)===this.getParentCellId(n.start.col,t.row);{const r=Ce(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),i=Ce(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(r.pop(),i.pop(),r.length<=i.length){if(r.length===i.length)return!r.find((l,s)=>l.dimensionKey!==i[s].dimensionKey||l.value!==i[s].value);if(r.length>0){for(let l=0;l<r.length;l++)if(r[l].startInTotal!==i[l].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(e,t){var n,r;if((!((n=this._table.options.dragOrder)===null||n===void 0)&&n.validateDragOrderOnEnd(e,t)||!(!((r=this._table.options.dragOrder)===null||r===void 0)&&r.validateDragOrderOnEnd))&&this.canMoveHeaderPosition(e,t)&&!this.isCellRangeEqual(e.col,e.row,t.col,t.row)){const i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){const l=i.end.col-i.start.col+1;let s;const o=this.getCellRange(t.col,i.start.row);if(s=t.col>=e.col?o.end.col-l+1:o.start.col,s===i.start.col)return null;for(let a=0;a<this._columnHeaderCellFullPathIds.length;a++){const u=this._columnHeaderCellFullPathIds[a].splice(i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,l);u.unshift(s-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[a],u)}const d=this._columnWidths.splice(i.start.col-this.leftRowSeriesNumberColumnCount,l);return d.unshift(s-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,d),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(e.col,e.row).colHeaderPaths.length-1,i.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,o.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.col,targetIndex:s,sourceSize:l,targetSize:o.end.col-o.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)){let l;const s=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,o=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,d=s[s.length-1],a=o[s.length-1],u=d.size;if(l=t.row>=e.row?a.startInTotal+a.size-u:a.startInTotal,l===i.start.row-this.columnHeaderLevelCount)return null;const h=this._rowHeaderCellIds.splice(i.start.row-this.columnHeaderLevelCount,u);h.unshift(l-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,h);const c=this._rowHeaderCellFullPathIds.splice(i.start.row-this.columnHeaderLevelCount,u);c.unshift(l-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,c);const f=this._rowHeaderCellIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,u);f.unshift(l,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,f);const C=this._rowHeaderCellFullPathIds_FULL.splice(i.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,u);return C.unshift(l,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,C),this.rowDimensionTree.movePosition(s.length-1,i.start.row-this.columnHeaderLevelCount,l+(t.row>e.row?d.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:i.start.row,targetIndex:l+this.columnHeaderLevelCount,sourceSize:u,targetSize:a.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(e){var t,n,r,i,l,s;let o,d,a=!1,u=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;o=e.filter(H=>this.colDimensionKeys.indexOf(H.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&H.indicatorKey),d=e.filter(H=>this.rowDimensionKeys.indexOf(H.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&H.indicatorKey)}else o=e.colHeaderPaths,d=e.rowHeaderPaths,(e==null?void 0:e.cellLocation)==="body"&&this._table.isPivotTable()&&(u=!0);if(!Array.isArray(o)&&!Array.isArray(d))return;if(o==null||o.sort((H,_)=>{var P,b;return this.colDimensionKeys.indexOf((P=H.dimensionKey)!==null&&P!==void 0?P:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf((b=_.dimensionKey)!==null&&b!==void 0?b:this.indicatorDimensionKey)}),d==null||d.sort((H,_)=>{var P,b;return this.fullRowDimensionKeys.indexOf((P=H.dimensionKey)!==null&&P!==void 0?P:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf((b=_.dimensionKey)!==null&&b!==void 0?b:this.indicatorDimensionKey)}),o==null||o.forEach(H=>{H.isPivotCorner&&(a=!0)}),d==null||d.forEach(H=>{H.isPivotCorner&&(a=!0)}),a){if(this.cornerSetting.titleOnDimension==="all"&&this.indicatorsAsCol&&o.length===0){for(let H=0;H<this.rowDimensionKeys.length;H++)if(((t=d[0])===null||t===void 0?void 0:t.dimensionKey)===this.rowDimensionKeys[H])return{col:H+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if(this.cornerSetting.titleOnDimension!=="all"||this.indicatorsAsCol||d.length!==0){if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="all"&&!this.indicatorsAsCol){for(let H=0;H<this.rowDimensionKeys.length;H++)if(((r=d[0])===null||r===void 0?void 0:r.dimensionKey)===this.rowDimensionKeys[H])return{col:H+this.leftRowSeriesNumberColumnCount,row:0}}else for(let H=0;H<this.colDimensionKeys.length;H++)if(((i=o[0])===null||i===void 0?void 0:i.dimensionKey)===this.colDimensionKeys[H])return{col:0,row:H}}else for(let H=0;H<this.colDimensionKeys.length;H++)if(((n=o[0])===null||n===void 0?void 0:n.dimensionKey)===this.colDimensionKeys[H])return{col:this.rowHeaderLevelCount-1,row:H}}let h,c,f,C,T=!1;(o==null?void 0:o.length)>=1&&(d==null?void 0:d.length)>=1&&(T=!0);let g,p,w=this.rowTree,m=this.columnTree;if(o)for(let H=0;H<o.length;H++){const _=o[H];for(let P=0;P<m.length;P++){const b=m[P];if(!x(_.indicatorKey)&&b.dimensionKey===_.dimensionKey&&b.value===_.value||x(_.indicatorKey)&&b.indicatorKey===_.indicatorKey&&(x(b.value)&&x(_.value)&&_.value===b.value||!x(b.value)||!x(_.value))){m=b.children,T&&!m?p=b:T||(p=b);break}}}if((d==null?void 0:d.length)>=1)if(this.rowHierarchyType==="tree"){const H=d[d.length-1],_=this.headerObjects.filter(b=>((b==null?void 0:b.field)===H.dimensionKey||(b==null?void 0:b.field)===H.indicatorKey)&&(b==null?void 0:b.title)===H.value).map(b=>b.id),P=this._rowHeaderCellIds.filter(b=>_.indexOf(b[b.length-1])>=0).find(b=>{const y=this.findFullCellIds(b);return y.length===d.length&&y.every(R=>{const v=this._headerObjectMap[R];return d.find(S=>S.dimensionKey===v.field&&S.value===v.title)})});c=this._rowHeaderCellIds.indexOf(P)+this.columnHeaderLevelCount}else for(let H=0;H<d.length;H++){const _=d[H];for(let P=0;P<w.length;P++){const b=w[P];if(!x(_.indicatorKey)&&b.dimensionKey===_.dimensionKey&&b.value===_.value||x(_.indicatorKey)&&b.indicatorKey===_.indicatorKey&&(!x(_.value)||b.value===_.value)){w=b.children,(!T||w&&!w.some(y=>y.dimensionKey==="axis"))&&T||(g=b);break}}}if(u||!T||(g||x(c))&&p){if(g||u){c=this.columnHeaderLevelCount;const{startInTotal:H,afterSpanLevel:_}=(l=g)!==null&&l!==void 0?l:tn;c+=H??0,f=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?_+1:_)+this.leftRowSeriesNumberColumnCount:0}if(p||u){h=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:H,afterSpanLevel:_}=(s=p)!==null&&s!==void 0?s:tn;h+=H??0,C=this.columnHeaderTitle?_+1:_}return x(h)||x(c)?{col:h??f,row:c??C}:void 0}}setChartInstance(e,t,n){var r,i,l,s;const o=this.getCellHeaderPaths(e,t);let d;if(this.indicatorsAsCol){const a=(r=o.colHeaderPaths.find(u=>u.indicatorKey))===null||r===void 0?void 0:r.indicatorKey;d=(i=this._indicators)===null||i===void 0?void 0:i.find(u=>u.indicatorKey===a)}else{const a=(l=o.rowHeaderPaths.find(u=>u.indicatorKey))===null||l===void 0?void 0:l.indicatorKey;d=(s=this._indicators)===null||s===void 0?void 0:s.find(u=>u.indicatorKey===a)}typeof(d==null?void 0:d.chartSpec)!="function"&&d&&(d.chartInstance=n)}getChartInstance(e,t){var n,r,i,l;const s=this.getCellHeaderPaths(e,t);let o;if(this.indicatorsAsCol){const d=(n=s.colHeaderPaths.find(a=>a.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;o=(r=this._indicators)===null||r===void 0?void 0:r.find(a=>a.indicatorKey===d)}else{const d=(i=s.rowHeaderPaths.find(a=>a.indicatorKey))===null||i===void 0?void 0:i.indicatorKey;o=(l=this._indicators)===null||l===void 0?void 0:l.find(a=>a.indicatorKey===d)}return o==null?void 0:o.chartInstance}checkHasChart(){return Yn(this)}getDimension(e,t){var n,r;return t==="column"?(n=this.columnsDefine)===null||n===void 0?void 0:n.find(i=>typeof i!="string"&&i.dimensionKey===e):t==="row"?(r=this.rowsDefine)===null||r===void 0?void 0:r.find(i=>typeof i!="string"&&i.dimensionKey===e):void 0}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&Ze(e,t,"row",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&Ze(e,t,"col",this)){const n=Ne.getFunction("getAxisConfigInPivotChart")(e,t,this);return(n==null?void 0:n.visible)===!1?void 0:n}}isEmpty(e,t){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(e,t)||!!this.isRightBottomCorner(e,t)||!!this.isRightTopCorner(e,t))}isAxisCell(e,t){return this._table.isPivotChart()?!!(this.indicatorKeys.length>=1&&ot(this.indicatorsDefine)&&(this.isBottomFrozenRow(e,t)&&Ze(e,t,"col",this)||this.isRightFrozenColumn(e,t)&&Ze(e,t,"row",this)||this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&Ze(e,t,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&Ze(e,t,"col",this))):!1}getChartAxes(e,t){if(Zn(e,t,this)||this.isAxisCell(e,t))return ei(e,t,this)}getRawChartSpec(e,t){return ti(e,t,this)}getChartSpec(e,t){return ni(e,t,this)}isShareChartSpec(e,t){return ii(e,t,this)}getChartDataId(e,t){return ri(e,t,this)}isNoChartDataRenderNothing(e,t){return si(e,t,this)}setPagination(e){var t,n,r,i,l,s,o;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,this.rowHierarchyType==="grid"&&x((t=this.pagination)===null||t===void 0?void 0:t.perPageCount)&&x((n=this.pagination)===null||n===void 0?void 0:n.currentPage)){this.indicatorsAsCol===!1&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);const{perPageCount:d,currentPage:a}=this.pagination;this.currentPageStartIndex=d*(a||0),this.currentPageEndIndex=this.currentPageStartIndex+d,this._rowHeaderCellIds=(r=this._rowHeaderCellIds_FULL)===null||r===void 0?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(i=this._rowHeaderCellFullPathIds_FULL)===null||i===void 0?void 0:i.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=(l=this._rowHeaderCellIds_FULL)===null||l===void 0?void 0:l.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(s=this._rowHeaderCellFullPathIds_FULL)===null||s===void 0?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=(o=this._rowHeaderCellIds_FULL)===null||o===void 0?void 0:o.length)}release(){var e;const t=this._table._getActiveChartInstance();t==null||t.release(),(e=this._indicators)===null||e===void 0||e.forEach(n=>{var r;(r=n.chartInstance)===null||r===void 0||r.release()})}getHeadNode(e,t){var n,r,i;let l;const s=this.getCellHeaderPaths(e,t);return s.rowHeaderPaths&&((r=(n=s.rowHeaderPaths)===null||n===void 0?void 0:n.length)!==null&&r!==void 0?r:0)>0?l=(i=s.rowHeaderPaths)===null||i===void 0?void 0:i.slice(0,s.rowHeaderPaths.length):s.colHeaderPaths&&s.colHeaderPaths.length>0&&(l=s.colHeaderPaths.slice(0,s.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(l,e,t)}getHeadNodeByRowOrColDimensions(e,t,n){var r;if(!Array.isArray(e))return;let i,l,s=this.rowTree,o=this.columnTree;if(x(n)&&x(t)&&this.rowHierarchyType==="tree"&&this.extensionRows&&t>=1+this.leftRowSeriesNumberColumnCount){const d=this.getCellId(t-1,n);s=this._rowHeaderExtensionTree[d].tree.children}for(let d=0;d<e.length;d++){const a=e[d];if((a.isPivotCorner||!x(a.value))&&d===e.length-1)return;let u=!1;for(let h=0;h<o.length;h++){const c=o[h];if(x(a.dimensionKey)&&c.dimensionKey===a.dimensionKey&&c.value===a.value||x(a.indicatorKey)&&c.indicatorKey===a.indicatorKey&&(c.value===a.value||!x(a.value)||!x(c.value))){o=c.children,l=c,u=!0;break}}if(!u)for(let h=0;(r=h<(s==null?void 0:s.length))!==null&&r!==void 0&&r;h++){const c=s[h];if(x(a.dimensionKey)&&c.dimensionKey===a.dimensionKey&&c.value===a.value||x(a.indicatorKey)&&c.indicatorKey===a.indicatorKey&&(c.value===a.value||!x(a.value)||!x(c.value))){s=c.children,i=c;break}}}return i||l||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){var n,r,i,l,s,o;let d;if(this.indicatorsAsCol===!1)for(let a=0;a<this.indicatorsDefine.length;a++){const u=this.indicatorsDefine[a].chartSpec;if(u&&(d=(n=u.xField)!==null&&n!==void 0?n:(i=(r=u==null?void 0:u.series)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.xField,d))return d}else for(let a=0;a<this.indicatorsDefine.length;a++){const u=this.indicatorsDefine[a].chartSpec;if(u&&(d=(l=u.yField)!==null&&l!==void 0?l:(o=(s=u==null?void 0:u.series)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.yField,d))return d}return null}_generateChartState(){return{vtable_selected:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(n=>{for(const r in n)if(typeof n[r]!="object"&&n[r]!==e[r])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!!this._table._selectedDimensionInChart.every(n=>typeof n.value=="object"||e[n.key]===n.value):!1}},vtable_selected_reverse:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(n=>{for(const r in n)if(typeof n[r]!="object"&&n[r]!==e[r])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!this._table._selectedDimensionInChart.every(n=>typeof n.value=="object"||e[n.key]===n.value):!1}}}}updateDataStateToChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const n=this._generateChartState();this._indicators.forEach(r=>{var i;const l=r.chartInstance;((i=r.chartSpec.select)===null||i===void 0?void 0:i.enable)!==!1&&l.updateState(n)}),e==null||e.updateState(n)}}updateDataStateToActiveChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const n=this._generateChartState();e==null||e.updateState(n)}}getIndicatorKeyInChartSpec(e,t){const n=this.getRawChartSpec(e,t),r=[];if(n){if(n.series||n.xField||n.yField)return this.indicatorsAsCol===!1?n.series?n.series.forEach(i=>{const l=i.yField;r.push(l)}):r.push(n.yField):n.series?n.series.forEach(i=>{const l=i.xField;r.push(l)}):r.push(n.xField),r;if(n.valueField&&r.push(n.valueField),r.length>=1)return r}return null}getOptimunHeightForChart(e){var t,n,r,i,l;const s=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;let o,d;for(const u in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[u].type==="yField"&&!this.dataset.collectValuesBy[u].range){o=(t=this.dataset.collectedValues[u])===null||t===void 0?void 0:t[s.map(h=>h.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=nn((n=o==null?void 0:o.length)!==null&&n!==void 0?n:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const u=this._chartItemSpanSize||25;d=((r=o==null?void 0:o.length)!==null&&r!==void 0?r:0)*(u+u/3)}const a=Ut((l=(i=this._chartPadding)!==null&&i!==void 0?i:this._table.theme.bodyStyle.padding)!==null&&l!==void 0?l:0);return d+a[0]+a[2]}getOptimunWidthForChart(e){var t,n,r,i,l;const s=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;let o,d;for(const u in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[u].type==="xField"&&!this.dataset.collectValuesBy[u].range){o=(t=this.dataset.collectedValues[u])===null||t===void 0?void 0:t[s.map(h=>h.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)d=nn((n=o==null?void 0:o.length)!==null&&n!==void 0?n:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const u=this._chartItemSpanSize||25;d=((r=o==null?void 0:o.length)!==null&&r!==void 0?r:0)*(u+u/3)}const a=Ut((l=(i=this._chartPadding)!==null&&i!==void 0?i:this._table.theme.bodyStyle.padding)!==null&&l!==void 0?l:0);return d+a[1]+a[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="left");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="top");return(e==null?void 0:e.visible)===!1?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){const n=this.getCellHeaderPaths(e,t),r=[];return n.colHeaderPaths.length&&n.colHeaderPaths.forEach(i=>{i.dimensionKey&&r.push(i.value)}),r==null?void 0:r.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){const n=this.getCellHeaderPaths(e,t),r=[];return n.rowHeaderPaths.length&&n.rowHeaderPaths.forEach(i=>{i.dimensionKey&&r.push(i.value)}),r==null?void 0:r.join(this.dataset.stringJoinChar)}getIndicatorInfo(e,t=""){var n;return(n=this.indicatorsDefine)===null||n===void 0?void 0:n.find(r=>typeof r!="string"&&(e?r.indicatorKey===e:!!t&&r.title===t))}getLayoutColumnTree(){const e=[],t=this.columnDimensionTree.tree.children;return qt(e,t),e}getLayoutRowTree(){const e=[],t=this.rowDimensionTree.tree.children;return qt(e,t),e}getLayoutColumnTreeCount(){const e=this.columnDimensionTree.tree.children;return _t(e,this.rowHierarchyType==="tree")}getLayoutRowTreeCount(){var e;const t=this.rowDimensionTree.tree.children;let n=_t(t,this.rowHierarchyType==="tree");return(e=this.extensionRows)===null||e===void 0||e.forEach(r=>{if(typeof r.rowTree!="function"){const i=_t(r.rowTree,!0);n*=i}}),n}resetHeaderTree(){var e,t,n;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];const r=this.dataset;this.rowTree=r.rowHeaderTree,this.columnTree=r.colHeaderTree;const i=this.rowDimensionTree.tree.children;(e=this.rowTree)===null||e===void 0||e.forEach((l,s)=>{const o=i.find(d=>d.dimensionKey===l.dimensionKey&&d.value===l.value);o&&this._table._syncHierarchyState(o,l)}),this.columnDimensionTree=new ge((t=this.columnTree)!==null&&t!==void 0?t:[],this.sharedVar,this.columnHierarchyType,this.columnHierarchyType!=="grid"?this.columnExpandLevel:void 0),this.rowDimensionTree=new ge((n=this.rowTree)!==null&&n!==void 0?n:[],this.sharedVar,this.rowHierarchyType,this.rowHierarchyType!=="grid"?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=yt(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((l,s)=>(l[s.id]=s,l),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){return!!(x(e)&&x(t)&&(this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:Object.assign({},this._table.internalProps.theme.cornerHeaderStyle,this._table.internalProps.rowSeriesNumber.headerStyle)}):this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,n){this.getHeadNode(e,t).value=n;const r=this.getCellId(e,t);this._headerObjectMap[r].title=n}changeCornerTitle(e,t,n){if(this.isCornerHeader(e,t)){const r=this.getCellId(e,t);this._headerObjectMap[r].title=n}}generateCellIdsConsiderHideHeader(){var e,t,n,r;if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const i=this.colDimensionKeys.indexOf(ze),l=this._columnHeaderCellIds.splice(i,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(l[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((i,l)=>{const s=i.slice();s.splice(0,s.length),this._rowHeaderCellIds_FULL[l]=s});else{const i=this.rowDimensionKeys.indexOf(ze);this._rowHeaderCellIds_FULL.forEach((l,s)=>{const o=l.slice(),d=o.splice(i,1);o.splice(0,o.length),o.push(d[0]),this._rowHeaderCellIds_FULL[s]=o})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),this.rowHeaderLevelCount===0||this.columnHeaderLevelCount===0)this._cornerHeaderCellIds=[];else if(this.cornerSetting.titleOnDimension!=="row"||this.showRowHeader){if(this.cornerSetting.titleOnDimension==="column"&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const i=this.colDimensionKeys.indexOf(ze),l=this._cornerHeaderCellIds.splice(i,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(l[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((i,l)=>{const s=i.slice();s.splice(0,s.length),this._cornerHeaderCellIds[l]=s});else{const i=this.rowDimensionKeys.indexOf(ze);this._cornerHeaderCellIds.forEach((l,s)=>{const o=l.slice(),d=o.splice(i,1);o.splice(0,o.length),o.push(d[0]),this._cornerHeaderCellIds[s]=o})}if(this.rowHierarchyType==="grid-tree"&&this.cornerSetting.titleOnDimension==="column")this._cornerHeaderCellIds[0].length<this._rowHeaderCellIds[0].length?this._cornerHeaderCellIds.forEach((i,l)=>{const s=i.length;i.length=this._rowHeaderCellIds[0].length,i.fill(i[0],s)}):this._cornerHeaderCellIds[0].length>this._rowHeaderCellIds[0].length&&this._cornerHeaderCellIds.forEach((i,l)=>{i.length=this._rowHeaderCellIds[0].length});else if(this.columnHierarchyType==="grid-tree"&&this.cornerSetting.titleOnDimension==="row")if(((e=this._cornerHeaderCellIds)===null||e===void 0?void 0:e.length)<((t=this._columnHeaderCellIds)===null||t===void 0?void 0:t.length)){const i=this._cornerHeaderCellIds.length;this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length,this._cornerHeaderCellIds.fill(this._cornerHeaderCellIds[0],i)}else((n=this._cornerHeaderCellIds)===null||n===void 0?void 0:n.length)>((r=this._columnHeaderCellIds)===null||r===void 0?void 0:r.length)&&(this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length)}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}disableUseHeaderPathCache(){this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,n){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,n):this._getBodyCache.set(t,n))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,n){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,n)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,n){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,n)}}function nn(I,e,t,n){t===1&&(t=0);const r=Oi(I,t,n),i=e/(1-t);return Math.ceil(r*i)}function Oi(I,e,t){let n;return n=I===1?I+2*t:I-e+2*t,I?n>0?n:1:0}class vt{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,typeof window<"u"&&window.performance.now(),this.setRecords(t),typeof window<"u"&&window.performance.now())}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let e=0,t=this.records.length;e<t;e++){const n=this.records[e];this.processRecord(n)}}processRecord(e){var t;const n=[],r=[];for(let i=0,l=this.dataConfig.rows.length;i<l;i++){const s=this.dataConfig.rows[i];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&r.push(e[s])}for(let i=0,l=this.dataConfig.columns.length;i<l;i++){const s=this.dataConfig.columns[i];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&n.push(e[s])}(t=this.dataConfig.indicators)===null||t===void 0||t.forEach(i=>{const l=e[i];l!==void 0&&(this.dataConfig.indicatorsAsCol?n.push(i):r.push(i));const s=r.join(this.stringJoinChar),o=n.join(this.stringJoinChar);r.length!==0&&(this.rowFlatKeys[s]||(this.rowFlatKeys[s]=1)),n.length!==0&&(this.colFlatKeys[o]||(this.colFlatKeys[o]=1)),n.length===0&&r.length===0||(this.tree[s]||(this.tree[s]={}),l!==void 0&&(this.tree[s][o]={value:l,record:e},this.dataConfig.indicatorsAsCol?n.pop():r.pop()))})}getTreeNode(e=[],t=[],n,r=!0){var i,l,s,o;let d,a;if(typeof e=="string")d=e;else{let u=!1;e.map((h,c)=>{h===n&&(e.splice(c,1),u=!0)}),u&&e.push(n),d=e.join(this.stringJoinChar)}if(typeof t=="string")a=t;else{let u=!1;t.map((h,c)=>{h===n&&(t.splice(c,1),u=!0)}),u&&t.push(n),a=t.join(this.stringJoinChar)}return r?(s=(l=(i=this.tree)===null||i===void 0?void 0:i[d])===null||l===void 0?void 0:l[a])!==null&&s!==void 0?s:void 0:x((o=this.beforeChangedTree[d])===null||o===void 0?void 0:o[a])?{value:this.beforeChangedTree[d][a].value,record:this.beforeChangedTree[d][a].record}:void 0}changeTreeNodeValue(e=[],t=[],n,r){var i,l,s,o,d,a,u;let h,c;if(typeof e=="string")h=e;else{let T=!1;e.map((g,p)=>{g===n&&(e.splice(p,1),T=!0)}),T&&e.push(n),h=e.join(this.stringJoinChar)}if(typeof t=="string")c=t;else{let T=!1;t.map((g,p)=>{g===n&&(t.splice(p,1),T=!0)}),T&&t.push(n),c=t.join(this.stringJoinChar)}const f=(l=(i=this.tree[h])===null||i===void 0?void 0:i[c])===null||l===void 0?void 0:l.value,C=Object.assign({},(o=(s=this.tree[h])===null||s===void 0?void 0:s[c])===null||o===void 0?void 0:o.record);!((a=(d=this.tree[h])===null||d===void 0?void 0:d[c])===null||a===void 0)&&a.record?(this.tree[h][c].record[n]=r,this.tree[h][c].value=r):(this.tree[h]||(this.tree[h]={}),this.tree[h][c]={record:this._buildRecord(e,t,n,r),value:r}),!((u=this.beforeChangedTree[h])===null||u===void 0)&&u[c]||(this.beforeChangedTree[h]={},this.beforeChangedTree[h][c]={record:void 0,value:void 0},this.beforeChangedTree[h][c].record=C,this.beforeChangedTree[h][c].value=f)}_buildRecord(e=[],t=[],n,r){const i={},l=this.dataConfig.rows,s=this.dataConfig.columns;return l.forEach((o,d)=>{o!==this.dataConfig.indicatorDimensionKey&&(i[o]=e[d])}),s.forEach((o,d)=>{o!==this.dataConfig.indicatorDimensionKey&&(i[o]=t[d])}),i[n]=r,this.records.push(i),i}addRecords(e){for(let t=0,n=e.length;t<n;t++){const r=e[t];this.processRecord(r)}this.records.push(e)}changeRecordFieldValue(e,t,n){let r=!1;for(let i=0;i<this.dataConfig.indicators.length;i++)this.dataConfig.indicators[i]===e&&(r=!0);if(!r){for(let i=0,l=this.records.length;i<l;i++){const s=this.records[i];s[e]===t&&(s[e]=n)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}function rn(I,e){let t="";for(let n=0;n<I.length;n++)t+=I[n],n!==I.length-1&&(t+=e);return t}class gt{constructor(e,t,n,r,i,l,s,o,d,a,u,h,c,f){var C,T,g,p,w,m,H,_,P,b,y,R,v,S,A,F,N,K,O,L,E,$,J,de,ae,ue,he,ce,pe,ve,be,Pe,Se,Ie,Re,De,te,se;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=(C=this.dataConfig)===null||C===void 0?void 0:C.filterRules,this.rowHierarchyType=o??"grid",this.columnHierarchyType=d??"grid",this.sortRules=(T=this.dataConfig)===null||T===void 0?void 0:T.sortRules,this.aggregationRules=(g=this.dataConfig)===null||g===void 0?void 0:g.aggregationRules,this.derivedFieldRules=(p=this.dataConfig)===null||p===void 0?void 0:p.derivedFieldRules,this.mappingRules=(w=this.dataConfig)===null||w===void 0?void 0:w.mappingRules,this.calculatedFieldRules=(m=this.dataConfig)===null||m===void 0?void 0:m.calculatedFieldRules,this.calculatedFiledKeys=(_=(H=this.calculatedFieldRules)===null||H===void 0?void 0:H.map(q=>q.key))!==null&&_!==void 0?_:[],this.calculatedFieldDependIndicatorKeys=(b=(P=this.calculatedFieldRules)===null||P===void 0?void 0:P.reduce((q,X)=>{for(let ne=0;ne<X.dependIndicatorKeys.length;ne++)q.indexOf(X.dependIndicatorKeys[ne])===-1&&q.push(X.dependIndicatorKeys[ne]);return q},[]))!==null&&b!==void 0?b:[],this.totals=(y=this.dataConfig)===null||y===void 0?void 0:y.totals,this.rows=t,this.columns=n,this.indicatorKeys=r,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...r];for(let q=0;q<this.calculatedFieldDependIndicatorKeys.length;q++)this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[q])===-1&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[q]);if(this.indicatorsAsCol=l,this.indicators=i,this.customColTree=a,this.customRowTree=u,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=f,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=(S=(v=(R=this.totals)===null||R===void 0?void 0:R.column)===null||v===void 0?void 0:v.grandTotalLabel)!==null&&S!==void 0?S:"总计",this.colSubTotalLabel=(N=(F=(A=this.totals)===null||A===void 0?void 0:A.column)===null||F===void 0?void 0:F.subTotalLabel)!==null&&N!==void 0?N:"小计",this.rowGrandTotalLabel=(L=(O=(K=this.totals)===null||K===void 0?void 0:K.row)===null||O===void 0?void 0:O.grandTotalLabel)!==null&&L!==void 0?L:"总计",this.rowSubTotalLabel=(J=($=(E=this.totals)===null||E===void 0?void 0:E.row)===null||$===void 0?void 0:$.subTotalLabel)!==null&&J!==void 0?J:"小计",this.collectValuesBy=(de=this.dataConfig)===null||de===void 0?void 0:de.collectValuesBy,this.needSplitPositiveAndNegative=h!=null&&h,this.rowsIsTotal=new Array((ue=(ae=this.rows)===null||ae===void 0?void 0:ae.length)!==null&&ue!==void 0?ue:0).fill(!1),this.colsIsTotal=new Array((ce=(he=this.columns)===null||he===void 0?void 0:he.length)!==null&&ce!==void 0?ce:0).fill(!1),((pe=this.totals)===null||pe===void 0?void 0:pe.row)&&this.totals.row.showSubTotals!==!1&&this.totals.row.subTotalsDimensions)for(let q=0,X=(Se=(Pe=(be=(ve=this.totals)===null||ve===void 0?void 0:ve.row)===null||be===void 0?void 0:be.subTotalsDimensions)===null||Pe===void 0?void 0:Pe.length)!==null&&Se!==void 0?Se:0;q<X;q++){const ne=this.totals.row.subTotalsDimensions[q],fe=this.rows.indexOf(ne);this.rowsIsTotal[fe]=!0}if(!((Ie=this.totals)===null||Ie===void 0)&&Ie.column&&this.totals.column.showSubTotals!==!1&&this.totals.column.subTotalsDimensions)for(let q=0,X=(se=(te=(De=(Re=this.totals)===null||Re===void 0?void 0:Re.column)===null||De===void 0?void 0:De.subTotalsDimensions)===null||te===void 0?void 0:te.length)!==null&&se!==void 0?se:0;q<X;q++){const ne=this.totals.column.subTotalsDimensions[q],fe=this.columns.indexOf(ne);this.colsIsTotal[fe]=!0}this.setRecords(s)}setRecords(e){var t,n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,e&&(this.records=e,typeof window<"u"&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.totalStatistics(),typeof window<"u"&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),typeof window<"u"&&window.performance.now(),this.sortKeys(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((b,y)=>this.rowsHasValue[y]),this.indicatorsAsCol?void 0:this.indicators,((n=(t=this.totals)===null||t===void 0?void 0:t.row)===null||n===void 0?void 0:n.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,(l=(i=(r=this.totals)===null||r===void 0?void 0:r.row)===null||i===void 0?void 0:i.showGrandTotalsOnTop)!==null&&l!==void 0&&l):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((b,y)=>this.rowsHasValue[y]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((o=(s=this.totals)===null||s===void 0?void 0:s.row)===null||o===void 0?void 0:o.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(u=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showGrandTotalsOnTop)!==null&&u!==void 0&&u,(f=(c=(h=this.totals)===null||h===void 0?void 0:h.row)===null||c===void 0?void 0:c.showSubTotalsOnTop)!==null&&f!==void 0&&f),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((b,y)=>this.columnsHasValue[y]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((T=(C=this.totals)===null||C===void 0?void 0:C.column)===null||T===void 0?void 0:T.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(w=(p=(g=this.totals)===null||g===void 0?void 0:g.column)===null||p===void 0?void 0:p.showGrandTotalsOnLeft)!==null&&w!==void 0&&w,(_=(H=(m=this.totals)===null||m===void 0?void 0:m.column)===null||H===void 0?void 0:H.showSubTotalsOnLeft)!==null&&_!==void 0&&_),typeof window<"u"&&window.performance.now(),!((P=this.dataConfig)===null||P===void 0)&&P.isPivotChart&&this.cacheDeminsionCollectedValues())}registerAggregator(e,t){Te[e]=t}registerAggregators(){this.registerAggregator(ee.RECORD,li),this.registerAggregator(ee.SUM,oi),this.registerAggregator(ee.COUNT,di),this.registerAggregator(ee.MAX,ai),this.registerAggregator(ee.MIN,ui),this.registerAggregator(ee.AVG,hi),this.registerAggregator(ee.NONE,ci),this.registerAggregator(ee.RECALCULATE,fi),this.registerAggregator(ee.CUSTOM,gi)}processCollectedValuesWithSumBy(){var e,t,n,r,i,l;for(const s in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[s])===null||t===void 0)&&t.sumBy)for(const o in this.collectedValues[s]){let d;((n=this.collectValuesBy[s])===null||n===void 0?void 0:n.extendRange)==="sum"?(d=Object.values(this.collectedValues[s][o]).reduce((c,f)=>c+f.value(),0),d+=Math.round(d/20)):(d=Object.values(this.collectedValues[s][o]).reduce((c,f)=>f.value()>c?f.value():c,Number.MIN_SAFE_INTEGER),((r=this.collectValuesBy[s])===null||r===void 0?void 0:r.extendRange)==="max"?d+=Math.round(d/20):typeof((i=this.collectValuesBy[s])===null||i===void 0?void 0:i.extendRange)=="number"&&(d=Math.max(d,(l=this.collectValuesBy[s])===null||l===void 0?void 0:l.extendRange)));const a=Object.values(this.collectedValues[s][o]).reduce((c,f)=>f.value()<c?f.value():c,Number.MAX_SAFE_INTEGER);let u,h;this.needSplitPositiveAndNegative&&(u=Object.values(this.collectedValues[s][o]).reduce((c,f)=>f.positiveValue()>c?f.positiveValue():c,Number.MIN_SAFE_INTEGER),h=Object.values(this.collectedValues[s][o]).reduce((c,f)=>f.negativeValue()<c?f.negativeValue():c,Number.MAX_SAFE_INTEGER)),this.collectedValues[s][o]={},this.collectedValues[s][o].max=d,this.collectedValues[s][o].min=a,this.needSplitPositiveAndNegative&&(this.collectedValues[s][o].positiveMax=u,this.collectedValues[s][o].negativeMin=h)}}processCollectedValuesWithSortBy(){var e,t;const n=this;for(const r in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[r])===null||t===void 0)&&t.sortBy)for(const i in this.collectedValues[r])this.collectedValues[r][i]=this.collectedValues[r][i].sort((l,s)=>{var o,d,a,u;return((d=(o=n.collectValuesBy[r].sortBy)===null||o===void 0?void 0:o.indexOf(l))!==null&&d!==void 0?d:-1)-((u=(a=n.collectValuesBy[r].sortBy)===null||a===void 0?void 0:a.indexOf(s))!==null&&u!==void 0?u:-1)})}generateCollectedValuesSortRule(){for(const e in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[e]&&!this.collectValuesBy[e].sortBy){let t=[];for(const n in this.collectedValues[e])Array.isArray(this.collectedValues[e][n])&&(t.push(...this.collectedValues[e][n]),t=Array.from(new Set(t)));t.length>0&&(this.collectValuesBy[e].sortBy=t)}}processRecords(){var e,t;let n=!1;if(((t=(e=this.filterRules)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)>=1&&(n=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let r=0,i=this.records.length;r<i;r++){const l=this.records[r];n&&!this.filterRecord(l)||(this.filteredRecords.push(l),this.processRecord(l))}}else{this.filteredRecords||(this.filteredRecords={});for(const r in this.records)for(let i=0,l=this.records[r].length;i<l;i++){const s=this.records[r][i];n&&!this.filterRecord(s)||(this.filteredRecords[r]||(this.filteredRecords[r]=[]),this.filteredRecords[r].push(s),this.processRecord(s,r))}}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(e){var t,n;let r=!0;if(this.filterRules)for(let i=0;i<this.filterRules.length;i++){const l=this.filterRules[i];if(l.filterKey){const s=e[l.filterKey];if(((t=l.filteredValues)===null||t===void 0?void 0:t.indexOf(s))===-1){r=!1;break}}else if(!(!((n=l.filterFunc)===null||n===void 0)&&n.call(l,e))){r=!1;break}}return r}processRecord(e,t){var n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P,b,y,R,v,S,A,F,N,K,O,L,E,$,J,de,ae,ue,he,ce,pe,ve,be,Pe,Se,Ie,Re,De,te,se,q,X,ne,fe,ye,le,me,Fe,je,We,Ue,qe,Ge,Qe,$e,Je;(n=this.derivedFieldRules)===null||n===void 0||n.forEach((D,k)=>{D.fieldName&&D.derivedFunc&&(e[D.fieldName]=D.derivedFunc(e))});for(const D in this.collectValuesBy)if(x(e[D])){this.collectedValues[D]||(this.collectedValues[D]={});const k=this.collectValuesBy[D].by.map(Q=>e[Q]).join(this.stringJoinChar);if(this.collectedValues[D][k]||(this.collectValuesBy[D].sumBy?this.collectedValues[D][k]={}:this.collectValuesBy[D].range?this.collectedValues[D][k]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[D][k]=[]),this.collectValuesBy[D].sumBy){const Q=(r=this.collectValuesBy[D].sumBy)===null||r===void 0?void 0:r.map(G=>e[G]).join(this.stringJoinChar);this.collectedValues[D][k][Q]||(this.collectedValues[D][k][Q]=new Te[ee.SUM]({key:D,field:D,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[D][k][Q].push(e)}else if(this.collectValuesBy[D].range){const Q=this.collectedValues[D][k],G=Math.max(e[D],Q.max),ie=Math.min(e[D],Q.min);isNaN(G)||(Q.max=G,Q.min=ie)}else{const Q=this.collectedValues[D][k];Q.indexOf(e[D])===-1&&Q.push(e[D])}}let Xe=!1;const oe=[],_e=[];if(!this.parseCustomTreeToMatchRecords||!((i=this.dataConfig)===null||i===void 0)&&i.isPivotChart||!(!((l=this.customRowTree)===null||l===void 0)&&l.length)||t||this.hasExtensionRowTree){const D=[];_e.push({rowKey:D,indicatorKey:t});for(let k=0,Q=this.rows.length;k<Q;k++){const G=this.rows[k];if(G in e)this.rowsHasValue[k]=!0,D.push(e[G]);else if(G!==ze){if(!((d=(o=(s=this.dataConfig)===null||s===void 0?void 0:s.totals)===null||o===void 0?void 0:o.row)===null||d===void 0)&&d.showGrandTotals&&k===0&&!this.rows.find(ie=>ie in e)){D.push(this.rowGrandTotalLabel),Xe=!0;break}if(!((h=(u=(a=this.dataConfig)===null||a===void 0?void 0:a.totals)===null||u===void 0?void 0:u.row)===null||h===void 0)&&h.subTotalsDimensions&&((C=(f=(c=this.dataConfig)===null||c===void 0?void 0:c.totals)===null||f===void 0?void 0:f.row)===null||C===void 0?void 0:C.subTotalsDimensions.indexOf(this.rows[k-1]))>=0){this.rowHierarchyType!=="tree"&&D.push(this.rowSubTotalLabel),Xe=!0;break}}}}else{const D=this.getFieldMatchRowDimensionPaths(e);if(D.length>0)for(let k=0,Q=D.length;k<Q;k++){const G=D[k],ie=[];let z;for(let U=0,re=G.length;U<re;U++)x(G[U].indicatorKey)?z=G[U].indicatorKey:ie.push(G[U].value);_e.push({rowKey:ie,indicatorKey:z})}}if(!this.parseCustomTreeToMatchRecords||!((T=this.dataConfig)===null||T===void 0)&&T.isPivotChart||!(!((g=this.customColTree)===null||g===void 0)&&g.length)||t||this.hasExtensionRowTree){const D=[];oe.push({colKey:D,indicatorKey:t});for(let k=0,Q=this.columns.length;k<Q;k++){const G=this.columns[k];if(G in e)this.columnsHasValue[k]=!0,D.push(e[G]);else if(G!==ze){if(!((m=(w=(p=this.dataConfig)===null||p===void 0?void 0:p.totals)===null||w===void 0?void 0:w.column)===null||m===void 0)&&m.showGrandTotals&&k===0&&!this.columns.find(ie=>ie in e)){D.push(this.colGrandTotalLabel),Xe=!0;break}if(!((P=(_=(H=this.dataConfig)===null||H===void 0?void 0:H.totals)===null||_===void 0?void 0:_.column)===null||P===void 0)&&P.subTotalsDimensions&&((R=(y=(b=this.dataConfig)===null||b===void 0?void 0:b.totals)===null||y===void 0?void 0:y.column)===null||R===void 0?void 0:R.subTotalsDimensions.indexOf(this.columns[k-1]))>=0){D.push(this.colSubTotalLabel),Xe=!0;break}}}}else{const D=this.getFieldMatchColDimensionPaths(e);if(D.length>0)for(let k=0,Q=D.length;k<Q;k++){const G=D[k],ie=[];let z;for(let U=0,re=G.length;U<re;U++)x(G[U].indicatorKey)?z=G[U].indicatorKey:ie.push(G[U].value);oe.push({colKey:ie,indicatorKey:z})}}for(let D=0;D<_e.length;D++){const k=_e[D].rowKey;let Q;this.indicatorsAsCol||(Q=_e[D].indicatorKey);for(let G=0;G<oe.length;G++){const ie=oe[G].colKey;this.indicatorsAsCol&&(Q=oe[G].indicatorKey);const z=k.join(this.stringJoinChar),U=ie.join(this.stringJoinChar);if(Xe){this.totalRecordsTree[z]||(this.totalRecordsTree[z]={}),this.totalRecordsTree[z][U]||(this.totalRecordsTree[z][U]=[]);const V=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let j=0;j<V.length;j++)if(this.calculatedFiledKeys.indexOf(V[j])>=0){const Y=(v=this.calculatedFieldRules)===null||v===void 0?void 0:v.find(Ae=>Ae.key===V[j]);!((A=(S=this.totalRecordsTree[z])===null||S===void 0?void 0:S[U])===null||A===void 0)&&A[j]||(this.totalRecordsTree[z][U][j]=new Te[ee.RECALCULATE]({key:V[j],field:V[j],isRecord:!0,formatFun:(N=(F=this.indicators)===null||F===void 0?void 0:F.find(Ae=>typeof Ae!="string"&&Ae.indicatorKey===V[j]))===null||N===void 0?void 0:N.format,calculateFun:Y==null?void 0:Y.calculateFun,dependAggregators:this.totalRecordsTree[z][U],dependIndicatorKeys:Y==null?void 0:Y.dependIndicatorKeys})),V[j]in e&&((O=(K=this.totalRecordsTree[z])===null||K===void 0?void 0:K[U])===null||O===void 0||O[j].push(e))}else{const Y=this.getAggregatorRule(V[j]);!((E=(L=this.totalRecordsTree[z])===null||L===void 0?void 0:L[U])===null||E===void 0)&&E[j]||(this.totalRecordsTree[z][U][j]=new Te[($=Y==null?void 0:Y.aggregationType)!==null&&$!==void 0?$:ee.SUM]({key:V[j],field:(J=Y==null?void 0:Y.field)!==null&&J!==void 0?J:V[j],aggregationFun:Y==null?void 0:Y.aggregationFun,formatFun:(de=Y==null?void 0:Y.formatFun)!==null&&de!==void 0?de:(ue=(ae=this.indicators)===null||ae===void 0?void 0:ae.find(Ae=>typeof Ae!="string"&&Ae.indicatorKey===V[j]))===null||ue===void 0?void 0:ue.format})),V[j]in e&&((ce=(he=this.totalRecordsTree[z])===null||he===void 0?void 0:he[U])===null||ce===void 0||ce[j].push(e))}return}k.length!==0&&(this.rowFlatKeys[z]||(this.rowKeys.push(k),this.rowFlatKeys[z]=1)),ie.length!==0&&(this.colFlatKeys[U]||(this.colKeys.push(ie),this.colFlatKeys[U]=1)),this.tree[z]||(this.tree[z]={}),!((pe=this.tree[z])===null||pe===void 0)&&pe[U]||(this.tree[z][U]=[]);const re=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let V=0;V<re.length;V++)if(this.calculatedFiledKeys.indexOf(re[V])>=0){const j=(ve=this.calculatedFieldRules)===null||ve===void 0?void 0:ve.find(Y=>Y.key===re[V]);!((Pe=(be=this.tree[z])===null||be===void 0?void 0:be[U])===null||Pe===void 0)&&Pe[V]||(this.tree[z][U][V]=new Te[ee.RECALCULATE]({key:re[V],field:re[V],isRecord:!0,formatFun:(Ie=(Se=this.indicators)===null||Se===void 0?void 0:Se.find(Y=>typeof Y!="string"&&Y.indicatorKey===re[V]))===null||Ie===void 0?void 0:Ie.format,calculateFun:j==null?void 0:j.calculateFun,dependAggregators:this.tree[z][U],dependIndicatorKeys:j==null?void 0:j.dependIndicatorKeys})),(De=(Re=this.tree[z])===null||Re===void 0?void 0:Re[U])===null||De===void 0||De[V].push(e)}else{const j=this.getAggregatorRule(re[V]);let Y=!1;Q?t===Q?re[V]===Q&&(Y=!0):re[V]===Q&&re[V]in e&&(Y=!0):j!=null&&j.field?typeof(j==null?void 0:j.field)=="string"?(j==null?void 0:j.field)in e&&(Y=!0):j!=null&&j.field.find(Ae=>Ae in e)&&(Y=!0):re[V]in e&&(Y=!0),!(!((se=(te=this.tree[z])===null||te===void 0?void 0:te[U])===null||se===void 0)&&se[V])&&Y&&(this.tree[z][U][V]=new Te[(q=j==null?void 0:j.aggregationType)!==null&&q!==void 0?q:ee.SUM]({key:re[V],field:(X=j==null?void 0:j.field)!==null&&X!==void 0?X:re[V],aggregationFun:j==null?void 0:j.aggregationFun,formatFun:(ne=j==null?void 0:j.formatFun)!==null&&ne!==void 0?ne:(ye=(fe=this.indicators)===null||fe===void 0?void 0:fe.find(Ae=>typeof Ae!="string"&&Ae.indicatorKey===re[V]))===null||ye===void 0?void 0:ye.format})),Y&&((me=(le=this.tree[z])===null||le===void 0?void 0:le[U])===null||me===void 0||me[V].push(e))}if(this.mappingRules)for(let V=0;V<this.indicatorKeys.length;V++){if(!this.indicatorStatistics[V]){const j=this.getAggregatorRule(this.indicatorKeys[V]);this.indicatorStatistics[V]={max:new Te[ee.MAX]({key:this.indicatorKeys[V],field:this.indicatorKeys[V]}),min:new Te[ee.MIN]({key:this.indicatorKeys[V],field:this.indicatorKeys[V]}),total:new Te[(Fe=j==null?void 0:j.aggregationType)!==null&&Fe!==void 0?Fe:ee.SUM]({key:this.indicatorKeys[V],field:(je=j==null?void 0:j.field)!==null&&je!==void 0?je:this.indicatorKeys[V],aggregationFun:j==null?void 0:j.aggregationFun,formatFun:(We=j==null?void 0:j.formatFun)!==null&&We!==void 0?We:(qe=(Ue=this.indicators)===null||Ue===void 0?void 0:Ue.find(Y=>typeof Y!="string"&&Y.indicatorKey===this.indicatorKeys[V]))===null||qe===void 0?void 0:qe.format})}}this.indicatorStatistics[V].max.push((Qe=(Ge=this.tree[z])===null||Ge===void 0?void 0:Ge[U])===null||Qe===void 0?void 0:Qe[V].value()),this.indicatorStatistics[V].min.push((Je=($e=this.tree[z])===null||$e===void 0?void 0:$e[U])===null||Je===void 0?void 0:Je[V].value()),this.indicatorStatistics[V].total.push(e)}}}}updateSortRules(e){var t,n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||(this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((P,b)=>this.rowsHasValue[b]),this.indicatorsAsCol?void 0:this.indicators,((n=(t=this.totals)===null||t===void 0?void 0:t.row)===null||n===void 0?void 0:n.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,(l=(i=(r=this.totals)===null||r===void 0?void 0:r.row)===null||i===void 0?void 0:i.showGrandTotalsOnTop)!==null&&l!==void 0&&l):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((P,b)=>this.rowsHasValue[b]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((o=(s=this.totals)===null||s===void 0?void 0:s.row)===null||o===void 0?void 0:o.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(u=(a=(d=this.totals)===null||d===void 0?void 0:d.row)===null||a===void 0?void 0:a.showGrandTotalsOnTop)!==null&&u!==void 0&&u,(f=(c=(h=this.totals)===null||h===void 0?void 0:h.row)===null||c===void 0?void 0:c.showSubTotalsOnTop)!==null&&f!==void 0&&f)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((P,b)=>this.columnsHasValue[b]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((T=(C=this.totals)===null||C===void 0?void 0:C.column)===null||T===void 0?void 0:T.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(w=(p=(g=this.totals)===null||g===void 0?void 0:g.column)===null||p===void 0?void 0:p.showGrandTotalsOnLeft)!==null&&w!==void 0&&w,(_=(H=(m=this.totals)===null||m===void 0?void 0:m.column)===null||H===void 0?void 0:H.showSubTotalsOnLeft)!==null&&_!==void 0&&_))}updateFilterRules(e,t=!1){var n,r;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(const i in this.tree)for(const l in this.tree[i])for(let s=0;s<this.tree[i][l].length;s++)(n=this.tree[i][l][s])===null||n===void 0||n.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),!((r=this.dataConfig)===null||r===void 0)&&r.isPivotChart&&this.cacheDeminsionCollectedValues()}getAggregatorRule(e){var t;return(t=this.aggregationRules)===null||t===void 0?void 0:t.find((n,r)=>e===n.indicatorKey)}getAggregator(e=[],t=[],n,r=!0,i){var l,s,o,d,a,u,h,c,f,C,T,g,p,w;const m=this.indicatorKeys.indexOf(n);let H,_;typeof e=="string"?H=e:(i&&i.position!=="row"||e.map((b,y)=>{b!==n||x(i==null?void 0:i.index)&&y!==i.index||e.splice(y,1)}),e.length<this.rows.length&&this.rowHierarchyType==="grid-tree"&&(e[0]===this.rowGrandTotalLabel||!((s=(l=this.totals)===null||l===void 0?void 0:l.row)===null||s===void 0)&&s.subTotalsDimensions&&((a=(d=(o=this.totals)===null||o===void 0?void 0:o.row)===null||d===void 0?void 0:d.subTotalsDimensions)===null||a===void 0?void 0:a.length)>=1&&e[e.length-1]!==this.rowSubTotalLabel&&e.push(this.rowSubTotalLabel)),H=rn(e,this.stringJoinChar)),typeof t=="string"?_=t:(i&&i.position!=="col"||t.map((b,y)=>{b!==n||x(i==null?void 0:i.index)&&y!==i.index||t.splice(y,1)}),t.length<this.columns.length&&this.columnHierarchyType==="grid-tree"&&(t[0]===this.colGrandTotalLabel||!((h=(u=this.totals)===null||u===void 0?void 0:u.column)===null||h===void 0)&&h.subTotalsDimensions&&((C=(f=(c=this.totals)===null||c===void 0?void 0:c.column)===null||f===void 0?void 0:f.subTotalsDimensions)===null||C===void 0?void 0:C.length)>=1&&t[t.length-1]!==this.colSubTotalLabel&&t.push(this.colSubTotalLabel)),_=rn(t,this.stringJoinChar));const P=(g=(T=this.tree[H])===null||T===void 0?void 0:T[_])===null||g===void 0?void 0:g[m];if(r&&x((w=(p=this.changedTree[H])===null||p===void 0?void 0:p[_])===null||w===void 0?void 0:w[m])){const b=this.changedTree[H][_][m];return P?{value:()=>b,formatValue:P.formatValue,formatFun:P.formatFun,records:P.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>b,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>b,clearCacheValue(){},reset(){}}}return P||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));const e=this.arrSort(this.columns,!1);this.colKeys.sort(e)}}arrSort(e,t){let n;const r=this,i=(function(l){const s=[];for(let o=0,d=e.length;o<d;o++)if(n=e[o],r.sortRules)for(let a=0,u=r.sortRules.length;a<u;a++)r.sortRules[a].sortField===n&&s.push({field:n,fieldIndex:o,sortRule:r.sortRules[a],func:r.getSort(r.sortRules[a],t)});return s}).call(this);return function(l,s){var o,d,a,u;let h,c;for(let f=0;f<i.length;f++){if(c=i[f],(o=c.sortRule)===null||o===void 0?void 0:o.sortByIndicator){let C=l,T=s;c.fieldIndex<e.length-1&&(C=l.slice(0,c.fieldIndex+1),r.rowHierarchyType==="grid"&&t?C.push(r.rowSubTotalLabel):t||C.push(r.colSubTotalLabel),T=s.slice(0,c.fieldIndex+1),r.rowHierarchyType==="grid"&&t?T.push(r.rowSubTotalLabel):t||T.push(r.colSubTotalLabel)),h=c.func(C,T,(d=c.sortRule)===null||d===void 0?void 0:d.sortType)}else h=(a=c.func)===null||a===void 0?void 0:a.call(c,l[c.fieldIndex],s[c.fieldIndex],(u=c.sortRule)===null||u===void 0?void 0:u.sortType);if(h!==0)return h}return 0}}getSort(e,t){const n=this;return e.sortByIndicator?(r,i,l)=>{const s=function(o,d){return n.rowHierarchyType==="grid"&&o.length<n.rows.length&&o[o.length-1]!==n.rowSubTotalLabel&&o[o.length-1]!==n.rowGrandTotalLabel&&o.push(n.rowSubTotalLabel),d.length<n.columns.length&&d[d.length-1]!==n.colSubTotalLabel&&d[d.length-1]!==n.colGrandTotalLabel&&d.push(n.colSubTotalLabel),n.getAggregator(o,d,e.sortByIndicator).value()};return t?e.sortFunc?e.sortFunc(s(r,e.query),s(i,e.query),r,i,l):wt(s(r,e.query),s(i,e.query),l):e.sortFunc?e.sortFunc(s(e.query,r),s(e.query,i),r,i,l):wt(s(e.query,r),s(e.query,i),l)}:e.sortBy?Ci(e.sortBy):e.sortFunc?e.sortFunc:e.sortType?pi:wt}totalStatistics(){var e,t,n,r,i,l,s,o,d,a,u,h,c,f;const C=this,T=(g,p)=>{var w,m,H,_,P,b,y,R,v,S,A,F,N,K,O,L,E,$,J,de,ae,ue,he,ce,pe,ve,be,Pe,Se,Ie,Re,De,te,se,q,X,ne,fe,ye,le,me,Fe,je,We,Ue,qe,Ge,Qe,$e,Je;if(!((m=(w=this.totalRecordsTree)===null||w===void 0?void 0:w[g])===null||m===void 0)&&m[p])return this.tree[g]||(this.tree[g]={}),void(this.tree[g][p]=(_=(H=this.totalRecordsTree)===null||H===void 0?void 0:H[g])===null||_===void 0?void 0:_[p]);const Xe=p.split(this.stringJoinChar);if(!((b=(P=C.totals)===null||P===void 0?void 0:P.column)===null||b===void 0)&&b.subTotalsDimensions&&((v=(R=(y=C.totals)===null||y===void 0?void 0:y.column)===null||R===void 0?void 0:R.subTotalsDimensions)===null||v===void 0?void 0:v.length)>0&&C.totals.column.showSubTotals!==!1)for(let oe=0,_e=(F=(A=(S=C.totals)===null||S===void 0?void 0:S.column)===null||A===void 0?void 0:A.subTotalsDimensions)===null||F===void 0?void 0:F.length;oe<_e;oe++){const D=C.totals.column.subTotalsDimensions[oe],k=C.columns.indexOf(D);if(k>=0){const Q=Xe.slice(0,k+1);Q.push(C.colSubTotalLabel);const G=Q.join(this.stringJoinChar);if(!((K=(N=this.totalRecordsTree)===null||N===void 0?void 0:N[g])===null||K===void 0)&&K[G])return void(this.tree[g][G]=(L=(O=this.totalRecordsTree)===null||O===void 0?void 0:O[g])===null||L===void 0?void 0:L[G]);this.tree[g][G]||(this.tree[g][G]=[]);const ie=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let z=0;z<ie.length;z++)if(this.calculatedFiledKeys.indexOf(ie[z])>=0){const U=(E=this.calculatedFieldRules)===null||E===void 0?void 0:E.find(re=>re.key===ie[z]);!((J=($=this.tree[g])===null||$===void 0?void 0:$[G])===null||J===void 0)&&J[z]||(this.tree[g][G][z]=new Te[ee.RECALCULATE]({key:ie[z],field:ie[z],isRecord:!0,formatFun:(ae=(de=this.indicators)===null||de===void 0?void 0:de.find(re=>typeof re!="string"&&re.indicatorKey===ie[z]))===null||ae===void 0?void 0:ae.format,calculateFun:U==null?void 0:U.calculateFun,dependAggregators:this.tree[g][G],dependIndicatorKeys:U==null?void 0:U.dependIndicatorKeys})),G!==p&&this.tree[g][G][z].push((he=(ue=C.tree[g])===null||ue===void 0?void 0:ue[p])===null||he===void 0?void 0:he[z])}else{if(!this.tree[g][G][z]){const U=this.getAggregatorRule(ie[z]);this.tree[g][G][z]=new Te[(ce=U==null?void 0:U.aggregationType)!==null&&ce!==void 0?ce:ee.SUM]({key:ie[z],field:(pe=U==null?void 0:U.field)!==null&&pe!==void 0?pe:ie[z],aggregationFun:U==null?void 0:U.aggregationFun,formatFun:(ve=U==null?void 0:U.formatFun)!==null&&ve!==void 0?ve:(Pe=(be=this.indicators)===null||be===void 0?void 0:be.find(re=>typeof re!="string"&&re.indicatorKey===ie[z]))===null||Pe===void 0?void 0:Pe.format})}G!==p&&this.tree[g][G][z].push((Ie=(Se=C.tree[g])===null||Se===void 0?void 0:Se[p])===null||Ie===void 0?void 0:Ie[z])}}}if(!((De=(Re=C.totals)===null||Re===void 0?void 0:Re.column)===null||De===void 0)&&De.showGrandTotals||this.rows.length===0){const oe=C.colGrandTotalLabel;if(!((se=(te=this.totalRecordsTree)===null||te===void 0?void 0:te[g])===null||se===void 0)&&se[oe])return void(this.tree[g][oe]=(X=(q=this.totalRecordsTree)===null||q===void 0?void 0:q[g])===null||X===void 0?void 0:X[oe]);this.tree[g][oe]||(this.tree[g][oe]=[]);const _e=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let D=0;D<_e.length;D++)if(this.calculatedFiledKeys.indexOf(_e[D])>=0){const k=(ne=this.calculatedFieldRules)===null||ne===void 0?void 0:ne.find(Q=>Q.key===_e[D]);!((ye=(fe=this.tree[g])===null||fe===void 0?void 0:fe[oe])===null||ye===void 0)&&ye[D]||(this.tree[g][oe][D]=new Te[ee.RECALCULATE]({key:_e[D],field:_e[D],isRecord:!0,formatFun:(me=(le=this.indicators)===null||le===void 0?void 0:le.find(Q=>typeof Q!="string"&&Q.indicatorKey===_e[D]))===null||me===void 0?void 0:me.format,calculateFun:k==null?void 0:k.calculateFun,dependAggregators:this.tree[g][oe],dependIndicatorKeys:k==null?void 0:k.dependIndicatorKeys})),oe!==p&&this.tree[g][oe][D].push((je=(Fe=C.tree[g])===null||Fe===void 0?void 0:Fe[p])===null||je===void 0?void 0:je[D])}else{if(!this.tree[g][oe][D]){const k=this.getAggregatorRule(_e[D]);this.tree[g][oe][D]=new Te[(We=k==null?void 0:k.aggregationType)!==null&&We!==void 0?We:ee.SUM]({key:_e[D],field:(Ue=k==null?void 0:k.field)!==null&&Ue!==void 0?Ue:_e[D],formatFun:(qe=k==null?void 0:k.formatFun)!==null&&qe!==void 0?qe:(Qe=(Ge=this.indicators)===null||Ge===void 0?void 0:Ge.find(Q=>typeof Q!="string"&&Q.indicatorKey===_e[D]))===null||Qe===void 0?void 0:Qe.format})}oe!==p&&this.tree[g][oe][D].push((Je=($e=C.tree[g])===null||$e===void 0?void 0:$e[p])===null||Je===void 0?void 0:Je[D])}}};if(!((t=(e=C==null?void 0:C.totals)===null||e===void 0?void 0:e.column)===null||t===void 0)&&t.subTotalsDimensions&&((i=(r=(n=C==null?void 0:C.totals)===null||n===void 0?void 0:n.column)===null||r===void 0?void 0:r.subTotalsDimensions)===null||i===void 0?void 0:i.length)>=1||!((s=(l=C==null?void 0:C.totals)===null||l===void 0?void 0:l.row)===null||s===void 0)&&s.subTotalsDimensions&&((a=(d=(o=C==null?void 0:C.totals)===null||o===void 0?void 0:o.row)===null||d===void 0?void 0:d.subTotalsDimensions)===null||a===void 0?void 0:a.length)>=1||!((h=(u=C==null?void 0:C.totals)===null||u===void 0?void 0:u.column)===null||h===void 0)&&h.showGrandTotals||!((f=(c=C==null?void 0:C.totals)===null||c===void 0?void 0:c.row)===null||f===void 0)&&f.showGrandTotals){const g=[];Object.keys(C.tree).forEach(p=>{const w=p.split(this.stringJoinChar);Object.keys(C.tree[p]).forEach(m=>{var H,_,P,b,y,R,v,S,A,F,N,K,O,L,E,$,J,de,ae,ue,he,ce,pe,ve,be,Pe,Se,Ie,Re,De;if(!((_=(H=C.totals)===null||H===void 0?void 0:H.row)===null||_===void 0)&&_.subTotalsDimensions&&((y=(b=(P=C.totals)===null||P===void 0?void 0:P.row)===null||b===void 0?void 0:b.subTotalsDimensions)===null||y===void 0?void 0:y.length)>0&&C.totals.row.showSubTotals!==!1)for(let te=0,se=(S=(v=(R=C.totals)===null||R===void 0?void 0:R.row)===null||v===void 0?void 0:v.subTotalsDimensions)===null||S===void 0?void 0:S.length;te<se;te++){const q=C.totals.row.subTotalsDimensions[te],X=C.rows.indexOf(q);if(X>=0&&X<C.rows.length-1){const ne=w.slice(0,X+1);this.rowHierarchyType!=="tree"&&ne.push(C.rowSubTotalLabel);const fe=ne.join(this.stringJoinChar);this.tree[fe]||(this.tree[fe]={},g.push(fe)),this.tree[fe][m]||(this.tree[fe][m]=[]);const ye=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let le=0;le<ye.length;le++){if(!this.tree[fe][m][le])if(this.calculatedFiledKeys.indexOf(ye[le])>=0){const me=(A=this.calculatedFieldRules)===null||A===void 0?void 0:A.find(Fe=>Fe.key===ye[le]);this.tree[fe][m][le]=new Te[ee.RECALCULATE]({key:ye[le],field:ye[le],isRecord:!0,formatFun:(N=(F=this.indicators)===null||F===void 0?void 0:F.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===ye[le]))===null||N===void 0?void 0:N.format,calculateFun:me==null?void 0:me.calculateFun,dependAggregators:this.tree[fe][m],dependIndicatorKeys:me==null?void 0:me.dependIndicatorKeys})}else{const me=this.getAggregatorRule(ye[le]);this.tree[fe][m][le]=new Te[(K=me==null?void 0:me.aggregationType)!==null&&K!==void 0?K:ee.SUM]({key:ye[le],field:(O=me==null?void 0:me.field)!==null&&O!==void 0?O:ye[le],formatFun:(L=me==null?void 0:me.formatFun)!==null&&L!==void 0?L:($=(E=this.indicators)===null||E===void 0?void 0:E.find(Fe=>typeof Fe!="string"&&Fe.indicatorKey===ye[le]))===null||$===void 0?void 0:$.format})}fe!==p&&this.tree[fe][m][le].push((de=(J=C.tree[p])===null||J===void 0?void 0:J[m])===null||de===void 0?void 0:de[le])}}}if(!((ue=(ae=C.totals)===null||ae===void 0?void 0:ae.row)===null||ue===void 0)&&ue.showGrandTotals||this.columns.length===0){const te=C.rowGrandTotalLabel;this.tree[te]||(this.tree[te]={},g.push(te)),this.tree[te][m]||(this.tree[te][m]=[]);const se=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let q=0;q<se.length;q++){if(!this.tree[te][m][q])if(this.calculatedFiledKeys.indexOf(se[q])>=0){const X=(he=this.calculatedFieldRules)===null||he===void 0?void 0:he.find(ne=>ne.key===se[q]);this.tree[te][m][q]=new Te[ee.RECALCULATE]({key:se[q],field:se[q],isRecord:!0,formatFun:(pe=(ce=this.indicators)===null||ce===void 0?void 0:ce.find(ne=>typeof ne!="string"&&ne.indicatorKey===se[q]))===null||pe===void 0?void 0:pe.format,calculateFun:X==null?void 0:X.calculateFun,dependAggregators:this.tree[te][m],dependIndicatorKeys:X==null?void 0:X.dependIndicatorKeys})}else{const X=this.getAggregatorRule(se[q]);this.tree[te][m][q]=new Te[(ve=X==null?void 0:X.aggregationType)!==null&&ve!==void 0?ve:ee.SUM]({key:se[q],field:(be=X==null?void 0:X.field)!==null&&be!==void 0?be:se[q],formatFun:(Pe=X==null?void 0:X.formatFun)!==null&&Pe!==void 0?Pe:(Ie=(Se=this.indicators)===null||Se===void 0?void 0:Se.find(ne=>typeof ne!="string"&&ne.indicatorKey===se[q]))===null||Ie===void 0?void 0:Ie.format})}te!==p&&this.tree[te][m][q].push((De=(Re=C.tree[p])===null||Re===void 0?void 0:Re[m])===null||De===void 0?void 0:De[q])}}T(p,m)})}),g.forEach(p=>{Object.keys(C.tree[p]).forEach(w=>{T(p,w)})})}for(const g in C.totalRecordsTree)for(const p in C.totalRecordsTree[g])T(g,p)}ArrToTree1(e,t,n,r,i,l){const s=[],o=this.stringJoinChar,d=new Map;function a(u,h){const c=[];let f;u.forEach((C,T)=>{var g;c.push(C);const p=c.join(o);let w=d.get(p);w||(w={value:C,dimensionKey:t[T],children:T===u.length-1&&((g=n==null?void 0:n.length)!==null&&g!==void 0?g:0)>=1?n==null?void 0:n.map(m=>typeof m=="string"?{indicatorKey:m,value:m}:{indicatorKey:m.indicatorKey,value:m.title}):[]},d.set(p,w),f?f.children.push(w):l&&h?s.unshift(w):s.push(w)),f=w})}return e.forEach(u=>a(u,!1)),r&&a([i],r),s}ArrToTree(e,t,n,r,i,l,s,o,d){var a;let u=[];const h=this.stringJoinChar,c=new Map;if(e!=null&&e.length?e.forEach(f=>function(C){const T=[];let g;C.forEach((p,w)=>{var m,H,_,P;T.push(p);const b=T.join(h);let y=c.get(b);if(!y){if(y={value:p,dimensionKey:t[w],children:w===C.length-1&&((m=n==null?void 0:n.length)!==null&&m!==void 0?m:0)>=1?n==null?void 0:n.map(R=>typeof R=="string"?{indicatorKey:R,value:R}:{indicatorKey:R.indicatorKey,value:R.title}):[]},r[w]){let R=(H=y.children)!==null&&H!==void 0?H:[];const v={value:s,dimensionKey:t[w+1],levelSpan:r.length-w-1,children:((_=n==null?void 0:n.length)!==null&&_!==void 0?_:0)>=1?n==null?void 0:n.map(S=>typeof S=="string"?{indicatorKey:S,value:S}:{indicatorKey:S.indicatorKey,value:S.title}):[]};R.push(v),R=(P=v.children)!==null&&P!==void 0?P:[]}c.set(b,y),g?r[w-1]&&!d?g.children.splice(g.children.length-1,0,y):g.children.push(y):u.push(y)}g=y})}(f)):n&&(u=n==null?void 0:n.map(f=>{var C;return typeof f=="string"?{indicatorKey:f,value:f}:{indicatorKey:f.indicatorKey,value:(C=f.title)!==null&&C!==void 0?C:f.indicatorKey}})),i&&(e==null?void 0:e.length)){const f={value:l,dimensionKey:t[0],levelSpan:r.length,children:(a=n==null?void 0:n.map(C=>typeof C=="string"?{indicatorKey:C,value:C}:{indicatorKey:C.indicatorKey,value:C.title}))!==null&&a!==void 0?a:[]};o?u.unshift(f):u.push(f)}return u}cacheDeminsionCollectedValues(){for(const e in this.collectValuesBy)this.collectValuesBy[e].type!=="xField"&&this.collectValuesBy[e].type!=="yField"||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=Bi(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],n,r){var i,l,s;const o=this.indicatorKeys.indexOf(n);let d,a;d=typeof e=="string"?e:e.join(this.stringJoinChar),a=typeof t=="string"?t:t.join(this.stringJoinChar),!((i=this.changedTree[d])===null||i===void 0)&&i[a]?this.changedTree[d][a][o]=r:this.changedTree[d]?(this.changedTree[d][a]=[],this.changedTree[d][a][o]=r):(this.changedTree[d]={},this.changedTree[d][a]=[],this.changedTree[d][a][o]=r);const u=(s=(l=this.tree[d])===null||l===void 0?void 0:l[a])===null||s===void 0?void 0:s[o];(u==null?void 0:u.records.length)===1&&(u.records[0][this.indicatorKeys[o]]=r)}changeRecordFieldValue(e,t,n){let r=!1;for(let i=0;i<this.indicatorKeys.length;i++)this.indicatorKeys[i]===e&&(r=!0);if(!r){if(Array.isArray(this.records))for(let i=0,l=this.records.length;i<l;i++){const s=this.records[i];s[e]===t&&(s[e]=n)}else for(const i in this.records)for(let l=0,s=this.records[i].length;l<s;l++){const o=this.records[i][l];o[e]===t&&(o[e]=n)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let t=0,n=e.length;t<n;t++){const r=e[t];this.processRecord(r)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,t){const n=[],r=this;function i(l,s){var o,d,a;l.virtual||(!((o=s[s.length-1])===null||o===void 0)&&o.childKeys&&l.dimensionKey&&s[s.length-1].childKeys.indexOf(l.dimensionKey)===-1&&l.dimensionKey!==s[s.length-1].dimensionKey&&s[s.length-1].childKeys.push(l.dimensionKey),s.push({dimensionKey:x(l.indicatorKey)?void 0:l.dimensionKey,value:l.value,indicatorKey:l.indicatorKey,virtual:l.virtual})),((d=l.children)===null||d===void 0?void 0:d.length)>0?(r.rowHierarchyType==="tree"&&t==="row"&&(s[s.length-1].childKeys=[],n.push([...s])),(a=l.children)===null||a===void 0||a.forEach(u=>i(u,[...s]))):n.push(s)}return e==null||e.forEach(l=>i(l,[])),n}getFieldMatchColDimensionPaths(e){var t,n;const r=[];for(let i=0;(n=i<((t=this.customColTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&n!==void 0&&n;i++){const l=this.customColTreeDimensionPaths[i];let s=!0;for(let o=0;o<l.length;o++){const d=l[o];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}}s&&r.push(l)}return r}getFieldMatchRowDimensionPaths(e){var t,n;const r=[];for(let i=0;(n=i<((t=this.customRowTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&n!==void 0&&n;i++){const l=this.customRowTreeDimensionPaths[i];let s=!0;for(let o=0;o<l.length;o++){const d=l[o];if(d.dimensionKey&&e[d.dimensionKey]!==d.value||d.indicatorKey&&e[d.indicatorKey]===void 0){s=!1;break}if(d.childKeys&&o===l.length-1&&d.childKeys.length>0&&d.childKeys.find(a=>x(e[a]))){s=!1;break}}s&&(this.indicatorsAsCol||this.rowHierarchyType!=="tree"||l.find(o=>o.indicatorKey)||(s=!1)),s&&r.push(l)}return r}}function Bi(I,e){return I.sort((t,n)=>{const r=e.indexOf(t),i=e.indexOf(n);return r<i?-1:r>i?1:0})}class Ni extends fn{constructor(e,t){var n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P,b,y,R;if(St.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},t){t.rowHierarchyType||(t.rowHierarchyType="grid"),t.columnHierarchyType||(t.columnHierarchyType="grid"),t.layout&&Object.assign(t,t.layout),this.internalProps.columns=Ce(t.columns),this.internalProps.rows=Ce(t.rows),this.internalProps.indicators=ct(t.indicators),(n=t.indicators)===null||n===void 0||n.forEach((S,A)=>{typeof S=="object"&&(S!=null&&S.editor)&&(this.internalProps.indicators[A].editor=S.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||!((r=t.columns)===null||r===void 0)&&r.length||t.columnTree?Ce(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((i=t.rows)===null||i===void 0)&&i.length||t.rowTree?Ce(t.rowTree):[],this.internalProps.records=t.records,this.pagination=t.pagination,this.internalProps.columnResizeType=(o=(s=(l=t.resize)===null||l===void 0?void 0:l.columnResizeType)!==null&&s!==void 0?s:t.columnResizeType)!==null&&o!==void 0?o:"column",this.internalProps.rowResizeType=(u=(a=(d=t.resize)===null||d===void 0?void 0:d.rowResizeType)!==null&&a!==void 0?a:t.rowResizeType)!==null&&u!==void 0?u:"row",this.internalProps.dataConfig=Ce(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader;const v=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((h=v==null?void 0:v[0])===null||h===void 0?void 0:h.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((c=t.customConfig)===null||c===void 0?void 0:c.enableDataAnalysis)===!1){const S=new ge((f=this.internalProps.columnTree)!==null&&f!==void 0?f:[],this.layoutNodeId,this.options.columnHierarchyType,this.options.columnHierarchyType!=="grid"?(C=this.options.columnExpandLevel)!==null&&C!==void 0?C:1:void 0),A=new ge((T=this.internalProps.rowTree)!==null&&T!==void 0?T:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType!=="grid"?(g=this.options.rowExpandLevel)!==null&&g!==void 0?g:1:void 0);this.internalProps.layoutMap=new Ve(this,null,S,A),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new vt({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},v))}else{const S=Gt(this,t),{rowKeys:A,columnKeys:F,indicatorKeys:N}=S;let{columnDimensionTree:K,rowDimensionTree:O}=S;this.dataset=new gt(this.internalProps.dataConfig,A,F,N,this.internalProps.indicators,(p=t.indicatorsAsCol)===null||p===void 0||p,t.records,t.rowHierarchyType,t.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree?K.hasHideNode&&(Oe(K.tree.children,t.indicators,!0,this),K.reset(K.tree.children)):(t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Me(this.dataset.colHeaderTree,t.indicators)),t.indicatorsAsCol!==!1&&t.indicators&&this.dataset.colHeaderTree&&Oe(this.dataset.colHeaderTree,t.indicators,!1,this),K=new ge((w=this.dataset.colHeaderTree)!==null&&w!==void 0?w:[],this.layoutNodeId,this.options.columnHierarchyType,this.options.columnHierarchyType!=="grid"?(m=this.options.columnExpandLevel)!==null&&m!==void 0?m:1:void 0)),t.rowTree?O.hasHideNode&&(Oe(O.tree.children,t.indicators,!0,this),O.reset(O.tree.children)):(t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Me(this.dataset.rowHeaderTree,t.indicators)),t.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&t.indicators&&Oe(this.dataset.rowHeaderTree,t.indicators,!1,this),O=new ge((H=this.dataset.rowHeaderTree)!==null&&H!==void 0?H:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType!=="grid"?(_=this.options.rowExpandLevel)!==null&&_!==void 0?_:1:void 0)),this.internalProps.layoutMap=new Ve(this,this.dataset,K,O)}if(this._changePivotSortStateBySortRules(),((b=(P=t.pivotSortState)===null||P===void 0?void 0:P.length)!==null&&b!==void 0?b:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),St.mode!=="node"&&(this.editorManager=new mi(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(v),this.scenegraph.createSceneGraph(),t.title){const S=Ne.getComponent("title");this.internalProps.title=new S(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(y=this.internalProps.emptyTip)===null||y===void 0||y.resetVisible();else{const S=Ne.getComponent("emptyTip");this.internalProps.emptyTip=new S(this.options.emptyTip,this),(R=this.internalProps.emptyTip)===null||R===void 0||R.resetVisible()}setTimeout(()=>{this.fireListeners(ht.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return Ht}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}_canResizeColumn(e,t){const n=super._canResizeColumn(e,t);if(n){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){const r=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(r!=null&&r.disableColumnResize)return!1}}return n}updateOption(e){var t,n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P,b,y,R,v;const S=this.internalProps;if(super.updateOption(e),e.rowHierarchyType||(e.rowHierarchyType="grid"),e.columnHierarchyType||(e.columnHierarchyType="grid"),this.layoutNodeId={seqId:0},this.internalProps.columns=Ce(e.columns),this.internalProps.rows=Ce(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?ct(e.indicators):[],(n=e.indicators)===null||n===void 0||n.forEach((F,N)=>{typeof F=="object"&&(F!=null&&F.editor)&&(this.internalProps.indicators[N].editor=F.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||!((r=e.columns)===null||r===void 0)&&r.length||e.columnTree?Ce(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((i=e.rows)===null||i===void 0)&&i.length||e.rowTree?Ce(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=e.pagination,S.columnResizeType=(o=(s=(l=e.resize)===null||l===void 0?void 0:l.columnResizeType)!==null&&s!==void 0?s:e.columnResizeType)!==null&&o!==void 0?o:"column",S.rowResizeType=(u=(a=(d=e.resize)===null||d===void 0?void 0:d.rowResizeType)!==null&&a!==void 0?a:e.rowResizeType)!==null&&u!==void 0?u:"row",S.dataConfig=Ce(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader,(e==null?void 0:e.rowHierarchyType)!=="grid"&&this.internalProps.layoutMap.rowHierarchyType!=="grid"&&this.internalProps.layoutMap.rowExpandLevel===(e==null?void 0:e.rowExpandLevel)){const F=this.internalProps.layoutMap.rowDimensionTree.tree.children;(h=this.internalProps.rowTree)===null||h===void 0||h.forEach((N,K)=>{const O=F.find(L=>L.dimensionKey===N.dimensionKey&&L.value===N.value);O&&this._syncHierarchyState(O,N)})}const A=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((c=A==null?void 0:A[0])===null||c===void 0?void 0:c.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((f=e.customConfig)===null||f===void 0?void 0:f.enableDataAnalysis)===!1){let F,N;e.columnTree&&(F=new ge((C=this.internalProps.columnTree)!==null&&C!==void 0?C:[],this.layoutNodeId,this.options.columnHierarchyType,this.options.columnHierarchyType!=="grid"?(T=this.options.columnExpandLevel)!==null&&T!==void 0?T:1:void 0)),e.rowTree&&(N=new ge((g=this.internalProps.rowTree)!==null&&g!==void 0?g:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType!=="grid"?(p=this.options.rowExpandLevel)!==null&&p!==void 0?p:1:void 0)),S.layoutMap=new Ve(this,null,F,N),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new vt({rows:S.layoutMap.fullRowDimensionKeys,columns:S.layoutMap.colDimensionKeys,indicators:S.layoutMap.indicatorKeys,indicatorsAsCol:S.layoutMap.indicatorsAsCol,indicatorDimensionKey:S.layoutMap.indicatorDimensionKey},A))}else{const F=Gt(this,e),{rowKeys:N,columnKeys:K,indicatorKeys:O}=F;let{columnDimensionTree:L,rowDimensionTree:E}=F;this.dataset=new gt(S.dataConfig,N,K,O,this.internalProps.indicators,(w=e.indicatorsAsCol)===null||w===void 0||w,A,e.rowHierarchyType,e.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree?L.hasHideNode&&(Oe(L.tree.children,e.indicators,!0,this),L.reset(L.tree.children)):(e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Me(this.dataset.colHeaderTree,e.indicators)),e.indicatorsAsCol!==!1&&e.indicators&&this.dataset.colHeaderTree&&Oe(this.dataset.colHeaderTree,e.indicators,!1,this),L=new ge((m=this.dataset.colHeaderTree)!==null&&m!==void 0?m:[],this.layoutNodeId,this.options.columnHierarchyType,this.options.columnHierarchyType!=="grid"?(H=this.options.columnExpandLevel)!==null&&H!==void 0?H:1:void 0)),e.rowTree?E.hasHideNode&&(Oe(E.tree.children,e.indicators,!0,this),E.reset(E.tree.children)):(e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Me(this.dataset.rowHeaderTree,e.indicators)),e.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&e.indicators&&Oe(this.dataset.rowHeaderTree,e.indicators,!1,this),E=new ge((_=this.dataset.rowHeaderTree)!==null&&_!==void 0?_:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType!=="grid"?(P=this.options.rowExpandLevel)!==null&&P!==void 0?P:1:void 0)),S.layoutMap=new Ve(this,this.dataset,L,E)}if(this._changePivotSortStateBySortRules(),((y=(b=e.pivotSortState)===null||b===void 0?void 0:b.length)!==null&&y!==void 0?y:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,S.releaseList&&(S.releaseList.forEach(F=>{var N;return(N=F==null?void 0:F.release)===null||N===void 0?void 0:N.call(F)}),S.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const F=Ne.getComponent("title");this.internalProps.title=new F(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(R=this.internalProps.emptyTip)===null||R===void 0||R.resetVisible();else{const F=Ne.getComponent("emptyTip");this.internalProps.emptyTip=new F(this.options.emptyTip,this),(v=this.internalProps.emptyTip)===null||v===void 0||v.resetVisible()}return new Promise(F=>{setTimeout(F,0)})}updatePagination(e){e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),typeof e.currentPage=="number"&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,n,r,i,l,s,o;const d=this,{layoutMap:a}=d.internalProps;a&&(d.colCount=(e=a.colCount)!==null&&e!==void 0?e:0,d.rowCount=(t=a.rowCount)!==null&&t!==void 0?t:0,this.internalProps.frozenColCount=this.options.frozenColCount?this.options.frozenColCount:((n=a.rowHeaderLevelCount)!==null&&n!==void 0?n:0)+a.leftRowSeriesNumberColumnCount,d.frozenRowCount=Math.max(a.headerLevelCount,(r=this.options.frozenRowCount)!==null&&r!==void 0?r:0),d.bottomFrozenRowCount!==((i=this.options.bottomFrozenRowCount)!==null&&i!==void 0?i:0)&&(d.bottomFrozenRowCount=(l=this.options.bottomFrozenRowCount)!==null&&l!==void 0?l:0),d.rightFrozenColCount!==((s=this.options.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(d.rightFrozenColCount=(o=this.options.rightFrozenColCount)!==null&&o!==void 0?o:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount),this.stateManager.setFrozenRow(this.frozenRowCount))}_getSortFuncFromHeaderOption(e,t,n){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}get columnHierarchyType(){return this.internalProps.layoutMap.columnHierarchyType}_syncHierarchyState(e,t){var n,r;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(n=t.hierarchyState)!==null&&n!==void 0?n:t!=null&&t.children?e.hierarchyState:void 0,(r=t==null?void 0:t.children)===null||r===void 0||r.forEach((i,l)=>{var s;if(!((s=e==null?void 0:e.children)===null||s===void 0)&&s[l]&&i){const o=e.children.find(d=>d.dimensionKey===i.dimensionKey&&d.value===i.value);o&&this._syncHierarchyState(o,i)}}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getFieldData(e,t,n){var r,i,l;if(!this.internalProps.layoutMap.isHeader(t,n)){if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(n),o=this.getBodyIndexByCol(t);return(r=this.records[s])===null||r===void 0?void 0:r[o]}if(this.dataset){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,n);if(s){let o;const d=(i=s.colHeaderPaths)===null||i===void 0?void 0:i.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(o={position:"col",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),a=(l=s.rowHeaderPaths)===null||l===void 0?void 0:l.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(o={position:"row",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(t,n),!0,o);if(u.records&&u.records.length>=1)return u.records[0][e]}}else if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,n),o=s.colHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),d=s.rowHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),a=this.flatDataToObjects.getTreeNode(d,o,this.internalProps.layoutMap.getBody(t,n).indicatorKey,!1);if(a!=null&&a.record)return a==null?void 0:a.record[e]}}}getCellValue(e,t,n){var r,i,l,s,o,d,a;if(!n){const u=this.getCustomMergeValue(e,t);if(u)return u}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){const{title:h}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return h}const{format:u}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return typeof u=="function"?u(e,t,this):t-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(e,t)){const{title:u,fieldFormat:h}=this.internalProps.layoutMap.getHeader(e,t);return typeof h=="function"?h(u,e,t,this):u}if(this.internalProps.recordsIsTwoDimensionalArray){const{fieldFormat:u}=this.internalProps.layoutMap.getBody(e,t),h=this.getBodyIndexByRow(t),c=this.getBodyIndexByCol(e),f=(r=this.records[h])===null||r===void 0?void 0:r[c];return typeof u=="function"?u(f,e,t,this):f}if(this.dataset){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);let h;const c=(l=(i=u.colHeaderPaths)===null||i===void 0?void 0:i.filter(g=>!g.virtual))===null||l===void 0?void 0:l.map((g,p)=>{var w;return g.indicatorKey&&(h={position:"col",index:p}),(w=g.indicatorKey)!==null&&w!==void 0?w:g.value}),f=(o=(s=u.rowHeaderPaths)===null||s===void 0?void 0:s.filter(g=>!g.virtual))===null||o===void 0?void 0:o.map((g,p)=>{var w;return g.indicatorKey&&(h={position:"row",index:p}),(w=g.indicatorKey)!==null&&w!==void 0?w:g.value}),C=this.dataset.getAggregator(f,c,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,h),{fieldFormat:T}=this.internalProps.layoutMap.getBody(e,t);return C.formatValue?C.formatValue(e,t,this):typeof T=="function"?T(C==null?void 0:C.value(),e,t,this):(d=C==null?void 0:C.value())!==null&&d!==void 0?d:""}if(this.flatDataToObjects){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t),h=u.colHeaderPaths.map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value}),c=u.rowHeaderPaths.map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value}),f=this.flatDataToObjects.getTreeNode(c,h,this.internalProps.layoutMap.getBody(e,t).indicatorKey),{fieldFormat:C}=this.internalProps.layoutMap.getBody(e,t);return typeof C=="function"?C(f==null?void 0:f.value,e,t,this):(a=f==null?void 0:f.value)!==null&&a!==void 0?a:""}}getCellOriginValue(e,t){var n,r,i;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){const{title:s}=l.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(n=this.records[s])===null||n===void 0?void 0:n[o]}if(this.dataset){let s;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(r=o.colHeaderPaths)===null||r===void 0?void 0:r.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(s={position:"col",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),a=(i=o.rowHeaderPaths)===null||i===void 0?void 0:i.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(s={position:"row",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,s);return u.value?u.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=s.colHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),d=s.rowHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),a=this.flatDataToObjects.getTreeNode(d,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return a==null?void 0:a.value}}getCellRawValue(e,t){var n,r,i;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){const{title:s}=l.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(n=this.records[s])===null||n===void 0?void 0:n[o]}if(this.dataset){let s;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),d=(r=o.colHeaderPaths)===null||r===void 0?void 0:r.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(s={position:"col",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),a=(i=o.rowHeaderPaths)===null||i===void 0?void 0:i.filter(h=>!h.virtual).map((h,c)=>{var f;return h.indicatorKey&&(s={position:"row",index:c}),(f=h.indicatorKey)!==null&&f!==void 0?f:h.value}),u=this.dataset.getAggregator(a,d,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,s);return u.value?u.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=s.colHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),d=s.rowHeaderPaths.map(u=>{var h;return(h=u.indicatorKey)!==null&&h!==void 0?h:u.value}),a=this.flatDataToObjects.getTreeNode(d,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return a==null?void 0:a.value}}getCellOriginRecord(e,t){var n,r,i;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(n=this.records[l])===null||n===void 0?void 0:n[s]}if(this.dataset){let l;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=(r=s.colHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,u)=>{var h;return a.indicatorKey&&(l={position:"col",index:u}),(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),d=(i=s.rowHeaderPaths)===null||i===void 0?void 0:i.filter(a=>!a.virtual).map((a,u)=>{var h;return a.indicatorKey&&(l={position:"row",index:u}),(h=a.indicatorKey)!==null&&h!==void 0?h:a.value});return this.dataset.getAggregator(d,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,l).records}if(this.flatDataToObjects){const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=l.colHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),o=l.rowHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),d=this.flatDataToObjects.getTreeNode(o,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return d==null?void 0:d.record}}}getCellRawRecord(e,t){var n,r,i;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(n=this.records[l])===null||n===void 0?void 0:n[s]}if(this.dataset){let l;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=(r=s.colHeaderPaths)===null||r===void 0?void 0:r.filter(a=>!a.virtual).map((a,u)=>{var h;return a.indicatorKey&&(l={position:"col",index:u}),(h=a.indicatorKey)!==null&&h!==void 0?h:a.value}),d=(i=s.rowHeaderPaths)===null||i===void 0?void 0:i.filter(a=>!a.virtual).map((a,u)=>{var h;return a.indicatorKey&&(l={position:"row",index:u}),(h=a.indicatorKey)!==null&&h!==void 0?h:a.value});return this.dataset.getAggregator(d,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,l).records}if(this.flatDataToObjects){const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=l.colHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),o=l.rowHeaderPaths.map(a=>{var u;return(u=a.indicatorKey)!==null&&u!==void 0?u:a.value}),d=this.flatDataToObjects.getTreeNode(o,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return d==null?void 0:d.record}}}updateSortRules(e,t,n){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();const{layoutMap:r}=this.internalProps;r.resetHeaderTree(),this.scenegraph.clearCells(),ft(t)&&ft(n)?(this.isRowHeader(t,n)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,n)?r.cornerSetting.titleOnDimension==="column"?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):r.cornerSetting.titleOnDimension==="row"&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,n)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var e,t,n,r;this.pivotSortState=[];const i=(t=(e=this.internalProps.dataConfig)===null||e===void 0?void 0:e.sortRules)!==null&&t!==void 0?t:[];for(let l=0;l<i.length;l++){const s=i[l],o=[];if(s.sortByIndicator&&s.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let a=0;a<s.query.length;a++)o.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[a]:this.dataset.rows[a],value:s.query[a]});o.push({indicatorKey:s.sortByIndicator,value:(r=(n=this.internalProps.layoutMap.getIndicatorInfo(s.sortByIndicator))===null||n===void 0?void 0:n.title)!==null&&r!==void 0?r:s.sortByIndicator})}else o.push({dimensionKey:s.sortField,isPivotCorner:!0,value:s.sortField});const d=s.sortType?s.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:o,order:nt[d]})}}_parseColumnWidthConfig(e){for(let t=0;t<(e==null?void 0:e.length);t++){const n=e[t],r=n.dimensions,i=n.width,l=this.getCellAddressByHeaderPaths(r);if(l&&l.col>=this.rowHeaderLevelCount){const s=this.getCellHeaderPaths(l.col,this.columnHeaderLevelCount);if(s.colHeaderPaths.length===r.length){let o=!0;for(let d=0;d<r.length;d++){const a=r[d];if(s.colHeaderPaths.findIndex((u,h)=>u.indicatorKey===a.indicatorKey||u.dimensionKey===a.dimensionKey&&u.value===a.value)<0){o=!1;break}}o&&!this.internalProps._widthResizedColMap.has(l.col)&&(this._setColWidth(l.col,i),this.internalProps._widthResizedColMap.add(l.col))}}else l&&l.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(l.col)||(this._setColWidth(l.col,i),this.internalProps._widthResizedColMap.add(l.col)))}}_parseColumnWidthConfigForRowHeader(e){for(let t=0;t<(e==null?void 0:e.length);t++){const n=e[t],r=n.dimensions,i=n.width,l=this.getCellAddressByHeaderPaths(r);l&&l.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(l.col)||(this._setColWidth(l.col,i),this.internalProps._widthResizedColMap.add(l.col)))}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,n){var r,i;let l;if(this.isCornerHeader(e,t)){const d=this.getHeaderDefine(e,t);l=[];const a={isPivotCorner:!0,dimensionKey:d.value,value:d.value};l.push(a)}else l=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;const s=l[l.length-1].indicatorKey,o=this.getHeaderDefine(e,t);if(o.sort){if(this.dataset.sortRules){const d={};for(let a=this.dataset.sortRules.length-1;a>=0;a--){const u=this.dataset.sortRules[a];(o.dimensionKey&&u.sortField===o.dimensionKey||s&&u.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1]))&&(d[u.sortField]=u,this.dataset.sortRules.splice(a,1))}if(s){const a=this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1];this.dataset.sortRules.push({sortField:a,sortType:nt[n],sortByIndicator:s,query:l.reduce((u,h)=>(h.dimensionKey&&u.push(h.value),u),[]),sortFunc:(r=d[a])===null||r===void 0?void 0:r.sortFunc})}else this.dataset.sortRules.push(Object.assign((i=d[o.dimensionKey])!==null&&i!==void 0?i:{},{sortField:o.dimensionKey,sortType:nt[n]}))}else this.dataset.sortRules=s?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:nt[n],sortByIndicator:s,query:l.reduce((d,a)=>(a.dimensionKey&&d.push(a.value),d),[])}]:[{sortField:o.dimensionKey,sortType:nt[n]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(e,t){if(!this.pivotSortState)return;const n=this.getCellRange(e,t);for(let r=0;r<this.pivotSortState.length;r++){const i=this.pivotSortState[r],l=i.dimensions,s=this.getCellAddressByHeaderPaths(l),o=i.order;if(s&&gn(n,s.col,s.row))return o}}_moveHeaderPosition(e,t){const n=this.getCellRange(e.col,e.row),r=this.getCellRange(t.col,t.row),i=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(i){if(i.moveType==="column"){if(this.internalProps.recordsIsTwoDimensionalArray)for(let l=0;l<this.internalProps.records.length;l++){const s=this.internalProps.records[l].splice(i.sourceIndex-this.rowHeaderLevelCount,i.sourceSize);s.unshift(i.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[l],s)}this.colWidthsMap.exchangeOrder(n.start.col,n.end.col-n.start.col+1,r.start.col,r.end.col-r.start.col+1,i.targetIndex),this.setMinMaxLimitWidth()}else if(i.moveType==="row"){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.internalProps.records.splice(i.sourceIndex-this.columnHeaderLevelCount,i.sourceSize);l.unshift(i.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,l)}i.targetIndex>i.sourceIndex?this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex+i.sourceSize-i.targetSize,i.targetSize,i.targetIndex):this.rowHeightsMap.exchangeOrder(i.sourceIndex,i.sourceSize,i.targetIndex,i.targetSize,i.targetIndex)}return i}return null}toggleHierarchyState(e,t,n=!0){const r=this.getHierarchyState(e,t);if(r===Be.expand)this._refreshHierarchyState(e,t,n),this.fireListeners(Ht.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Be.collapse});else if(r===Be.collapse){const i=this.internalProps.layoutMap.getHeadNode(e,t);Array.isArray(i.children)&&this._refreshHierarchyState(e,t,n),this.fireListeners(Ht.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Be.expand,originData:i})}}_refreshHierarchyState(e,t,n=!0,r){var i,l;this.frozenColCount,this.frozenRowCount;const s=this.getBodyVisibleRowRange().rowStart;this.internalProps._oldRowCount=this.rowCount,this.internalProps._oldColCount=this.colCount;let o=!1,d=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);const a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(d=this.getAllRowsHeight()<=this.tableNoFrameHeight));const u=this.internalProps.layoutMap.isRowHeader(e,t)?this.internalProps.layoutMap.toggleHierarchyState(e,t):this.internalProps.layoutMap.toggleHierarchyStateForColumnTree(e,t);r&&r(),this.refreshRowColCount(),this.frozenColCount,this.frozenRowCount,this.clearCellStyleCache(),this.rowHierarchyType==="tree"&&this.scenegraph.updateHierarchyIcon(e,t),(i=this.reactCustomLayout)===null||i===void 0||i.clearCache(),this.rowHierarchyType!=="grid-tree"&&this.columnHierarchyType!=="grid-tree"?this.scenegraph.updateRow(u.removeCellPositionsRowDirection,u.addCellPositionsRowDirection,u.updateCellPositionsRowDirection,n):(this.internalProps.stick.changedCells.clear(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.scrollToRow(s)),(l=this.reactCustomLayout)===null||l===void 0||l.updateAllCustomCell(),a&&(this.autoFillWidth&&!o&&(o=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!d&&(d=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||o||this.heightMode==="adaptive"||d)&&this.scenegraph.updateChartSizeForResizeColWidth(-1)),this.internalProps._oldRowCount=void 0,this.internalProps._oldColCount=void 0}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var n;return(n=this._getHeaderLayoutMap(e,t))===null||n===void 0?void 0:n.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}getMenuInfo(e,t,n){const r=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(e){var t,n,r,i,l,s,o,d;const a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e,this.internalProps.recordsIsTwoDimensionalArray=!1,((t=e==null?void 0:e[0])===null||t===void 0?void 0:t.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);const u=this.options,h=this.internalProps;if(((n=this.options.customConfig)===null||n===void 0?void 0:n.enableDataAnalysis)===!1)this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new vt({rows:h.layoutMap.fullRowDimensionKeys,columns:h.layoutMap.colDimensionKeys,indicators:h.layoutMap.indicatorKeys,indicatorsAsCol:h.layoutMap.indicatorsAsCol,indicatorDimensionKey:h.layoutMap.indicatorDimensionKey},e));else{let c,f;this.dataset.setRecords(e),u.columnTree?c=h.layoutMap.columnDimensionTree:(u.indicatorsAsCol!==!1&&u.indicators&&this.dataset.colHeaderTree&&Oe(this.dataset.colHeaderTree,u.indicators,!1,this),c=new ge((r=this.dataset.colHeaderTree)!==null&&r!==void 0?r:[],this.layoutNodeId,this.options.columnHierarchyType,this.options.columnHierarchyType!=="grid"?(i=this.options.columnExpandLevel)!==null&&i!==void 0?i:1:void 0)),u.rowTree?f=h.layoutMap.rowDimensionTree:(u.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&u.indicators&&Oe(this.dataset.rowHeaderTree,u.indicators,!1,this),f=new ge((l=this.dataset.rowHeaderTree)!==null&&l!==void 0?l:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType!=="grid"?(s=this.options.rowExpandLevel)!==null&&s!==void 0?s:1:void 0)),h.layoutMap=new Ve(this,this.dataset,c,f),this.pivotSortState=[],u.pivotSortState&&(this.pivotSortState=u.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)(o=this.internalProps.emptyTip)===null||o===void 0||o.resetVisible();else{const c=Ne.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(d=this.internalProps.emptyTip)===null||d===void 0||d.resetVisible()}}startEditCell(e,t,n){var r;if(x(e)&&x(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,n);else if(!((r=this.stateManager.select)===null||r===void 0)&&r.cellPos){const{col:i,row:l}=this.stateManager.select.cellPos;x(i)&&x(l)&&this.editorManager.startEditCell(i,l,n)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var n,r,i;let l;if(this.isCornerHeader(e,t)){const s=this.getHeaderDefine(e,t);l=(n=s==null?void 0:s.headerEditor)!==null&&n!==void 0?n:this.options.headerEditor}else if(this.isHeader(e,t)){const s=this.getHeaderDefine(e,t);l=(r=s==null?void 0:s.headerEditor)!==null&&r!==void 0?r:this.options.headerEditor}else{const s=this.getBodyColumnDefine(e,t);l=(i=s==null?void 0:s.editor)!==null&&i!==void 0?i:this.options.editor}return typeof l=="function"&&(l=l({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),typeof l=="string"?yi(l):l}isHasEditorDefine(e,t){var n;const r=this.getBodyColumnDefine(e,t);let i=(n=r==null?void 0:r.editor)!==null&&n!==void 0?n:this.options.editor;return typeof i=="function"&&(i=i({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),x(i)}changeCellValue(e,t,n,r=!1){if(r&&this.isHasEditorDefine(e,t)||r===!1){let i=n;const l=this.getCellOriginValue(e,t),s=this.getCellRawValue(e,t);typeof s=="number"&&Jt(n)&&(i=parseFloat(n)),this._changeCellValueToDataSet(e,t,l,i);const o=this.getCellRange(e,t);for(let d=o.start.col;d<=o.end.col;d++)for(let a=o.start.row;a<=o.end.row;a++)this.scenegraph.updateCellContent(d,a);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(e)){const d=this.getColWidth(e),a=Qt(e,0,this.rowCount-1,this,!1);a!==d&&this.scenegraph.updateColWidth(e,a-d)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.internalProps._heightResizedRowMap.size===0&&this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight()&&!this.internalProps._heightResizedRowMap.has(t)){const d=this.getRowHeight(t),a=$t(t,0,this.colCount-1,this);this.scenegraph.updateRowHeight(t,a-d)}l!==i&&this.fireListeners(ht.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:l,changedValue:i}),this.scenegraph.updateNextFrame()}}changeCellValues(e,t,n,r=!1){let i=e,l=t;const s=[],o=[];for(let u=0;u<n.length&&!(t+u>this.rowCount-1);u++){const h=n[u],c=[],f=[];s.push(c),o.push(f);for(let C=0;C<h.length&&!(e+C>this.colCount-1);C++){const T=this.getCellRawValue(e+C,t+u);c.push(T);const g=this.getCellOriginValue(e+C,t+u);f.push(g)}}for(let u=0;u<n.length&&!(t+u>this.rowCount-1);u++){l=t+u;const h=n[u];let c=e;for(let f=0;f<h.length&&!(e+f>this.colCount-1);f++)if(c=e+f,r&&this.isHasEditorDefine(e+f,t+u)||r===!1){const C=h[f];let T=C;const g=o[u][f],p=s[u][f];typeof p=="number"&&Jt(C)&&(T=parseFloat(C)),this._changeCellValueToDataSet(e+f,t+u,g,T);const w=this.getCellOriginValue(e+f,t+u);w!==g&&this.fireListeners(ht.CHANGE_CELL_VALUE,{col:e+f,row:t+u,rawValue:p,currentValue:g,changedValue:w})}i=Math.max(i,c)}const d=this.getCellRange(e,t),a=this.getCellRange(i,l);for(let u=d.start.col;u<=a.end.col;u++)for(let h=d.start.row;h<=a.end.row;h++)this.scenegraph.updateCellContent(u,h);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else for(let u=e;u<=a.end.col;u++)if(!this.internalProps._widthResizedColMap.has(u)){const h=this.getColWidth(u),c=Qt(u,0,this.rowCount-1,this,!1);c!==h&&this.scenegraph.updateColWidth(u,c-h)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight()){const u=[],h=[];for(let c=t;c<=a.end.row;c++)if(this.rowHeightsMap.get(c)){const f=this.getRowHeight(c),C=$t(c,0,this.colCount-1,this);u.push(c),h.push(C-f)}this.scenegraph.updateRowsHeight(u,h)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,n,r){var i,l,s,o,d,a,u,h;if(this.internalProps.recordsIsTwoDimensionalArray){const c=this.getBodyIndexByRow(t),f=this.getBodyIndexByCol(e);this.records[c][f]=r}else if(this.dataset){const c=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isCornerHeader(e,t))this.internalProps.layoutMap.changeCornerTitle(e,t,r);else if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,r),!this.isCornerHeader(e,t)&&this.dataset.changeRecordFieldValue(!((i=c.colHeaderPaths)===null||i===void 0)&&i.length?(l=c.colHeaderPaths[c.colHeaderPaths.length-1].indicatorKey)!==null&&l!==void 0?l:c.colHeaderPaths[c.colHeaderPaths.length-1].dimensionKey:(s=c.rowHeaderPaths[c.rowHeaderPaths.length-1].indicatorKey)!==null&&s!==void 0?s:c.rowHeaderPaths[c.rowHeaderPaths.length-1].dimensionKey,n,r);else{const f=(o=c.colHeaderPaths)===null||o===void 0?void 0:o.filter(T=>!T.virtual).map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value}),C=(d=c.rowHeaderPaths)===null||d===void 0?void 0:d.filter(T=>!T.virtual).map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?C:C.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?f.slice(0,-1):f,this.internalProps.layoutMap.getIndicatorKey(e,t),r)}}else if(this.flatDataToObjects){const c=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,r),!this.isCornerHeader(e,t)&&this.flatDataToObjects.changeRecordFieldValue(!((a=c.colHeaderPaths)===null||a===void 0)&&a.length?(u=c.colHeaderPaths[c.colHeaderPaths.length-1].indicatorKey)!==null&&u!==void 0?u:c.colHeaderPaths[c.colHeaderPaths.length-1].dimensionKey:(h=c.rowHeaderPaths[c.rowHeaderPaths.length-1].indicatorKey)!==null&&h!==void 0?h:c.rowHeaderPaths[c.rowHeaderPaths.length-1].dimensionKey,n,r);else{const f=c.colHeaderPaths.map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value}),C=c.rowHeaderPaths.map(T=>{var g;return(g=T.indicatorKey)!==null&&g!==void 0?g:T.value});this.flatDataToObjects.changeTreeNodeValue(C,f,this.internalProps.layoutMap.getBody(e,t).indicatorKey,r)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:n}=this.internalProps.layoutMap;for(let r=0;r<e.length;r++){const i=e[r];if(typeof i!="string"&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let r=0;r<n.length;r++){const i=n[r];if(typeof i!="string"&&(i.customLayout||i.headerCustomLayout||i.customRender||i.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,n,r){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(n,r).children=e,this._refreshHierarchyState(n,r,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(n,r).children=e,this._refreshHierarchyState(n,r,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return(e=this.dataset)===null||e===void 0?void 0:e.filterRules}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}release(){this.editorManager.release(),super.release()}}Cn(),pn(),mn(),yn(),_n(),wn(),Hn(),Tn(),vn(),bn(),Pn(),Sn(),In(),Rn();class Dt extends Ni{}Cn(),pn(),mn(),yn(),_n(),wn(),Hn(),Tn(),vn(),bn(),Pn(),Sn(),In(),Rn();class Ft extends fn{constructor(e,t){var n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P,b,y,R;let v,S;St.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},t.layout&&Object.assign(t,t.layout),this.internalProps.columns=Ce(t.columns),this.internalProps.rows=Ce(t.rows),this.internalProps.indicators=ct(t.indicators),this.internalProps.columnTree=!t.indicatorsAsCol||!((n=t.columns)===null||n===void 0)&&n.length||t.columnTree?Ce(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((r=t.rows)===null||r===void 0)&&r.length||t.rowTree?Ce(t.rowTree):[],this.internalProps.records=t.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=(s=(l=(i=t.resize)===null||i===void 0?void 0:i.columnResizeType)!==null&&l!==void 0?l:t.columnResizeType)!==null&&s!==void 0?s:"column",this.internalProps.rowResizeType=(a=(d=(o=t.resize)===null||o===void 0?void 0:o.rowResizeType)!==null&&d!==void 0?d:t.rowResizeType)!==null&&a!==void 0?a:"row",this.internalProps.dataConfig={isPivotChart:!0},this._axes=Ee(t.axes)?t.axes:[],t.columnTree&&(t.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Me(this.internalProps.columnTree,t.indicators)),v=new ge((u=this.internalProps.columnTree)!==null&&u!==void 0?u:[],this.layoutNodeId)),t.rowTree&&(t.indicatorsAsCol===!1&&(this.internalProps.rowTree=Me(this.internalProps.rowTree,t.indicators)),S=new ge((h=this.internalProps.rowTree)!==null&&h!==void 0?h:[],this.layoutNodeId));const A=!((c=S==null?void 0:S.dimensionKeys)===null||c===void 0)&&c.count?S.dimensionKeys.valueArr():(C=(f=t.rows)===null||f===void 0?void 0:f.reduce((K,O)=>(typeof O=="string"?K.push(O):K.push(O.dimensionKey),K),[]))!==null&&C!==void 0?C:[],F=!((T=v==null?void 0:v.dimensionKeys)===null||T===void 0)&&T.count?v.dimensionKeys.valueArr():(p=(g=t.columns)===null||g===void 0?void 0:g.reduce((K,O)=>(typeof O=="string"?K.push(O):K.push(O.dimensionKey),K),[]))!==null&&p!==void 0?p:[],N=(m=(w=t.indicators)===null||w===void 0?void 0:w.reduce((K,O)=>(typeof O=="string"?K.push(O):K.push(O.indicatorKey),K),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(F,A),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new gt(this.internalProps.dataConfig,A,F,N,this.internalProps.indicators,(H=t.indicatorsAsCol)===null||H===void 0||H,t.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&ot(this.internalProps.indicators)){const K=O=>{O.forEach(L=>{var E;!((E=L.children)===null||E===void 0)&&E.length?K(L.children):L.children=[{dimensionKey:"axis",value:""}]})};!((_=this.dataset.rowHeaderTree)===null||_===void 0)&&_.length?K(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Me(this.dataset.colHeaderTree,t.indicators)),t.rowTree||t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Me(this.dataset.rowHeaderTree,t.indicators)),v=new ge((P=this.dataset.colHeaderTree)!==null&&P!==void 0?P:[],this.layoutNodeId),S=new ge((b=this.dataset.rowHeaderTree)!==null&&b!==void 0?b:[],this.layoutNodeId),this.internalProps.layoutMap=new Ve(this,this.dataset,v,S),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),t.title){const K=Ne.getComponent("title");this.internalProps.title=new K(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(y=this.internalProps.emptyTip)===null||y===void 0||y.resetVisible();else{const K=Ne.getComponent("emptyTip");this.internalProps.emptyTip=new K(this.options.emptyTip,this),(R=this.internalProps.emptyTip)===null||R===void 0||R.resetVisible()}setTimeout(()=>{this.fireListeners(ht.INITIALIZED,null)},0)}static get EVENT_TYPE(){return _i}get pivotChartAxes(){return this._axes}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(e,t){const n=super._canResizeColumn(e,t);if(n&&!this.internalProps.layoutMap.indicatorsAsCol){const r=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(r!=null&&r.disableColumnResize)return!1}return n}updateOption(e){var t,n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w,m,H,_,P,b,y,R,v;const S=this.internalProps;let A,F;super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=Ce(e.columns),this.internalProps.rows=Ce(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?ct(e.indicators):[],this.internalProps.columnTree=!e.indicatorsAsCol||!((n=e.columns)===null||n===void 0)&&n.length||e.columnTree?Ce(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((r=e.rows)===null||r===void 0)&&r.length||e.rowTree?Ce(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],S.columnResizeType=(s=(l=(i=e.resize)===null||i===void 0?void 0:i.columnResizeType)!==null&&l!==void 0?l:e.columnResizeType)!==null&&s!==void 0?s:"column",S.rowResizeType=(a=(d=(o=e.resize)===null||o===void 0?void 0:o.rowResizeType)!==null&&d!==void 0?d:e.rowResizeType)!==null&&a!==void 0?a:"row",S.dataConfig={isPivotChart:!0},this._axes=Ee(e.axes)?e.axes:[],e.columnTree&&(e.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Me(this.internalProps.columnTree,e.indicators)),A=new ge((u=this.internalProps.columnTree)!==null&&u!==void 0?u:[],this.layoutNodeId)),e.rowTree&&(e.indicatorsAsCol===!1&&(this.internalProps.rowTree=Me(this.internalProps.rowTree,e.indicators)),F=new ge((h=this.internalProps.rowTree)!==null&&h!==void 0?h:[],this.layoutNodeId));const N=!((c=F==null?void 0:F.dimensionKeys)===null||c===void 0)&&c.count?F.dimensionKeys.valueArr():(C=(f=e.rows)===null||f===void 0?void 0:f.reduce((L,E)=>(typeof E=="string"?L.push(E):L.push(E.dimensionKey),L),[]))!==null&&C!==void 0?C:[],K=!((T=A==null?void 0:A.dimensionKeys)===null||T===void 0)&&T.count?A.dimensionKeys.valueArr():(p=(g=e.columns)===null||g===void 0?void 0:g.reduce((L,E)=>(typeof E=="string"?L.push(E):L.push(E.dimensionKey),L),[]))!==null&&p!==void 0?p:[],O=(m=(w=e.indicators)===null||w===void 0?void 0:w.reduce((L,E)=>(typeof E=="string"?L.push(E):L.push(E.indicatorKey),L),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(K,N),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new gt(this.internalProps.dataConfig,N,K,O,this.internalProps.indicators,(H=e.indicatorsAsCol)===null||H===void 0||H,(_=e.records)!==null&&_!==void 0?_:this.internalProps.records,void 0,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&ot(this.internalProps.indicators)){const L=E=>{E.forEach($=>{var J;!((J=$.children)===null||J===void 0)&&J.length?L($.children):$.children=[{dimensionKey:"axis",value:""}]})};!((P=this.dataset.rowHeaderTree)===null||P===void 0)&&P.length?L(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Me(this.dataset.colHeaderTree,e.indicators)),e.rowTree||e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Me(this.dataset.rowHeaderTree,e.indicators)),A=new ge((b=this.dataset.colHeaderTree)!==null&&b!==void 0?b:[],this.layoutNodeId),F=new ge((y=this.dataset.rowHeaderTree)!==null&&y!==void 0?y:[],this.layoutNodeId),S.layoutMap=new Ve(this,this.dataset,A,F),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,S.releaseList&&(S.releaseList.forEach(L=>{var E;return(E=L==null?void 0:L.release)===null||E===void 0?void 0:E.call(L)}),S.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const L=Ne.getComponent("title");this.internalProps.title=new L(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(R=this.internalProps.emptyTip)===null||R===void 0||R.resetVisible();else{const L=Ne.getComponent("emptyTip");this.internalProps.emptyTip=new L(this.options.emptyTip,this),(v=this.internalProps.emptyTip)===null||v===void 0||v.resetVisible()}return new Promise(L=>{setTimeout(L,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,n,r,i,l,s,o;const d=this,{layoutMap:a}=d.internalProps;a&&(d.colCount=(e=a.colCount)!==null&&e!==void 0?e:0,d.rowCount=(t=a.rowCount)!==null&&t!==void 0?t:0,d.internalProps.frozenColCount=(n=a.rowHeaderLevelCount)!==null&&n!==void 0?n:0,d.frozenRowCount=Math.max(a.headerLevelCount,(r=this.options.frozenRowCount)!==null&&r!==void 0?r:0),d.bottomFrozenRowCount!==((i=a==null?void 0:a.bottomFrozenRowCount)!==null&&i!==void 0?i:0)&&(d.bottomFrozenRowCount=(l=a==null?void 0:a.bottomFrozenRowCount)!==null&&l!==void 0?l:0),d.rightFrozenColCount!==((s=a==null?void 0:a.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(d.rightFrozenColCount=(o=a==null?void 0:a.rightFrozenColCount)!==null&&o!==void 0?o:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,n){}syncHierarchyState(e,t){var n,r;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(n=t.hierarchyState)!==null&&n!==void 0?n:t!=null&&t.children?e.hierarchyState:void 0,(r=t==null?void 0:t.children)===null||r===void 0||r.forEach((i,l)=>{var s;!((s=e==null?void 0:e.children)===null||s===void 0)&&s[l]&&i&&this.syncHierarchyState(e.children[l],i)}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getCellValue(e,t,n){var r,i,l;if(!n){const u=this.getCustomMergeValue(e,t);if(u)return u}if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const c=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let f;return c==null||c.forEach(C=>{const T=this.internalProps.layoutMap.getIndicatorInfo(C);T&&(f=T)}),(i=(r=f==null?void 0:f.title)!==null&&r!==void 0?r:f==null?void 0:f.indicatorKey)!==null&&i!==void 0?i:""}const{title:u,fieldFormat:h}=this.internalProps.layoutMap.getHeader(e,t);return typeof h=="function"?h(u,e,t,this):u}if(this.dataset){let u;const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t),c=h.colHeaderPaths.map((T,g)=>{var p;return T.indicatorKey&&(u={position:"col",index:g}),(p=T.indicatorKey)!==null&&p!==void 0?p:T.value}),f=h.rowHeaderPaths.map((T,g)=>{var p;return T.indicatorKey&&(u={position:"row",index:g}),(p=T.indicatorKey)!==null&&p!==void 0?p:T.value}),C=this.dataset.getAggregator(f,c,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,u);return C.value?C.value():void 0}const{fieldFormat:s}=this.internalProps.layoutMap.getBody(e,t),o=this.getBodyIndexByRow(t),d=this.getBodyIndexByCol(e),a=(l=this.records[o])===null||l===void 0?void 0:l[d];return typeof s=="function"?s(a,e,t,this):a}getCellOriginValue(e,t){var n,r,i;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const a=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let u;return a==null||a.forEach(h=>{const c=this.internalProps.layoutMap.getIndicatorInfo(h);c&&(u=c)}),(r=(n=u==null?void 0:u.title)!==null&&n!==void 0?n:u==null?void 0:u.indicatorKey)!==null&&r!==void 0?r:""}const{title:d}=l.internalProps.layoutMap.getHeader(e,t);return typeof d=="function"?d():d}if(this.dataset){let d;const a=this.internalProps.layoutMap.getCellHeaderPaths(e,t),u=a.colHeaderPaths.map((f,C)=>{var T;return f.indicatorKey&&(d={position:"col",index:C}),(T=f.indicatorKey)!==null&&T!==void 0?T:f.value}),h=a.rowHeaderPaths.map((f,C)=>{var T;return f.indicatorKey&&(d={position:"row",index:C}),(T=f.indicatorKey)!==null&&T!==void 0?T:f.value}),c=this.dataset.getAggregator(h,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,d);return c.value?c.value():void 0}const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(i=this.records[s])===null||i===void 0?void 0:i[o]}getCellRawValue(e,t){return this.getCellOriginValue(e,t)}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)&&this.dataset){let n;const r=this.internalProps.layoutMap.getCellHeaderPaths(e,t),i=r.colHeaderPaths.map((s,o)=>{var d;return s.indicatorKey&&(n={position:"col",index:o}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value}),l=r.rowHeaderPaths.map((s,o)=>{var d;return s.indicatorKey&&(n={position:"row",index:o}),(d=s.indicatorKey)!==null&&d!==void 0?d:s.value});return this.dataset.getAggregator(l,i,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,n).records}}getCellRawRecord(e,t){return this.getCellOriginRecord(e,t)}getPivotSortState(e,t){if(!this.pivotSortState)return;const n=this.getCellRange(e,t);for(let r=0;r<this.pivotSortState.length;r++){const{col:i,row:l,order:s}=this.pivotSortState[r];if(gn(n,i,l))return s}}_moveHeaderPosition(e,t){var n,r,i,l;const s=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(s){if(s.moveType==="column"){if(((r=(n=this.options.records)===null||n===void 0?void 0:n[0])===null||r===void 0?void 0:r.constructor)===Array)for(let o=0;o<this.internalProps.records.length;o++){const d=this.internalProps.records[o].splice(s.sourceIndex-this.rowHeaderLevelCount,s.sourceSize);d.unshift(s.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[o],d)}this.colWidthsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize),this.setMinMaxLimitWidth()}else if(s.moveType==="row"){if(((l=(i=this.options.records)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.constructor)===Array){const o=this.internalProps.records.splice(s.sourceIndex-this.columnHeaderLevelCount,s.sourceSize);o.unshift(s.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,o)}this.rowHeightsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize)}return s}return null}toggleHierarchyState(e,t,n=!0){}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var n;return(n=this._getHeaderLayoutMap(e,t))===null||n===void 0?void 0:n.hierarchyState}getMenuInfo(e,t,n){const r=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}_generateCollectValuesConfig(e,t){var n,r,i,l,s,o,d,a,u,h,c,f,C,T,g,p,w;e=e.filter(_=>_!==ze),t=t.filter(_=>_!==ze);const m=this.internalProps.indicators,H={};for(let _=0,P=m==null?void 0:m.length;_<P;_++)if(typeof m[_]!="string"&&m[_].chartSpec){if(((n=m[_].chartSpec)===null||n===void 0?void 0:n.type)==="pie"||((r=m[_].chartSpec)===null||r===void 0?void 0:r.type)==="rose"||((i=m[_].chartSpec)===null||i===void 0?void 0:i.type)==="radar"||((l=m[_].chartSpec)===null||l===void 0?void 0:l.type)==="gauge"||((s=m[_].chartSpec)===null||s===void 0?void 0:s.type)==="wordCloud")continue;const b=m[_],y=b.chartSpec;if(this.options.indicatorsAsCol===!1)if((y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0),H[b.indicatorKey]={by:t,range:!0,sumBy:(y==null?void 0:y.stack)&&e.concat(y==null?void 0:y.xField)},y.series)y.series.forEach(R=>{var v,S,A,F,N,K,O,L,E,$,J,de,ae,ue;const he=typeof R.xField=="string"?R.xField:R.xField[0];H[he]={by:e,type:R.direction!=="horizontal"?"xField":void 0,range:Ye(R,this._axes,R.direction==="horizontal",!0),sortBy:R.direction!=="horizontal"?(F=(A=(S=(v=R==null?void 0:R.data)===null||v===void 0?void 0:v.fields)===null||S===void 0?void 0:S[he])===null||A===void 0?void 0:A.domain)!==null&&F!==void 0?F:(O=(K=(N=y==null?void 0:y.data)===null||N===void 0?void 0:N.fields)===null||K===void 0?void 0:K[he])===null||O===void 0?void 0:O.domain:void 0};const ce=R.yField;R.stack!==!1&&(R.type==="bar"||R.type==="area")&&(R.stack=!0),H[ce]={by:t,range:Ye(R,this._axes,R.direction==="horizontal",!1),sumBy:R.stack&&e.concat(R==null?void 0:R.xField),sortBy:R.direction==="horizontal"?(J=($=(E=(L=R==null?void 0:R.data)===null||L===void 0?void 0:L.fields)===null||E===void 0?void 0:E[ce])===null||$===void 0?void 0:$.domain)!==null&&J!==void 0?J:(ue=(ae=(de=y==null?void 0:y.data)===null||de===void 0?void 0:de.fields)===null||ae===void 0?void 0:ae[ce])===null||ue===void 0?void 0:ue.domain:void 0,extendRange:ut(y.markLine)}});else{const R=typeof y.xField=="string"?y.xField:y.xField[0];H[R]={by:e,type:y.direction!=="horizontal"?"xField":void 0,range:Ye(y,this._axes,y.direction==="horizontal",!0),sortBy:y.direction!=="horizontal"?(a=(d=(o=y==null?void 0:y.data)===null||o===void 0?void 0:o.fields)===null||d===void 0?void 0:d[R])===null||a===void 0?void 0:a.domain:void 0},(y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0);const v=y.yField;H[v]={by:t,range:y.direction!=="horizontal",sumBy:y.stack&&e.concat(y==null?void 0:y.xField),sortBy:y.direction==="horizontal"?(c=(h=(u=y==null?void 0:y.data)===null||u===void 0?void 0:u.fields)===null||h===void 0?void 0:h[v])===null||c===void 0?void 0:c.domain:void 0,extendRange:ut(y.markLine)}}else{const R=m[_];if((y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0),H[R.indicatorKey]={by:e,range:!0,sumBy:(y==null?void 0:y.stack)&&t.concat(y==null?void 0:y.yField)},y.series)y.series.forEach(v=>{var S,A,F,N,K,O,L,E,$,J,de,ae,ue,he;const ce=typeof v.yField=="string"?v.yField:v.yField[0];H[ce]={by:t,type:v.direction==="horizontal"?"yField":void 0,range:Ye(v,this._axes,v.direction==="horizontal",!1),sortBy:v.direction==="horizontal"?(N=(F=(A=(S=v==null?void 0:v.data)===null||S===void 0?void 0:S.fields)===null||A===void 0?void 0:A[ce])===null||F===void 0?void 0:F.domain)!==null&&N!==void 0?N:(L=(O=(K=y==null?void 0:y.data)===null||K===void 0?void 0:K.fields)===null||O===void 0?void 0:O[ce])===null||L===void 0?void 0:L.domain:void 0};const pe=v.xField;v.stack!==!1&&(v.type==="bar"||v.type==="area")&&(v.stack=!0),H[pe]={by:e,range:Ye(v,this._axes,v.direction==="horizontal",!0),sumBy:v.stack&&t.concat(v==null?void 0:v.yField),sortBy:v.direction!=="horizontal"?(de=(J=($=(E=v==null?void 0:v.data)===null||E===void 0?void 0:E.fields)===null||$===void 0?void 0:$[pe])===null||J===void 0?void 0:J.domain)!==null&&de!==void 0?de:(he=(ue=(ae=y==null?void 0:y.data)===null||ae===void 0?void 0:ae.fields)===null||ue===void 0?void 0:ue[pe])===null||he===void 0?void 0:he.domain:void 0,extendRange:ut(y.markLine)}});else{const v=typeof y.yField=="string"?y.yField:y.yField[0];H[v]={by:t,type:y.direction==="horizontal"?"yField":void 0,range:Ye(y,this._axes,y.direction==="horizontal",!1),sortBy:y.direction==="horizontal"?(T=(C=(f=y==null?void 0:y.data)===null||f===void 0?void 0:f.fields)===null||C===void 0?void 0:C[v])===null||T===void 0?void 0:T.domain:void 0},(y==null?void 0:y.stack)!==!1&&((y==null?void 0:y.type)==="bar"||(y==null?void 0:y.type)==="area")&&(y.stack=!0);const S=y.xField;H[S]={by:e,range:Ye(y,this._axes,y.direction==="horizontal",!0),sumBy:y.stack&&t.concat(y==null?void 0:y.yField),sortBy:y.direction!=="horizontal"?(w=(p=(g=y==null?void 0:y.data)===null||g===void 0?void 0:g.fields)===null||p===void 0?void 0:p[S])===null||w===void 0?void 0:w.domain:void 0,extendRange:ut(y.markLine)}}}}return H}_generateAggregationRules(){var e;const t=[];return(e=this.internalProps.indicators)===null||e===void 0||e.forEach(n=>{var r,i;if(typeof n=="string")t.push({indicatorKey:n,field:n,aggregationType:ee.RECORD});else if(!((r=n.chartSpec)===null||r===void 0)&&r.series){const l=[];(i=n.chartSpec)===null||i===void 0||i.series.forEach(s=>{const o=this.options.indicatorsAsCol===!1?s.yField:s.xField;l.indexOf(o)===-1&&l.push(o)}),t.push({indicatorKey:n.indicatorKey,field:l,aggregationType:ee.RECORD})}else{const l=this.options.indicatorsAsCol===!1?n.chartSpec.yField:n.chartSpec.xField;t.push({indicatorKey:n.indicatorKey,field:l??n.indicatorKey,aggregationType:ee.RECORD})}}),t}setCustomStateNameToSpec(){var e;const t=n=>{var r,i,l,s,o,d,a,u,h,c;!((i=(r=n.bar)===null||r===void 0?void 0:r.state)===null||i===void 0)&&i.selected&&(n.bar.state.vtable_selected=n.bar.state.selected,n.bar.state.vtable_selected_reverse=n.bar.state.selected_reverse,delete n.bar.state.selected,delete n.bar.state.selected_reverse),!((s=(l=n.point)===null||l===void 0?void 0:l.state)===null||s===void 0)&&s.selected&&(n.point.state.vtable_selected=n.point.state.selected,n.point.state.vtable_selected_reverse=n.point.state.selected_reverse,delete n.point.state.selected,delete n.point.state.selected_reverse),!((d=(o=n.line)===null||o===void 0?void 0:o.state)===null||d===void 0)&&d.selected&&(n.line.state.vtable_selected=n.line.state.selected,n.line.state.vtable_selected_reverse=n.line.state.selected_reverse,delete n.line.state.selected,delete n.line.state.selected_reverse),!((u=(a=n.area)===null||a===void 0?void 0:a.state)===null||u===void 0)&&u.selected&&(n.area.state.vtable_selected=n.area.state.selected,n.area.state.vtable_selected_reverse=n.area.state.selected_reverse,delete n.area.state.selected,delete n.area.state.selected_reverse),!((c=(h=n.pie)===null||h===void 0?void 0:h.state)===null||c===void 0)&&c.selected&&(n.pie.state.vtable_selected=n.pie.state.selected,n.pie.state.vtable_selected_reverse=n.pie.state.selected_reverse,delete n.pie.state.selected,delete n.pie.state.selected_reverse)};(e=this.internalProps.indicators)===null||e===void 0||e.forEach(n=>{if(n.chartSpec){const r=n.chartSpec;r.series?r.series.forEach(i=>{t(i)}):t(r)}})}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),Xt(this.scenegraph),wi(this.scenegraph),this.render()}clearChartCacheImage(e,t){ft(e)&&ft(t)?Hi(e,t,this.scenegraph):Xt(this.scenegraph)}getLegendSelected(){var e;const t=[];return(e=this.internalProps.legends)===null||e===void 0||e.forEach(n=>{const r=n.legendComponent._getSelectedLegends().map(i=>i.label);t.push(...r)}),t}setLegendSelected(e){var t;(t=this.internalProps.legends)===null||t===void 0||t.forEach(n=>{n.legendComponent.setSelected(e)})}getChartDatumPosition(e,t){const{chartInstance:n,bounds:r}=this.getChartInstance(t);if(n){const i=n.convertDatumToPosition(e);return i?{x:Math.round(i.x+r.x1),y:Math.round(i.y+r.y1)}:null}return null}getCellAddressByRecord(e){const t=[],n=[],r={},i=[];this.dataset.dataConfig.aggregationRules.forEach(l=>{if(typeof l.field=="string")r[l.field]=l.indicatorKey,i.push(l.field);else for(let s=0;s<l.field.length;s++)r[l.field[s]]=l.indicatorKey,i.push(l.field[s])});for(const l in e)this.dataset.rows.indexOf(l)>=0&&t.push({dimensionKey:l,value:e[l]}),this.dataset.columns.indexOf(l)>=0&&n.push({dimensionKey:l,value:e[l]}),i.indexOf(l)>=0&&(this.dataset.indicatorsAsCol?n.push({indicatorKey:r[l]}):t.push({indicatorKey:r[l]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:t,colHeaderPaths:n,cellLocation:"body"})}getChartInstance(e){var t,n,r,i,l;const s=this.getCellAddressByHeaderPaths(e);if(s){const o=this.getCellRelativeRect(s.col,s.row),d=this.scenegraph.getCell(s.col,s.row);let a;const u=(t=d==null?void 0:d.getChildren())===null||t===void 0?void 0:t[0];if(u.attribute.chartInstance){a=u.attribute.chartInstance;const{dataId:h,data:c,axes:f,spec:C}=u.attribute,T=u.getViewBox();f==null||f.forEach((m,H)=>{var _,P,b,y,R;m.type==="linear"?a.updateModelSpecSync({type:"axes",index:H},{min:(P=(_=m.range)===null||_===void 0?void 0:_.min)!==null&&P!==void 0?P:0,max:(y=(b=m.range)===null||b===void 0?void 0:b.max)!==null&&y!==void 0?y:0,tick:{tickMode:(R=m.tick)===null||R===void 0?void 0:R.tickMode}},!0):m.type==="band"&&a.updateModelSpec({type:"axes",index:H},{domain:m.domain.slice(0)},!0)}),a.updateViewBox({x1:0,x2:T.x2-T.x1,y1:0,y2:T.y2-T.y1},!1,!1);const g=a.getStage(),p=u.globalTransMatrix.clone(),w=u.stage.window.getViewBoxTransform();if(p.multiply(w.a,w.b,w.c,w.d,w.e,w.f),g.window.setViewBoxTransform&&g.window.setViewBoxTransform(p.a,p.b,p.c,p.d,p.e,p.f),typeof h=="string")a.updateDataSync(h,c??[]);else{const m=[];for(const H in h){const _=h[H],P=C.series.find(b=>{var y;return((y=b==null?void 0:b.data)===null||y===void 0?void 0:y.id)===H});m.push({id:H,values:_?(n=c==null?void 0:c.filter(b=>b.hasOwnProperty(_)))!==null&&n!==void 0?n:[]:c??[],fields:(r=P==null?void 0:P.data)===null||r===void 0?void 0:r.fields}),a.updateFullDataSync||a.updateDataSync(H,_?(i=c==null?void 0:c.filter(b=>b.hasOwnProperty(_)))!==null&&i!==void 0?i:[]:c??[])}(l=a.updateFullDataSync)===null||l===void 0||l.call(a,m)}this.render()}return{chartInstance:a,bounds:o.bounds}}return{}}activateChartInstance(e){var t,n,r,i,l;const s=this.getCellAddressByHeaderPaths(e);if(s){const o=s.col,d=s.row,a=this.scenegraph.getCell(o,d),u=(t=a==null?void 0:a.getChildren())===null||t===void 0?void 0:t[0],h=this.scenegraph.activateChart(o,d),{dataId:c,data:f,axes:C,spec:T}=u.attribute,g=u.getViewBox();C==null||C.forEach((H,_)=>{var P,b,y,R,v;H.type==="linear"?h.updateModelSpecSync({type:"axes",index:_},{min:(b=(P=H.range)===null||P===void 0?void 0:P.min)!==null&&b!==void 0?b:0,max:(R=(y=H.range)===null||y===void 0?void 0:y.max)!==null&&R!==void 0?R:0,tick:{tickMode:(v=H.tick)===null||v===void 0?void 0:v.tickMode}},!0):H.type==="band"&&h.updateModelSpec({type:"axes",index:_},{domain:H.domain.slice(0)},!0)}),h.updateViewBox({x1:0,x2:g.x2-g.x1,y1:0,y2:g.y2-g.y1},!1,!1);const p=h.getStage();p.needRender=!0;const w=u.globalTransMatrix.clone(),m=u.stage.window.getViewBoxTransform().clone();if(m.multiply(w.a,w.b,w.c,w.d,w.e,w.f),p.window.setViewBoxTransform(m.a,m.b,m.c,m.d,m.e,m.f),typeof c=="string")h.updateDataSync(c,f??[]);else{const H=[];for(const _ in c){const P=c[_],b=T.series.find(y=>{var R;return((R=y==null?void 0:y.data)===null||R===void 0?void 0:R.id)===_});H.push({id:_,values:P?(n=f==null?void 0:f.filter(y=>y.hasOwnProperty(P)))!==null&&n!==void 0?n:[]:f??[],fields:(r=b==null?void 0:b.data)===null||r===void 0?void 0:r.fields}),h.updateFullDataSync||h.updateDataSync(_,P?(i=f==null?void 0:f.filter(y=>y.hasOwnProperty(P)))!==null&&i!==void 0?i:[]:f??[])}(l=h.updateFullDataSync)===null||l===void 0||l.call(h,H)}return h}}replaceChartCacheImage(e,t){var n;const r=this.getCellAddressByHeaderPaths(e);if(r){const i=this.scenegraph.getCell(r.col,r.row),l=(n=i==null?void 0:i.getChildren())===null||n===void 0?void 0:n[0];Ti(t.getStage(),l)}}_getDimensionSortArray(){var e,t;if(!((t=(e=this.options)===null||e===void 0?void 0:e.axes)===null||t===void 0)&&t.length){const n=this.options.indicatorsAsCol?"left":"bottom",r=this.options.axes.find(i=>i.orient===n);if(r&&Ee(r.domain))return r.domain}}setRecords(e){var t,n;const r={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e;const i=this.options,l=this.internalProps;let s,o;this.dataset.setRecords(e),s=i.columnTree?l.layoutMap.columnDimensionTree:new ge((t=this.dataset.colHeaderTree)!==null&&t!==void 0?t:[],this.layoutNodeId),o=i.rowTree?l.layoutMap.rowDimensionTree:new ge((n=this.dataset.rowHeaderTree)!==null&&n!==void 0?n:[],this.layoutNodeId),l.layoutMap=new Ve(this,this.dataset,s,o),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(r.col,r.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:n}=this.internalProps.layoutMap;for(let r=0;r<e.length;r++){const i=e[r];if(typeof i!="string"&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&(i.headerCustomLayout||i.headerCustomRender))return!0}for(let r=0;r<n.length;r++){const i=n[r];if(typeof i!="string"&&(i.customLayout||i.headerCustomLayout||i.customRender||i.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}}let zi=class extends vi{constructor(e){var t,n,r,i,l,s,o,d,a,u;e.src&&(e.image=e.src),e.shape==="circle"&&(e.cornerRadius=e.width/2);const h=Ee(e.boundsPadding),c=[(n=(t=e.marginTop)!==null&&t!==void 0?t:h?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(i=(r=e.marginRight)!==null&&r!==void 0?r:h?e.boundsPadding[1]:e.boundsPadding)!==null&&i!==void 0?i:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:h?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:h?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=c,super(e)}},Vi=class extends bi{constructor(e){var t,n,r,i,l,s,o,d,a,u,h;e.textBaseline||(e.textBaseline="top");const c=Ee(e.boundsPadding),f=[(n=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(i=(r=e.marginRight)!==null&&r!==void 0?r:c?e.boundsPadding[1]:e.boundsPadding)!==null&&i!==void 0?i:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:c?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=f,e.fill=(h=e.fill)!==null&&h!==void 0?h:"#000",super(e)}getSize(e){this.AABBBounds.width()}},ki=class extends Pi{constructor(e){var t,n,r,i,l,s,o,d,a,u;const h=Ee(e.boundsPadding),c=[(n=(t=e.marginTop)!==null&&t!==void 0?t:h?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(i=(r=e.marginRight)!==null&&r!==void 0?r:h?e.boundsPadding[1]:e.boundsPadding)!==null&&i!==void 0?i:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:h?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:h?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=c,super(e)}getSize(e){this.AABBBounds.width()}},ji=class extends Si{constructor(e){var t,n,r,i,l,s,o,d,a,u;const h=Ee(e.boundsPadding),c=[(n=(t=e.marginTop)!==null&&t!==void 0?t:h?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(i=(r=e.marginRight)!==null&&r!==void 0?r:h?e.boundsPadding[1]:e.boundsPadding)!==null&&i!==void 0?i:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:h?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(u=(d=e.marginLeft)!==null&&d!==void 0?d:h?(a=e.boundsPadding[3])!==null&&a!==void 0?a:e.boundsPadding[1]:e.boundsPadding)!==null&&u!==void 0?u:0];e.boundsPadding=c,super(e)}};const sn=[{"Row ID":"7981","Order ID":"CA-2015-103800","Order Date":"2015/1/3","Ship Date":"2015/1/7","Ship Mode":"Standard Class","Customer ID":"DP-13000","Customer Name":"Darren Powers",Segment:"Consumer",Country:"United States",City:"Houston",State:"Texas","Postal Code":"77095",Region:"Central","Product ID":"OFF-PA-10000174",Category:"Office Supplies","Sub-Category":"Paper","Product Name":'Message Book, Wirebound, Four 5 1/2" X 4" Forms/Pg., 200 Dupl. Sets/Book',Sales:"16.448",Quantity:"2",Discount:"0.2",Profit:"5.5512"},{"Row ID":"740","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-LA-10003223",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 508",Sales:"11.784",Quantity:"3",Discount:"0.2",Profit:"4.2717"},{"Row ID":"741","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-ST-10002743",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"SAFCO Boltless Steel Shelving",Sales:"272.736",Quantity:"3",Discount:"0.2",Profit:"-64.7748"},{"Row ID":"742","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-BI-10004094",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"GBC Standard Plastic Binding Systems Combs",Sales:"3.54",Quantity:"2",Discount:"0.8",Profit:"-5.487"},{"Row ID":"1760","Order ID":"CA-2015-141817","Order Date":"2015/1/5","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"MB-18085","Customer Name":"Mick Brown",Segment:"Consumer",Country:"United States",City:"Philadelphia",State:"Pennsylvania","Postal Code":"19143",Region:"East","Product ID":"OFF-AR-10003478",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Avery Hi-Liter EverBold Pen Style Fluorescent Highlighters, 4/Pack",Sales:"19.536",Quantity:"3",Discount:"0.2",Profit:"4.884"},{"Row ID":"5328","Order ID":"CA-2015-130813","Order Date":"2015/1/6","Ship Date":"2015/1/8","Ship Mode":"Second Class","Customer ID":"LS-17230","Customer Name":"Lycoris Saunders",Segment:"Consumer",Country:"United States",City:"Los Angeles",State:"California","Postal Code":"90049",Region:"West","Product ID":"OFF-PA-10002005",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Xerox 225",Sales:"19.44",Quantity:"3",Discount:"0",Profit:"9.3312"},{"Row ID":"7181","Order ID":"CA-2015-106054","Order Date":"2015/1/6","Ship Date":"2015/1/7","Ship Mode":"First Class","Customer ID":"JO-15145","Customer Name":"Jack O'Briant",Segment:"Corporate",Country:"United States",City:"Athens",State:"Georgia","Postal Code":"30605",Region:"South","Product ID":"OFF-AR-10002399",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Dixon Prang Watercolor Pencils, 10-Color Set with Brush",Sales:"12.78",Quantity:"3",Discount:"0",Profit:"5.2398"},{"Row ID":"7475","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"FUR-CH-10004063",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Deluxe High-Back Manager's Chair",Sales:"2573.82",Quantity:"9",Discount:"0",Profit:"746.4078"},{"Row ID":"7476","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-BI-10004632",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"Ibico Hi-Tech Manual Binding System",Sales:"609.98",Quantity:"2",Discount:"0",Profit:"274.491"},{"Row ID":"7477","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-AR-10001662",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Rogers Handheld Barrel Pencil Sharpener",Sales:"5.48",Quantity:"2",Discount:"0",Profit:"1.4796"},{"Row ID":"7478","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004977",Category:"Technology","Sub-Category":"Phones","Product Name":"GE 30524EE4",Sales:"391.98",Quantity:"2",Discount:"0",Profit:"113.6742"},{"Row ID":"7479","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004539",Category:"Technology","Sub-Category":"Phones","Product Name":"Wireless Extenders zBoost YX545 SOHO Signal Booster",Sales:"755.96",Quantity:"4",Discount:"0",Profit:"204.1092"},{"Row ID":"7480","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-FA-10001883",Category:"Office Supplies","Sub-Category":"Fasteners","Product Name":"Alliance Super-Size Bands, Assorted Sizes",Sales:"31.12",Quantity:"4",Discount:"0",Profit:"0.3112"},{"Row ID":"7481","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-PA-10000955",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Southworth 25% Cotton Granite Paper & Envelopes",Sales:"6.54",Quantity:"1",Discount:"0",Profit:"3.0084"},{"Row ID":"7661","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"FUR-FU-10004864",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 14-1/2" Diameter Chrome Round Wall Clock',Sales:"76.728",Quantity:"3",Discount:"0.6",Profit:"-53.7096"},{"Row ID":"7662","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"OFF-BI-10003708",Category:"Office Supplies","Sub-Category":"Binders","Product Name":'Acco Four Pocket Poly Ring Binder with Label Holder, Smoke, 1"',Sales:"10.43",Quantity:"7",Discount:"0.8",Profit:"-18.2525"},{"Row ID":"593","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"OFF-AR-10004078",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Newell 312",Sales:"9.344",Quantity:"2",Discount:"0.2",Profit:"1.168"},{"Row ID":"594","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"TEC-AC-10001266",Category:"Technology","Sub-Category":"Accessories","Product Name":"Memorex Micro Travel Drive 8 GB",Sales:"31.2",Quantity:"3",Discount:"0.2",Profit:"9.75"},{"Row ID":"866","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"OFF-LA-10004272",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 482",Sales:"2.89",Quantity:"1",Discount:"0",Profit:"1.3583"},{"Row ID":"867","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"FUR-FU-10000965",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 11-1/2" Diameter Ridgewood Wall Clock',Sales:"51.94",Quantity:"1",Discount:"0",Profit:"21.2954"},{"Row ID":"717","Order ID":"CA-2015-130092","Order Date":"2015/1/11","Ship Date":"2015/1/14","Ship Mode":"First Class","Customer ID":"SV-20365","Customer Name":"Seth Vernon",Segment:"Consumer",Country:"United States",City:"Dover",State:"Delaware","Postal Code":"19901",Region:"East","Product ID":"FUR-FU-10000010",Category:"Furniture","Sub-Category":"Furnishings","Product Name":"DAX Value U-Channel Document Frames, Easel Back",Sales:"9.94",Quantity:"2",Discount:"0",Profit:"3.0814"},{"Row ID":"764","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001990",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Staple envelope",Sales:"11.36",Quantity:"2",Discount:"0",Profit:"5.3392"},{"Row ID":"765","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001532",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Brown Kraft Recycled Envelopes",Sales:"50.94",Quantity:"3",Discount:"0",Profit:"25.47"},{"Row ID":"766","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"TEC-AC-10003174",Category:"Technology","Sub-Category":"Accessories","Product Name":"Plantronics S12 Corded Telephone Headset System",Sales:"646.74",Quantity:"6",Discount:"0",Profit:"258.696"},{"Row ID":"767","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-BI-10004187",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"3-ring staple pack",Sales:"5.64",Quantity:"3",Discount:"0",Profit:"2.7072"},{"Row ID":"768","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-ST-10000025",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Fellowes Stor/Drawer Steel Plus Storage Drawers",Sales:"572.58",Quantity:"6",Discount:"0",Profit:"34.3548"},{"Row ID":"2979","Order ID":"CA-2015-109232","Order Date":"2015/1/13","Ship Date":"2015/1/16","Ship Mode":"Second Class","Customer ID":"ND-18370","Customer Name":"Natalie DeCherney",Segment:"Consumer",Country:"United States",City:"Mount Pleasant",State:"South Carolina","Postal Code":"29464",Region:"South","Product ID":"FUR-CH-10000422",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Highback Leather Tilter in Burgundy",Sales:"545.94",Quantity:"6",Discount:"0",Profit:"87.3504"},{"Row ID":"4938","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-ST-10000078",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Tennsco 6- and 18-Compartment Lockers",Sales:"1325.85",Quantity:"5",Discount:"0",Profit:"238.653"},{"Row ID":"4939","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"FUR-BO-10003034",Category:"Furniture","Sub-Category":"Bookcases","Product Name":"O'Sullivan Elevations Bookcase, Cherry Finish",Sales:"333.999",Quantity:"3",Discount:"0.15",Profit:"3.9294"},{"Row ID":"4940","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-AR-10003514",Category:"Office Supplies","Sub-Category":"Art","Product Name":"4009 Highlighters by Sanford",Sales:"19.9",Quantity:"5",Discount:"0",Profit:"6.567"}],Wi=[{bloggerId:1,bloggerName:"Virtual Anchor Xiaohua",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",introduction:"Hi everyone, I am Xiaohua, the virtual host. I am a little fairy who likes games, animation and food. I hope to share happy moments with you through live broadcast.",fansCount:400,worksCount:10,viewCount:5,city:"Dream City",tags:["game","anime","food"]},{bloggerId:2,bloggerName:"Virtual anchor little wolf",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",introduction:"Hello everyone, I am the virtual anchor Little Wolf. I like music, travel and photography, and I hope to explore the beauty of the world with you through live broadcast.",fansCount:800,worksCount:20,viewCount:15,city:"City of Music",tags:["music","travel","photography"]},{bloggerId:3,bloggerName:"Virtual anchor bunny",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",introduction:"Hello everyone, I am the virtual anchor Xiaotu. I like painting, handicrafts and beauty makeup. I hope to share creativity and fashion with you through live broadcast.",fansCount:600,worksCount:15,viewCount:10,city:"City of Art",tags:["painting","handmade","beauty makeup"]},{bloggerId:4,bloggerName:"Virtual anchor kitten",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",introduction:"Hello everyone, I am the virtual host Kitty. I am a lazy cat who likes dancing, fitness and cooking. I hope to live a healthy and happy life with everyone through the live broadcast.",fansCount:1e3,worksCount:30,viewCount:20,city:"Health City",tags:["dance","fitness","cooking"]},{bloggerId:5,bloggerName:"Virtual anchor Bear",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",introduction:"Hello everyone, I am the virtual host Xiaoxiong. A little wise man who likes movies, reading and philosophy, I hope to explore the meaning of life with you through live broadcast.",fansCount:1200,worksCount:25,viewCount:18,city:"City of Wisdom",tags:["Movie","Literature"]},{bloggerId:6,bloggerName:"Virtual anchor bird",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",introduction:"Hello everyone, I am the virtual anchor Xiaoniao. I like singing, acting and variety shows. I hope to be happy with everyone through the live broadcast.",fansCount:900,worksCount:12,viewCount:8,city:"Happy City",tags:["music","performance","variety"]}],Ui=[{dimensionKey:"Region",title:"Region",headerStyle:{textStick:!0}},"Category"],qi=[{dimensionKey:"Order Year",title:"Order Year",headerStyle:{textStick:!0}},"Ship Mode"],Gi=[{indicatorKey:"Quantity",title:"Quantity",width:"auto",cellType:"chart",chartModule:"vchart",chartSpec:{stack:!0,type:"bar",data:{id:"data",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},xField:["Sub-Category"],yField:"Quantity",seriesField:"Segment-Indicator",axes:[{orient:"left",visible:!0,label:{visible:!0}},{orient:"bottom",visible:!0}],bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}},scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}},{indicatorKey:"Sales",title:"Sales & Profit",cellType:"chart",chartModule:"vchart",chartSpec:{type:"common",series:[{type:"bar",data:{id:"data1",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!0,xField:["Sub-Category"],yField:"Sales",seriesField:"Segment-Indicator",bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}}},{type:"line",data:{id:"data2",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Phones","Accessories","Machines","Copiers"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!1,xField:["Sub-Category"],yField:"Profit",seriesField:"Segment-Indicator",line:{state:{selected:{lineWidth:3},selected_reverse:{lineWidth:1}}},point:{state:{selected:{fill:"yellow"},selected_reverse:{fill:"#ddd"}}}}],scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}}];function Ct(I){return I.flatMap(e=>Array.isArray(e.children)?Ct(e.children):e)}function Ln(I){return I.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function Nt(I){const e={};for(const t in I)if(I.hasOwnProperty(t)){const n=Ln(t);e[n]=I[t]}return e}function Qi(I,e){return I.startsWith("on")&&Bt(e[I])}function $i(I,e,t){const n={Group:ji,Image:zi,Text:Vi,Tag:ki,Radio:Ri,CheckBox:Ii};function r(s){var o,d;if(!s)return null;const{type:a,children:u}=s,h=Nt(s.props),c=(a==null?void 0:a.symbol)||(a==null?void 0:a.name),f=n[c];if(!f)return null;const C=new f(Object.assign({},h));l(C,h);const T=i(u);if(dt(h==null?void 0:h.vue)){const{element:g}=h.vue,p=g??T[0];return Object.assign(s.props.vue,{element:dn(p)?p:null,container:e?(o=t==null?void 0:t.table)===null||o===void 0?void 0:o.headerDomContainer:(d=t==null?void 0:t.table)===null||d===void 0?void 0:d.bodyDomContainer}),C}return T.forEach(g=>{const p=r(g);p?C.add(p):g.type===Symbol.for("v-fgt")&&g.children.forEach(w=>{const m=r(w);m&&C.add(m)})}),C}function i(s){var o;return((o=s==null?void 0:s.default)===null||o===void 0?void 0:o.call(s))||s||[]}function l(s,o){Object.keys(o).forEach(d=>{if(Qi(d,o)){let a;d.startsWith("on")?a=d.slice(2).toLowerCase():a=Ln(d.slice(2)).toLowerCase(),s.addEventListener(a,o[d])}})}return{rootComponent:r(I)}}function ln(I,e){return t=>{const{table:n,row:r,col:i,rect:l}=t,s=n.getCellOriginRecord(i,r),{height:o,width:d}=l??n.getCellRect(i,r),a=e?"headerCustomLayout":"customLayout";if(!I[a])return null;const u=I[a]({table:n,row:r,col:i,rect:l,record:s,height:o,width:d})[0],{rootComponent:h}=$i(u,e,t);return{rootContainer:h,renderDefault:!1}}}class Ji{constructor(){this.tableContainer=null,this.currentValue=null,this.wrapContainer=null,this.nodeMap=new Map}registerNode(e,t,n){!x(e)||!x(t)||typeof n!="function"||(this.nodeMap.has(e)||this.nodeMap.set(e,new Map),this.nodeMap.get(e).set(t,n))}getNode(e,t){var n;return(n=this.nodeMap.get(e))===null||n===void 0?void 0:n.get(t)}removeNode(e){this.nodeMap.delete(e)}release(e){x(e)?this.removeNode(e):this.nodeMap.clear()}onStart(e){return Tt(this,void 0,void 0,function*(){const{value:t}=e;this.setValue(t),yield this.createElement(e)})}createElement(e){var t,n;return Tt(this,void 0,void 0,function*(){const{row:r,col:i,value:l,table:s,container:o,referencePosition:d}=e;if(!o)return!1;const a=s.getBodyColumnDefine(i,r),{editConfig:u}=a||{},{id:h}=s,c=this.getColumnKeyField(a);if(!x(c)||!x(h))return!1;if(typeof(u==null?void 0:u.editBefore)=="function"&&!(yield u.editBefore(e)))return s.showTooltip(i,r,{content:u.disablePrompt||"This field is not allowed to be edited",referencePosition:{rect:d==null?void 0:d.rect,placement:Yt.top},style:{bgColor:"black",color:"white",arrowMark:!0},disappearDelay:1e3}),!1;const f=(n=(t=this.getNode(h,c))===null||t===void 0?void 0:t({row:r,col:i,value:l,table:s,onChange:g=>this.setValue(g)}))===null||n===void 0?void 0:n[0];if(!f||!dn(f))return!1;const C=document.createElement("div");C.style.position="absolute",C.style.width="100%",C.style.boxSizing="border-box";const{bgColor:T}=s.getCellStyle(i,r)||{};return C.style.backgroundColor=T||"#FFFFFF",this.wrapContainer=C,this.tableContainer=o,this.tableContainer.appendChild(C),lt(f,C),d!=null&&d.rect&&this.adjustPosition(d.rect),!0})}getColumnKeyField(e){const{field:t,key:n}=e||{};return x(n)?n:t}getValue(){return this.currentValue}setValue(e){this.currentValue=e}adjustPosition(e){this.wrapContainer&&(this.wrapContainer.style.top=`${e.top}px`,this.wrapContainer.style.left=`${e.left}px`,this.wrapContainer.style.width=`${e.width}px`,this.wrapContainer.style.height=`${e.height}px`)}validateValue(e,t,n,r){return Tt(this,void 0,void 0,function*(){const{col:i,row:l}=n||{};if(!x(i)||!x(l))return!0;const s=r.getBodyColumnDefine(i,l),{editConfig:o}=s||{};if(typeof(o==null?void 0:o.validateValue)=="function"){const d=yield o.validateValue({col:i,row:l,value:e,oldValue:t,table:r});if(d===!1){const a=r.getVisibleCellRangeRelativeRect({col:i,row:l});return r.showTooltip(i,l,{content:o.invalidPrompt||"invalid",referencePosition:{rect:a,placement:Yt.top},style:{bgColor:"red",color:"white",arrowMark:!0},disappearDelay:1e3}),!1}return d}return!0})}onEnd(){this.wrapContainer&&this.tableContainer&&(lt(null,this.wrapContainer),this.tableContainer.removeChild(this.wrapContainer)),this.wrapContainer=null,this.tableContainer=null}isEditorElement(e){var t;return((t=this.wrapContainer)===null||t===void 0?void 0:t.contains(e))||this.isClickEditorElement(e)}isClickEditorElement(e){for(;e;){if(e.classList&&e.classList.contains("table-editor-element"))return!0;e=e.parentNode}return!1}}const Lt="dynamic-render-editor";function xn(I,e){const{editor:t}=I||{},n=An(I);return!x(n)||t!==Lt?!1:typeof e=="function"?(I.getEditCustomNode=e,!0):typeof I.getEditCustomNode=="function"}function An(I){const{field:e,key:t}=I||{};return x(t)?t:e}function bt(I){let e=Zt(Lt);return!e&&I&&(e=new Ji,Zt(Lt,e)),e}function Mn(I){const e={columns:[],columnHeaderTitle:[],rows:[],rowHeaderTitle:[],indicators:[],corner:{},tooltip:{},menu:{}},t={PivotColumnDimension:"columns",PivotColumnHeaderTitle:"columnHeaderTitle",PivotRowDimension:"rows",PivotRowHeaderTitle:"rowHeaderTitle",PivotCorner:"corner",PivotIndicator:"indicators",Tooltip:"tooltip",Menu:"menu"};return I.forEach(n=>{var r,i;n.props=Nt(n.props);const l=((r=n.type)===null||r===void 0?void 0:r.symbol)||((i=n.type)===null||i===void 0?void 0:i.name),s=t[l];s&&(Array.isArray(e[s])?n.props.hasOwnProperty("objectHandler")?e[s].push(n.props.objectHandler):e[s].push(n.props):e[s]=n.props)}),e}function Xi(I){const e={columns:[],tooltip:{},menu:{}},t={ListColumn:"columns",Tooltip:"tooltip",Menu:"menu"};return I.forEach(n=>{var r,i;n.props=Nt(n.props);const l=((r=n.type)===null||r===void 0?void 0:r.symbol)||((i=n.type)===null||i===void 0?void 0:i.name),s=t[l];s&&(s==="columns"&&n.children&&(n.children.customLayout&&(n.props.customLayout=ln(n.children)),n.children.headerCustomLayout&&(n.props.headerCustomLayout=ln(n.children,!0)),xn(n.props,n.children.edit)),Array.isArray(e[s])?e[s].push(n.props):e[s]=n.props)}),e}function zt(I,e){return Object.assign(Object.assign({},I),{columns:e.columns&&e.columns.length?e.columns:I.columns,columnHeaderTitle:e.columnHeaderTitle&&e.columnHeaderTitle.length?e.columnHeaderTitle:I.columnHeaderTitle,rows:e.rows&&e.rows.length?e.rows:I.rows,rowHeaderTitle:e.rowHeaderTitle&&e.rowHeaderTitle.length?e.rowHeaderTitle:I.rowHeaderTitle,indicators:e.indicators&&e.indicators.length?e.indicators:I.indicators,corner:Object.keys(I.corner||{}).length?I.corner:e.corner,tooltip:Object.keys(e.tooltip||{}).length?e.tooltip:I.tooltip,menu:Object.keys(e.menu||{}).length?e.menu:I.menu})}const W=Object.assign(Object.assign(Object.assign({},It.EVENT_TYPE),Dt.EVENT_TYPE),Ft.EVENT_TYPE),Kn={onClickCell:W.CLICK_CELL,onDblClickCell:W.DBLCLICK_CELL,onMouseDownCell:W.MOUSEDOWN_CELL,onMouseUpCell:W.MOUSEUP_CELL,onSelectedCell:W.SELECTED_CELL,onKeyDown:W.KEYDOWN,onMouseEnterTable:W.MOUSEENTER_TABLE,onMouseLeaveTable:W.MOUSELEAVE_TABLE,onMouseDownTable:W.MOUSEDOWN_TABLE,onMouseMoveCell:W.MOUSEMOVE_CELL,onMouseEnterCell:W.MOUSEENTER_CELL,onMouseLeaveCell:W.MOUSELEAVE_CELL,onContextMenuCell:W.CONTEXTMENU_CELL,onResizeColumn:W.RESIZE_COLUMN,onResizeColumnEnd:W.RESIZE_COLUMN_END,onChangeHeaderPosition:W.CHANGE_HEADER_POSITION,onChangeHeaderPositionStart:W.CHANGE_HEADER_POSITION_START,onChangeHeaderPositionFail:W.CHANGE_HEADER_POSITION_FAIL,onSortClick:W.SORT_CLICK,onFreezeClick:W.FREEZE_CLICK,onScroll:W.SCROLL,onDropdownMenuClick:W.DROPDOWN_MENU_CLICK,onMouseOverChartSymbol:W.MOUSEOVER_CHART_SYMBOL,onDragSelectEnd:W.DRAG_SELECT_END,onDropdownIconClick:W.DROPDOWN_ICON_CLICK,onDropdownMenuClear:W.DROPDOWN_MENU_CLEAR,onTreeHierarchyStateChange:W.TREE_HIERARCHY_STATE_CHANGE,onShowMenu:W.SHOW_MENU,onHideMenu:W.HIDE_MENU,onIconClick:W.ICON_CLICK,onLegendItemClick:W.LEGEND_ITEM_CLICK,onLegendItemHover:W.LEGEND_ITEM_HOVER,onLegendItemUnHover:W.LEGEND_ITEM_UNHOVER,onLegendChange:W.LEGEND_CHANGE,onMouseEnterAxis:W.MOUSEENTER_AXIS,onMouseLeaveAxis:W.MOUSELEAVE_AXIS,onCheckboxStateChange:W.CHECKBOX_STATE_CHANGE,onRadioStateChange:W.RADIO_STATE_CHANGE,onAfterRender:W.AFTER_RENDER,onInitialized:W.INITIALIZED,onPivotSortClick:W.PIVOT_SORT_CLICK,onDrillMenuClick:W.DRILLMENU_CLICK,onVChartEventType:W.VCHART_EVENT_TYPE,onChangeCellValue:W.CHANGE_CELL_VALUE,onMousedownFillHandle:W.MOUSEDOWN_FILL_HANDLE,onDragFillHandleEnd:W.DRAG_FILL_HANDLE_END,onDblclickFillHandle:W.DBLCLICK_FILL_HANDLE,onScrollVerticalEnd:W.SCROLL_VERTICAL_END,onScrollHorizontalEnd:W.SCROLL_HORIZONTAL_END,onChangCellValue:W.CHANGE_CELL_VALUE},on=Object.keys(Kn);function Yi(I,e){const t=Le(()=>{var l;const s=(l=I.options)===null||l===void 0?void 0:l.columns;return Ee(s)?s.filter(o=>!!dt(o)&&!!xn(o)):[]});an(()=>{n()}),un(()=>{r()});function n(){const l=i();if(!x(l))return;let s=bt();s?s.removeNode(l):t.value.length>0&&(s=bt(!0)),t.value.forEach(o=>{const{getEditCustomNode:d}=o,a=An(o);s.registerNode(l,a,d),delete o.editCustomNode})}function r(){const l=i();if(!x(l))return;const s=bt();s==null||s.release(l)}function i(){var l;return(l=e.value)===null||l===void 0?void 0:l.id}}class Zi extends Ai{constructor(){super(...arguments),this.renderQueue=new Set,this.isRendering=!1}renderGraphicHTML(e){this.checkNeedRender(e)&&(this.renderQueue.add(e),this.scheduleRender())}scheduleRender(){this.isRendering||(this.isRendering=!0,requestAnimationFrame(()=>{this.renderQueue.forEach(e=>{try{this.doRenderGraphic(e)}catch{const{id:n}=this.getGraphicOptions(e)||{};this.removeElement(n,!0)}}),this.renderQueue.clear(),this.isRendering=!1}))}doRenderGraphic(e){var t;const{id:n,options:r}=this.getGraphicOptions(e),i=e.stage,{element:l,container:s}=r,o=s&&er(e);let d=(t=this.htmlMap)===null||t===void 0?void 0:t[n];if(d&&o&&o!==d.container&&(this.removeElement(n),d=null),!d||!this.checkDom(d.wrapContainer)){const{wrapContainer:a,nativeContainer:u}=this.getWrapContainer(i,o,{id:n,options:r});a&&(lt(l,a),d={wrapContainer:a,nativeContainer:u,container:o,renderId:this.renderId,graphic:e,isInViewport:!0,lastPosition:null,lastStyle:{}},this.htmlMap[n]=d)}else lt(l,d.wrapContainer);d&&(this.updateStyleOfWrapContainer(e,i,d.wrapContainer,d.nativeContainer),d.renderId=this.renderId)}getGraphicOptions(e){var t;const{vue:n}=e.attribute;return n?{id:Rt(n.id)?`${(t=e.id)!==null&&t!==void 0?t:e._uid}_vue`:n.id,options:n}:null}checkNeedRender(e){const{id:t,options:n}=this.getGraphicOptions(e)||{};if(!t||!e.stage)return!1;const{element:i}=n;return i?this.checkInViewport(e):!1}checkInViewport(e){const{stage:t,globalAABBBounds:n}=e;if(!t)return!1;const r=100,{AABBBounds:i}=t,l={x1:i.x1-r,x2:i.x2+r,y1:i.y1-r,y2:i.y2+r};return n.x1<l.x2&&n.x2>l.x1&&n.y1<l.y2&&n.y2>l.y1}checkDom(e){return e?document.contains(e):!1}removeAllDom(e){this.htmlMap&&(Object.keys(this.htmlMap).forEach(t=>{this.removeElement(t,!0)}),this.htmlMap=null)}removeElement(e,t){var n;const r=(n=this.htmlMap)===null||n===void 0?void 0:n[e];if(!r)return;const{wrapContainer:i}=r;i&&(lt(null,i),t?(this.checkDom(i)&&super.removeElement(e),delete this.htmlMap[e]):(i.remove(),r.isInViewport=!1),this.removeWrapContainerEventListener(i))}getWrapContainer(e,t,n){var r;let i;t?i=typeof t=="string"?xe.global.getElementById(t):t:i=e.window.getContainer();const{id:l}=n||{},s=(r=this.htmlMap)===null||r===void 0?void 0:r[l];if(s&&!s.isInViewport){const{wrapContainer:o}=s;return this.checkDom(o)||i.appendChild(o),{wrapContainer:o,nativeContainer:i}}return{wrapContainer:xe.global.createDom({tagName:"div",parent:i}),nativeContainer:i}}updateStyleOfWrapContainer(e,t,n,r){const{attribute:i,type:l}=e,s=i||{},{vue:o,width:d,height:a,visible:u,display:h}=s,c=en(s,["vue","width","height","visible","display"]),{x:f,y:C}=this.calculatePosition(e,o.anchorType),{left:T,top:g}=this.calculateOffset(t,r,f,C),{id:p}=this.getGraphicOptions(e)||{},w=p?this.htmlMap[p]:null;if(!w||!(!w.lastPosition||w.lastPosition.x!==T||w.lastPosition.y!==g))return;const{pointerEvents:H=!0,penetrateEventList:_=["wheel"]}=o,P=this.parseDefaultStyleFromGraphic(e),b=this.convertCellStyle(e);Object.assign(P,Object.assign(Object.assign(Object.assign({overflow:"hidden"},b||{}),c||{}),{transform:`translate(${T}px, ${g}px)`,boxSizing:"border-box",display:u!==!1?h||"block":"none",pointerEvents:H===!0?"all":H||"none",position:"absolute"})),P.pointerEvents!=="none"&&(this.removeWrapContainerEventListener(n),Fi(_).forEach(R=>{R==="wheel"&&(n.addEventListener("wheel",this.onWheel),n.addEventListener("wheel",v=>v.preventDefault(),!0))})),l==="text"&&o.anchorType==="position"&&Object.assign(P,this.getTransformOfText(e)),this.applyUserStyles(o,P,{offsetX:T,offsetTop:g,graphic:e,wrapContainer:n}),!Li(w.lastStyle,P)&&(xe.global.updateDom(n,{width:d,height:a,style:P}),w.lastStyle=P)}convertCellStyle(e){var t;const{col:n,row:r,stage:i}=En(e),l=(t=i==null?void 0:i.table)===null||t===void 0?void 0:t.getCellStyle(n,r);if(!dt(l))return;const s=l,{lineHeight:o,padding:d}=s,a=en(s,["lineHeight","padding"]);return Object.assign(Object.assign({},a),{padding:Ee(d)?d.map(u=>`${u}px`).join(" "):d})}calculatePosition(e,t){const n=e.globalAABBBounds;if(t==="position"||n.empty()){const r=e.globalTransMatrix;return{x:r.e,y:r.f}}return cn(n,t||"top-left")}calculateOffset(e,t,n,r){const i=xe.global.getElementTopLeft(t,!1),l=e.window.getTopLeft(!1);return{left:n+l.left-i.left,top:r+l.top-i.top}}applyUserStyles(e,t,n){if(Bt(e.style)){const r=e.style({top:n.offsetTop,left:n.offsetX,width:n.graphic.globalAABBBounds.width(),height:n.graphic.globalAABBBounds.height()},n.graphic,n.wrapContainer);Object.assign(t,r)}else dt(e.style)?Object.assign(t,e.style):Dn(e.style)&&Object.assign(t,Fn(e.style))}}function er(I){var e;const{col:t,row:n,stage:r}=En(I);let i=(e=I.attribute.vue)===null||e===void 0?void 0:e.container;const{table:l}=r;return i===l.bodyDomContainer?t<l.frozenColCount&&n>=l.rowCount-l.bottomFrozenRowCount?i=l.bottomFrozenBodyDomContainer:t>=l.colCount-l.rightFrozenColCount&&n>=l.rowCount-l.bottomFrozenRowCount?i=l.rightFrozenBottomDomContainer:n>=l.rowCount-l.bottomFrozenRowCount?i=l.bottomFrozenBodyDomContainer:t<l.frozenColCount?i=l.frozenBodyDomContainer:t>=l.colCount-l.rightFrozenColCount&&(i=l.rightFrozenBodyDomContainer):i===l.headerDomContainer&&(t<l.frozenColCount?i=l.frozenHeaderDomContainer:t>=l.colCount-l.rightFrozenColCount&&(i=l.rightFrozenHeaderDomContainer)),i}function En(I){for(;I!=null&&I.parent;){if(I.name==="custom-container")return I;I=I.parent}return{col:-1,row:-1,stage:null}}function tr(I,e){an(()=>{var t,n;!((n=(t=I==null?void 0:I.options)===null||t===void 0?void 0:t.customConfig)===null||n===void 0)&&n.createReactContainer&&e.value&&e.value.scenegraph.stage.pluginService.register(new Zi)})}var Vt=at({__name:"base-table",props:{type:{type:String,required:!1},options:{type:null,required:!1},records:{type:Array,required:!1},width:{type:[Number,String],required:!1,default:"100%"},height:{type:[Number,String],required:!1,default:"100%"},onReady:{type:Function,required:!1},onError:{type:Function,required:!1},keepColumnWidthChange:{type:Boolean,required:!1},onClickCell:{type:null,required:!1},onDblClickCell:{type:null,required:!1},onMouseDownCell:{type:null,required:!1},onMouseUpCell:{type:null,required:!1},onSelectedCell:{type:null,required:!1},onKeyDown:{type:null,required:!1},onMouseEnterTable:{type:null,required:!1},onMouseLeaveTable:{type:null,required:!1},onMouseDownTable:{type:null,required:!1},onMouseMoveCell:{type:null,required:!1},onMouseEnterCell:{type:null,required:!1},onMouseLeaveCell:{type:null,required:!1},onContextMenuCell:{type:null,required:!1},onResizeColumn:{type:null,required:!1},onResizeColumnEnd:{type:null,required:!1},onChangeHeaderPosition:{type:null,required:!1},onChangeHeaderPositionStart:{type:null,required:!1},onChangeHeaderPositionFail:{type:null,required:!1},onSortClick:{type:null,required:!1},onFreezeClick:{type:null,required:!1},onScroll:{type:null,required:!1},onDropdownMenuClick:{type:null,required:!1},onMouseOverChartSymbol:{type:null,required:!1},onDragSelectEnd:{type:null,required:!1},onDropdownIconClick:{type:null,required:!1},onDropdownMenuClear:{type:null,required:!1},onTreeHierarchyStateChange:{type:null,required:!1},onShowMenu:{type:null,required:!1},onHideMenu:{type:null,required:!1},onIconClick:{type:null,required:!1},onLegendItemClick:{type:null,required:!1},onLegendItemHover:{type:null,required:!1},onLegendItemUnHover:{type:null,required:!1},onLegendChange:{type:null,required:!1},onMouseEnterAxis:{type:null,required:!1},onMouseLeaveAxis:{type:null,required:!1},onCheckboxStateChange:{type:null,required:!1},onRadioStateChange:{type:null,required:!1},onAfterRender:{type:null,required:!1},onInitialized:{type:null,required:!1},onPivotSortClick:{type:null,required:!1},onDrillMenuClick:{type:null,required:!1},onVChartEventType:{type:null,required:!1},onChangeCellValue:{type:null,required:!1},onMousedownFillHandle:{type:null,required:!1},onDragFillHandleEnd:{type:null,required:!1},onDblclickFillHandle:{type:null,required:!1},onScrollVerticalEnd:{type:null,required:!1},onScrollHorizontalEnd:{type:null,required:!1}},emits:on,setup(I,{expose:e,emit:t}){const n=I,r=we(null),i=Mt(null),l=we(new Map),s=we([]),o=we([]);Yi(n,i),tr(n,i),e({vTableInstance:i});const d=Le(()=>typeof n.width=="number"?`${n.width}px`:n.width),a=Le(()=>typeof n.height=="number"?`${n.height}px`:n.height),u=t,h=g=>{on.forEach(p=>{const w=m=>{u(p,m)};g.on(Kn[p],w)})},c=(g,p)=>{const w=new g(r.value,p);i.value=w,l.value.clear(),s.value=[],o.value=[],w.on("resize_column_end",m=>{if(!n.keepColumnWidthChange)return;const{col:H,colWidths:_}=m,P=_[H];if(w.isPivotTable()){const b=w.getCellHeaderPaths(H,w.columnHeaderLevelCount);let y=null;b.cellLocation==="rowHeader"?y=b.rowHeaderPaths:y=b.colHeaderPaths;let R=!1;for(let v=0;v<s.value.length;v++){const S=s.value[v];JSON.stringify(S.dimensions)===JSON.stringify(y)&&(S.width=P,R=!0)}R||s.value.push({dimensions:y,width:P})}else{const b=w.getBodyColumnDefine(H,0);b!=null&&b.key&&l.value.set(b.key,P)}})},f=()=>{var g,p;if(!r.value)return;i.value&&i.value.release();const w=()=>n.records!==void 0&&n.records!==null&&n.records.length>0?n.records:n.options.records;try{switch(n.type){case"list":c(It,Object.assign(Object.assign({},n.options),{records:w()}));break;case"pivot":c(Dt,Object.assign(Object.assign({},n.options),{records:w()}));break;case"chart":c(Ft,Object.assign(Object.assign({},n.options),{records:w()}));break}h(i.value),(g=n.onReady)===null||g===void 0||g.call(n,i.value,!0)}catch(m){(p=n.onError)===null||p===void 0||p.call(n,m)}},C=g=>{var p;if(i.value)try{if(n.keepColumnWidthChange){const w=T(l.value,s.value,i.value);g=Object.assign(Object.assign({},g),{columnWidthConfig:w,columnWidthConfigForRowHeader:w})}switch(n.type){case"list":i.value instanceof It&&i.value.updateOption(g);break;case"pivot":i.value instanceof Dt&&i.value.updateOption(g);break;case"chart":i.value instanceof Ft&&i.value.updateOption(g);break}}catch(w){(p=n.onError)===null||p===void 0||p.call(n,w)}};hn(f),un(()=>{var g;(g=i.value)===null||g===void 0||g.release()}),kt(()=>n.options,(g,p)=>{i.value?C(g):f()}),kt(()=>n.records,(g,p)=>{i.value?C(Object.assign(Object.assign({},n.options),{records:g})):f()},{deep:!0});function T(g,p,w){if(w.isPivotTable())return p;const m=[];return g.forEach((H,_)=>{m.push({key:_,width:H})}),m}return(g,p)=>(Ke(),ke("div",{ref_key:"vTableContainer",ref:r,style:st([{width:d.value,height:a.value},{position:"relative"}])},null,4))}}),Pt=at({__name:"list-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(I,{expose:e}){const t=I,n=we(null),r=Kt(),i=Le(()=>{var l;const s=Ct(((l=r.default)===null||l===void 0?void 0:l.call(r))||[]),o=Xi(s);return zt(t.options,o)});return e({vTableInstance:Le(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(Ke(),ke(tt,null,[B(Vt,Ot({type:"list",options:i.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Et(l.$slots,"default")],64))}}),nr=at({__name:"pivot-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(I,{expose:e}){const t=I,n=Mt(null),r=Kt(),i=Le(()=>{var l;const s=Ct(((l=r.default)===null||l===void 0?void 0:l.call(r))||[]),o=Mn(s);return zt(t.options,o)});return e({vTableInstance:Le(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(Ke(),ke(tt,null,[B(Vt,Ot({type:"pivot",options:i.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Et(l.$slots,"default")],64))}}),ir=at({__name:"pivot-chart",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(I,{expose:e}){const t=I,n=Mt(null),r=Kt(),i=Le(()=>{var l;const s=Ct(((l=r.default)===null||l===void 0?void 0:l.call(r))||[]),o=Mn(s);return zt(t.options,o)});return e({vTableInstance:Le(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(Ke(),ke(tt,null,[B(Vt,Ot({type:"chart",options:i.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Et(l.$slots,"default")],64))}});const rr=(I,e)=>{Di(I,e)};function Z(I){return null}Z.symbol="ListColumn";function On(I){return null}On.symbol="PivotColumnDimension";function Bn(I){return null}Bn.symbol="PivotRowDimension";function Nn(I){return null}Nn.symbol="PivotIndicator";function zn(I){return null}zn.symbol="PivotCorner";function Vn(I){return null}Vn.symbol="Menu";function et(){return null}et.symbol="Group";function xt(){return null}xt.symbol="Image";function At(){return null}At.symbol="Text";function kn(I){return null}kn.symbol="Tag";const sr={class:"h-full"},Hr=at({__name:"vtable",setup(I){rr("vchart",qn);const e=["#3370ff","#34c724","#ff9f1a","#ff4050","#1f2329"],t=Wn(),n=we(null),r=Le(()=>({theme:t.darkMode?it:rt})),i=we(sn),l=we(null),s=Le(()=>({groupBy:["Category","Sub-Category"],theme:(t.darkMode?it:rt).extends({groupTitleStyle:{fontWeight:"bold",bgColor:P=>{const{col:b,row:y,table:R}=P,v=R.getGroupTitleLevel(b,y);return v!==void 0?e[v%e.length]:"white"}}})})),o=we(sn),d=we(null),a=Le(()=>({tooltip:{isShowOverflowTextTooltip:!0},dataConfig:{sortRules:[{sortField:"Category",sortBy:["Office Supplies","Technology","Furniture"]}]},widthMode:"standard",theme:t.darkMode?it:rt,emptyTip:{text:"no data records"}})),u=we([{indicatorKey:"Quantity",title:"Quantity",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},style:{padding:[16,28,16,28],color(_){return _.dataValue>=0?"black":"red"}}},{indicatorKey:"Sales",title:"Sales",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:_=>`$${Number(_).toFixed(2)}`,style:{padding:[16,28,16,28],color(_){return _.dataValue>=0?"black":"red"}}},{indicatorKey:"Profit",title:"Profit",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:_=>`$${Number(_).toFixed(2)}`,style:{padding:[16,28,16,28],color(_){return _.dataValue>=0?"black":"red"}}}]),h=we([{dimensionKey:"City",title:"City",headerStyle:{textStick:!0},width:"auto"}]),c=we([]),f=we(null),C=Le(()=>({rows:qi,columns:Ui,indicators:Gi,indicatorsAsCol:!1,defaultRowHeight:200,defaultHeaderRowHeight:50,defaultColWidth:280,defaultHeaderColWidth:100,indicatorTitle:"指标",autoWrapText:!0,corner:{titleOnDimension:"row",headerStyle:{autoWrapText:!0}},legends:{orient:"bottom",type:"discrete",data:[{label:"Consumer-Quantity",shape:{fill:"#2E62F1",symbolType:"circle"}},{label:"Consumer-Quantity",shape:{fill:"#4DC36A",symbolType:"square"}},{label:"Home Office-Quantity",shape:{fill:"#FF8406",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#FFCC00",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#4F44CF",symbolType:"square"}},{label:"Home Office-Sales",shape:{fill:"#5AC8FA",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#003A8C",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#B08AE2",symbolType:"square"}},{label:"Home Office-Profit",shape:{fill:"#FF6341",symbolType:"square"}}]},theme:(t.darkMode?it:rt).extends({bodyStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1]},headerStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:"#CCE0FF"}},rowHeaderStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:"#CCE0FF"}},cornerHeaderStyle:{borderColor:"gray",borderLineWidth:[0,1,1,0],hover:{cellBgColor:""}},cornerRightTopCellStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:""}},cornerLeftBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:""}},cornerRightBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1],hover:{cellBgColor:""}},rightFrozenStyle:{borderColor:"gray",borderLineWidth:[1,0,1,1],hover:{cellBgColor:""}},bottomFrozenStyle:{borderColor:"gray",borderLineWidth:[1,1,0,1],hover:{cellBgColor:""}},selectionStyle:{cellBgColor:"",cellBorderColor:""},frameStyle:{borderLineWidth:0}}),emptyTip:{text:"no data records"}})),T=we({});function g(_){var P;(P=f==null?void 0:f.value)==null||P.vTableInstance.updateFilterRules([{filterKey:"Segment-Indicator",filteredValues:_.value}])}const p=we(null),w=Le(()=>({defaultRowHeight:80,theme:t.darkMode?it:rt})),m=we(Wi),H=we({fontFamily:"Arial",fontSize:12,fontWeight:"bold"});return hn(()=>{fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_data.json").then(_=>_.json()).then(_=>{c.value=_}),fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_Chart_data.json").then(_=>_.json()).then(_=>{T.value=_})}),(_,P)=>{const b=Un,y=jn,R=xi;return Ke(),ke("div",sr,[B(R,{vertical:"",size:16},{default:He(()=>[B(b,{title:"List Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(M(Pt),{ref_key:"listTableRef",ref:n,options:M(r),records:M(i),height:"400px"},{default:He(()=>[B(M(Z),{field:"Order ID",title:"Order ID",width:"auto"}),B(M(Z),{field:"Customer ID",title:"Customer ID",width:"auto"}),B(M(Z),{field:"Product Name",title:"Product Name",width:"auto"}),B(M(Z),{field:"Category",title:"Category",width:"auto"}),B(M(Z),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),B(M(Z),{field:"Region",title:"Region",width:"auto"}),B(M(Z),{field:"City",title:"City",width:"auto"}),B(M(Z),{field:"Order Date",title:"Order Date",width:"auto"}),B(M(Z),{field:"Quantity",title:"Quantity",width:"auto"}),B(M(Z),{field:"Sales",title:"Sales",width:"auto"}),B(M(Z),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),B(b,{title:"Group Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(M(Pt),{ref_key:"groupTableRef",ref:l,options:M(s),records:M(o),height:"400px"},{default:He(()=>[B(M(Z),{field:"Order ID",title:"Order ID",width:"auto"}),B(M(Z),{field:"Customer ID",title:"Customer ID",width:"auto"}),B(M(Z),{field:"Product Name",title:"Product Name",width:"auto"}),B(M(Z),{field:"Category",title:"Category",width:"auto"}),B(M(Z),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),B(M(Z),{field:"Region",title:"Region",width:"auto"}),B(M(Z),{field:"City",title:"City",width:"auto"}),B(M(Z),{field:"Order Date",title:"Order Date",width:"auto"}),B(M(Z),{field:"Quantity",title:"Quantity",width:"auto"}),B(M(Z),{field:"Sales",title:"Sales",width:"auto"}),B(M(Z),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),B(b,{title:"Pivot Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(M(nr),{ref_key:"pivotTableRef",ref:d,options:M(a),records:M(c),height:"400px"},{default:He(()=>[B(M(On),{title:"Category","dimension-key":"Category","header-style":{textStick:!0},width:"auto"}),(Ke(!0),ke(tt,null,pt(M(h),(v,S)=>(Ke(),mt(M(Bn),{key:S,"dimension-key":v.dimensionKey,title:v.title,"header-style":v.headerStyle,width:v.width},null,8,["dimension-key","title","header-style","width"]))),128)),(Ke(!0),ke(tt,null,pt(M(u),(v,S)=>(Ke(),mt(M(Nn),{key:S,"indicator-key":v.indicatorKey,title:v.title,width:v.width,"show-sort":v.showSort,"header-style":v.headerStyle,format:v.format,style:st(v.style)},null,8,["indicator-key","title","width","show-sort","header-style","format","style"]))),128)),B(M(zn),{"title-on-dimension":"row"}),B(M(Vn),{"menu-type":"html","context-menu-items":["copy","paste","delete","..."]})]),_:1},8,["options","records"])]),_:1}),B(b,{title:"Pivot Chart",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(M(ir),{ref_key:"pivotChartRef",ref:f,options:M(C),records:M(T),height:"800px",onOnLegendItemClick:g},null,8,["options","records"])]),_:1}),B(b,{title:"Custom Component",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(M(Pt),{ref_key:"customLayoutListTableRef",ref:p,options:M(w),records:M(m),height:"400px"},{default:He(()=>[B(M(Z),{field:"bloggerId",title:"Order Number",width:"100"}),B(M(Z),{field:"bloggerName",title:"Anchor Nickname",width:330},{customLayout:He(({record:v,height:S,width:A})=>[B(M(et),{height:S,width:A,display:"flex","flex-direction":"row","flex-wrap":"nowrap"},{default:He(()=>[B(M(et),{height:S,width:60,display:"flex","flex-direction":"column","align-items":"center","justify-content":"space-around",fill:"red",opacity:.1},{default:He(()=>[B(M(xt),{id:"icon0",width:50,height:50,image:v.bloggerAvatar,"corner-radius":25},null,8,["image"])]),_:2},1032,["height"]),B(M(et),{height:S,width:A-60,display:"flex","flex-direction":"column","flex-wrap":"nowrap"},{default:He(()=>[B(M(et),{height:S/2,width:A-60,display:"flex","flex-wrap":"wrap","align-items":"center",fill:"orange",opacity:.1},{default:He(()=>[B(M(At),{text:v.bloggerName,"font-size":13,"font-family":"sans-serif",fill:"black","bounds-padding":[0,0,0,10]},null,8,["text"]),B(M(xt),{id:"location",image:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/location.svg",width:15,height:15,"bounds-padding":[0,0,0,10],cursor:"pointer"}),B(M(At),{text:v.city,"font-size":11,"font-family":"sans-serif",fill:"#6f7070"},null,8,["text"])]),_:2},1032,["height","width"]),B(M(et),{height:S/2,width:A-60,display:"flex","align-items":"center",fill:"yellow",opacity:.1},{default:He(()=>[(Ke(!0),ke(tt,null,pt(v==null?void 0:v.tags,F=>(Ke(),mt(M(kn),{key:F,text:F,"text-style":{fontSize:10,fontFamily:"sans-serif",fill:"rgb(51, 101, 238)"},panel:{visible:!0,fill:"#f4f4f2",cornerRadius:5},space:5,"bounds-padding":[0,0,0,5]},null,8,["text"]))),128))]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:1}),B(M(Z),{field:"fansCount",title:"Fans Count",width:"120","field-format":v=>`${v.fansCount}w`,style:st(M(H))},null,8,["field-format","style"]),B(M(Z),{field:"worksCount",title:"Works Count",style:st(M(H)),width:"135"},null,8,["style"]),B(M(Z),{field:"viewCount",title:"View Count",width:"120","field-format":v=>`${v.viewCount}w`,style:st(M(H))},null,8,["field-format","style"])]),_:1},8,["options","records"])]),_:1}),B(b,{bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:He(()=>[B(y,{label:"More VTable Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1})]),_:1})])}}});export{Hr as default};
