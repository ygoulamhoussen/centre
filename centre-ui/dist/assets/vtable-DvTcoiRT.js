import{_ as ii}from"./web-site-link.vue_vue_type_script_setup_true_lang-DLgvku9w.js";import{d as ni,j as si,cZ as Ee,a5 as ai,P as ri,Q as li,c as oi,k as Ge,l as je,b8 as di,e as Bt,o as hi}from"./index-D_-DzWhp.js";import{G as W,c as J,a as Ke,S as At,T as he,I as Ve,b as ci,C as Wt,L as ui,i as pi,B as gi,d as fi,e as _i,P as bi,f as mi,v as Pe,g as ki,h as yi,j as Si,D as Xe,k as It,l as Li}from"./index-Cu1hC02A.js";import{i as G}from"./linear-scale-E30nU8tb.js";import{_ as vi}from"./Space-CoVGbzuR.js";import"./get-C9XpniJp.js";import"./isSymbol-DUeTwM-o.js";import"./index-k_YsQNhl.js";import"./get-slot-Bk_rJcZu.js";const Ti=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-15",progress:31,priority:"P0",children:[{id:2,title:"Project Feature Review",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-07-24",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-25",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Project Create",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Develop feature 1",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-15",progress:0,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-01",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-01",progress:90,priority:"P0"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.26",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-18",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-23",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-14",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-04",end:"2024-08-04",progress:90,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/24/2024",end:"08/04/2024",progress:60,priority:"P0"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]}],xi=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-15",end:"2024-07-16",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-17",progress:60,priority:"P0"},{id:3,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-18",end:"2024-07-19",progress:90,priority:"P0"},{id:4,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/17",end:"2024/07/18",progress:100,priority:"P1"},{id:5,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/19/2024",end:"07/20/2024",progress:60,priority:"P0"},{id:6,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:7,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:8,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:9,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/09",end:"2024/07/11",progress:100,priority:"P1"},{id:10,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:11,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:12,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:13,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-09",end:"2024-07-11",progress:100,priority:"P1"}],Bi=[{id:1,title:"Project Task 1",developer:"bear.xiong",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",start:"2024-07-24",end:"2024-07-26",progress:31,priority:"P0"},{id:2,title:"Project Task 2",developer:"wolf.lang",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",start:"07/25/2024",end:"07/28/2024",progress:60,priority:"P0"},{id:3,title:"Project Task 3",developer:"rabbit.tu",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",start:"2024-07-28",end:"2024-08-01",progress:100,priority:"P1"},{id:1,title:"Project Task 4",developer:"cat.mao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",start:"2024-07-31",end:"2024-08-03",progress:31,priority:"P0"},{id:2,title:"Project Task 5",developer:"bird.niao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",start:"2024-08-02",end:"2024-08-04",progress:60,priority:"P0"},{id:3,title:"Project Task 6",developer:"flower.hua",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",start:"2024-08-03",end:"2024-08-10",progress:100,priority:"P1"}];class jt{constructor(e){this.editorType="Input",this.editorConfig=e}createElement(){var e;const t=document.createElement("input");t.setAttribute("type","text"),!((e=this.editorConfig)===null||e===void 0)&&e.readonly&&t.setAttribute("readonly",`${this.editorConfig.readonly}`),t.style.position="absolute",t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",t.style.backgroundColor="#FFFFFF",this.element=t,this.container.appendChild(t),t.addEventListener("keydown",i=>{i.key==="a"&&(i.ctrlKey||i.metaKey)&&i.stopPropagation()}),t.addEventListener("wheel",i=>{i.preventDefault()})}setValue(e){this.element.value=e!==void 0?e:""}getValue(){return this.element.value}onStart({value:e,referencePosition:t,container:i,endEdit:s}){this.container=i,this.successCallback=s,this.element||(this.createElement(),e!=null&&this.setValue(e),t!=null&&t.rect&&this.adjustPosition(t.rect)),this.element.focus()}adjustPosition(e){this.element.style.top=e.top+"px",this.element.style.left=e.left+"px",this.element.style.width=e.width+"px",this.element.style.height=e.height+"px"}endEditing(){}onEnd(){var e;!((e=this.container)===null||e===void 0)&&e.contains(this.element)&&this.container.removeChild(this.element),this.element=void 0}isEditorElement(e){return e===this.element}validateValue(e,t,i,s){return!0}}class wi extends jt{constructor(e){super(e),this.editorType="DateInput",this.editorConfig=e}createElement(){const e=document.createElement("input");e.setAttribute("type","date"),e.style.padding="4px",e.style.width="100%",e.style.boxSizing="border-box",e.style.position="absolute",e.style.backgroundColor="#FFFFFF",this.element=e,this.container.appendChild(e),e.addEventListener("keydown",t=>{t.key==="a"&&(t.ctrlKey||t.metaKey)&&t.stopPropagation()}),e.addEventListener("wheel",t=>{t.preventDefault()})}}var R;(function(n){n.default="default",n.grabing="grabing",n.scrolling="scrolling"})(R||(R={}));var U;(function(n){n.FinishToStart="finish_to_start",n.StartToStart="start_to_start",n.FinishToFinish="finish_to_finish",n.StartToFinish="start_to_finish"})(U||(U={}));var T;(function(n){n.Tasks_Separate="tasks_separate",n.Sub_Tasks_Inline="sub_tasks_inline",n.Sub_Tasks_Separate="sub_tasks_separate",n.Sub_Tasks_Arrange="sub_tasks_arrange",n.Sub_Tasks_Compact="sub_tasks_compact"})(T||(T={}));const I={SCROLL:"scroll",CHANGE_DATE_RANGE:"change_date_range",CLICK_TASK_BAR:"click_task_bar",CONTEXTMENU_TASK_BAR:"contextmenu_task_bar",MOUSEENTER_TASK_BAR:"mouseenter_task_bar",MOUSELEAVE_TASK_BAR:"mouseleave_task_bar",CREATE_TASK_SCHEDULE:"create_task_schedule",CREATE_DEPENDENCY_LINK:"create_dependency_link",DELETE_DEPENDENCY_LINK:"delete_dependency_link",CLICK_DEPENDENCY_LINK_POINT:"click_dependency_link_point",CONTEXTMENU_DEPENDENCY_LINK:"contextmenu_dependency_link",CLICK_MARKLINE_CREATE:"click_markline_create",CLICK_MARKLINE_CONTENT:"click_markline_content"},Dt={barColor:"blue",completedBarColor:"gray",width:30,cornerRadius:3,borderWidth:0,fontFamily:"Arial",fontSize:14};function Oi(n){Dt.width=n}const Ci=typeof window>"u"||window.window===void 0,Di=864e5;function Fe(n,e){const t=n+e.stateManager.scroll.horizontalBarPos,i=e.getDateColWidth(0);return Math.floor((t-i)/e.parsedOptions.timelineColWidth)+1}function Mt(n){var e,t,i,s,a;return n?n===!0?[{date:j().toLocaleDateString(),scrollToMarkLine:!0,position:"left",style:{lineColor:"red",lineWidth:1}}]:Array.isArray(n)?n.map((r,o)=>{var l,h,d,u;return Object.assign(Object.assign({},r),{date:r.date,scrollToMarkLine:r.scrollToMarkLine,position:(l=r.position)!==null&&l!==void 0?l:"left",style:{lineColor:((h=r.style)===null||h===void 0?void 0:h.lineColor)||"red",lineWidth:((d=r.style)===null||d===void 0?void 0:d.lineWidth)||1,lineDash:(u=r.style)===null||u===void 0?void 0:u.lineDash}})}):[Object.assign(Object.assign({},n),{date:n.date,scrollToMarkLine:(e=n.scrollToMarkLine)===null||e===void 0||e,position:(t=n.position)!==null&&t!==void 0?t:"left",style:{lineColor:((i=n.style)===null||i===void 0?void 0:i.lineColor)||"red",lineWidth:((s=n.style)===null||s===void 0?void 0:s.lineWidth)||1,lineDash:(a=n.style)===null||a===void 0?void 0:a.lineDash}})]:[]}function Mi(n){var e;return n!=null&&n.hoverOn||n!=null&&n.horizontalVisible&&(n==null?void 0:n.horizontalVisible)==="none"||!(n!=null&&n.horizontalVisible)&&(n==null?void 0:n.visible)==="none"?0:(e=n==null?void 0:n.width)!==null&&e!==void 0?e:7}function Hi(n){var e;return n!=null&&n.hoverOn||n!=null&&n.verticalVisible&&(n==null?void 0:n.verticalVisible)==="none"||!(n!=null&&n.verticalVisible)&&(n==null?void 0:n.visible)==="none"?0:(e=n==null?void 0:n.width)!==null&&e!==void 0?e:7}function zt(n){var e,t,i,s,a,r,o,l,h,d,u,p,c,g,_,y,k,f,b,L,S,v,x,C,w,O,B,D,H,N,X,P,z,Y,K,V,q,Z,Q,le,oe,ne,ee,ue,pe,ge,fe,_e,be,me,ke,ye,Se,Le,ve,Te,xe,Be,we,Oe,Ce,De,Me,He,Ae,We,M,Ne,A,$,de,te,ze,tt,it,nt,st,at,rt,lt,ot,dt,ht,ct,ut,pt,gt,ft,_t,bt,mt,kt,yt,St,Lt,vt,Tt;const m=n.options;n.parsedOptions.tasksShowMode=(e=m==null?void 0:m.tasksShowMode)!==null&&e!==void 0?e:T.Tasks_Separate,n.parsedOptions.pixelRatio=(t=m==null?void 0:m.pixelRatio)!==null&&t!==void 0?t:1,n.parsedOptions.rowHeight=(i=m==null?void 0:m.rowHeight)!==null&&i!==void 0?i:40,n.parsedOptions.timelineColWidth=(a=(s=m==null?void 0:m.timelineHeader)===null||s===void 0?void 0:s.colWidth)!==null&&a!==void 0?a:60,n.parsedOptions.startDateField=(o=(r=m.taskBar)===null||r===void 0?void 0:r.startDateField)!==null&&o!==void 0?o:"startDate",n.parsedOptions.endDateField=(h=(l=m.taskBar)===null||l===void 0?void 0:l.endDateField)!==null&&h!==void 0?h:"endDate",n.parsedOptions.progressField=(u=(d=m.taskBar)===null||d===void 0?void 0:d.progressField)!==null&&u!==void 0?u:"progress";const{unit:xt,startOfWeek:Ht,step:ei}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=m!=null&&m.minDate?Ie(new Date(m.minDate),xt,Ht):void 0,n.parsedOptions.maxDate=m!=null&&m.maxDate?Ue(n.parsedOptions.minDate,new Date(m.maxDate),xt,ei):void 0,n.parsedOptions._minDateTime=(p=n.parsedOptions.minDate)===null||p===void 0?void 0:p.getTime(),n.parsedOptions._maxDateTime=(c=n.parsedOptions.maxDate)===null||c===void 0?void 0:c.getTime(),n.parsedOptions.overscrollBehavior=(g=m==null?void 0:m.overscrollBehavior)!==null&&g!==void 0?g:"auto",n.parsedOptions.underlayBackgroundColor=(_=m==null?void 0:m.underlayBackgroundColor)!==null&&_!==void 0?_:"#FFF",n.parsedOptions.scrollStyle=Object.assign({},{scrollRailColor:"rgba(100, 100, 100, 0.2)",scrollSliderColor:"rgba(100, 100, 100, 0.5)",scrollSliderCornerRadius:4,width:10,visible:"always",hoverOn:!0,barToSide:!1},m==null?void 0:m.scrollStyle),n.parsedOptions.timelineHeaderHorizontalLineStyle=(y=m==null?void 0:m.timelineHeader)===null||y===void 0?void 0:y.horizontalLine,n.parsedOptions.timelineHeaderVerticalLineStyle=(k=m==null?void 0:m.timelineHeader)===null||k===void 0?void 0:k.verticalLine,n.parsedOptions.timelineHeaderBackgroundColor=(f=m==null?void 0:m.timelineHeader)===null||f===void 0?void 0:f.backgroundColor,n.parsedOptions.timeLineHeaderRowHeights=[],n.parsedOptions.timelineHeaderStyles=[];for(let se=0;(b=se<n.parsedOptions.sortedTimelineScales.length)!==null&&b!==void 0&&b;se++){const ti=n.parsedOptions.sortedTimelineScales[se].style;n.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},ti)),n.parsedOptions.timeLineHeaderRowHeights.push((S=(L=n.parsedOptions.sortedTimelineScales[se].rowHeight)!==null&&L!==void 0?L:m==null?void 0:m.headerRowHeight)!==null&&S!==void 0?S:40)}n.parsedOptions.grid=Object.assign({},m==null?void 0:m.grid),Oi(3*n.parsedOptions.rowHeight/4),n.parsedOptions.taskBarStyle=!((v=m==null?void 0:m.taskBar)===null||v===void 0)&&v.barStyle&&typeof((x=m==null?void 0:m.taskBar)===null||x===void 0?void 0:x.barStyle)=="function"?m.taskBar.barStyle:Object.assign({},Dt,(C=m==null?void 0:m.taskBar)===null||C===void 0?void 0:C.barStyle),n.parsedOptions.taskBarMilestoneStyle=Object.assign(typeof n.parsedOptions.taskBarStyle=="function"?{}:{width:n.parsedOptions.taskBarStyle.width,borderColor:n.parsedOptions.taskBarStyle.borderColor,borderLineWidth:(w=n.parsedOptions.taskBarStyle.borderLineWidth)!==null&&w!==void 0?w:1,fillColor:n.parsedOptions.taskBarStyle.barColor,cornerRadius:0},(O=m==null?void 0:m.taskBar)===null||O===void 0?void 0:O.milestoneStyle),n.parsedOptions.taskBarMilestoneHypotenuse=n.parsedOptions.taskBarMilestoneStyle.width*Math.sqrt(2),n.parsedOptions.dateFormat=m==null?void 0:m.dateFormat,n.parsedOptions.taskBarHoverStyle=Object.assign({barOverlayColor:"rgba(99, 144, 0, 0.4)"},(B=m==null?void 0:m.taskBar)===null||B===void 0?void 0:B.hoverBarStyle),n.parsedOptions.taskBarSelectable=(H=(D=m==null?void 0:m.taskBar)===null||D===void 0?void 0:D.selectable)===null||H===void 0||H,n.parsedOptions.taskBarSelectedStyle=Object.assign(typeof n.parsedOptions.taskBarStyle=="function"?{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,borderLineWidth:1}:{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:n.parsedOptions.taskBarStyle.barColor,borderColor:n.parsedOptions.taskBarStyle.barColor,borderLineWidth:1},(N=m==null?void 0:m.taskBar)===null||N===void 0?void 0:N.selectedBarStyle),n.parsedOptions.taskBarLabelText=(P=(X=m==null?void 0:m.taskBar)===null||X===void 0?void 0:X.labelText)!==null&&P!==void 0?P:"",n.parsedOptions.taskBarMoveable=(Y=(z=m==null?void 0:m.taskBar)===null||z===void 0?void 0:z.moveable)===null||Y===void 0||Y,n.parsedOptions.moveTaskBarToExtendDateRange=(V=(K=m==null?void 0:m.taskBar)===null||K===void 0?void 0:K.moveToExtendDateRange)===null||V===void 0||V,n.parsedOptions.taskBarResizable=(Z=(q=m==null?void 0:m.taskBar)===null||q===void 0?void 0:q.resizable)===null||Z===void 0||Z,n.parsedOptions.taskBarDragOrder=(le=(Q=m==null?void 0:m.taskBar)===null||Q===void 0?void 0:Q.dragOrder)===null||le===void 0||le,n.parsedOptions.taskBarLabelStyle={fontFamily:(ee=(ne=(oe=m==null?void 0:m.taskBar)===null||oe===void 0?void 0:oe.labelTextStyle)===null||ne===void 0?void 0:ne.fontFamily)!==null&&ee!==void 0?ee:"Arial",fontSize:(ge=(pe=(ue=m==null?void 0:m.taskBar)===null||ue===void 0?void 0:ue.labelTextStyle)===null||pe===void 0?void 0:pe.fontSize)!==null&&ge!==void 0?ge:20,color:(be=(_e=(fe=m==null?void 0:m.taskBar)===null||fe===void 0?void 0:fe.labelTextStyle)===null||_e===void 0?void 0:_e.color)!==null&&be!==void 0?be:"#F01",textAlign:(ye=(ke=(me=m==null?void 0:m.taskBar)===null||me===void 0?void 0:me.labelTextStyle)===null||ke===void 0?void 0:ke.textAlign)!==null&&ye!==void 0?ye:"left",textBaseline:(ve=(Le=(Se=m==null?void 0:m.taskBar)===null||Se===void 0?void 0:Se.labelTextStyle)===null||Le===void 0?void 0:Le.textBaseline)!==null&&ve!==void 0?ve:"middle",padding:(Be=(xe=(Te=m==null?void 0:m.taskBar)===null||Te===void 0?void 0:Te.labelTextStyle)===null||xe===void 0?void 0:xe.padding)!==null&&Be!==void 0?Be:[0,0,0,10],textOverflow:(Oe=(we=m==null?void 0:m.taskBar)===null||we===void 0?void 0:we.labelTextStyle)===null||Oe===void 0?void 0:Oe.textOverflow},n.parsedOptions.taskBarCustomLayout=(Ce=m==null?void 0:m.taskBar)===null||Ce===void 0?void 0:Ce.customLayout,n.parsedOptions.taskBarCreatable=(Me=(De=m==null?void 0:m.taskBar)===null||De===void 0?void 0:De.scheduleCreatable)!==null&&Me!==void 0?Me:!(n.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&n.parsedOptions.tasksShowMode!==T.Tasks_Separate),n.parsedOptions.taskBarCreationButtonStyle=Object.assign({lineColor:"rgb(99, 144, 0)",lineWidth:1,lineDash:[5,5],cornerRadius:4,backgroundColor:"#FFF"},(Ae=(He=m==null?void 0:m.taskBar)===null||He===void 0?void 0:He.scheduleCreation)===null||Ae===void 0?void 0:Ae.buttonStyle),n.parsedOptions.taskBarCreationCustomLayout=(M=(We=m==null?void 0:m.taskBar)===null||We===void 0?void 0:We.scheduleCreation)===null||M===void 0?void 0:M.customLayout,n.parsedOptions.taskBarCreationMaxWidth=(A=(Ne=m==null?void 0:m.taskBar)===null||Ne===void 0?void 0:Ne.scheduleCreation)===null||A===void 0?void 0:A.maxWidth,n.parsedOptions.taskBarCreationMinWidth=(de=($=m==null?void 0:m.taskBar)===null||$===void 0?void 0:$.scheduleCreation)===null||de===void 0?void 0:de.minWidth,n.parsedOptions.outerFrameStyle=Object.assign({borderColor:"#e1e4e8",borderLineWidth:1,cornerRadius:4},(te=m.frame)===null||te===void 0?void 0:te.outerFrameStyle),n.parsedOptions.markLine=Mt(m==null?void 0:m.markLine),(tt=(ze=n.parsedOptions.markLine)===null||ze===void 0?void 0:ze.length)!==null&&tt!==void 0&&tt&&(!((it=n.parsedOptions.markLine)===null||it===void 0)&&it.every(se=>se.scrollToMarkLine===void 0)&&(n.parsedOptions.markLine[0].scrollToMarkLine=!0),!((nt=n.parsedOptions.markLine)===null||nt===void 0)&&nt.find(se=>se.scrollToMarkLine)&&(n.parsedOptions.scrollToMarkLineDate=Ie(new Date((st=n.parsedOptions.markLine)===null||st===void 0?void 0:st.find(se=>se.scrollToMarkLine).date),xt,Ht))),n.parsedOptions.verticalSplitLineHighlight=(at=m.frame)===null||at===void 0?void 0:at.verticalSplitLineHighlight,n.parsedOptions.verticalSplitLine=Object.assign({lineColor:(rt=n.parsedOptions.outerFrameStyle)===null||rt===void 0?void 0:rt.borderColor,lineWidth:(lt=n.parsedOptions.outerFrameStyle)===null||lt===void 0?void 0:lt.borderLineWidth},(ot=m.frame)===null||ot===void 0?void 0:ot.verticalSplitLine),n.parsedOptions.horizontalSplitLine=(dt=m.frame)===null||dt===void 0?void 0:dt.horizontalSplitLine,n.parsedOptions.verticalSplitLineMoveable=(ht=m.frame)===null||ht===void 0?void 0:ht.verticalSplitLineMoveable,n.parsedOptions.taskKeyField=(ct=m.taskKeyField)!==null&&ct!==void 0?ct:"id",n.parsedOptions.dependencyLinks=(pt=(ut=m.dependency)===null||ut===void 0?void 0:ut.links)!==null&&pt!==void 0?pt:[],n.parsedOptions.dependencyLinkCreatable=(ft=(gt=m.dependency)===null||gt===void 0?void 0:gt.linkCreatable)!==null&&ft!==void 0&&ft,n.parsedOptions.dependencyLinkSelectable=(bt=(_t=m.dependency)===null||_t===void 0?void 0:_t.linkSelectable)===null||bt===void 0||bt,n.parsedOptions.dependencyLinkDeletable=(kt=(mt=m.dependency)===null||mt===void 0?void 0:mt.linkDeletable)!==null&&kt!==void 0&&kt,n.parsedOptions.dependencyLinkLineStyle=Object.assign({lineColor:"red",lineWidth:1},(yt=m.dependency)===null||yt===void 0?void 0:yt.linkLineStyle),n.parsedOptions.dependencyLinkSelectedLineStyle=Object.assign({shadowBlur:4,shadowOffset:0,shadowColor:n.parsedOptions.dependencyLinkLineStyle.lineColor,lineColor:n.parsedOptions.dependencyLinkLineStyle.lineColor,lineWidth:n.parsedOptions.dependencyLinkLineStyle.lineWidth},(St=m==null?void 0:m.dependency)===null||St===void 0?void 0:St.linkSelectedLineStyle),n.parsedOptions.dependencyLinkLineCreatePointStyle=Object.assign({strokeColor:"red",fillColor:"white",radius:5,strokeWidth:1},(Lt=m==null?void 0:m.dependency)===null||Lt===void 0?void 0:Lt.linkCreatePointStyle),n.parsedOptions.dependencyLinkLineCreatingPointStyle=Object.assign({strokeColor:"red",fillColor:"red",radius:5,strokeWidth:1},(vt=m==null?void 0:m.dependency)===null||vt===void 0?void 0:vt.linkCreatingPointStyle),n.parsedOptions.dependencyLinkLineCreatingStyle=Object.assign({lineColor:"red",lineWidth:1,lineDash:[5,5]},(Tt=m==null?void 0:m.dependency)===null||Tt===void 0?void 0:Tt.linkCreatingLineStyle),n.parsedOptions.eventOptions=m==null?void 0:m.eventOptions,n.parsedOptions.keyboardOptions=m==null?void 0:m.keyboardOptions,n.parsedOptions.markLineCreateOptions=m==null?void 0:m.markLineCreateOptions}function Ai(n){var e,t,i,s,a;const r=n.options,{unit:o,startOfWeek:l,step:h}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=Ie(new Date(n.parsedOptions.minDate),o,l),n.parsedOptions.maxDate=Ue(n.parsedOptions.minDate,new Date(n.parsedOptions.maxDate),o,h),n.parsedOptions._minDateTime=(e=n.parsedOptions.minDate)===null||e===void 0?void 0:e.getTime(),n.parsedOptions._maxDateTime=(t=n.parsedOptions.maxDate)===null||t===void 0?void 0:t.getTime(),n.parsedOptions.timeLineHeaderRowHeights=[],n.parsedOptions.timelineHeaderStyles=[];for(let d=0;(i=d<n.parsedOptions.sortedTimelineScales.length)!==null&&i!==void 0&&i;d++){const u=n.parsedOptions.sortedTimelineScales[d].style;n.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},u)),n.parsedOptions.timeLineHeaderRowHeights.push((a=(s=n.parsedOptions.sortedTimelineScales[d].rowHeight)!==null&&s!==void 0?s:r==null?void 0:r.headerRowHeight)!==null&&a!==void 0?a:40)}}function Wi(n,e,t){var i;const{unit:s,step:a,format:r}=t,o=[];for(;n<e;)if(s==="day"){const l=n.getFullYear(),h=n.getMonth(),d=n.getDate(),u=ce(new Date(l,h,d+a-1),!0);u.getTime()>e.getTime()&&u.setTime(e.getTime());const p=n,c=(r==null?void 0:r({dateIndex:d,startDate:p,endDate:u}))||d.toString(),g={days:Math.abs(u.getTime()-n.getTime()+1)/864e5,startDate:p,endDate:u,step:a,unit:"day",title:c,dateIndex:d};o.push(g),n=new Date(l,h,d+a)}else if(s==="month"){const l=n.getFullYear(),h=n.getMonth(),d=ce(new Date(l,h+a,0),!0);d.getTime()>e.getTime()&&d.setTime(e.getTime());const u=n,p=(r==null?void 0:r({dateIndex:h+1,startDate:u,endDate:d}))||(h+1).toString(),c={days:Math.abs(d.getTime()-n.getTime()+1)/864e5,startDate:u,step:a,unit:"month",endDate:d,title:p,dateIndex:h+1};o.push(c),n=new Date(l,h+a,1)}else if(s==="quarter"){const l=n.getFullYear(),h=Math.floor(n.getMonth()/3),d=ce(new Date(l,3*(h+a),0),!0);d.getTime()>e.getTime()&&d.setTime(e.getTime());const u=n,p=(r==null?void 0:r({dateIndex:h+1,startDate:u,endDate:d}))||(h+1).toString(),c={days:Math.abs(d.getTime()-n.getTime()+1)/864e5,startDate:u,step:a,unit:"quarter",endDate:d,title:p,dateIndex:h+1};o.push(c),n=new Date(l,3*(h+a),1)}else if(s==="year"){const l=n.getFullYear(),h=ce(new Date(l+a-1,11,31),!0);h.getTime()>e.getTime()&&h.setTime(e.getTime());const d=n,u=(r==null?void 0:r({dateIndex:l,startDate:d,endDate:h}))||l.toString(),p={days:Math.abs(h.getTime()-n.getTime()+1)/864e5,startDate:d,endDate:h,step:a,unit:"year",title:u,dateIndex:l};o.push(p),n=new Date(l+a,0,1)}else if(s==="week"){const l=(i=t.startOfWeek)!==null&&i!==void 0?i:"monday";let h=n.getDay();l==="monday"&&(h=h===0?6:h-1);const d=j(n),u=ce(n.getTime()+24*(7*a-h)*60*60*1e3-1,!0);u>e&&u.setTime(e.getTime());const p=Ki(d),c=(r==null?void 0:r({dateIndex:p,startDate:d,endDate:u}))||p.toString(),g={days:(u.getTime()-d.getTime()+1)/864e5,startDate:d,endDate:u,step:a,unit:"week",title:c,dateIndex:p};o.push(g),n.setTime(j(n.getTime()+24*(7*a-h)*60*60*1e3,!0).getTime())}else if(s==="hour"){const l=n.getFullYear(),h=n.getMonth(),d=n.getDate(),u=n.getHours(),p=$i(new Date(l,h,d,u+a-1),!0);p.getTime()>e.getTime()&&p.setTime(e.getTime());const c=n,g=(r==null?void 0:r({dateIndex:u,startDate:c,endDate:p}))||u.toString(),_={days:Math.abs(p.getTime()-n.getTime()+1)/864e5,startDate:c,endDate:p,step:a,unit:"hour",title:g,dateIndex:n.getHours()};o.push(_),n=new Date(l,h,d,u+a)}else if(s==="minute"){const l=n.getFullYear(),h=n.getMonth(),d=n.getDate(),u=n.getHours(),p=n.getMinutes(),c=qi(new Date(l,h,d,u,p+a-1),!0);c.getTime()>e.getTime()&&c.setTime(e.getTime());const g=n,_=(r==null?void 0:r({dateIndex:p,startDate:g,endDate:c}))||p.toString(),y={days:Math.abs(c.getTime()-n.getTime()+1)/864e5,startDate:g,endDate:c,step:a,unit:"minute",title:_,dateIndex:n.getMinutes()};o.push(y),n=new Date(l,h,d,u,p+a)}else if(s==="second"){const l=n.getFullYear(),h=n.getMonth(),d=n.getDate(),u=n.getHours(),p=n.getMinutes(),c=n.getSeconds(),g=Ut(new Date(l,h,d,u,p,c+a-1),!0);g.getTime()>e.getTime()&&g.setTime(e.getTime());const _=n,y=(r==null?void 0:r({dateIndex:c,startDate:_,endDate:g}))||c.toString(),k={days:Math.abs(g.getTime()-n.getTime()+1)/864e5,startDate:_,endDate:g,step:a,unit:"second",title:y,dateIndex:n.getSeconds()};o.push(k),n=new Date(l,h,d,u,p,c+a)}return o}function Je(n,e,t,i,s){var a,r,o,l,h,d,u,p,c;let g=(a=n[3])!==null&&a!==void 0?a:10;e==="right"||e==="end"?g=i-0-((r=n[1])!==null&&r!==void 0?r:10):e==="center"&&(g=0+(i-0+((o=n[3])!==null&&o!==void 0?o:10)-((l=n[1])!==null&&l!==void 0?l:10))/2);let _=0+((h=n[0])!==null&&h!==void 0?h:10);return t==="bottom"||t==="alphabetic"||t==="ideographic"?_=s-0-((d=n[2])!==null&&d!==void 0?d:10):t==="middle"&&(_=0+(s-0-((u=n[0])!==null&&u!==void 0?u:10)-((p=n[2])!==null&&p!==void 0?p:10))/2+((c=n[0])!==null&&c!==void 0?c:10)),{x:g,y:_}}function Ii(n){return typeof n=="string"&&(n=n.replace("%",""),n=parseFloat(n)),Math.round(n)}function zi(n){var e,t;if(n.taskListTableInstance){n.verticalSplitResizeLine=document.createElement("div"),n.verticalSplitResizeLine.style.position="absolute",n.verticalSplitResizeLine.style.top=n.tableY+"px",n.verticalSplitResizeLine.style.left=(n.taskTableWidth?n.taskTableWidth-7+n.parsedOptions.verticalSplitLine.lineWidth/2:0)+"px",n.verticalSplitResizeLine.style.width="14px",n.verticalSplitResizeLine.style.height=n.drawHeight+"px",n.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",n.verticalSplitResizeLine.style.zIndex="100",n.parsedOptions.verticalSplitLineMoveable&&(n.verticalSplitResizeLine.style.cursor="col-resize"),n.verticalSplitResizeLine.style.userSelect="none",n.verticalSplitResizeLine.style.opacity="1";const i=document.createElement("div");if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-n.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=n.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=n.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",n.verticalSplitResizeLine.appendChild(i),n.parsedOptions.verticalSplitLineHighlight){const s=document.createElement("div");s.style.position="absolute",s.style.top="0px",s.style.left=((e=14-n.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",s.style.width=((t=n.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",s.style.height="100%",s.style.backgroundColor=n.parsedOptions.verticalSplitLineHighlight.lineColor,s.style.zIndex="100",s.style.cursor="col-resize",s.style.userSelect="none",s.style.pointerEvents="none",s.style.opacity="0",s.style.transition="background-color 0.3s",n.verticalSplitResizeLine.appendChild(s)}n.container.appendChild(n.verticalSplitResizeLine)}}function Ze(n){var e,t;if(n.verticalSplitResizeLine){n.verticalSplitResizeLine.style.position="absolute",n.verticalSplitResizeLine.style.top=n.tableY+"px",n.verticalSplitResizeLine.style.left=n.taskTableWidth?n.taskTableWidth-7+n.parsedOptions.verticalSplitLine.lineWidth/2+"px":"0px",n.verticalSplitResizeLine.style.width="14px",n.verticalSplitResizeLine.style.height=n.drawHeight+"px",n.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",n.verticalSplitResizeLine.style.zIndex="100",n.parsedOptions.verticalSplitLineMoveable&&(n.verticalSplitResizeLine.style.cursor="col-resize"),n.verticalSplitResizeLine.style.userSelect="none",n.verticalSplitResizeLine.style.opacity="1";const i=n.verticalSplitResizeLine.childNodes[0];if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-n.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=n.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=n.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",n.verticalSplitResizeLine.childNodes[1]){const s=n.verticalSplitResizeLine.childNodes[1];s.style.position="absolute",s.style.top="0px",s.style.left=((e=14-n.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",s.style.width=((t=n.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",s.style.height="100%",s.style.backgroundColor=n.parsedOptions.verticalSplitLineHighlight.lineColor,s.style.zIndex="100",s.style.cursor="col-resize",s.style.userSelect="none",s.style.pointerEvents="none",s.style.opacity="0",s.style.transition="background-color 0.3s"}}}function ae(n,e,t,i="children"){var s;for(let a=0;a<n.length;a++){if(Array.isArray(t)&&t.length===1&&n[a][e]===t[0]||n[a][e]===t)return{record:n[a],index:[a]};if(!((s=n[a][i])===null||s===void 0)&&s.length){if(Array.isArray(t)&&t[0]===n[a][e]){const r=ae(n[a][i],e,t.slice(1));if(r)return r.index.unshift(a),r}else if(!Array.isArray(t)){const r=ae(n[a][i],e,t);if(r)return r.index.unshift(a),r}}}}function Xt(n,e="children"){var t;for(let i=0;i<n.length;i++)!((t=n[i][e])===null||t===void 0)&&t.length?Xt(n[i][e],e):(delete n[i].vtable_gantt_linkedTo,delete n[i].vtable_gantt_linkedFrom)}function Yt(n,e="children"){var t;for(let i=0;i<n.length;i++)!((t=n[i][e])===null||t===void 0)&&t.length?Yt(n[i][e],e):delete n[i].vtable_gantt_showIndex}function ie(n,e){let t,i;if(e.taskListTableInstance){const s=e.taskListTableInstance.getTargetRowAt(n+e.headerHeight);if(s){const{row:a}=s;t=a-e.taskListTableInstance.columnHeaderLevelCount;const r=e.getRowsHeightByIndex(0,t-1);e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate||(i=Math.floor((n-r)/e.parsedOptions.rowHeight))}}else t=Math.floor(n/e.parsedOptions.rowHeight);return{task_index:t,sub_task_index:i}}function Kt(n,e){var t;if(!e.children||e.children.length===1)return((t=e.children)===null||t===void 0?void 0:t.length)===1?e.children[0].vtable_gantt_showIndex=0:e.vtable_gantt_showIndex=0,1;const i=e.children.slice().sort((a,r)=>{const{startDate:o}=Ye(n,a),{startDate:l}=Ye(n,r);return o.getTime()-l.getTime()}),s=[];for(let a=0;a<=i.length-1;a++){const r=i[a],{startDate:o,endDate:l}=Ye(n,r);let h=!1;for(let d=0;d<s.length;d++)if(o.getTime()>s[d]){s[d]=l.getTime(),h=!0,r.vtable_gantt_showIndex=d;break}h||(s.push(l.getTime()),r.vtable_gantt_showIndex=s.length-1)}return s.length}function Ei(n,e,t,i){return t.some(s=>{const{startDate:a,endDate:r}=Ye(i,s);return n<=r&&a<=e})}function Vt(n,e){var t;if(!e.children||e.children.length===1)return((t=e.children)===null||t===void 0?void 0:t.length)===1?e.children[0].vtable_gantt_showIndex=0:e.vtable_gantt_showIndex=0,1;const i=[];for(let s=0;s<=e.children.length-1;s++){const a=e.children[s],{startDate:r,endDate:o}=Ye(n,a);let l=!1;for(let h=0;h<i.length;h++)if(!Ei(r,o,e.children.filter(d=>d!==a&&d.vtable_gantt_showIndex===h),n)){i[h]=o.getTime(),l=!0,a.vtable_gantt_showIndex=h;break}l||(i.push(o.getTime()),a.vtable_gantt_showIndex=i.length-1)}return i.length}function Ye(n,e){const{timeScaleIncludeHour:t,startDateField:i,endDateField:s}=n.parsedOptions,a=e[i],r=e[s];return t?{startDate:j(a),endDate:ce(r)}:{startDate:j(a,!0),endDate:ce(r,!0)}}function Ri(n){var e,t,i,s,a,r;const o=n.options,{unit:l,startOfWeek:h}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.markLine=Mt(o==null?void 0:o.markLine),(t=(e=n.parsedOptions.markLine)===null||e===void 0?void 0:e.length)!==null&&t!==void 0&&t&&(!((i=n.parsedOptions.markLine)===null||i===void 0)&&i.every(d=>d.scrollToMarkLine===void 0)&&(n.parsedOptions.markLine[0].scrollToMarkLine=!0),!((s=n.parsedOptions.markLine)===null||s===void 0)&&s.find(d=>d.scrollToMarkLine)&&(n.parsedOptions.scrollToMarkLineDate=Ie(new Date((a=n.parsedOptions.markLine)===null||a===void 0?void 0:a.find(d=>d.scrollToMarkLine).date),l,h))),n.parsedOptions.dependencyLinks=(r=o.dependency)===null||r===void 0?void 0:r.links}function Pi(n){var e,t;const i=n.options,{unit:s,startOfWeek:a,step:r}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=i!=null&&i.minDate?Ie(new Date(i.minDate),s,a):void 0,n.parsedOptions.maxDate=i!=null&&i.maxDate?Ue(n.parsedOptions.minDate,new Date(i.maxDate),s,r):void 0,n.parsedOptions._minDateTime=(e=n.parsedOptions.minDate)===null||e===void 0?void 0:e.getTime(),n.parsedOptions._maxDateTime=(t=n.parsedOptions.maxDate)===null||t===void 0?void 0:t.getTime()}function wt(n){const e=n.options;n.parsedOptions.markLine=Mt(e==null?void 0:e.markLine)}function Fi(n,e,t){const i=ie(e-t.headerHeight+t.stateManager.scrollTop,t),s=t.getRecordByIndex(i.task_index),a=Fe(n,t),r=t.getDateRangeByIndex(a);if(s!=null&&s.children){const o=ie(e-t.headerHeight+t.stateManager.scrollTop,t);for(let l=0;l<s.children.length;l++){const{startDate:h,endDate:d,taskDays:u,progress:p,taskRecord:c}=t.getTaskInfoByTaskListIndex(o.task_index,l);if(((t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange)&&c.vtable_gantt_showIndex===o.sub_task_index||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline)&&r.startDate.getTime()>=h.getTime()&&r.endDate.getTime()<=d.getTime())return{startDate:h,endDate:d,taskDays:u,progress:p,taskRecord:c}}}}function Et(n,e){return{left:n.globalTransMatrix.e+e.taskListTableInstance.tableNoFrameWidth+e.taskListTableInstance.tableX+e.tableX,top:n.globalTransMatrix.f,width:n.attribute.width,height:n.attribute.height}}function Ni(n,e){const t=n.startDate.getTime(),i=n.endDate.getTime();return e.some(s=>{const a=new Date(s.date).getTime();return a>=t&&a<=i})}function Rt(n,e){let t=null;return function(...i){t||(n.apply(this,i),t=setTimeout(()=>{t=null},e))}}function re(n,e){const t=n.getFullYear().toString(),i=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0");if((e=(e=(e=e.replace("yyyy",t)).replace("mm",i)).replace("dd",s)).length>10){const a=n.getHours().toString().padStart(2,"0"),r=n.getMinutes().toString().padStart(2,"0"),o=n.getSeconds().toString().padStart(2,"0");e=(e=(e=e.replace("hh",a)).replace("mm",r)).replace("ss",o)}return e}function Gi(n,e){const t=e.indexOf("yyyy"),i=e.indexOf("mm"),s=e.indexOf("dd"),a=i<t?i<s?0:1:i<s?1:2,r=s<t?s<i?0:1:s<i?1:2,o=parseInt(n[t<i?t<s?0:1:i<s?1:2],10),l=parseInt(n[a],10)-1,h=parseInt(n[r],10);if(isNaN(o)||o<1||isNaN(l)||l<0||l>11)return!1;const d=[31,Xi(o)?29:28,31,30,31,30,31,31,30,31,30,31];return!(isNaN(h)||h<1||h>d[l])}function ji(n,e){if(e.includes("hh")||e.includes("mm")||e.includes("ss")){const t=e.indexOf("hh")>-1?e.indexOf("hh"):e.indexOf("HH"),i=parseInt(n[t],10),s=parseInt(n[t+1],10),a=n.length>t+2?parseInt(n[t+2],10):0;if(isNaN(i)||i<0||i>23||isNaN(s)||s<0||s>59||isNaN(a)||a<0||a>59)return!1}return!0}function Xi(n){return n%4==0&&n%100!=0||n%400==0}function $e(n){const e=["yyyy-mm-dd","dd-mm-yyyy","mm/dd/yyyy","yyyy/mm/dd","dd/mm/yyyy","yyyy.mm.dd","mm.dd.yyyy","dd.mm.yyyy"],t=["hh:mm:ss","hh:mm"],i=(n=n.trim()).split(" "),s=i[0],a=i[1];let r,o;if(s)for(let l=0;l<e.length;l++){const h=e[l],d=s.split(Ot(h)),u=Gi(d,h);if(d.length===3&&u){r=h;break}}if(r&&a)for(let l=0;l<t.length;l++){const h=t[l],d=a.split(Ot(h)),u=h.split(Ot(h));if(ji(d,h)&&d.length===u.length){o=h;break}}return s&&a&&r&&o?r+" "+o:s&&!a?r:"yyyy-mm-dd hh:mm:ss"}function Ot(n){const e=n.match(/[^\w]/g);if(e){const t=e.map(i=>"\\"+i).join("|");return new RegExp(t,"g")}return/[^\w]/}function Yi(n,e){return n.replace(/\{([^}]+)\}/g,(t,i)=>{const s=i.split(".");let a=e;for(const r of s){if(!a.hasOwnProperty(r)){a=t;break}a=a[r]}return a})}function et(n){return Array.isArray(n)?n.length===3?[n[0],n[1],n[2],n[1]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:[n[0],n[1],n[2],n[3]]:[n,n,n,n]}function Ki(n){const e=new Date(n.getFullYear(),0,1);return Math.ceil(((n.getTime()+1-e.getTime())/864e5+1)/7)}function Vi(n,e="long"){const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=new Date(n);return e==="short"?t[i.getDay()].substr(0,3):e==="long"?t[i.getDay()]:'Invalid format specified. Please use "short" or "long".'}function Ui(n,e){const t=Object.getOwnPropertyDescriptor(n,e);return!!t&&(!!t.set||t.writable===!0)}function j(n,e=!1){let t;if(n){if(t=new Date(n),typeof n=="string"){if(n.length>10)return e&&t.setHours(0,0,0,0),t;t.setHours(0,0,0,0)}}else t=new Date;return e&&t.setHours(0,0,0,0),t}function $i(n,e=!1){let t;if(n){if(t=new Date(n),typeof n=="string"){if(n.length>10)return e&&t.setMinutes(59,59,999),t;t.setMinutes(59,59,999)}}else t=new Date;return e&&t.setMinutes(59,59,999),t}function qi(n,e=!1){let t;if(n){if(t=new Date(n),typeof n=="string"){if(n.length>10)return e&&t.setSeconds(59,999),t;t.setSeconds(59,999)}}else t=new Date;return e&&t.setSeconds(59,999),t}function Ut(n,e=!1){let t;if(n){if(t=new Date(n),typeof n=="string"){if(n.length>10)return e&&t.setMilliseconds(999),t;t.setMilliseconds(999)}}else t=new Date;return e&&t.setMilliseconds(999),t}function ce(n,e=!1){let t;if(n){if(t=new Date(n),typeof n=="string"){if(n.length>10)return e&&t.setHours(23,59,59,999),t;t.setHours(23,59,59,999)}}else t=new Date;return e&&t.setHours(23,59,59,999),t}function Ue(n,e,t,i){let s=new Date(e);switch(t){case"second":s.setMilliseconds(999);break;case"minute":s.setSeconds(59,999);break;case"hour":s.setMinutes(59,59,999);break;case"day":s.setHours(23,59,59,999);break;case"week":const o=6-s.getDay();s.setDate(s.getDate()+o),s.setHours(23,59,59,999);break;case"month":const l=new Date(s.getFullYear(),s.getMonth()+1,0).getDate();s.setDate(l),s.setHours(23,59,59,999);break;case"quarter":const h=s.getMonth(),d=h-h%3+2,u=new Date(s.getFullYear(),d+1,0).getDate();s.setMonth(d,u),s.setHours(23,59,59,999);break;case"year":s.setMonth(11,31),s.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}const a=E(s,n,t,i,1),r=Math.ceil(a);if(r>a){const o=(r-a)*i,l=1e3,h=60*l,d=60*h,u=24*d,p=7*u;switch(new Date(s.getTime()+1),t){case"second":s.setTime(s.getTime()+o*l);break;case"minute":s.setTime(s.getTime()+o*h);break;case"hour":s.setTime(s.getTime()+o*d);break;case"day":s.setTime(s.getTime()+o*u);break;case"week":s.setTime(s.getTime()+o*p);break;case"month":s=new Date(s.getFullYear(),s.getMonth()+1+Math.round(o),0),s.setHours(23,59,59,999);break;case"quarter":const c=s.getMonth(),g=c-c%3+2;s=new Date(s.getFullYear(),g+Math.round(3*o)+1,0),s.setHours(23,59,59,999);break;case"year":s.setFullYear(s.getFullYear()+Math.floor(o)),s.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}}return s}function Ie(n,e,t="monday"){const i=new Date(n);switch(e){case"second":i.setMilliseconds(0);break;case"minute":i.setSeconds(0,0);break;case"hour":i.setMinutes(0,0,0);break;case"day":i.setHours(0,0,0,0);break;case"week":const s=i.getDay();let a=s;a=t==="monday"?s===0?-6:1-s:-s,i.setDate(i.getDate()+a),i.setHours(0,0,0,0);break;case"month":i.setDate(1),i.setHours(0,0,0,0);break;case"quarter":const r=i.getMonth(),o=r-r%3;i.setMonth(o,1),i.setHours(0,0,0,0);break;case"year":i.setMonth(0,1),i.setHours(0,0,0,0);break;default:throw new Error("Invalid time scale")}return i}function E(n,e,t,i,s=0){let a;const r=new Date(n.getTime()+s);switch(t){case"second":a=(r.getTime()-e.getTime())/1e3;break;case"minute":a=(r.getTime()-e.getTime())/6e4;break;case"hour":a=(r.getTime()-e.getTime())/36e5;break;case"day":a=(r.getTime()-e.getTime())/864e5;break;case"week":a=(r.getTime()-e.getTime())/6048e5;break;case"month":a=12*(r.getFullYear()-e.getFullYear())+(r.getMonth()-e.getMonth()),a+=(r.getDate()-e.getDate())/new Date(r.getFullYear(),r.getMonth()+1,0).getDate();break;case"quarter":a=4*(r.getFullYear()-e.getFullYear())+Math.floor(r.getMonth()/3)-Math.floor(e.getMonth()/3),a+=(r.getTime()-e.getTime())/Di/(3*new Date(r.getFullYear(),r.getMonth()+1,0).getDate());break;case"year":a=r.getFullYear()-e.getFullYear(),a+=(r.getMonth()-e.getMonth())/12;break;default:throw new Error("Invalid time scale")}return a/i}class Zi{constructor(e){var t;this._scene=e,this.scrollLeft=0,this.scrollTop=0,this.x=0,this.y=e._gantt.getAllHeaderRowsHeight(),this.width=e.ganttGroup.attribute.width,this.height=e.ganttGroup.attribute.height-e.timelineHeader.group.attribute.height,this.rowHeight=e._gantt.parsedOptions.rowHeight,this.rowCount=e._gantt.itemCount,this.allGridWidth=e._gantt.getAllDateColsWidth(),this.allGridHeight=e._gantt.getAllTaskBarsHeight(),this.group=new W({x:this.x,y:this.y,width:this.width,height:this.height,clip:!0,fill:(t=e._gantt.parsedOptions.grid)===null||t===void 0?void 0:t.backgroundColor}),this.group.name="grid-container",e.ganttGroup.addChild(this.group),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}createTimeLineHeaderBottomLine(){var e,t,i,s,a,r;const o=this._scene._gantt.parsedOptions,l=(t=(e=o.horizontalSplitLine)===null||e===void 0?void 0:e.lineWidth)!==null&&t!==void 0?t:(i=o.timelineHeaderHorizontalLineStyle)===null||i===void 0?void 0:i.lineWidth,h=(1&l?-.5:0)+l/2,d=J({pickable:!1,stroke:(a=(s=o.horizontalSplitLine)===null||s===void 0?void 0:s.lineColor)!==null&&a!==void 0?a:(r=o.timelineHeaderHorizontalLineStyle)===null||r===void 0?void 0:r.lineColor,lineWidth:l+(1&l?1:0),points:[{x:0,y:h},{x:this._scene._gantt.getAllDateColsWidth(),y:h}]});d.name="timeLine-header-bottom-line",this.group.addChild(d)}createVerticalLines(){var e,t;const i=this._scene._gantt.parsedOptions.grid,s=(e=i.verticalLineDependenceOnTimeScale)!==null&&e!==void 0?e:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0].unit;if(i.verticalLine){this.verticalLineGroup=new W({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalLineGroup.name="grid-vertical",this.group.appendChild(this.verticalLineGroup);const a=(t=this._scene._gantt.parsedOptions.reverseSortedTimelineScales.find(d=>d.unit===s))!==null&&t!==void 0?t:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{unit:r,step:o}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{timelineDates:l}=a,h=this._scene._gantt.parsedOptions.timelineColWidth;if(typeof i.verticalLine=="function")for(let d=0;d<(l==null?void 0:l.length)-1;d++){const{endDate:u}=l[d],p=i.verticalLine({index:d,dateIndex:l[d].dateIndex,date:l[d].endDate,ganttInstance:this._scene._gantt}),c=Math.ceil(E(u,this._scene._gantt.parsedOptions.minDate,r,o,1)*h)+(1&p.lineWidth?.5:0),g=J({pickable:!1,stroke:p.lineColor,lineWidth:p.lineWidth,points:[{x:c,y:0},{x:c,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}else{const d=i.verticalLine;for(let u=0;u<(l==null?void 0:l.length)-1;u++){const{endDate:p}=l[u],c=Math.ceil(E(p,this._scene._gantt.parsedOptions.minDate,r,o,1)*h)+(1&d.lineWidth?.5:0),g=J({pickable:!1,stroke:d.lineColor,lineWidth:d.lineWidth,points:[{x:c,y:0},{x:c,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}}}}createHorizontalLines(){const e=this._scene._gantt.parsedOptions.grid;if(e.horizontalLine)if(this.horizontalLineGroup=new W({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalLineGroup.name="grid-horizontal",this.group.appendChild(this.horizontalLineGroup),typeof e.horizontalLine=="function"){let t=.5;for(let i=0;i<this.rowCount-1;i++){const s=e.horizontalLine({index:i,ganttInstance:this._scene._gantt});t+=this._scene._gantt.getRowHeightByIndex(i);const a=J({pickable:!1,stroke:s.lineColor,lineWidth:s.lineWidth,points:[{x:0,y:t},{x:this.allGridWidth,y:t}]});this.horizontalLineGroup.appendChild(a)}}else{const t=e.horizontalLine;let i=0;1&t.lineWidth&&(i+=.5);for(let s=0;s<this.rowCount-1;s++){i+=this._scene._gantt.getRowHeightByIndex(s);const a=J({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,points:[{x:0,y:i},{x:this.allGridWidth,y:i}]});this.horizontalLineGroup.appendChild(a)}}}createVerticalBackgroundRects(){const e=this._scene._gantt.parsedOptions.grid.verticalBackgroundColor,t=this._scene._gantt.parsedOptions.grid.weekendBackgroundColor;if(e||t){this.verticalBackgroundRectsGroup=new W({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalBackgroundRectsGroup.name="grid-vertical-background",this.group.appendChild(this.verticalBackgroundRectsGroup);const{timelineDates:i,unit:s,step:a}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],r=this._scene._gantt.parsedOptions.timelineColWidth;if(e||t)for(let o=0;o<=(i==null?void 0:i.length)-1;o++){let l;if(!t||s!=="day"||a!==1||i[o].startDate.getDay()!==0&&i[o].startDate.getDay()!==6?typeof e=="function"?l=e({index:o,dateIndex:i[o].dateIndex,date:i[o].endDate,ganttInstance:this._scene._gantt}):e&&(l=e[o%e.length]):l=t,l){const h=Math.ceil(r*o),d=Ke({pickable:!1,fill:l,x:h,y:0,width:r,height:this.allGridHeight});this.verticalBackgroundRectsGroup.appendChild(d)}}}}createHorizontalBackgroundRects(){const e=this._scene._gantt.parsedOptions.grid.horizontalBackgroundColor;if(e){this.horizontalBackgroundRectsGroup=new W({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalBackgroundRectsGroup.name="grid-horizontal-background",this.group.appendChild(this.horizontalBackgroundRectsGroup);let t=0;for(let i=0;i<=this.rowCount-1;i++){let s;s=typeof e=="function"?e({index:i,ganttInstance:this._scene._gantt}):e[i%e.length];const a=Ke({pickable:!1,fill:s,x:0,y:t,width:this.allGridWidth,height:this._scene._gantt.getRowHeightByIndex(i)});this.horizontalBackgroundRectsGroup.appendChild(a),t+=this._scene._gantt.getRowHeightByIndex(i)}}}refresh(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttributes({width:this.width,height:this.height,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.rowCount=this._scene._gantt.itemCount,this.allGridWidth=this._scene._gantt.getAllDateColsWidth(),this.allGridHeight=this._scene._gantt.getAllTaskBarsHeight(),this.group.removeAllChild(),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}setX(e){var t,i,s,a;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("x",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("x",e),(s=this.verticalBackgroundRectsGroup)===null||s===void 0||s.setAttribute("x",e),(a=this.horizontalBackgroundRectsGroup)===null||a===void 0||a.setAttribute("x",e)}setY(e){var t,i,s,a;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("y",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("y",e),(s=this.verticalBackgroundRectsGroup)===null||s===void 0||s.setAttribute("y",e),(a=this.horizontalBackgroundRectsGroup)===null||a===void 0||a.setAttribute("y",e)}resize(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}}class F{static get mode(){return F._mode||(F._mode=Qi()),F._mode}static set mode(e){F._mode=e}static RegisterCreateCanvas(e){F.CreateCanvas=e}static RegisterLoadImage(e){F.LoadImage=e}static GetCreateCanvasFunc(){return F.CreateCanvas?F.CreateCanvas:F.mode==="worker"?(e=200,t=200)=>new OffscreenCanvas(e,t):void 0}static RegisterRequestAnimationFrame(e){F.RequestAnimationFrame=e()}static GetRequestAnimationFrame(){if(F.RequestAnimationFrame)return F.RequestAnimationFrame}static RegisterCancelAnimationFrame(e){F.CancelAnimationFrame=e()}static GetCancelAnimationFrame(){if(F.CancelAnimationFrame)return F.CancelAnimationFrame}}function Qi(){let n="browser";try{window.type==="node"?n="node":typeof window>"u"||window.performance?typeof window>"u"&&(n="node"):n="miniApp"}catch{n="node"}return n}F.dpr=0;class Ji{constructor(e){this._gantt=e,this.createScrollBar(e.tableNoFrameWidth,e.tableNoFrameHeight-e.getAllHeaderRowsHeight())}createScrollBar(e,t){var i,s;const a=this._gantt.parsedOptions.scrollStyle.scrollRailColor,r=this._gantt.parsedOptions.scrollStyle.scrollSliderColor,o=this._gantt.parsedOptions.scrollStyle.scrollSliderCornerRadius,l=this._gantt.parsedOptions.scrollStyle.width;let h;h=G(o)?{cornerRadius:o,fill:r}:{fill:r},(i=this._gantt.parsedOptions.scrollStyle)===null||i===void 0||i.visible,(s=this._gantt.parsedOptions.scrollStyle)===null||s===void 0||s.hoverOn,this.hScrollBar=new At({direction:"horizontal",x:2*-e,y:2*-t,width:e,height:l,padding:0,railStyle:{fill:a},sliderStyle:h,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new At({direction:"vertical",x:2*-e,y:2*-t,width:l,height:t,padding:0,railStyle:{fill:a},sliderStyle:h,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}refresh(){}hideVerticalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showVerticalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{this.hideVerticalScrollBar()},1e3)))}hideHorizontalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showHorizontalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{this.hideHorizontalScrollBar()},1e3)))}updateVerticalScrollBarPos(e){const t=this.vScrollBar.attribute.range,i=t[1]-t[0],s=e*(1-i);this.vScrollBar.setAttribute("range",[s,s+i]);const a=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:a.x1,y:a.y1}}updateHorizontalScrollBarPos(e){const t=this.hScrollBar.attribute.range,i=t[1]-t[0],s=e*(1-i);this.hScrollBar.setAttribute("range",[s,s+i]);const a=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:a.x1,y:a.y1}}updateScrollBar(){const e=this._gantt.stateManager.scroll.horizontalBarPos,t=this._gantt.stateManager.scroll.verticalBarPos,i=this._gantt.parsedOptions.scrollStyle,s=i==null?void 0:i.width,a=i==null?void 0:i.visible,r=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.width),o=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.height),l=this._gantt.getAllRowsHeight(),h=this._gantt.getAllDateColsWidth(),d=this._gantt.getAllHeaderRowsHeight();if(h>r){const u=Math.min(o,l),p=Math.max(.05,r/h),c=i.hoverOn;let g=0;g=i.barToSide?this._gantt.tableNoFrameHeight-(c?s:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY:u-(c?s:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,this.hScrollBar.setAttributes({x:this._gantt.scenegraph.ganttGroup.attribute.x,y:g,width:r,range:[0,p],visible:a==="always"});const _=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:_.x1,y:_.y1},a==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,width:0,visible:!1});if(l>o){const u=Math.min(r,h)+this._gantt.scenegraph.ganttGroup.attribute.x,p=Math.max(.05,(o-d)/(l-d));let c=0;const g=this._gantt.parsedOptions.scrollStyle.hoverOn;c=this._gantt.parsedOptions.scrollStyle.barToSide?this._gantt.tableNoFrameWidth-(g?s:-this._gantt.scenegraph.ganttGroup.attribute.x):u-(g?s:-this._gantt.scenegraph.ganttGroup.attribute.x),this.vScrollBar.setAttributes({x:c,y:d+(g?0:this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,height:o-d,range:[0,p],visible:a==="always"});const _=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:_.x1,y:_.y1},a==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,height:0,visible:!1});this._gantt.stateManager.setScrollLeft(e),this._gantt.stateManager.setScrollTop(t)}}function en(n,e,t,i=!0){let{deltaX:s,deltaY:a}=n;n.shiftKey&&n.deltaY&&(s=a,a=0);const[r,o]=tn(s,a,{horizontal:1,vertical:1});r&&(e.setScrollLeft(e.scroll.horizontalBarPos+r),t.scenegraph.scrollbarComponent.showHorizontalScrollBar(!0)),o&&(e.setScrollTop(e.scroll.verticalBarPos+o),t.scenegraph.scrollbarComponent.showVerticalScrollBar(!0)),i&&e.resetInteractionState(),n.cancelable&&(e._gantt.parsedOptions.overscrollBehavior==="none"||Math.abs(a)>=Math.abs(s)&&a!==0&&nn(a,e)||Math.abs(a)<=Math.abs(s)&&s!==0&&sn(s,e))&&n.preventDefault()}function tn(n,e,t){var i,s;const a=Math.abs(n/e),r=a<=.5?0:n,o=a>2?0:e;return[Math.ceil(r*((i=t.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(o*((s=t.vertical)!==null&&s!==void 0?s:0))]}function nn(n,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!=0&&!an(n,e)&&!rn(n,e)}function sn(n,e){return e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width!=0&&!ln(n,e)&&!on(n,e)}function an(n,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!==0&&n<=0&&e.scroll.verticalBarPos<1}function rn(n,e){const t=e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height;return t!==0&&n>=0&&Math.abs(e.scroll.verticalBarPos-t)<1}function ln(n,e){return e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width!==0&&n<=0&&e.scroll.horizontalBarPos<1}function on(n,e){const t=e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width;return t!==0&&n>=0&&Math.abs(e.scroll.horizontalBarPos-t)<1}function dn(n){const e=n._gantt,t=e.stateManager,i=e.scenegraph;i.scrollbarComponent.vScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointerout",r=>{t.interactionState!==R.scrolling&&i.scrollbarComponent.hideVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerout",r=>{t.interactionState!==R.scrolling&&i.scrollbarComponent.hideHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.vScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0}),i.scrollbarComponent.vScrollBar.addEventListener("pointerup",()=>{i._gantt.eventManager.isDraging=!1,t.interactionState===R.scrolling&&t.updateInteractionState(R.default)}),i.scrollbarComponent.vScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===R.scrolling&&t.updateInteractionState(R.default)}),i.scrollbarComponent.vScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1}),i.scrollbarComponent.hScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerdown",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0,t.interactionState!==R.scrolling&&t.updateInteractionState(R.scrolling)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerup",()=>{t.interactionState===R.scrolling&&t.updateInteractionState(R.default)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===R.scrolling&&t.updateInteractionState(R.default)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1});const s=Rt(t.updateVerticalScrollBar,20),a=Rt(t.updateHorizontalScrollBar,20);i.scrollbarComponent.vScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.interactionState!==R.scrolling&&t.updateInteractionState(R.scrolling);const o=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);s(o,r)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.fastScrolling=!0,t.interactionState!==R.scrolling&&t.updateInteractionState(R.scrolling);const o=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);a(o)})}const hn='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1471" width="24" height="24"> <path d="M840.05 153.35a27.61875 27.61875 0 0 0-22.95-4.95c-56.25 13.05-218.25 39.6-289.8 2.25-115.65-60.75-241.65-31.95-299.7-13.05V95.75a27.05625 27.05625 0 0 0-27-27 27.05625 27.05625 0 0 0-27 27v834.75c0 14.85 12.15 27 27 27s27-12.15 27-27V611.9c44.1-13.95 199.35-56.25 293.85 1.8 45.9 28.35 96.75 37.8 143.55 37.8 89.1 0 164.7-34.2 169.65-36.45a27.9 27.9 0 0 0 15.75-24.75V174.5a27.5625 27.5625 0 0 0-10.35-21.15z" fill="#f54319" p-id="1472"></path></svg>';class cn{constructor(e){this._scene=e,this.initNodes()}initNodes(){var e,t,i,s,a,r,o,l,h;const{_scene:d}=this,u=new W({x:0,y:0,width:d._gantt.getAllDateColsWidth(),height:d._gantt.getAllHeaderRowsHeight(),clip:!0,pickable:!1});this.group=u,u.name="date-header-container",d.ganttGroup.addChild(this.group);const{unit:p,step:c}=d._gantt.parsedOptions.reverseSortedTimelineScales[0];let g=0;for(let _=0;_<d._gantt.timeLineHeaderLevel;_++){const{timelineDates:y,customLayout:k,visible:f}=d._gantt.parsedOptions.sortedTimelineScales[_];if(f===!1)continue;const b=new W({x:0,y:g,width:d._gantt.getAllDateColsWidth(),height:d._gantt.parsedOptions.timeLineHeaderRowHeights[_],clip:!1});g+=b.attribute.height,b.name="row-header",u.addChild(b);for(let L=0;L<(y==null?void 0:y.length);L++){const{days:S,endDate:v,startDate:x,title:C,dateIndex:w,unit:O}=y[L],B=Math.ceil(E(x,d._gantt.parsedOptions.minDate,p,c)*d._gantt.parsedOptions.timelineColWidth),D=Math.ceil(E(v,d._gantt.parsedOptions.minDate,p,c,1)*d._gantt.parsedOptions.timelineColWidth)-B,H=new W({x:B,y:0,width:D,height:b.attribute.height,clip:!1,fill:d._gantt.parsedOptions.timelineHeaderBackgroundColor});let N;H.name="date-header-cell";let X=!0;const P=b.attribute.height;if(k){let z;typeof k=="function"?z=k({width:D,height:P,index:L,startDate:x,endDate:v,days:S,dateIndex:w,title:C,ganttInstance:this._scene._gantt}):z=k,z&&(N=z.rootContainer,X=(e=z.renderDefaultText)!==null&&e!==void 0&&e,N.name="task-bar-custom-render"),N&&H.appendChild(N)}if(X){const{padding:z,textAlign:Y,textBaseline:K,textOverflow:V,fontSize:q,fontWeight:Z,color:Q,strokeColor:le,textStick:oe}=d._gantt.parsedOptions.timelineHeaderStyles[_],ne=Je(et(z),Y,K,D,P),ee=new he({x:ne.x,y:ne.y,maxLineWidth:D,heightLimit:P,pickable:!0,text:C.toLocaleString(),fontSize:q,fontWeight:Z,fill:Q,stroke:le,lineWidth:2,textAlign:Y,textBaseline:K,ellipsis:V==="clip"?"":V==="ellipsis"?"...":G(V)?V:void 0});ee.attribute.textStick=oe,H.appendChild(ee),ee.name="date-header-cell-text"}if(_===d._gantt.timeLineHeaderLevel-1&&d._gantt.parsedOptions.markLineCreateOptions&&d._gantt.parsedOptions.markLineCreateOptions.markLineCreatable){const z=d._gantt.parsedOptions.markLineCreateOptions.markLineCreationStyle||{},Y=z.size||24,K=z.iconSize||18,V=z.svg||hn,q=new W({x:D/2-Y/2,y:P/2-Y/2,width:Y,height:Y,visiable:!0});q.name="markline-hover-group",q.data=y[L];const Z=new W({x:0,y:0,width:Y,height:Y,cornerRadius:Y/2,fill:z.fill||"#ccc",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",visibleAll:!1});Z.name="markline-hover-inner-group",q.add(Z);const Q=new Ve({width:K,height:K,image:V,cursor:"pointer",pickable:!0});Q.name="markline-hover-icon",Z.appendChild(Q),H.add(q)}if(b.addChild(H),L>0){const z=J({pickable:!1,stroke:(t=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||t===void 0?void 0:t.lineColor,lineWidth:(i=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||i===void 0?void 0:i.lineWidth,points:[{x:1&((s=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||s===void 0?void 0:s.lineWidth)?.5:0,y:0},{x:1&((a=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||a===void 0?void 0:a.lineWidth)?.5:0,y:b.attribute.height}]});H.appendChild(z)}}if(_>0){const L=J({pickable:!1,stroke:(r=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||r===void 0?void 0:r.lineColor,lineWidth:(o=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||o===void 0?void 0:o.lineWidth,points:[{x:0,y:1&((l=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||l===void 0?void 0:l.lineWidth)?.5:0},{x:d._gantt.getAllDateColsWidth(),y:1&((h=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||h===void 0?void 0:h.lineWidth)?.5:0}]});b.addChild(L)}}}setX(e){this.group.setAttribute("x",e)}setY(e){this.group.setAttribute("y",e)}resize(){var e,t,i,s;this.group.setAttribute("width",(t=(e=this.group.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0),this.group.setAttribute("height",(s=(i=this.group.attribute)===null||i===void 0?void 0:i.height)!==null&&s!==void 0?s:0)}refresh(){var e;(e=this.group)===null||e===void 0||e.parent.removeChild(this.group),this.initNodes()}showMarklineIcon(e){let t;return e.children.forEach(i=>{i.name==="date-header-cell-text"&&i.setAttribute("visible",!1),i.name==="markline-hover-group"&&(t=i.firstChild,t.setAttribute("visibleAll",!0))}),t}hideMarklineIconHover(e){let t;return e.children.forEach(i=>{i.name==="date-header-cell-text"&&i.setAttribute("visible",!0),i.name==="markline-hover-group"&&(t=i.firstChild,t.setAttribute("visibleAll",!1))}),t}}class un extends W{constructor(e){super(e)}}const Pt=`<svg width="100" height="200" xmlns="http://www.w3.org/2000/svg">
  <line x1="30" y1="10" x2="30" y2="190" stroke="black" stroke-width="4"/>
  <line x1="70" y1="10" x2="70" y2="190" stroke="black" stroke-width="4"/>
</svg>`,$t=10;class pn{constructor(e){this.selectedBorders=[],this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new W({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="task-bar-container",e.ganttGroup.addChild(this.group),this.initBars(),this.initHoverBarIcons()}initBars(){var e,t;this.barContainer=new W({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.barContainer);for(let i=0;i<this._scene._gantt.itemCount;i++)if(this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact){const s=this.initBar(i);s&&this.barContainer.appendChild(s)}else{const s=this._scene._gantt.getRecordByIndex(i);if(((e=s.children)===null||e===void 0?void 0:e.length)>0)for(let a=0;a<((t=s.children)===null||t===void 0?void 0:t.length);a++){const r=this.initBar(i,a,s.children.length);r&&this.barContainer.appendChild(r)}else{const a=this.initBar(i);a&&this.barContainer.appendChild(a)}}}initBar(e,t,i){var s,a,r;const o=this._scene._gantt.parsedOptions.taskBarCustomLayout,{startDate:l,endDate:h,taskDays:d,progress:u,taskRecord:p}=this._scene._gantt.getTaskInfoByTaskListIndex(e,t),c=p.type==="milestone";if(c&&!l||!c&&(d<=0||!l||!h||l.getTime()>h.getTime()))return null;const{unit:g,step:_}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],y=E(h,l,g,_,1)*this._scene._gantt.parsedOptions.timelineColWidth,k=this._scene._gantt.getTaskBarStyle(e,t),f=k.width,b=(j(this._scene._gantt.parsedOptions.minDate),this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange?Vt(this._scene._gantt,this._scene._gantt.records[e]):this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact&&Kt(this._scene._gantt,this._scene._gantt.records[e])),this._scene._gantt.parsedOptions.rowHeight),L=this._scene._gantt.parsedOptions.taskBarMilestoneStyle.width,S=E(l,this._scene._gantt.parsedOptions.minDate,g,_)*this._scene._gantt.parsedOptions.timelineColWidth-(c?L/2:0),v=this._scene._gantt.getRowsHeightByIndex(0,e-1)+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(t??0)*b:this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?p.vtable_gantt_showIndex*b:0)+(b-(c?L:f))/2,x=new un({x:S,y:v,width:c?L:y,height:c?L:f,cornerRadius:c?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:k.cornerRadius,lineWidth:c?2*this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderLineWidth:2*((s=k.borderLineWidth)!==null&&s!==void 0?s:k.borderWidth),stroke:c?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderColor:k.borderColor,angle:c?.25*Math.PI:0,anchor:c?[S+L/2,v+L/2]:void 0});x.name="task-bar",x.task_index=e,x.sub_task_index=t,x.record=p;const C=new W({x:0,y:0,width:x.attribute.width,height:x.attribute.height,cornerRadius:c?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:k.cornerRadius,clip:!0});let w;C.name="task-bar-group",x.appendChild(C),x.clipGroupBox=C;let O=!0,B=!0;if(o){let D;typeof o=="function"?D=o({width:y,height:f,index:e,startDate:l,endDate:h,taskDays:d,progress:u,taskRecord:p,ganttInstance:this._scene._gantt}):D=o,D&&(w=D.rootContainer,O=(a=D.renderDefaultBar)!==null&&a!==void 0&&a,B=(r=D.renderDefaultText)!==null&&r!==void 0&&r,w&&(w.name="task-bar-custom-render"))}if(O){const D=Ke({x:0,y:0,width:x.attribute.width,height:x.attribute.height,fill:c?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.fillColor:k.barColor,pickable:!1});if(D.name="task-bar-rect",C.appendChild(D),x.barRect=D,p.type!=="milestone"){const H=Ke({x:0,y:0,width:y*u/100,height:f,fill:k.completedBarColor,pickable:!1});H.name="task-bar-progress-rect",C.appendChild(H),x.progressRect=H}}if(w&&C.appendChild(w),B&&p.type!=="milestone"){const{textAlign:D,textBaseline:H,fontSize:N,fontFamily:X,textOverflow:P,color:z,padding:Y}=this._scene._gantt.parsedOptions.taskBarLabelStyle,K=Je(et(Y),D,H,y,f),V=ci({x:K.x,y:K.y,fontSize:N,fill:z,fontFamily:X,text:Yi(this._scene._gantt.parsedOptions.taskBarLabelText,p),maxLineWidth:y-10,textBaseline:H,textAlign:D,ellipsis:P==="clip"?"":P==="ellipsis"?"...":G(P)?P:void 0,poptip:{position:"bottom",dx:(y-10)/4}});C.appendChild(V),x.textLabel=V}return x}updateTaskBarNode(e,t){const i=this.getTaskBarNodeByIndex(e,t);i&&this.barContainer.removeChild(i);const s=this.initBar(e,t);s&&this.barContainer.insertInto(s,e)}initHoverBarIcons(){var e,t;const i=new W({x:0,y:0,width:100,height:100,clip:!0,pickable:!1,cornerRadius:(t=(e=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&e!==void 0?e:Dt.cornerRadius)!==null&&t!==void 0?t:0,fill:this._scene._gantt.parsedOptions.taskBarHoverStyle.barOverlayColor,visibleAll:!1});if(this.hoverBarGroup=i,i.name="task-bar-hover-shadow",this._scene._gantt.parsedOptions.taskBarResizable){const s=new Ve({x:0,y:0,width:10,height:20,image:Pt,pickable:!0,cursor:"col-resize"});s.name="task-bar-hover-shadow-left-icon",this.hoverBarLeftIcon=s,i.appendChild(s);const a=new Ve({x:0,y:0,width:10,height:20,image:Pt,pickable:!0,cursor:"col-resize"});a.name="task-bar-hover-shadow-right-icon",this.hoverBarRightIcon=a,i.appendChild(a)}}setX(e){this.barContainer.setAttribute("x",e)}setY(e){this.barContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const e=this.barContainer.attribute.x,t=this.barContainer.attribute.y;this.barContainer.removeAllChild(),this.group.removeChild(this.barContainer),this.initBars(),this.setX(e),this.setY(t)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}showHoverBar(e,t,i,s,a){var r,o,l,h;const{startDate:d,endDate:u,taskRecord:p}=this._scene._gantt.getTaskInfoByTaskListIndex(a.task_index,a.sub_task_index);a&&a.name==="task-bar"&&a.appendChild(this.hoverBarGroup),this.hoverBarGroup.setAttribute("x",0),this.hoverBarGroup.setAttribute("y",0),this.hoverBarGroup.setAttribute("width",i),this.hoverBarGroup.setAttribute("height",s),this.hoverBarGroup.setAttribute("visibleAll",!0);const c=this._scene._gantt.getTaskBarStyle(a.task_index,a.sub_task_index);if(p.type==="milestone")this.hoverBarGroup.setAttribute("cornerRadius",a.attribute.cornerRadius);else{const y=(o=(r=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&r!==void 0?r:c.cornerRadius)!==null&&o!==void 0?o:0;this.hoverBarGroup.setAttribute("cornerRadius",y)}(l=this.hoverBarLeftIcon)===null||l===void 0||l.setAttribute("visible",!1),(h=this.hoverBarRightIcon)===null||h===void 0||h.setAttribute("visible",!1);let g=!0,_=!0;if(p.type==="milestone")g=!1,_=!1;else if(typeof this._scene._gantt.parsedOptions.taskBarResizable=="function"){const y={index:a.task_index,startDate:d,endDate:u,taskRecord:p,ganttInstance:this._scene._gantt},k=this._scene._gantt.parsedOptions.taskBarResizable(y);Array.isArray(k)?[g,_]=k:(g=k,_=k)}else Array.isArray(this._scene._gantt.parsedOptions.taskBarResizable)?[g,_]=this._scene._gantt.parsedOptions.taskBarResizable:(g=this._scene._gantt.parsedOptions.taskBarResizable,_=this._scene._gantt.parsedOptions.taskBarResizable);g&&this.hoverBarLeftIcon.setAttribute("visible",!0),_&&this.hoverBarRightIcon.setAttribute("visible",!0),this.hoverBarLeftIcon&&(this.hoverBarLeftIcon.setAttribute("x",0),this.hoverBarLeftIcon.setAttribute("y",Math.ceil(s/10)),this.hoverBarLeftIcon.setAttribute("width",10),this.hoverBarLeftIcon.setAttribute("height",s-2*Math.ceil(s/10)),this.hoverBarRightIcon.setAttribute("x",i-10),this.hoverBarRightIcon.setAttribute("y",Math.ceil(s/10)),this.hoverBarRightIcon.setAttribute("width",10),this.hoverBarRightIcon.setAttribute("height",s-2*Math.ceil(s/10)))}hideHoverBar(){this.hoverBarGroup.setAttribute("visibleAll",!1)}createSelectedBorder(e,t,i,s,a,r=!1){const o=a.record,l=new W({x:e,y:t,width:i,height:s,pickable:!1,attachedToTaskBarNode:a,zIndex:1e4});l.name="task-bar-select-border",this.barContainer.appendChild(l),this.selectedBorders.push(l);const h=new W({x:0,y:0,width:i,height:s,lineWidth:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderLineWidth,pickable:!1,cornerRadius:a.attribute.cornerRadius,fill:!1,stroke:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderColor,shadowColor:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowColor,shadowOffsetX:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetX,shadowOffsetY:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetY,shadowBlur:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowBlur,angle:a.attribute.angle,anchor:[i/2,s/2]});if(l.appendChild(h),r){const d=o.type==="milestone"?15:10,u=new W({x:-d,y:0,width:10,height:s,pickable:!0}),p=new Wt({x:5,y:s/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1});u.appendChild(p),u.name="task-bar-link-point-left",l.appendChild(u);const c=new W({x:i+(d-10),y:0,width:10,height:s,pickable:!0}),g=new Wt({x:5,y:s/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1,pickStrokeBuffer:10});c.appendChild(g),c.name="task-bar-link-point-right",l.appendChild(c)}}removeSelectedBorder(){this.selectedBorders.forEach(e=>{e.delete()}),this.selectedBorders=[]}removeSecondSelectedBorder(){this.selectedBorders.length===2&&this.selectedBorders.pop().delete()}updateCreatingDependencyLine(e,t,i,s){this.creatingDependencyLine&&(this.creatingDependencyLine.delete(),this.creatingDependencyLine=void 0);const a=new ui({points:[{x:e,y:t},{x:i,y:s}],stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineWidth,lineDash:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineDash,pickable:!1});this.creatingDependencyLine=a,this.selectedBorders[0].appendChild(a)}getTaskBarNodeByIndex(e,t){let i=this.barContainer.firstChild;if(!i)return null;for(let s=0;s<this.barContainer.childrenCount;s++){if(i.task_index===e&&(!G(t)||G(t)&&i.sub_task_index===t))return i;i=i._next}return null}}class gn{constructor(e){this.markLineContainerWidth=20,this._scene=e,this.height=Math.min(e._gantt.tableNoFrameHeight,e._gantt.drawHeight)-e._gantt.getAllHeaderRowsHeight(),this.group=new W({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:e._gantt.tableNoFrameWidth,height:this.height,pickable:!1,clip:!0}),this.group.name="mark-line-container",e.ganttGroup.addChild(this.group),this.markLIneContainer=new W({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this.height,pickable:!1,clip:!0}),this.group.appendChild(this.markLIneContainer),this.initMarkLines()}initMarkLines(){this._scene._gantt.parsedOptions.markLine.forEach(e=>{const t=e.style,i=e.contentStyle||{},s=this._scene._gantt.parsedOptions.timeScaleIncludeHour?j(e.date):j(e.date,!0),a=this._scene._gantt.parsedOptions.minDate,{unit:r,step:o}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],l=E(s,a,r,o),h=this._scene._gantt.parsedOptions.timelineColWidth*(Math.floor(l)+(e.position==="right"?1:e.position==="middle"?.5:0)),d=new W({pickable:!1,x:h-this.markLineContainerWidth/2,y:0,width:this.markLineContainerWidth,height:this.height});d.name="mark-line",this.markLIneContainer.appendChild(d);const u=J({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,lineDash:t.lineDash,points:[{x:this.markLineContainerWidth/2,y:0},{x:this.markLineContainerWidth/2,y:this.height}]});if(d.appendChild(u),e.content){const p=this._scene._gantt.parsedOptions.timelineColWidth,c=i.lineHeight||18,g=new W({x:this.markLineContainerWidth/2,y:0,cursor:"pointer",height:c,clip:!1,fill:i.backgroundColor||t.lineColor,display:"flex",cornerRadius:i.cornerRadius||[0,2,2,0]});g.name="mark-line-content",g.data=e,d.appendChild(g);const _=new he({maxLineWidth:p,text:e.content,cursor:"pointer",lineHeight:c,fontWeight:i.fontWeight||"normal",fill:i.color||t.lineColor,fontSize:i.fontSize||12,poptip:{position:"top",dx:p/4,dy:-c/4}});g.appendChild(_)}})}refresh(){this.height=Math.min(this._scene._gantt.tableNoFrameHeight,this._scene._gantt.drawHeight)-this._scene._gantt.getAllHeaderRowsHeight(),this.markLIneContainer.removeAllChild(),this.group.setAttribute("height",this.height),this.markLIneContainer.setAttribute("height",this.height),this.initMarkLines()}setX(e){this.markLIneContainer.setAttribute("x",e)}}class fn{constructor(e){this._scene=e,this.createFrameBorder()}createFrameBorder(){var e,t,i,s,a,r;const o=this._scene.ganttGroup,l=this._scene._gantt.parsedOptions.outerFrameStyle;if(!l)return;const{cornerRadius:h,borderColor:d,borderLineWidth:u,borderLineDash:p}=l,c={},g={pickable:!1};if(u&&(g.stroke=!0,g.fill=!1,g.stroke=d,g.lineWidth=u,p&&(g.lineDash=p),g.lineCap="butt"),h&&(this._scene._gantt.taskListTableInstance?(g.cornerRadius=[0,(e=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&e!==void 0?e:0,(t=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&t!==void 0?t:0,0],c.cornerRadius=[0,(i=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&i!==void 0?i:0,(s=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&s!==void 0?s:0,0]):(g.cornerRadius=(a=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&a!==void 0?a:0,c.cornerRadius=(r=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&r!==void 0?r:0)),o.setAttributes(c),g.stroke){g.x=this._scene._gantt.taskListTableInstance?-u/2:u/2,g.y=u/2,g.pickable=!1,g.width=o.attribute.width+u+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),g.height=o.attribute.height+u/2+u/2;const _=Ke(g);_.name="border-rect",o.parent.insertAfter(_,o),o.border=_,this.border=_}}refresh(){this.border&&this.border.parent&&this.border.parent.removeChild(this.border),this.createFrameBorder()}resize(){var e;const{cornerRadius:t,borderColor:i,borderLineWidth:s,borderLineDash:a}=this._scene._gantt.parsedOptions.outerFrameStyle;(e=this.border)===null||e===void 0||e.setAttributes({width:this._scene.ganttGroup.attribute.width+s+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),height:this._scene._gantt.drawHeight+s})}}var _n=function(n,e,t,i){var s,a=arguments.length,r=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(r=(a<3?s(r):a>3?s(e,t,r):s(e,t))||r);return a>3&&r&&Object.defineProperty(e,t,r),r};let Qe=class{constructor(){this.time=gi.beforeFillStroke,this.useStyle=!0,this.order=0,this.supportedAppName="vtable"}drawShape(n,e,t,i,s,a,r,o,l,h,d,u,p){n.name==="date-header-cell"&&n.forEachChildren(c=>{var g;if(c.name==="date-header-cell-text"&&c.attribute.textStick===!0){const _=c;_.setAttribute("dx",0);const y=_.globalAABBBounds,k=_.stage.globalAABBBounds,f=_.parent.globalAABBBounds,b=k.intersect(f);k.intersect(f)&&(y.width()>=b.width()&&_.attribute.last_dx?_.setAttribute("dx",(g=_.attribute.last_dx)!==null&&g!==void 0?g:0):k.x1>=y.x1?(_.setAttribute("dx",k.x1-y.x1),_.setAttribute("last_dx",k.x1-y.x1)):k.x2<=y.x2&&(_.setAttribute("dx",k.x2-y.x2),_.setAttribute("last_dx",k.x1-y.x1)))}})}};Qe=_n([pi()],Qe);const bn=new fi((n,e,t,i)=>{n(Qe).toSelf().inSingletonScope(),n(_i).toService(Qe)});class mn{constructor(e){this._scene=e,this.createAddButton()}createAddButton(){var e;this._scene._gantt.parsedOptions.taskBarCreationCustomLayout?this.group=new W({x:0,y:0,width:100,height:100}):(this.group=new W({x:0,y:0,width:100,height:100,lineDash:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineDash,cursor:"pointer",lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,cornerRadius:(e=this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.cornerRadius)!==null&&e!==void 0?e:0,fill:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.backgroundColor}),this.lineVertical=J({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:50,y:0},{x:50,y:100}]}),this.group.appendChild(this.lineVertical),this.lineHorizontal=J({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:0,y:50},{x:100,y:50}]}),this.group.appendChild(this.lineHorizontal)),this.group.name="task-creation-button",this._scene.taskBar.group.addChild(this.group)}show(e,t,i,s){if(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout)this.group.appendChild(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout({width:i,height:s,ganttInstance:this._scene._gantt}).rootContainer);else{const a=Math.min(i,s)/6;this.lineHorizontal.setAttribute("points",[{x:(i-4*a)/2,y:s/2},{x:(i-4*a)/2+4*a,y:s/2}]),this.lineVertical.setAttribute("points",[{x:i/2,y:(s-4*a)/2},{x:i/2,y:(s-4*a)/2+4*a}])}this.group.setAttribute("x",e),this.group.setAttribute("y",t),this.group.setAttribute("width",i),this.group.setAttribute("height",s),this.group.setAttribute("visibleAll",!0)}hide(){this.group.setAttribute("visibleAll",!1),this._scene._gantt.parsedOptions.taskBarCreationCustomLayout&&this.group.removeAllChild()}}class Ft{constructor(e){this._scene=e,this.group=new bi({position:"top",content:"",contentStyle:{fill:"#fff"},visible:!1,panel:{background:"#14161c",cornerRadius:4}}),e.ganttGroup.addChild(this.group)}show(e){var t,i,s;const a=((t=this._scene._gantt.parsedOptions.markLineCreateOptions)===null||t===void 0?void 0:t.markLineCreationHoverToolTip)||{},r=e.globalTransMatrix,o=e.attribute.width,l=e.attribute.height;let h,d;const u=a.position||"top";u==="top"?(h=r.e+o/2-2,d=r.f):u==="bottom"&&(h=r.e+o/2-2,d=r.f+l);const p=((i=a.style)===null||i===void 0?void 0:i.contentStyle)||{fill:"#fff"},c=((s=a.style)===null||s===void 0?void 0:s.panelStyle)||{background:"#14161c",cornerRadius:4};this.group.setAttributes({content:a.tipContent,position:u,visibleAll:!0,visible:!0,contentStyle:p,panel:Object.assign(Object.assign({},c),{visible:!0}),x:h,y:d})}hide(){this.group.setAttributes({visibleAll:!1,visible:!1})}}class kn{constructor(e){this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new W({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="dependency-link-container",e.ganttGroup.addChild(this.group),this.initLinkLines()}initLinkLines(){var e,t,i;if(Xt(this._scene._gantt.records),this.linkLinesContainer=new W({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.linkLinesContainer),(e=this._scene._gantt.records)===null||e===void 0?void 0:e.length)for(let s=0;(i=s<((t=this._scene._gantt.parsedOptions.dependencyLinks)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;s++)this.initLinkLine(s)}initLinkLine(e){var t,i;const{taskKeyField:s,dependencyLinks:a}=this._scene._gantt.parsedOptions,r=a[e],{linkedToTaskKey:o,linkedFromTaskKey:l,type:h}=r,d=ae(this._scene._gantt.records,s,o),u=ae(this._scene._gantt.records,s,l);if(!d||!u)return;let p,c,g,_,y,k,f,b;if(d.record.vtable_gantt_linkedTo||(d.record.vtable_gantt_linkedTo=[]),d.record.vtable_gantt_linkedTo.push(r),u.record.vtable_gantt_linkedFrom||(u.record.vtable_gantt_linkedFrom=[]),u.record.vtable_gantt_linkedFrom.push(r),this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline?(b=u.index[0],f=d.index[0],{startDate:p,endDate:c,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(d.index[0],d.index[1]),{startDate:_,endDate:y,taskDays:k}=this._scene._gantt.getTaskInfoByTaskListIndex(u.index[0],u.index[1])):this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(b=this._scene._gantt.getRowsHeightByIndex(0,u.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?u.record.vtable_gantt_showIndex:(t=u.index[1])!==null&&t!==void 0?t:0),f=this._scene._gantt.getRowsHeightByIndex(0,d.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?d.record.vtable_gantt_showIndex:(i=d.index[1])!==null&&i!==void 0?i:0),{startDate:p,endDate:c,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(d.index[0],d.index[1]),{startDate:_,endDate:y,taskDays:k}=this._scene._gantt.getTaskInfoByTaskListIndex(u.index[0],u.index[1])):(b=this._scene._gantt.getTaskShowIndexByRecordIndex(u.index),f=this._scene._gantt.getTaskShowIndexByRecordIndex(d.index),{startDate:p,endDate:c,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(f),{startDate:_,endDate:y,taskDays:k}=this._scene._gantt.getTaskInfoByTaskListIndex(b)),!k||!g)return;j(this._scene._gantt.parsedOptions.minDate);const{arrowPoints:L,linePoints:S}=yn(h,_,y,b,k,u.record.type==="milestone",p,c,f,g,d.record.type==="milestone",this._scene._gantt),v=this._scene._gantt.parsedOptions.dependencyLinkLineStyle,x=J({pickable:!0,stroke:v.lineColor,lineWidth:v.lineWidth,lineDash:v.lineDash,points:S,pickStrokeBuffer:3,vtable_link:r});this.linkLinesContainer.appendChild(x),r.vtable_gantt_linkLineNode=x;const C=new mi({fill:v.lineColor,points:L});this.linkLinesContainer.appendChild(C),r.vtable_gantt_linkArrowNode=C}setX(e){this.linkLinesContainer.setAttribute("x",e)}setY(e){this.linkLinesContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const e=this.linkLinesContainer.attribute.x,t=this.linkLinesContainer.attribute.y;this.linkLinesContainer.removeAllChild(),this.group.removeChild(this.linkLinesContainer),this.initLinkLines(),this.setX(e),this.setY(t)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}createSelectedLinkLine(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode,s=t.clone(),a=i.clone();s.setAttribute("stroke",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),s.setAttribute("lineWidth",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineWidth),s.setAttribute("shadowColor",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowColor),s.setAttribute("shadowOffsetX",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),s.setAttribute("shadowOffsetY",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),s.setAttribute("shadowBlur",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowBlur),this.linkLinesContainer.appendChild(s),a.setAttribute("fill",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),this.linkLinesContainer.appendChild(a),this.selectedEffectNodes=[s,a]}removeSelectedLinkLine(){var e;(e=this.selectedEffectNodes)===null||e===void 0||e.forEach(t=>{t.delete()}),this.selectedEffectNodes=[]}deleteLink(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode;t.delete(),i.delete()}}function yn(n,e,t,i,s,a,r,o,l,h,d,u){const{unit:p,step:c}=u.parsedOptions.reverseSortedTimelineScales[0],{minDate:g,rowHeight:_,timelineColWidth:y}=u.parsedOptions,k=u.parsedOptions.taskBarMilestoneHypotenuse;let f=[],b=[];if(n===U.FinishToStart){let L=E(t,g,p,c,1)*y;a&&(L=E(e,g,p,c,1)*y+k/2);let S=E(r,g,p,c)*y;d&&(S-=k/2),f=[{x:L,y:_*(i+.5)},{x:L+20,y:_*(i+.5)},{x:L+20,y:_*(i+(i>l?0:1))},{x:S-20,y:_*(i+(i>l?0:1))},{x:S-20,y:_*(l+.5)},{x:S,y:_*(l+.5)}],L+20<=S-20&&f.splice(2,3,{x:L+20,y:_*(l+.5)});const v=f[f.length-1];b=[{x:v.x,y:v.y},{x:v.x-10,y:v.y-5},{x:v.x-10,y:v.y+5},{x:v.x,y:v.y}]}else if(n===U.StartToFinish){let L=E(e,g,p,c)*y;a&&(L-=k/2);let S=E(o,g,p,c,1)*y;d&&(S=E(r,g,p,c,1)*y+k/2),f=[{x:L,y:_*(i+.5)},{x:L-20,y:_*(i+.5)},{x:L-20,y:_*(i+(i>l?0:1))},{x:S+20,y:_*(i+(i>l?0:1))},{x:S+20,y:_*(l+.5)},{x:S,y:_*(l+.5)}],L-20>=S+20&&f.splice(2,3,{x:L-20,y:_*(l+.5)});const v=f[f.length-1];b=[{x:v.x,y:v.y},{x:v.x+10,y:v.y-5},{x:v.x+10,y:v.y+5},{x:v.x,y:v.y}]}else if(n===U.StartToStart){let L=E(e,g,p,c)*y;a&&(L-=k/2);let S=E(r,g,p,c)*y;d&&(S-=k/2),f=[{x:L,y:_*(i+.5)},{x:(i===l?L:Math.min(L,S))-20,y:_*(i+.5)},{x:(i===l?L:Math.min(L,S))-20,y:_*(l+(i===l?1:.5))},{x:S-20,y:_*(l+(i===l?1:.5))},{x:(i===l?S:Math.min(L,S))-20,y:_*(l+.5)},{x:S,y:_*(l+.5)}];const v=f[f.length-1];b=[{x:v.x,y:v.y},{x:v.x-10,y:v.y-5},{x:v.x-10,y:v.y+5},{x:v.x,y:v.y}]}else if(n===U.FinishToFinish){let L=E(t,g,p,c,1)*y;a&&(L=E(e,g,p,c,1)*y+k/2);let S=E(o,g,p,c,1)*y;d&&(S=E(r,g,p,c,1)*y+k/2),f=[{x:L,y:_*(i+.5)},{x:(i===l?L:Math.max(L,S))+20,y:_*(i+.5)},{x:(i===l?L:Math.max(L,S))+20,y:_*(l+(i===l?1:.5))},{x:S+20,y:_*(l+(i===l?1:.5))},{x:S+20,y:_*(l+.5)},{x:S,y:_*(l+.5)}];const v=f[f.length-1];b=[{x:v.x,y:v.y},{x:v.x+10,y:v.y-5},{x:v.x+10,y:v.y+5},{x:v.x,y:v.y}]}return{linePoints:f,arrowPoints:b}}function Nt(n,e,t,i,s,a,r,o,l,h,d,u,p,c,g,_){const{unit:y,step:k}=_.parsedOptions.reverseSortedTimelineScales[0],{minDate:f,rowHeight:b,timelineColWidth:L}=_.parsedOptions,S=_.parsedOptions.taskBarMilestoneHypotenuse,v=_.parsedOptions.taskBarMilestoneStyle.width;let x=[],C=[];if(n===U.FinishToStart){let w=r?r.attribute.x+r.attribute.width:E(t,f,y,k,1)*L;a&&(w=r?r.attribute.x+r.attribute.width+(S-v)/2:E(e,f,y,k,1)*L+S/2);let O=c?c.attribute.x:E(l,f,y,k)*L;p&&(O-=(S-v)/2),x=[{x:w,y:b*(i+.5)+o},{x:w+20,y:b*(i+.5)+o},{x:w+20,y:b*(i+(i>d?0:1))+o},{x:O-20,y:b*(i+(i>d?0:1))+o},{x:O-20,y:b*(d+.5)+g},{x:O,y:b*(d+.5)+g}],w+20<=O-20&&x.splice(2,3,{x:w+20,y:b*(d+.5)+g});const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x-10,y:B.y-5},{x:B.x-10,y:B.y+5},{x:B.x,y:B.y}]}else if(n===U.StartToFinish){let w=r?r.attribute.x:E(e,f,y,k)*L;a&&(w-=(S-v)/2);let O=c?c.attribute.x+c.attribute.width:E(h,f,y,k,1)*L;p&&(O=c?c.attribute.x+c.attribute.width+(S-v)/2:E(l,f,y,k,1)*L+S/2),x=[{x:w,y:b*(i+.5)+o},{x:w-20,y:b*(i+.5)+o},{x:w-20,y:b*(i+(i>d?0:1))+o},{x:O+20,y:b*(i+(i>d?0:1))+o},{x:O+20,y:b*(d+.5)+g},{x:O,y:b*(d+.5)+g}],w-20>=O+20&&x.splice(2,3,{x:w-20,y:b*(d+.5)+g});const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x+10,y:B.y-5},{x:B.x+10,y:B.y+5},{x:B.x,y:B.y}]}else if(n===U.StartToStart){let w=r?r.attribute.x:E(e,f,y,k)*L;a&&(w-=(S-v)/2);let O=c?c.attribute.x:E(l,f,y,k)*L;p&&(O-=(S-v)/2),x=[{x:w,y:b*(i+.5)+o},{x:(i===d?w:Math.min(w,O))-20,y:b*(i+.5)+o},{x:(i===d?w:Math.min(w,O))-20,y:b*(d+(i===d?1:.5))+g},{x:O-20,y:b*(d+(i===d?1:.5))+g},{x:(i===d?O:Math.min(w,O))-20,y:b*(d+.5)+g},{x:O,y:b*(d+.5)+g}];const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x-10,y:B.y-5},{x:B.x-10,y:B.y+5},{x:B.x,y:B.y}]}else if(n===U.FinishToFinish){let w=r?r.attribute.x+r.attribute.width:E(t,f,y,k,1)*L;a&&(w=r?r.attribute.x+r.attribute.width+(S-v)/2:E(e,f,y,k,1)*L+S/2);let O=c?c.attribute.x+c.attribute.width:E(h,f,y,k,1)*L;p&&(O=c?c.attribute.x+c.attribute.width+(S-v)/2:E(l,f,y,k,1)*L+S/2),x=[{x:w,y:b*(i+.5)+o},{x:(i===d?w:Math.max(w,O))+20,y:b*(i+.5)+o},{x:(i===d?w:Math.max(w,O))+20,y:b*(d+(i===d?1:.5))+g},{x:O+20,y:b*(d+(i===d?1:.5))+g},{x:O+20,y:b*(d+.5)+g},{x:O,y:b*(d+.5)+g}];const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x+10,y:B.y-5},{x:B.x+10,y:B.y+5},{x:B.x,y:B.y}]}return{linePoints:x,arrowPoints:C}}class Sn{constructor(e){this._scene=e,this.dragLineContainer=new W({x:0,y:0,width:e._gantt.tableNoFrameWidth,height:Math.min(e._gantt.tableNoFrameHeight,e._gantt.drawHeight),pickable:!1,clip:!0,visible:!1}),this.dragLineContainer.name="drag-order-line-container",e.ganttGroup.addChild(this.dragLineContainer),this.initDragLine()}initDragLine(){if(this._scene._gantt.taskListTableInstance){const e=this._scene._gantt.taskListTableInstance.theme.dragHeaderSplitLine,t=J({pickable:!1,stroke:e.lineColor,lineWidth:e.lineWidth,points:[]});this.dragLine=t,this.dragLineContainer.appendChild(t)}}showDragLine(e){this.dragLineContainer.showAll(),this.dragLine.setAttribute("points",[{x:0,y:e},{x:this._scene._gantt.tableNoFrameWidth,y:e}])}hideDragLine(){this.dragLineContainer.hideAll()}}yi.load(bn);class Ln{constructor(e){let t,i;this._gantt=e,this.tableGroupWidth=e.tableNoFrameWidth,this.tableGroupHeight=Math.min(e.tableNoFrameHeight,e.drawHeight),F.mode==="node"||(Pe.setEnv("browser"),t=e.canvas.width,i=e.canvas.height),this.stage=ki({canvas:e.canvas,width:t,height:i,disableDirtyBounds:!1,background:e.parsedOptions.underlayBackgroundColor,enableLayout:!0,autoRender:!1,context:{appName:"vtable"},pluginList:["poptipForText"]}),this.stage.gantt=this._gantt,this.stage.table=this._gantt,this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph()}initSceneGraph(){this.ganttGroup=new W({x:this._gantt.tableX,y:this._gantt.tableY,width:this.tableGroupWidth,height:this.tableGroupHeight,clip:!0,pickable:!1}),this.stage.defaultLayer.add(this.ganttGroup),this.ganttGroup.name="table",this.timelineHeader=new cn(this),this.grid=new Zi(this),this.dependencyLink=new kn(this),this.taskBar=new pn(this),this.markLine=new gn(this),this.toolTip=new Ft(this),this.frameBorder=new fn(this),this.scrollbarComponent=new Ji(this._gantt),this.stage.defaultLayer.addChild(this.scrollbarComponent.hScrollBar),this.stage.defaultLayer.addChild(this.scrollbarComponent.vScrollBar),this.dragOrderLine=new Sn(this)}updateSceneGraph(){const e=this._gantt;let t,i;this.tableGroupWidth=e.tableNoFrameWidth,this.tableGroupHeight=Math.min(e.tableNoFrameHeight,e.drawHeight),F.mode==="node"||(Pe.setEnv("browser"),t=e.canvas.width,i=e.canvas.height),this.stage.resize(t,i),this.refreshAll()}afterCreateSceneGraph(){this.scrollbarComponent.updateScrollBar(),dn(this._gantt.eventManager)}refreshAll(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.ganttGroup.setAttribute("width",this.tableGroupWidth),this.timelineHeader.refresh(),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.dependencyLink.refresh(),this.frameBorder.refresh(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}refreshTaskBars(){this.dependencyLink.refresh(),this.taskBar.refresh(),this.updateNextFrame()}refreshTaskBarsAndGrid(){this._gantt.verticalSplitResizeLine.style.height=this._gantt.drawHeight+"px",this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.frameBorder.resize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}updateTableSize(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttributes({x:this._gantt.tableX,y:this._gantt.tableY,width:this._gantt.tableNoFrameWidth,height:this.tableGroupHeight}),this.grid.resize(),this.taskBar.resize(),this.dependencyLink.resize(),this.markLine.refresh(),this.frameBorder.resize()}updateStageBackground(){this.stage.background=this._gantt.parsedOptions.underlayBackgroundColor,this.updateNextFrame()}renderSceneGraph(){this.stage.render()}updateNextFrame(){this.stage.renderNextFrame()}get width(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0}get height(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get x(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.x)!==null&&t!==void 0?t:0}get y(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.y)!==null&&t!==void 0?t:0}setX(e,t=!1){this.timelineHeader.setX(e),this.grid.setX(e),this.taskBar.setX(e),this.dependencyLink.setX(e),this.markLine.setX(e),this.updateNextFrame()}setY(e,t=!1){this.grid.setY(e),this.taskBar.setY(e),this.dependencyLink.setY(e),this.updateNextFrame()}setPixelRatio(e){this.stage.disableDirtyBounds(),this.stage.window.setDpr(e),this.stage.render(),this.stage.enableDirtyBounds()}resize(){this.updateTableSize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}release(){this.stage.release()}showTaskCreationButton(e,t,i){this.taskCreationButton||(this.taskCreationButton=new mn(this._gantt.scenegraph));const s=this._gantt.parsedOptions.taskBarCreationMaxWidth,a=this._gantt.parsedOptions.taskBarCreationMinWidth,r=this._gantt.getDateColWidth(i),o=s?Math.min(s,a?Math.max(a,r):r):a?Math.max(a,r):r,l=e-(o-r)/2;this.taskCreationButton.show(l,t,o,this._gantt.parsedOptions.rowHeight),this.updateNextFrame()}hideTaskCreationButton(){this.taskCreationButton&&(this.taskCreationButton.hide(),this.updateNextFrame())}showToolTip(e){this.toolTip||(this.toolTip=new Ft(this._gantt.scenegraph)),this.toolTip.show(e)}hideToolTip(){this.toolTip.hide()}refreshRecordLinkNodes(e,t,i,s=0){const a=this._gantt,r=a.getRecordByIndex(e,t),o=r.vtable_gantt_linkedTo,l=r.vtable_gantt_linkedFrom;for(let h=0;h<(o==null?void 0:o.length);h++){const d=o[h],u=d.vtable_gantt_linkLineNode,p=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:c,linkedFromTaskKey:g,type:_}=d,{taskKeyField:y,minDate:k}=a.parsedOptions,f=ae(a.records,y,g),b=ae(a.records,y,c);let L,S,v,x,C,w,O,B,D;const H=this._gantt.getTaskBarStyle(e,t);if(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){const P=ie(i.attribute.y+s,a);B=f.index[0],O=a.getRowsHeightByIndex(0,P.task_index-1)/a.parsedOptions.rowHeight,{startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(b.index[0],b.index[1]),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(f.index[0],f.index[1]);const z=H.width;D=i.attribute.y+z/2-(O+.5)*a.parsedOptions.rowHeight}else if(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const P=ie(i.attribute.y+s,a);B=a.getRowsHeightByIndex(0,f.index[0]-1)/a.parsedOptions.rowHeight+(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?f.record.vtable_gantt_showIndex:f.index[1]),O=a.getRowsHeightByIndex(0,P.task_index-1)/a.parsedOptions.rowHeight+(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?b.record.vtable_gantt_showIndex:P.sub_task_index),{startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(b.index[0],b.index[1]),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(f.index[0],f.index[1]);const z=H.width;D=i.attribute.y+z/2-(O+.5)*a.parsedOptions.rowHeight}else{if(B=a.getTaskShowIndexByRecordIndex(f.index),O=a.getTaskShowIndexByRecordIndex(b.index),B===-1||O===-1)continue;({startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(O)),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(B)}if(!(x&&C&&L&&S&&u&&p))return;const{linePoints:N,arrowPoints:X}=Nt(_,x,C,B,w,f.record.type==="milestone",null,0,L,S,O,v,b.record.type==="milestone",i,D??0,this._gantt);u.setAttribute("points",N),p.setAttribute("points",X)}for(let h=0;h<(l==null?void 0:l.length);h++){const d=l[h],u=d.vtable_gantt_linkLineNode,p=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:c,linkedFromTaskKey:g,type:_}=d,{taskKeyField:y,minDate:k}=a.parsedOptions,f=ae(a.records,y,c),b=ae(a.records,y,g);let L,S,v,x,C,w,O,B,D;const H=this._gantt.getTaskBarStyle(e,t);if(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){const P=ie(i.attribute.y+s,a);B=a.getRowsHeightByIndex(0,P.task_index-1)/a.parsedOptions.rowHeight,O=f.index[0],{startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(f.index[0],f.index[1]),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(b.index[0],b.index[1]);const z=H.width;D=i.attribute.y+z/2-(B+.5)*a.parsedOptions.rowHeight}else if(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const P=ie(i.attribute.y+s,a);B=a.getRowsHeightByIndex(0,P.task_index-1)/a.parsedOptions.rowHeight+(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?b.record.vtable_gantt_showIndex:P.sub_task_index),O=a.getRowsHeightByIndex(0,f.index[0]-1)/a.parsedOptions.rowHeight+(a.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||a.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?f.record.vtable_gantt_showIndex:f.index[1]),{startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(f.index[0],f.index[1]),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(b.index[0],b.index[1]);const z=H.width;D=i.attribute.y+z/2-(B+.5)*a.parsedOptions.rowHeight}else{if(B=a.getTaskShowIndexByRecordIndex(b.index),O=a.getTaskShowIndexByRecordIndex(f.index),B===-1||O===-1)continue;({startDate:L,endDate:S,taskDays:v}=a.getTaskInfoByTaskListIndex(O)),{startDate:x,endDate:C,taskDays:w}=a.getTaskInfoByTaskListIndex(B)}if(!(x&&C&&L&&S&&u&&p))return;const{linePoints:N,arrowPoints:X}=Nt(_,x,C,B,w,b.record.type==="milestone",i,D??0,L,S,O,v,f.record.type==="milestone",null,0,this._gantt);u.setAttribute("points",N),p.setAttribute("points",X)}}}const vn=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},Tn=(n,e)=>vn(n)===e,xn=n=>Tn(n,"object");function qt(n,e,t){let i,s,a,r,o,l,h=0,d=!1,u=!1,p=!0;const c=!e&&e!==0&&typeof requestAnimationFrame=="function";if(typeof n!="function")throw new TypeError("Expected a function");function g(f){const b=i,L=s;return s=void 0,i=void 0,h=f,r=n.apply(L,b),r}function _(f,b){return c?requestAnimationFrame(f):setTimeout(f,b)}function y(f){const b=f-l;return l===void 0||b>=e||b<0||d&&f-h>=a}function k(){const f=Date.now();if(y(f))return function(b){return o=void 0,p&&i?g(b):(s=void 0,i=void 0,r)}(f);o=_(k,function(b){const L=b-h,S=e&&-(b-l);return d?Math.min(S,a-L):S}(f))}return e=+e||0,xn(t)&&(u=!!t.leading,d="maxWait"in t,d&&(a=Math.max(+t.maxWait||0,e)),p="trailing"in t?!!t.trailing:p),function(...f){const b=Date.now(),L=y(b);if(i=f,s=this,l=b,L){if(o===void 0)return function(S){return h=S,o=_(k,e),u?g(S):r}(l);if(d)return o=_(k,e),g(l)}return o===void 0&&(o=_(k,e)),r}}let Bn=1;class wn{constructor(e,t,i){var s;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const a=this.getSize();let r=!1;a.width===this.lastSize.width&&a.height===this.lastSize.height&&(r=!0),this.lastSize=a,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:r}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=qt(this.callBack,this.resizeTime),window==null||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){const a=window.ResizeObserver;this.observer=new a(this.mutationResize),(s=this.observer)===null||s===void 0||s.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){const e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class On{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,i,...s){if(F.mode==="node")return-1;const a=Bn++;if(e!=null&&e.addEventListener)if(t!=="resize"||e===window)e==null||e.addEventListener(t,i,...s);else{const o=new wn(e,i,this.resizeTime);this.reseizeListeners[a]=o}const r={target:e,type:t,listener:i,options:s};return this.listeners[a]=r,a}once(e,t,i,...s){if(F.mode==="node")return-1;const a=this.on(e,t,(...r)=>{this.off(a),i(...r)},...s);return a}off(e){var t;if(F.mode==="node"||e==null)return;const i=(t=this.listeners)===null||t===void 0?void 0:t[e];i&&(delete this.listeners[e],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(e,t,...i){if(F.mode!=="node")for(const s in this.listeners){const a=this.listeners[s];a.target===e&&a.type===t&&a.listener.call(a.target,...i)}}hasListener(e,t){if(F.mode==="node")return!1;let i=!1;for(const s in this.listeners){const a=this.listeners[s];a.target===e&&a.type===t&&(i=!0)}return i}clear(){if(F.mode!=="node"){for(const e in this.listeners){const t=this.listeners[e];t.target.removeEventListener&&t.target.removeEventListener(t.type,t.listener,...t.options)}for(const e in this.reseizeListeners){const t=this.reseizeListeners[e];t==null||t.disConnect()}this.listeners={}}}release(){F.mode!=="node"&&(this.clear(),this.listeners={})}}let Re=1;function Zt(){return Ci?Re=1:(Re=Math.ceil(window.devicePixelRatio||1),Re>1&&Re%2!=0&&(Re+=1)),Re}Zt();class Cn{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._gantt=e,this._eventHandler=new On,this.bindEvent()}release(){this._eventHandler.release(),this.globalEventListeners.forEach(e=>{e.env==="document"?document.removeEventListener(e.name,e.callback):e.env==="body"?document.body.removeEventListener(e.name,e.callback):e.env==="window"&&window.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}bindEvent(){Dn(this),Mn(this)}}function Dn(n){const e=n._gantt.scenegraph,t=n._gantt,i=t.stateManager;e.ganttGroup.addEventListener("pointerdown",s=>{if(s.button!==0)return;let a,r,o;if(s.detailPath.find(l=>l.name==="task-bar"?(a=l,!0):l.name==="task-creation-button"?!0:l.name==="task-bar-link-point-left"?(r=l,!0):l.name==="task-bar-link-point-right"?(o=l,!0):!!l.attribute.vtable_link&&(l.attribute.vtable_link,!0)),a){if(s.target.name==="task-bar-hover-shadow-left-icon")i.startResizeTaskBar(a,s.nativeEvent.x,s.nativeEvent.y,s.offset.y,"left"),i.updateInteractionState(R.grabing);else if(s.target.name==="task-bar-hover-shadow-right-icon")i.startResizeTaskBar(a,s.nativeEvent.x,s.nativeEvent.y,s.offset.y,"right"),i.updateInteractionState(R.grabing);else if(t.parsedOptions.taskBarMoveable){let l=!0;if(typeof t.parsedOptions.taskBarMoveable=="function"){const{startDate:h,endDate:d,taskRecord:u}=e._gantt.getTaskInfoByTaskListIndex(a.task_index,a.sub_task_index),p={index:a.task_index,startDate:h,endDate:d,taskRecord:u,ganttInstance:e._gantt};l=t.parsedOptions.taskBarMoveable(p)}else l=t.parsedOptions.taskBarMoveable;l&&(i.startMoveTaskBar(a,s.nativeEvent.x,s.nativeEvent.y,s.offset.y),i.updateInteractionState(R.grabing))}}else r?(i.startCreateDependencyLine(r,s.nativeEvent.x,s.nativeEvent.y,s.offset.y,"left"),i.updateInteractionState(R.grabing)):o&&(i.startCreateDependencyLine(o,s.nativeEvent.x,s.nativeEvent.y,s.offset.y,"right"),i.updateInteractionState(R.grabing))}),e.ganttGroup.addEventListener("pointermove",s=>{var a,r,o,l,h;if(i.interactionState===R.default){const d=s.detailPath.find(c=>c.name==="task-bar"),u=s.detailPath.find(c=>c.name==="markline-hover-group"),p=s.detailPath.find(c=>c.name==="mark-line-content");if(!((a=t.parsedOptions.markLineCreateOptions)===null||a===void 0)&&a.markLineCreatable&&(u&&!Ni(u.data,t.parsedOptions.markLine)?e._gantt.stateManager.marklineIcon.target!==u&&(e._gantt.stateManager.marklineIcon.target=u,i.showMarklineIconHover()):e._gantt.stateManager.marklineIcon.target&&i.hideMarklineIconHover()),d){if(e._gantt.stateManager.hoverTaskBar.target!==d&&(e._gantt.stateManager.hoverTaskBar.target=d,i.showTaskBarHover(),e._gantt.hasListeners(I.MOUSEENTER_TASK_BAR))){const c=d.task_index,g=d.sub_task_index,_=e._gantt.getRecordByIndex(c,g);e._gantt.fireListeners(I.MOUSEENTER_TASK_BAR,{federatedEvent:s,event:s.nativeEvent,index:c,sub_task_index:g,record:_})}}else{if(e._gantt.stateManager.hoverTaskBar.target){if(e._gantt.hasListeners(I.MOUSELEAVE_TASK_BAR)){const c=e._gantt.stateManager.hoverTaskBar.target.task_index,g=e._gantt.stateManager.hoverTaskBar.target.sub_task_index,_=e._gantt.getRecordByIndex(c,g);e._gantt.fireListeners(I.MOUSELEAVE_TASK_BAR,{federatedEvent:s,event:s.nativeEvent,index:c,sub_task_index:g,record:_})}i.hideTaskBarHover(s)}if(t.parsedOptions.taskBarCreatable&&!p){const c=ie(s.offset.y-t.headerHeight+t.stateManager.scrollTop,t),g=t.getTaskInfoByTaskListIndex(c.task_index,c.sub_task_index);let _=!0;if(typeof t.parsedOptions.taskBarCreatable=="function"){const{startDate:y,endDate:k,taskRecord:f}=g,b={index:c.task_index,sub_task_index:c.sub_task_index,startDate:y,endDate:k,taskRecord:f,ganttInstance:t};_=t.parsedOptions.taskBarCreatable(b)}else _=t.parsedOptions.taskBarCreatable;if(_){const y=Fi(s.offset.x,s.offset.y,t);if((t.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||t.parsedOptions.tasksShowMode===T.Tasks_Separate)&&!g.taskDays&&g.taskRecord&&!g.taskRecord.vtableMerge||(t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)&&!y){const k=Fe(s.offset.x,t),f=(k>=1?t.getDateColsWidth(0,k-1):0)-t.stateManager.scroll.horizontalBarPos,b=t.taskListTableInstance.getRowsHeight(t.taskListTableInstance.columnHeaderLevelCount,c.task_index+t.taskListTableInstance.columnHeaderLevelCount-1)+((r=c.sub_task_index)!==null&&r!==void 0?r:0)*t.parsedOptions.rowHeight-t.stateManager.scroll.verticalBarPos;return void t.scenegraph.showTaskCreationButton(f,b,k)}}}}t.scenegraph.hideTaskCreationButton()}else if(i.interactionState===R.grabing){let d,u,p;s.detailPath.find(c=>c.name==="task-bar"?(d=c,!0):c.name==="task-creation-button"?!0:c.name==="task-bar-link-point-left"?(u=c,!0):c.name==="task-bar-link-point-right"?(p=c,!0):!!c.attribute.vtable_link&&(c.attribute.vtable_link,!0)),d=(l=d??((o=u==null?void 0:u.parent)===null||o===void 0?void 0:o.attribute.attachedToTaskBarNode))!==null&&l!==void 0?l:(h=p==null?void 0:p.parent)===null||h===void 0?void 0:h.attribute.attachedToTaskBarNode,e._gantt.stateManager.isCreatingDependencyLine()&&!d?i.hideSecondTaskBarSelectedBorder():e._gantt.stateManager.isCreatingDependencyLine()&&u&&e._gantt.stateManager.selectedTaskBar.target!==d?(i.highlightLinkPointNode(u),i.creatingDenpendencyLink.lastHighLightLinkPoint=u,i.creatingDenpendencyLink.secondTaskBarPosition="left"):e._gantt.stateManager.isCreatingDependencyLine()&&p&&e._gantt.stateManager.selectedTaskBar.target!==d?(i.highlightLinkPointNode(p),i.creatingDenpendencyLink.lastHighLightLinkPoint=p,i.creatingDenpendencyLink.secondTaskBarPosition="right"):e._gantt.stateManager.isCreatingDependencyLine()&&d&&e._gantt.stateManager.selectedTaskBar.target!==d&&(i.unhighlightLinkPointNode(i.creatingDenpendencyLink.lastHighLightLinkPoint),i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode===d||(i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode!==d&&i.hideSecondTaskBarSelectedBorder(),i.creatingDenpendencyLink.secondTaskBarNode=d,i.showSecondTaskBarSelectedBorder()))}}),e.ganttGroup.addEventListener("pointerup",s=>{var a,r;if(s.button===0){let o,l,h,d=!1,u=!1,p=!1,c=!1,g=!1,_=!1,y=!1;const k=s.detailPath.find(f=>f.name==="task-bar"?(d=!0,!0):f.name==="task-creation-button"?(u=!0,!1):f.name==="task-bar-link-point-left"?(c=!0,!1):f.name==="task-bar-link-point-right"?(g=!0,!1):f.attribute.vtable_link?(p=!0,o=f.attribute.vtable_link,!1):f.name==="markline-hover-group"?(_=!0,h=f,!1):f.name==="mark-line-content"&&(y=!0,l=f,!1));if(d&&e._gantt.parsedOptions.taskBarSelectable&&n.poniterState==="down"){if(i.hideDependencyLinkSelectedLine(),i.showTaskBarSelectedBorder(k),t.hasListeners(I.CLICK_TASK_BAR)){const f=k.task_index,b=k.sub_task_index,L=t.getRecordByIndex(f,b);t.fireListeners(I.CLICK_TASK_BAR,{federatedEvent:s,event:s.nativeEvent,index:f,sub_task_index:b,record:L})}}else if(u&&n.poniterState==="down"){i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder();const f=ie(s.offset.y-t.headerHeight+t.stateManager.scrollTop,t);if(t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){if(t.hasListeners(I.CREATE_TASK_SCHEDULE)){const b=Fe(s.offset.x,t),L=t.getDateRangeByIndex(b),S=(a=t.parsedOptions.dateFormat)!==null&&a!==void 0?a:t.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd";t.fireListeners(I.CREATE_TASK_SCHEDULE,{federatedEvent:s,event:s.nativeEvent,index:f.task_index,sub_task_index:f.sub_task_index,startDate:re(L.startDate,S),endDate:re(L.endDate,S),record:void 0,parentRecord:t.getRecordByIndex(f.task_index)})}}else{const b=t.getTaskInfoByTaskListIndex(f.task_index,f.sub_task_index);if(b.taskRecord){const L=(r=t.parsedOptions.dateFormat)!==null&&r!==void 0?r:t.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd",S=Fe(s.offset.x,t),v=t.getDateRangeByIndex(S);b.taskRecord[t.parsedOptions.startDateField]=re(v.startDate,L),b.taskRecord[t.parsedOptions.endDateField]=re(v.endDate,L),t.scenegraph.hideTaskCreationButton(),t.updateTaskRecord(b.taskRecord,f.task_index,f.sub_task_index),t.hasListeners(I.CREATE_TASK_SCHEDULE)&&t.fireListeners(I.CREATE_TASK_SCHEDULE,{federatedEvent:s,event:s.nativeEvent,index:f.task_index,sub_task_index:f.sub_task_index,startDate:b.taskRecord[t.parsedOptions.startDateField],endDate:b.taskRecord[t.parsedOptions.endDateField],record:b.taskRecord})}}}else if(p&&e._gantt.parsedOptions.dependencyLinkSelectable&&n.poniterState==="down")i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder(),e._gantt.stateManager.selectedDenpendencyLink.link=o,i.showDependencyLinkSelectedLine();else if((c||g)&&n.poniterState==="down"){if(t.hasListeners(I.CLICK_DEPENDENCY_LINK_POINT)){const f=ie(s.offset.y-t.headerHeight+t.stateManager.scrollTop,t),b=t.getRecordByIndex(f.task_index,f.sub_task_index);t.fireListeners(I.CLICK_DEPENDENCY_LINK_POINT,{event:s.nativeEvent,index:f.task_index,sub_task_index:f.sub_task_index,point:c?"start":"end",record:b})}i.hideTaskBarSelectedBorder()}else if(_&&n.poniterState==="down")t.hasListeners(I.CLICK_MARKLINE_CREATE)&&t.fireListeners(I.CLICK_MARKLINE_CREATE,{event:s.nativeEvent,position:Et(h,e._gantt),data:e._gantt.stateManager.marklineIcon.target.data});else if(y&&n.poniterState==="down")t.hasListeners(I.CLICK_MARKLINE_CONTENT)&&t.fireListeners(I.CLICK_MARKLINE_CONTENT,{event:s.nativeEvent,position:Et(l,e._gantt),data:l.data});else if(c&&n.poniterState==="draging"){if(i.isCreatingDependencyLine()){const f=i.endCreateDependencyLine(s.offset.y);t.hasListeners(I.CREATE_DEPENDENCY_LINK)&&t.fireListeners(I.CREATE_DEPENDENCY_LINK,{federatedEvent:s,event:s.nativeEvent,link:f})}}else if(g&&n.poniterState==="draging"){if(i.isCreatingDependencyLine()){const f=i.endCreateDependencyLine(s.offset.y);t.hasListeners(I.CREATE_DEPENDENCY_LINK)&&t.fireListeners(I.CREATE_DEPENDENCY_LINK,{federatedEvent:s,event:s.nativeEvent,link:f})}}else i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder()}}),e.ganttGroup.addEventListener("rightdown",s=>{let a,r=!1,o=!1;const l=s.detailPath.find(h=>h.name==="task-bar"?(r=!0,!0):!!h.attribute.vtable_link&&(o=!0,a=h.attribute.vtable_link,!1));if(r){if(t.hasListeners(I.CONTEXTMENU_TASK_BAR)){const h=l.task_index,d=l.sub_task_index,u=t.getRecordByIndex(h,d);t.fireListeners(I.CONTEXTMENU_TASK_BAR,{federatedEvent:s,event:s.nativeEvent,index:h,sub_task_index:d,record:u})}}else o&&t.hasListeners(I.CONTEXTMENU_DEPENDENCY_LINK)&&t.fireListeners(I.CONTEXTMENU_DEPENDENCY_LINK,{federatedEvent:s,event:s.nativeEvent,link:a})}),e.ganttGroup.addEventListener("pointerenter",s=>{(t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showVerticalScrollBar()}),e.ganttGroup.addEventListener("pointerleave",s=>{if((t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideVerticalScrollBar(),e._gantt.stateManager.hoverTaskBar.target){if(e._gantt.hasListeners(I.MOUSELEAVE_TASK_BAR)){const a=e._gantt.stateManager.hoverTaskBar.target.task_index,r=e._gantt.stateManager.hoverTaskBar.target.sub_task_index,o=e._gantt.getRecordByIndex(a,r);e._gantt.fireListeners(I.MOUSELEAVE_TASK_BAR,{federatedEvent:s,event:s.nativeEvent,index:a,sub_task_index:r,record:o})}i.hideTaskBarHover(s)}}),e.ganttGroup.addEventListener("wheel",s=>{en(s,i,t)})}function Mn(n){const e=n._gantt,t=(n._gantt.scenegraph,e.stateManager),i=n._eventHandler;i.on(e.getElement(),"contextmenu",l=>{var h;((h=e.parsedOptions.eventOptions)===null||h===void 0?void 0:h.preventDefaultContextMenu)!==!1&&l.preventDefault()}),i.on(e.getContainer(),"resize",l=>{l.width===0&&l.height===0||(G(e.options.pixelRatio)||e.setPixelRatio(Zt()),l.windowSizeNotChange||e._resize())}),e.taskListTableInstance&&e.parsedOptions.verticalSplitLineMoveable&&i.on(e.verticalSplitResizeLine,"mousedown",l=>{t.updateInteractionState(R.grabing),t.startResizeTableWidth(l)}),e.parsedOptions.verticalSplitLineHighlight&&(e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseover",l=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="1"}),e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseout",l=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="0"}));const s=l=>{e.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y},e.eventManager.poniterState="down"};n.globalEventListeners.push({name:"mousedown",env:"document",callback:s}),Pe.addEventListener("mousedown",s);const a=l=>{var h,d,u,p,c,g;if(e.eventManager.poniterState==="down"){const _=(h=e.eventManager.lastDragPointerXYOnWindow.x)!==null&&h!==void 0?h:l.x,y=l.x-_,k=(d=e.eventManager.lastDragPointerXYOnWindow.y)!==null&&d!==void 0?d:l.y,f=l.y-k;(Math.abs(y)>=1||Math.abs(f)>=1)&&(e.eventManager.poniterState="draging")}if(t.interactionState===R.grabing&&e.eventManager.poniterState==="draging"){const _=(p=(u=e.eventManager.lastDragPointerXYOnWindow)===null||u===void 0?void 0:u.x)!==null&&p!==void 0?p:l.x,y=(g=(c=e.eventManager.lastDragPointerXYOnWindow)===null||c===void 0?void 0:c.y)!==null&&g!==void 0?g:l.y;(Math.abs(_-l.x)>=1||Math.abs(y-l.y)>=1)&&(t.isResizingTableWidth()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealResizeTableWidth(l)):t.isMoveingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarMove(l)):t.isResizingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarResize(l)):t.isCreatingDependencyLine()&&t.dealCreateDependencyLine(l),e.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y})}};n.globalEventListeners.push({name:"mousemove",env:"document",callback:a}),Pe.addEventListener("mousemove",a);const r=l=>{t.interactionState==="grabing"&&(t.updateInteractionState(R.default),t.isResizingTableWidth()?t.endResizeTableWidth():t.isMoveingTaskBar()?t.endMoveTaskBar():t.isResizingTaskBar()&&t.endResizeTaskBar(l.x)),e.eventManager.lastDragPointerXYOnWindow=void 0,e.eventManager.poniterState="up"};n.globalEventListeners.push({name:"mouseup",env:"document",callback:r}),Pe.addEventListener("mouseup",r);const o=l=>{var h,d;if(e.parsedOptions.dependencyLinkDeletable&&(l.key==="Delete"&&(!((h=e.parsedOptions.keyboardOptions)===null||h===void 0)&&h.deleteLinkOnDel)||l.key==="Backspace"&&(!((d=e.parsedOptions.keyboardOptions)===null||d===void 0)&&d.deleteLinkOnBack))&&e.stateManager.selectedDenpendencyLink.link){const u=e.stateManager.selectedDenpendencyLink.link;e.deleteLink(e.stateManager.selectedDenpendencyLink.link),t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),e.hasListeners(I.DELETE_DEPENDENCY_LINK)&&e.fireListeners(I.DELETE_DEPENDENCY_LINK,{event:l,link:u})}};n.globalEventListeners.push({name:"keydown",env:"document",callback:o}),Pe.addEventListener("keydown",o)}function Gt(n){const{scroll:e}=n.stateManager,{verticalBarPos:t}=e;n.taskListTableInstance.stateManager.setScrollTop(t,void 0,!1)}function Hn(n){var e;n.taskListTableInstance&&((e=n.taskListTableInstance)===null||e===void 0||e.on("scroll",t=>{if(t.scrollDirection==="vertical"){const{scroll:i}=n.taskListTableInstance.stateManager,{verticalBarPos:s}=i;n.stateManager.setScrollTop(s,!1)}}))}function An(n){var e;(e=n.taskListTableInstance)===null||e===void 0||e.on("change_cell_value",t=>{const{col:i,row:s,rawValue:a,changedValue:r}=t;n._refreshTaskBar(s-n.taskListTableInstance.columnHeaderLevelCount)})}function Wn(n){var e;(e=n.taskListTableInstance)===null||e===void 0||e.on("tree_hierarchy_state_change",t=>{var i;n._syncPropsFromTable(),n.scenegraph.refreshTaskBarsAndGrid(),!n.taskListTableInstance.checkHasColumnAutoWidth()||((i=n.options.taskListTable)===null||i===void 0?void 0:i.tableWidth)!=="auto"&&n.taskTableWidth!==-1||Qt(n);const s=n.stateManager.scroll.horizontalBarPos,a=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-s),n.scenegraph.setY(-a)})}function In(n){var e;(e=n.taskListTableInstance)===null||e===void 0||e.on("after_sort",t=>{n.scenegraph.refreshTaskBars();const i=n.stateManager.scroll.horizontalBarPos,s=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-i),n.scenegraph.setY(-s)})}function zn(n){var e,t,i,s;(e=n.taskListTableInstance)===null||e===void 0||e.on("change_header_position",a=>{n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?n.scenegraph.refreshTaskBarsAndGrid():n.scenegraph.refreshTaskBars(),n.scenegraph.dragOrderLine.hideDragLine();const r=n.stateManager.scroll.horizontalBarPos,o=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-r),n.scenegraph.setY(-o)}),(t=n.taskListTableInstance)===null||t===void 0||t.on("change_header_position_start",a=>{const{col:r,row:o,x:l,y:h,backX:d,lineX:u,backY:p,lineY:c,event:g}=a;n.scenegraph.dragOrderLine.showDragLine(c),n.scenegraph.updateNextFrame()}),(i=n.taskListTableInstance)===null||i===void 0||i.on("changing_header_position",a=>{const{col:r,row:o,x:l,y:h,backX:d,lineX:u,backY:p,lineY:c,event:g}=a;n.scenegraph.dragOrderLine.showDragLine(c),n.scenegraph.updateNextFrame()}),(s=n.taskListTableInstance)===null||s===void 0||s.on("change_header_position_fail",a=>{n.scenegraph.dragOrderLine.hideDragLine(),n.scenegraph.updateNextFrame()})}function En(n){var e;(e=n.taskListTableInstance)===null||e===void 0||e.on("resize_column",t=>{Qt(n)})}function Qt(n){var e,t,i,s,a,r,o,l;const h=n.taskTableWidth;n.taskTableWidth=n.taskListTableInstance.getAllColsWidth()+n.parsedOptions.outerFrameStyle.borderLineWidth,!((t=(e=n.options)===null||e===void 0?void 0:e.taskListTable)===null||t===void 0)&&t.maxTableWidth&&(n.taskTableWidth=Math.min((s=(i=n.options)===null||i===void 0?void 0:i.taskListTable)===null||s===void 0?void 0:s.maxTableWidth,n.taskTableWidth)),!((r=(a=n.options)===null||a===void 0?void 0:a.taskListTable)===null||r===void 0)&&r.minTableWidth&&(n.taskTableWidth=Math.max((l=(o=n.options)===null||o===void 0?void 0:o.taskListTable)===null||l===void 0?void 0:l.minTableWidth,n.taskTableWidth)),h!==n.taskTableWidth&&(n.element.style.left=n.taskTableWidth?`${n.taskTableWidth}px`:"0px",n.taskListTableInstance.setCanvasSize(n.taskTableWidth,n.tableNoFrameHeight+2*n.parsedOptions.outerFrameStyle.borderLineWidth),n._updateSize(),Ze(n))}class Rn{constructor(){}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,i){this.stopped=!1,this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var e;if(this.stopped)return;const t=Date.now(),i=t-this.lastTime;let s=!0;const a=Math.pow(this.friction,i/16),r=a*this.speedX,o=a*this.speedY;let l=0,h=0;Math.abs(r)>.05&&(s=!1,l=(this.speedX+r)/2*i),Math.abs(o)>.05&&(s=!1,h=(this.speedY+o)/2*i),(e=this.scrollHandle)===null||e===void 0||e.call(this,l,h),s?this.runingId=null:(this.lastTime=t,this.speedX=r,this.speedY=o,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null,this.stopped=!0}isInertiaScrolling(){return!!this.runingId}}class Pn{constructor(e){var t;this.interactionState=R.default,this.resetInteractionState=qt(()=>{this.updateInteractionState(R.default)},100),this._gantt=e,this.scroll={horizontalBarPos:0,verticalBarPos:0},this.moveTaskBar={targetStartX:null,targetStartY:null,deltaX:0,deltaY:0,startOffsetY:null,startX:null,startY:null,moving:!1,target:null,moveTaskBarXSpeed:0,moveTaskBarXInertia:new Rn},this.hoverTaskBar={targetStartX:null,startX:null,target:null},this.marklineIcon={target:null},this.selectedTaskBar={target:null},this.resizeTaskBar={startOffsetY:null,targetStartX:null,targetEndX:null,startX:null,startY:null,target:null,resizing:!1,onIconName:""},this.resizeTableWidth={lastX:null,resizing:!1},this.selectedDenpendencyLink={link:null},this.creatingDenpendencyLink={startClickedPoint:null,startX:null,startY:null,startOffsetY:null,targetStartX:null,creating:!1,secondTaskBarNode:null},this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this),Hn(this._gantt),An(this._gantt),zn(this._gantt),Wn(this._gantt),In(this._gantt),((t=this._gantt.options.taskListTable)===null||t===void 0?void 0:t.tableWidth)!=="auto"&&this._gantt.taskTableWidth!==-1||En(this._gantt)}setScrollTop(e,t=!0){const i=this._gantt.getAllRowsHeight();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.height)),e=Math.ceil(e);const s=this.scroll.verticalBarPos;this.scroll.verticalBarPos=e,G(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-e);const a=e/(i-this._gantt.scenegraph.height);this._gantt.scenegraph.scrollbarComponent.updateVerticalScrollBarPos(a),s!==e&&t&&(Gt(this._gantt),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:a}))}get scrollLeft(){return this.scroll.horizontalBarPos}get scrollTop(){return this.scroll.verticalBarPos}setScrollLeft(e,t=!0){const i=this._gantt.getAllDateColsWidth();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.width)),e=Math.ceil(e);const s=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=e,G(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-e);const a=e/(i-this._gantt.scenegraph.width);this._gantt.scenegraph.scrollbarComponent.updateHorizontalScrollBarPos(a),s!==e&&t&&this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioX:a})}updateInteractionState(e){if(this.interactionState===e)return;const t=this.interactionState;this.interactionState=e,t===R.scrolling&&R.default}updateVerticalScrollBar(e){const t=this._gantt.getAllRowsHeight();this.scroll.verticalBarPos,this.scroll.verticalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.height)),G(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-this.scroll.verticalBarPos,e===1),Gt(this._gantt),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:e})}updateHorizontalScrollBar(e){const t=this._gantt.getAllDateColsWidth();this.scroll.horizontalBarPos,this.scroll.horizontalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.width)),G(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-this.scroll.horizontalBarPos,e===1),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioY:e})}startMoveTaskBar(e,t,i,s){e.name==="task-bar-hover-shadow"&&(e=e.parent),this.moveTaskBar.moving=!0,this.moveTaskBar.target=e,this.moveTaskBar.targetStartX=e.attribute.x,this.moveTaskBar.targetStartY=e.attribute.y,this.moveTaskBar.startX=t,this.moveTaskBar.startY=i,this.moveTaskBar.startOffsetY=s,e.setAttribute("zIndex",1e4)}isMoveingTaskBar(){return this.moveTaskBar.moving}endMoveTaskBar(){this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()&&this.moveTaskBar.moveTaskBarXInertia.endInertia();const e=this.moveTaskBar.deltaX,t=this.moveTaskBar.deltaY,i=this.moveTaskBar.target;if(Math.abs(e)>=1||Math.abs(t)>=1){const s=i.task_index,a=i.sub_task_index,{startDate:r,endDate:o}=this._gantt.getTaskInfoByTaskListIndex(s,a),l=this.moveTaskBar.targetStartY+this._gantt.parsedOptions.rowHeight*Math.round(t/this._gantt.parsedOptions.rowHeight),h=this._gantt.parsedOptions.taskBarMilestoneStyle.width,d=this.moveTaskBar.target.attribute.x+(i.record.type==="milestone"?h/2:0),u=Fe(d-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),p=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[u];if(!p)return;const c=p.startDate,g=new Date(c.getTime()+(j(o).getTime()-j(r).getTime()));let _;if(j(r).getTime()!==c.getTime()){_=j(r).getTime()>c.getTime()?"left":"right",this._gantt._updateStartEndDateToTaskRecord(c,g,s,a);const y=this._gantt.getRecordByIndex(s,a);this._gantt.hasListeners(I.CHANGE_DATE_RANGE)&&this._gantt.fireListeners(I.CHANGE_DATE_RANGE,{startDate:y[this._gantt.parsedOptions.startDateField],endDate:y[this._gantt.parsedOptions.endDateField],oldStartDate:r,oldEndDate:o,index:s,record:y})}if(this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const y=ie(l,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,y.task_index,y.sub_task_index),Yt(this._gantt.records),this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid()}else if(this._gantt.parsedOptions.tasksShowMode!==T.Tasks_Separate&&Math.abs(Math.round(t/this._gantt.parsedOptions.rowHeight))>=1){const y=ie(l,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,y.task_index,y.sub_task_index),this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt.scenegraph.refreshTaskBarsAndGrid()):(this._gantt.scenegraph.taskBar.refresh(),this._gantt.scenegraph.dependencyLink.refresh())}else{let y=u>=1?this._gantt.getDateColsWidth(0,u-1):0;if(i.record.type==="milestone"&&(y-=this._gantt.parsedOptions.taskBarMilestoneStyle.width/2),qe(i,y-i.attribute.x,l-i.attribute.y,this),_==="right"){let k=i;for(;k.nextSibling&&k.nextSibling.attribute.y===i.attribute.y&&k.nextSibling.record[this._gantt.parsedOptions.startDateField]<=i.record[this._gantt.parsedOptions.startDateField];)k=k.nextSibling;k!==i&&k.parent.insertAfter(i,k)}else if(_==="left"){let k=i;for(;k.previousSibling&&k.previousSibling.attribute.y===i.attribute.y&&k.previousSibling.record[this._gantt.parsedOptions.startDateField]>=i.record[this._gantt.parsedOptions.startDateField];)k=k.previousSibling;k!==i&&k.parent.insertBefore(i,k)}}this._gantt.scenegraph.updateNextFrame()}this.moveTaskBar.moving=!1,this.selectedTaskBar.target!==i&&i.setAttribute("zIndex",0),this.moveTaskBar.target=null,this.moveTaskBar.deltaX=0,this.moveTaskBar.deltaY=0,this.moveTaskBar.moveTaskBarXSpeed=0}dealTaskBarMove(e){var t,i,s,a;const r=this._gantt;let o=this.moveTaskBar.target;o.setAttribute("zIndex",1e4);const l=r.eventManager.lastDragPointerXYOnWindow.x,h=e.x-l,d=r.eventManager.lastDragPointerXYOnWindow.y,u=e.y-d;if(this.moveTaskBar.deltaX+=h,this.moveTaskBar.deltaY+=u,qe(o,h,u,this),o.attribute.x<=r.stateManager.scrollLeft&&h<0)if(r.parsedOptions.moveTaskBarToExtendDateRange&&r.stateManager.scrollLeft===0){(t=this.moveTaskBar.moveTaskBarXInertia)===null||t===void 0||t.endInertia();const p=r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[1].startDate.getTime()-r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime(),{unit:c,startOfWeek:g}=r.parsedOptions.reverseSortedTimelineScales[0];r.parsedOptions.minDate=Ie(new Date(r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime()-p/2),c,g),r.parsedOptions._minDateTime=(i=r.parsedOptions.minDate)===null||i===void 0?void 0:i.getTime(),r._generateTimeLineDateMap(),r._updateSize(),r.scenegraph.refreshAll(),o=this.moveTaskBar.target=r.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),r.scrollLeft=r.parsedOptions.timelineColWidth-1,r.eventManager.lastDragPointerXYOnWindow.x=e.x,o.setAttribute("x",r.scrollLeft)}else this.moveTaskBar.moveTaskBarXSpeed=-r.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((p,c)=>{this.moveTaskBar.deltaX+=p,this.moveTaskBar.deltaY+=c,qe(o,p,c,this),r.stateManager.setScrollLeft(o.attribute.x),r.stateManager.scrollLeft===0&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else if(o.attribute.x+o.attribute.width>=r.stateManager.scrollLeft+r.tableNoFrameWidth&&h>0)if(r.parsedOptions.moveTaskBarToExtendDateRange&&r.stateManager.scrollLeft+r.tableNoFrameWidth===r.getAllDateColsWidth()){(s=this.moveTaskBar.moveTaskBarXInertia)===null||s===void 0||s.endInertia();const p=r.parsedOptions.reverseSortedTimelineScales[0].timelineDates,c=p[1].startDate.getTime()-p[0].startDate.getTime(),{unit:g,startOfWeek:_,step:y}=r.parsedOptions.reverseSortedTimelineScales[0];r.parsedOptions.maxDate=Ue(r.parsedOptions.minDate,new Date(p[p.length-1].endDate.getTime()+c/2),g,y),r.parsedOptions._maxDateTime=(a=r.parsedOptions.maxDate)===null||a===void 0?void 0:a.getTime(),r._generateTimeLineDateMap(),r._updateSize(),r.scenegraph.refreshAll(),o=this.moveTaskBar.target=r.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),r.scrollLeft+=1,r.eventManager.lastDragPointerXYOnWindow.x=e.x,o.setAttribute("x",r.scrollLeft+r.tableNoFrameWidth-o.attribute.width)}else this.moveTaskBar.moveTaskBarXSpeed=r.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((p,c)=>{this.moveTaskBar.deltaX+=p,this.moveTaskBar.deltaY+=c,qe(o,p,c,this),r.stateManager.setScrollLeft(o.attribute.x+o.attribute.width-r.tableNoFrameWidth),r.stateManager.scrollLeft===r.getAllDateColsWidth()-r.tableNoFrameWidth&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()?this.moveTaskBar.moveTaskBarXInertia.endInertia():this.moveTaskBar.moveTaskBarXSpeed=0;r.scenegraph.updateNextFrame()}startResizeTaskBar(e,t,i,s,a){this.resizeTaskBar.onIconName=a,this.resizeTaskBar.resizing=!0,this.resizeTaskBar.target=e,this.resizeTaskBar.targetStartX=e.attribute.x,this.resizeTaskBar.targetEndX=e.attribute.x+e.attribute.width,this.resizeTaskBar.startX=t,this.resizeTaskBar.startY=i,this.resizeTaskBar.startOffsetY=s}isResizingTaskBar(){return this.resizeTaskBar.resizing}endResizeTaskBar(e){const t=this._gantt.stateManager.resizeTaskBar.onIconName,i=e-this.resizeTaskBar.startX;if(Math.abs(i)>=1){const s=Fe((t==="left"?this.resizeTaskBar.target.attribute.x:this.resizeTaskBar.target.attribute.x+this.resizeTaskBar.target.attribute.width)-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),a=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[s];if(!a)return;const r=t==="left"?a.startDate:a.endDate,o=this.resizeTaskBar.target,l=o.clipGroupBox,h=o.barRect,d=o.progressRect,u=o.textLabel,p=o.task_index,c=o.sub_task_index,{taskDays:g,progress:_,startDate:y,endDate:k}=this._gantt.getTaskInfoByTaskListIndex(p,c);let f=!1;if(t==="left"?(this._gantt._updateStartDateToTaskRecord(r,p,c),r.getTime()!==new Date(y).getTime()&&(f=!0)):(this._gantt._updateEndDateToTaskRecord(r,p,c),r.getTime()!==new Date(k).getTime()&&(f=!0)),this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid();else{if(t==="left"){const b=s>=1?this._gantt.getDateColsWidth(0,s-1):0;o.setAttribute("x",b),o.setAttribute("width",this.resizeTaskBar.targetEndX-b)}else if(t==="right"){const b=this._gantt.getDateColsWidth(0,s);o.setAttribute("width",b-this.resizeTaskBar.targetStartX)}if(l.setAttribute("width",o.attribute.width),h==null||h.setAttribute("width",o.attribute.width),d==null||d.setAttribute("width",_/100*o.attribute.width),u){const{textAlign:b,textBaseline:L,padding:S}=this._gantt.parsedOptions.taskBarLabelStyle,v=Je(et(S),b,L,o.attribute.width,o.attribute.height);u.setAttribute("maxLineWidth",o.attribute.width-2*$t),u.setAttribute("x",v.x)}this._gantt.scenegraph.refreshRecordLinkNodes(p,c,o,0),this.showTaskBarHover(),Jt(this._gantt,o,p,c),o.setAttribute("zIndex",0)}if(this.resizeTaskBar.resizing=!1,this.resizeTaskBar.target=null,f&&this._gantt.hasListeners(I.CHANGE_DATE_RANGE)){const b=this._gantt.getRecordByIndex(p,c);this._gantt.fireListeners(I.CHANGE_DATE_RANGE,{startDate:b[this._gantt.parsedOptions.startDateField],endDate:b[this._gantt.parsedOptions.endDateField],oldStartDate:y,oldEndDate:k,index:p,record:b})}this._gantt.scenegraph.updateNextFrame()}}dealTaskBarResize(e){const t=this._gantt.eventManager.lastDragPointerXYOnWindow.x,i=e.x-t,s=this._gantt.stateManager.resizeTaskBar.target;let a=this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-i:i;const r=Math.max(1,s.attribute.width+a);a=r-s.attribute.width,Fn(s,this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-a:0,r,this),this._gantt.scenegraph.updateNextFrame()}startCreateDependencyLine(e,t,i,s,a){this.creatingDenpendencyLink.creating=!0,this.creatingDenpendencyLink.startClickedPoint=e,this.creatingDenpendencyLink.startX=t,this.creatingDenpendencyLink.startY=i,this.creatingDenpendencyLink.startOffsetY=s,this.creatingDenpendencyLink.firstTaskBarPosition=a,this.highlightLinkPointNode(e)}isCreatingDependencyLine(){return this.creatingDenpendencyLink.creating}endCreateDependencyLine(e){const t=this._gantt.parsedOptions.taskKeyField,i=this.selectedTaskBar.target.task_index,s=this.selectedTaskBar.target.sub_task_index,a=this.creatingDenpendencyLink.secondTaskBarNode.task_index,r=this.creatingDenpendencyLink.secondTaskBarNode.sub_task_index,o={linkedFromTaskKey:this._gantt.getRecordByIndex(i,s)[t],linkedToTaskKey:this._gantt.getRecordByIndex(a,r)[t],type:this.creatingDenpendencyLink.firstTaskBarPosition==="left"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?U.StartToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?U.FinishToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="right"?U.FinishToFinish:U.StartToFinish};return this._gantt.addLink(o),this.hideTaskBarSelectedBorder(),this._gantt.scenegraph.updateNextFrame(),this.creatingDenpendencyLink.creating=!1,o}dealCreateDependencyLine(e){const t=this.creatingDenpendencyLink.startX,i=this.creatingDenpendencyLink.startY,s=e.x-t,a=e.y-i,r=this.creatingDenpendencyLink.startClickedPoint,o=r.attribute.x+r.attribute.width/2,l=r.attribute.y+r.attribute.height/2;this._gantt.scenegraph.taskBar.updateCreatingDependencyLine(o,l,o+s,l+a),this._gantt.scenegraph.updateNextFrame()}startResizeTableWidth(e){this.resizeTableWidth.resizing=!0,this.resizeTableWidth.lastX=e.pageX}isResizingTableWidth(){return this.resizeTableWidth.resizing}endResizeTableWidth(){this.resizeTableWidth.resizing=!1}dealResizeTableWidth(e){var t,i;if(!this.resizeTableWidth.resizing)return;const s=e.pageX-this.resizeTableWidth.lastX;if(Math.abs(s)>=1){let a=this._gantt.taskTableWidth+s;const r=Math.min(this._gantt.taskListTableInstance.getAllColsWidth()+this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(t=this._gantt.options.taskListTable.maxTableWidth)!==null&&t!==void 0?t:1e5),o=Math.max(this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(i=this._gantt.options.taskListTable.minTableWidth)!==null&&i!==void 0?i:0);s>0&&a>r&&(a=r),s<0&&a<o&&(a=o),this._gantt.taskTableWidth=a,this._gantt.element.style.left=this._gantt.taskTableWidth?`${this._gantt.taskTableWidth}px`:"0px",this._gantt.verticalSplitResizeLine.style.left=this._gantt.taskTableWidth?this._gantt.taskTableWidth-7+"px":"0px",this._gantt._resize(),this.resizeTableWidth.lastX=e.pageX}}showTaskBarHover(){const e=this._gantt.stateManager.hoverTaskBar.target;if(e){const t=e.attribute.x,i=e.attribute.y,s=e.attribute.width,a=e.attribute.height;this._gantt.scenegraph.taskBar.showHoverBar(t,i,s,a,e),this._gantt.scenegraph.updateNextFrame()}}hideTaskBarHover(e){this._gantt.stateManager.hoverTaskBar.target=null,this._gantt.scenegraph.taskBar.hideHoverBar(),this._gantt.scenegraph.updateNextFrame()}showTaskBarSelectedBorder(e){var t;(t=this._gantt.stateManager.selectedTaskBar.target)===null||t===void 0||t.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=e;const i=this._gantt.parsedOptions.dependencyLinkCreatable;e.setAttribute("zIndex",1e4);const s=e.attribute.x,a=e.attribute.y,r=e.attribute.width,o=e.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(s,a,r,o,e,i),this._gantt.scenegraph.updateNextFrame()}hideTaskBarSelectedBorder(){var e;(e=this._gantt.stateManager.selectedTaskBar.target)===null||e===void 0||e.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=null,this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showSecondTaskBarSelectedBorder(){const e=this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode,t=e.attribute.x,i=e.attribute.y,s=e.attribute.width,a=e.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(t,i,s,a,e,!0),this._gantt.scenegraph.updateNextFrame()}hideSecondTaskBarSelectedBorder(){this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode=null,this._gantt.scenegraph.taskBar.removeSecondSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showDependencyLinkSelectedLine(){const e=this._gantt.stateManager.selectedDenpendencyLink.link;this._gantt.scenegraph.dependencyLink.createSelectedLinkLine(e);const{taskKeyField:t,dependencyLinks:i}=this._gantt.parsedOptions,{linkedToTaskKey:s,linkedFromTaskKey:a,type:r}=e;let o,l,h,d;const u=ae(this._gantt.records,t,s),p=ae(this._gantt.records,t,a);this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(o=p.index[0],l=p.index[1],h=u.index[0],d=u.index[1]):(o=this._gantt.getTaskShowIndexByRecordIndex(p.index),h=this._gantt.getTaskShowIndexByRecordIndex(u.index));const c=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(o,l);this._gantt.scenegraph.taskBar.createSelectedBorder(c.attribute.x,c.attribute.y,c.attribute.width,c.attribute.height,c,!1);const g=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(h,d);this._gantt.scenegraph.taskBar.createSelectedBorder(g.attribute.x,g.attribute.y,g.attribute.width,g.attribute.height,g,!1),this._gantt.scenegraph.updateNextFrame()}hideDependencyLinkSelectedLine(){this._gantt.stateManager.selectedDenpendencyLink.link=null,this._gantt.scenegraph.dependencyLink.removeSelectedLinkLine(),this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}highlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}unhighlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}showMarklineIconHover(){var e,t;const i=this._gantt.stateManager.marklineIcon.target;if(i){const s=this._gantt.scenegraph.timelineHeader.showMarklineIcon(i.parent);s&&(!((t=(e=this._gantt.parsedOptions.markLineCreateOptions)===null||e===void 0?void 0:e.markLineCreationHoverToolTip)===null||t===void 0)&&t.tipContent)&&this._gantt.scenegraph.showToolTip(s),this._gantt.scenegraph.updateNextFrame()}}hideMarklineIconHover(){this._gantt.scenegraph.timelineHeader.hideMarklineIconHover(this._gantt.stateManager.marklineIcon.target.parent),this._gantt.scenegraph.hideToolTip(),this._gantt.stateManager.marklineIcon.target=null,this._gantt.scenegraph.updateNextFrame()}}function Jt(n,e,t,i){const s=n.parsedOptions.taskBarCustomLayout;if(s){let a;if(typeof s=="function"){const{startDate:r,endDate:o,taskDays:l,progress:h,taskRecord:d}=n.getTaskInfoByTaskListIndex(t,i);a=s({width:e.attribute.width,height:e.attribute.height,index:t,startDate:r,endDate:o,taskDays:l,progress:h,taskRecord:d,ganttInstance:n})}else a=s;if(a){const r=a.rootContainer;r.name="task-bar-custom-render";const o=e.children.find(l=>l.name==="task-bar-group");if(o){const l=o.children.findIndex(d=>d.name==="task-bar-custom-render"),h=o.children[l];h&&(o.removeChild(h),o.insertInto(r,l))}}}}function qe(n,e,t,i){const s=n.task_index,a=n.sub_task_index,r=n.record.type==="milestone";e&&n.setAttribute("x",Math.max(0,n.attribute.x+e)),i._gantt.parsedOptions.tasksShowMode!==T.Tasks_Separate?t&&n.setAttribute("y",n.attribute.y+t):t=0,r&&n.setAttribute("anchor",[n.attribute.x+n.attribute.width/2,n.attribute.y+n.attribute.height/2]),i._gantt.scenegraph.refreshRecordLinkNodes(s,a,n,t)}function Fn(n,e,t,i){const s=i._gantt.parsedOptions.progressField,a=n.clipGroupBox,r=n.barRect,o=n.progressRect,l=n.textLabel,h=n.task_index,d=n.sub_task_index,u=n.record,p=u[s],c=u.type==="milestone";if(n.setAttribute("zIndex",1e4),e&&n.setAttribute("x",n.attribute.x+e),c&&n.setAttribute("anchor",[n.attribute.x+n.attribute.width/2,n.attribute.y+n.attribute.height/2]),t&&n.setAttribute("width",t),a.setAttribute("width",n.attribute.width),r==null||r.setAttribute("width",n.attribute.width),o==null||o.setAttribute("width",p/100*n.attribute.width),l){const{textAlign:g,textBaseline:_,padding:y}=i._gantt.parsedOptions.taskBarLabelStyle,k=Je(et(y),g,_,t,n.attribute.height);l.setAttribute("maxLineWidth",t-2*$t),l.setAttribute("x",k.x)}i.showTaskBarHover(),Jt(i._gantt,n,h,d),i._gantt.scenegraph.refreshRecordLinkNodes(h,d,n,0)}let Nn=1;class Gn{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(e,t){const i=this.listenersData.listeners[e]||(this.listenersData.listeners[e]=[]);i.push(t);const s=Nn++;return this.listenersData.listenerData[s]={type:e,listener:t,remove:()=>{delete this.listenersData.listenerData[s];const a=i.indexOf(t);i.splice(a,1),this.listenersData.listeners[e].length||delete this.listenersData.listeners[e]}},s}off(e,t){var i;if(t){const s=e;this.removeEventListener(s,t)}else{const s=e;if(!this.listenersData)return;(i=this.listenersData.listenerData[s])===null||i===void 0||i.remove()}}addEventListener(e,t,i){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(const i in this.listenersData.listenerData){const s=this.listenersData.listenerData[i];s.type===e&&s.listener===t&&this.off(i)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){if(!this.listenersData)return[];const i=this.listenersData.listeners[e];return i?i.map(s=>s.call(this,t)).filter(s=>G(s)):[]}release(){delete this.listenersData}}class jn{constructor(e){this._gantt=e,this.records=e.records,this.processRecords()}processRecords(){const e=!this._gantt.options.minDate,t=!this._gantt.options.maxDate;let i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;if((e||t||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)&&this.records.length){for(let l=0;l<this.records.length;l++){const h=this.records[l];if(e&&h[this._gantt.parsedOptions.startDateField]){const d=j(h[this._gantt.parsedOptions.startDateField]);i=Math.min(i,d.getTime())}if(t&&h[this._gantt.parsedOptions.endDateField]){const d=j(h[this._gantt.parsedOptions.endDateField]);s=Math.max(s,d.getTime())}this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||h.children&&h.children.sort((d,u)=>j(d[this._gantt.parsedOptions.startDateField]).getTime()-j(u[this._gantt.parsedOptions.startDateField]).getTime())}const{unit:a,startOfWeek:r,step:o}=this._gantt.parsedOptions.reverseSortedTimelineScales[0];e&&(this._gantt.parsedOptions.minDate=Ie(new Date(i),a,r),this._gantt.parsedOptions._minDateTime=this._gantt.parsedOptions.minDate.getTime()),t&&(this._gantt.parsedOptions.maxDate=Ue(this._gantt.parsedOptions.minDate,new Date(s),a,o),this._gantt.parsedOptions._maxDateTime=this._gantt.parsedOptions.maxDate.getTime())}}adjustOrder(e,t,i,s){var a,r;if(this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||e!==i){if(this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){if(G(t)&&G(s)&&G(e)&&G(i)){const o=this.records[e].children[t];this.records[e].children.splice(t,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(s,0,o)}(r=(a=this.records[i])===null||a===void 0?void 0:a.children)===null||r===void 0||r.sort((o,l)=>j(o[this._gantt.parsedOptions.startDateField]).getTime()-j(l[this._gantt.parsedOptions.startDateField]).getTime())}else if(G(t)&&G(s)&&G(e)&&G(i)){const o=this.records[e].children[t];this.records[e].children.splice(t,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(s,0,o)}}}setRecords(e){this.records=e,this.processRecords()}}function Xn(n,e="vtable-gantt"){var t,i;const s=document.createElement("div");s.setAttribute("tabindex","0"),s.classList.add(e),s.style.outline="none",s.style.margin=`${n.top}px ${n.right}px ${n.bottom}px ${n.left}px`;const a=(s.offsetWidth||((t=s.parentElement)===null||t===void 0?void 0:t.offsetWidth)||1)-1,r=(s.offsetHeight||((i=s.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return s.style.width=a&&a-n.left-n.right+"px"||"0px",s.style.height=r&&r-n.top-n.bottom+"px"||"0px",s}class Ct extends Gn{constructor(e,t){var i,s,a,r,o;super(),this.parsedOptions={},this.container=e,this.options=t,this.taskTableWidth=typeof((i=t==null?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)=="number"?(s=t==null?void 0:t.taskListTable)===null||s===void 0?void 0:s.tableWidth:-1,this.taskTableColumns=(r=(a=t==null?void 0:t.taskListTable)===null||a===void 0?void 0:a.columns)!==null&&r!==void 0?r:[],this.records=(o=t==null?void 0:t.records)!==null&&o!==void 0?o:[],this._sortScales(),zt(this),this.data=new jn(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.element=Xn({top:0,right:0,left:0,bottom:0},"vtable-gantt"),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),e?(e.appendChild(this.element),this._updateSize()):this._updateSize(),this._generateListTable(),this._syncPropsFromTable(),zi(this),this.scenegraph=new Ln(this),this.stateManager=new Pn(this),this.eventManager=new Cn(this),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}renderTaskBarsTable(){this.scenegraph.updateNextFrame()}_updateSize(){var e,t,i,s,a,r,o,l;let h=0,d=0;if(F.mode==="browser"){const c=this.getElement();let g=0,_=0;if(c.parentElement){const b=c.parentElement.style||window.getComputedStyle(c.parentElement);g=c.parentElement.offsetWidth-parseInt(b.paddingLeft||"0px",10)-parseInt(b.paddingRight||"0px",10),_=c.parentElement.offsetHeight-parseInt(b.paddingTop||"0px",10)-parseInt(b.paddingBottom||"0px",20)}const y=(g??1)-1-this.taskTableWidth,k=(_??1)-1;c.style.width=y&&`${y}px`||"0px",c.style.height=k&&`${k}px`||"0px";const{canvas:f}=this;h=(t=(e=f.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&t!==void 0?t:1,d=(s=(i=f.parentElement)===null||i===void 0?void 0:i.offsetHeight)!==null&&s!==void 0?s:1,!((a=this==null?void 0:this.scenegraph)===null||a===void 0)&&a.stage?this.scenegraph.stage.resize(h,d):(f.style.width="",f.style.height="",f.width=h,f.height=d,f.style.width=`${h}px`,f.style.height=`${d}px`)}else F.mode;const u=Math.floor(h-Hi(this.parsedOptions.scrollStyle)),p=Math.floor(d-Mi(this.parsedOptions.scrollStyle));if(this.tableNoFrameWidth=h,this.tableNoFrameHeight=Math.floor(d),this.parsedOptions.outerFrameStyle){const c=(r=this.parsedOptions.outerFrameStyle)===null||r===void 0?void 0:r.borderLineWidth;this.tableX=this.taskTableColumns.length>=1||!((o=this.options)===null||o===void 0)&&o.rowSeriesNumber?(l=this.parsedOptions.verticalSplitLine.lineWidth)!==null&&l!==void 0?l:0:c,this.tableY=c,this.tableNoFrameWidth=Math.min(u-c-this.tableX,this.getAllDateColsWidth()),this.tableNoFrameHeight=p-2*c}}_updateListTableSize(e){var t,i,s,a,r,o,l,h,d,u;if(e&&(((i=(t=this.options)===null||t===void 0?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)!=="auto"&&this.taskTableWidth!==-1||(this.taskTableWidth=e.getAllColsWidth()+this.parsedOptions.outerFrameStyle.borderLineWidth,!((a=(s=this.options)===null||s===void 0?void 0:s.taskListTable)===null||a===void 0)&&a.maxTableWidth&&(this.taskTableWidth=Math.min((o=(r=this.options)===null||r===void 0?void 0:r.taskListTable)===null||o===void 0?void 0:o.maxTableWidth,this.taskTableWidth)),!((h=(l=this.options)===null||l===void 0?void 0:l.taskListTable)===null||h===void 0)&&h.minTableWidth&&(this.taskTableWidth=Math.max((u=(d=this.options)===null||d===void 0?void 0:d.taskListTable)===null||u===void 0?void 0:u.minTableWidth,this.taskTableWidth)),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",e.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._updateSize()),e.columnHeaderLevelCount>1))if(e.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let p=0;p<e.columnHeaderLevelCount;p++)e.setRowHeight(p,this.parsedOptions.timeLineHeaderRowHeights[p]);else{const p=this.getAllHeaderRowsHeight()/e.columnHeaderLevelCount;for(let c=0;c<e.columnHeaderLevelCount;c++)e.setRowHeight(c,p)}}_generateListTable(){var e;if(this.taskTableColumns.length>=1||!((e=this.options)===null||e===void 0)&&e.rowSeriesNumber){const t=this._generateListTableOptions();this.taskListTableInstance=new Si(this.container,t),this._updateListTableSize(this.taskListTableInstance)}}_generateListTableOptions(){var e,t,i,s,a,r,o,l,h,d,u,p,c,g,_,y,k,f,b,L,S,v,x,C,w,O,B,D,H,N,X,P,z,Y,K,V,q,Z,Q,le,oe,ne,ee,ue,pe,ge,fe,_e,be,me,ke,ye,Se,Le,ve,Te,xe,Be,we,Oe,Ce,De,Me,He,Ae,We;const M={},Ne=["container","records","rowSeriesNumber","overscrollBehavior","pixelRatio","eventOptions"];for(const A in this.options)Ne.indexOf(A)>=0&&(M[A]=this.options[A]);for(const A in this.options.taskListTable){if(M[A]=this.options.taskListTable[A],A==="columns"&&(M[A][M[A].length-1].disableColumnResize=!0,this.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact))for(let $=0;$<M.columns.length;$++)M.columns[$].tree&&(M.columns[$].tree=!1);A!=="hierarchyExpandLevel"||this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||delete M[A]}if(!((e=this.options.taskListTable)===null||e===void 0)&&e.theme)if(M.theme=(t=this.options.taskListTable)===null||t===void 0?void 0:t.theme,M.theme.bodyStyle&&!Ui(M.theme,"bodyStyle")){M.theme=((i=this.options.taskListTable)===null||i===void 0?void 0:i.theme).extends(((s=this.options.taskListTable)===null||s===void 0?void 0:s.theme).getExtendTheme());const A=M.theme.getExtendTheme();M.theme.clearBodyStyleCache(),!((a=M.theme.headerStyle)===null||a===void 0)&&a.bgColor||(A.headerStyle?A.headerStyle.bgColor||(A.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):A.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor}),A.bodyStyle?A.bodyStyle.frameStyle={borderLineWidth:[(o=(r=this.parsedOptions.horizontalSplitLine)===null||r===void 0?void 0:r.lineWidth)!==null&&o!==void 0?o:0,0,0,0],borderColor:(l=this.parsedOptions.horizontalSplitLine)===null||l===void 0?void 0:l.lineColor}:A.bodyStyle={frameStyle:{borderLineWidth:[(d=(h=this.parsedOptions.horizontalSplitLine)===null||h===void 0?void 0:h.lineWidth)!==null&&d!==void 0?d:0,0,0,0],borderColor:(u=this.parsedOptions.horizontalSplitLine)===null||u===void 0?void 0:u.lineColor}},A.cellInnerBorder=!1,A.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{shadowBlur:0,cornerRadius:[(c=(p=this.parsedOptions.outerFrameStyle)===null||p===void 0?void 0:p.cornerRadius)!==null&&c!==void 0?c:0,0,0,(_=(g=this.parsedOptions.outerFrameStyle)===null||g===void 0?void 0:g.cornerRadius)!==null&&_!==void 0?_:0],borderLineWidth:[(k=(y=this.parsedOptions.outerFrameStyle)===null||y===void 0?void 0:y.borderLineWidth)!==null&&k!==void 0?k:0,0,(b=(f=this.parsedOptions.outerFrameStyle)===null||f===void 0?void 0:f.borderLineWidth)!==null&&b!==void 0?b:0,(S=(L=this.parsedOptions.outerFrameStyle)===null||L===void 0?void 0:L.borderLineWidth)!==null&&S!==void 0?S:0]}),A.scrollStyle=Object.assign({},(x=(v=this.options.taskListTable)===null||v===void 0?void 0:v.theme)===null||x===void 0?void 0:x.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),A.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},A==null?void 0:A.columnResize),A.underlayBackgroundColor||(A.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor)}else M.theme.headerStyle?M.theme.headerStyle.bgColor||(M.theme.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):M.theme.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor},M.theme.headerStyle=Object.assign({},Xe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(w=(C=this.options.taskListTable)===null||C===void 0?void 0:C.theme)===null||w===void 0?void 0:w.headerStyle),M.theme.bodyStyle=Object.assign({},Xe.bodyStyle,(B=(O=this.options.taskListTable)===null||O===void 0?void 0:O.theme)===null||B===void 0?void 0:B.bodyStyle,{frameStyle:{borderLineWidth:[(H=(D=this.parsedOptions.horizontalSplitLine)===null||D===void 0?void 0:D.lineWidth)!==null&&H!==void 0?H:0,0,0,0],borderColor:(N=this.parsedOptions.horizontalSplitLine)===null||N===void 0?void 0:N.lineColor}}),M.theme.cellInnerBorder=!1,M.theme.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(P=(X=this.parsedOptions.outerFrameStyle)===null||X===void 0?void 0:X.cornerRadius)!==null&&P!==void 0?P:0,0,0,(Y=(z=this.parsedOptions.outerFrameStyle)===null||z===void 0?void 0:z.cornerRadius)!==null&&Y!==void 0?Y:0],borderLineWidth:[(V=(K=this.parsedOptions.outerFrameStyle)===null||K===void 0?void 0:K.borderLineWidth)!==null&&V!==void 0?V:0,0,(Z=(q=this.parsedOptions.outerFrameStyle)===null||q===void 0?void 0:q.borderLineWidth)!==null&&Z!==void 0?Z:0,(le=(Q=this.parsedOptions.outerFrameStyle)===null||Q===void 0?void 0:Q.borderLineWidth)!==null&&le!==void 0?le:0]}),M.theme.scrollStyle=Object.assign({},(ne=(oe=this.options.taskListTable)===null||oe===void 0?void 0:oe.theme)===null||ne===void 0?void 0:ne.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),M.theme.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(ue=(ee=this.options.taskListTable)===null||ee===void 0?void 0:ee.theme)===null||ue===void 0?void 0:ue.columnResize),M.theme.underlayBackgroundColor||(M.theme.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor);else M.theme={scrollStyle:Object.assign({},(ge=(pe=this.options.taskListTable)===null||pe===void 0?void 0:pe.theme)===null||ge===void 0?void 0:ge.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),headerStyle:Object.assign({},Xe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(_e=(fe=this.options.taskListTable)===null||fe===void 0?void 0:fe.theme)===null||_e===void 0?void 0:_e.headerStyle),bodyStyle:Object.assign({},Xe.bodyStyle,(me=(be=this.options.taskListTable)===null||be===void 0?void 0:be.theme)===null||me===void 0?void 0:me.bodyStyle,{frameStyle:{borderLineWidth:[(ye=(ke=this.parsedOptions.horizontalSplitLine)===null||ke===void 0?void 0:ke.lineWidth)!==null&&ye!==void 0?ye:0,0,0,0],borderColor:(Se=this.parsedOptions.horizontalSplitLine)===null||Se===void 0?void 0:Se.lineColor}}),cellInnerBorder:!1,frameStyle:Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(ve=(Le=this.parsedOptions.outerFrameStyle)===null||Le===void 0?void 0:Le.cornerRadius)!==null&&ve!==void 0?ve:0,0,0,(xe=(Te=this.parsedOptions.outerFrameStyle)===null||Te===void 0?void 0:Te.cornerRadius)!==null&&xe!==void 0?xe:0],borderLineWidth:[(we=(Be=this.parsedOptions.outerFrameStyle)===null||Be===void 0?void 0:Be.borderLineWidth)!==null&&we!==void 0?we:0,0,(Ce=(Oe=this.parsedOptions.outerFrameStyle)===null||Oe===void 0?void 0:Oe.borderLineWidth)!==null&&Ce!==void 0?Ce:0,(Me=(De=this.parsedOptions.outerFrameStyle)===null||De===void 0?void 0:De.borderLineWidth)!==null&&Me!==void 0?Me:0]}),columnResize:Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(Ae=(He=this.options.taskListTable)===null||He===void 0?void 0:He.theme)===null||Ae===void 0?void 0:Ae.columnResize),underlayBackgroundColor:this.parsedOptions.underlayBackgroundColor};return M.canvasWidth=this.taskTableWidth,M.canvasHeight=this.canvas.height,M.defaultHeaderRowHeight=this.getAllHeaderRowsHeight(),this.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(M.customComputeRowHeight=A=>{var $;const{row:de,table:te}=A,ze=te.getRecordByRowCol(0,de);if(ze)return((($=ze.children)===null||$===void 0?void 0:$.length)||1)*this.parsedOptions.rowHeight},M.defaultRowHeight="auto"):this.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(M.customComputeRowHeight=A=>{const{row:$,table:de}=A,te=de.getRecordByRowCol(0,$);if(te)return Kt(this,te)*this.parsedOptions.rowHeight},M.defaultRowHeight="auto"):this.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange?(M.customComputeRowHeight=A=>{const{row:$,table:de}=A,te=de.getRecordByRowCol(0,$);if(te)return Vt(this,te)*this.parsedOptions.rowHeight},M.defaultRowHeight="auto"):M.defaultRowHeight=(We=this.options.rowHeight)!==null&&We!==void 0?We:40,M.clearDOM=!1,M}getElement(){return this.element}getContainer(){return this.element.parentElement}_sortScales(){const{timelineHeader:e}=this.options;if(e){const t=e.scales,i=["year","quarter","month","week","day","hour","minute","second"];t.length===1&&(t[0].unit!=="hour"&&t[0].unit!=="minute"&&t[0].unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0));const s=t.slice().sort((r,o)=>{r.unit!=="hour"&&r.unit!=="minute"&&r.unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0);const l=i.indexOf(r.unit),h=i.indexOf(o.unit);return l===-1?1:h===-1?-1:l-h}),a=t.slice().sort((r,o)=>{const l=i.indexOf(r.unit),h=i.indexOf(o.unit);return l===-1?1:h===-1?-1:h-l});this.parsedOptions.sortedTimelineScales=s,this.parsedOptions.reverseSortedTimelineScales=a}}_generateTimeLineDateMap(){if(this.parsedOptions.minDate&&this.parsedOptions.maxDate)for(const e of this.parsedOptions.reverseSortedTimelineScales)e.timelineDates=Wi(new Date(this.parsedOptions.minDate),this.parsedOptions.maxDate,e)}getRowHeightByIndex(e){return this.taskListTableInstance?this.taskListTableInstance.getRowHeight(e+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight}getRowsHeightByIndex(e,t){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(e+this.taskListTableInstance.columnHeaderLevelCount,t+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight*(t-e+1)}getAllRowsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getAllRowsHeight():this.getAllHeaderRowsHeight()+this.itemCount*this.parsedOptions.rowHeight}getAllHeaderRowsHeight(){return this.parsedOptions.timeLineHeaderRowHeights.reduce((e,t,i)=>this.parsedOptions.sortedTimelineScales[i].visible===!1?e:e+t,0)}getAllDateColsWidth(){var e,t;return this.parsedOptions.timelineColWidth*((t=(e=this.parsedOptions.reverseSortedTimelineScales[0].timelineDates)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)}getAllTaskBarsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(this.taskListTableInstance.columnHeaderLevelCount,this.taskListTableInstance.rowCount-1):this.itemCount*this.parsedOptions.rowHeight}getRecordIndexByTaskShowIndex(e){return this.taskListTableInstance?this.taskListTableInstance.getRecordIndexByCell(0,this.taskListTableInstance.columnHeaderLevelCount+e):e}getTaskShowIndexByRecordIndex(e){return this.taskListTableInstance.getBodyRowIndexByRecordIndex(e)}getRecordByIndex(e,t){var i,s;return G(t)?(s=(i=this.records[e])===null||i===void 0?void 0:i.children)===null||s===void 0?void 0:s[t]:this.taskListTableInstance?this.taskListTableInstance.getRecordByCell(0,e+this.taskListTableInstance.columnHeaderLevelCount):this.records[e]}_refreshTaskBar(e,t){this.scenegraph.taskBar.updateTaskBarNode(e,t),this.scenegraph.refreshRecordLinkNodes(e,void 0,this.scenegraph.taskBar.getTaskBarNodeByIndex(e,t)),this.scenegraph.updateNextFrame()}_updateRecordToListTable(e,t){this.taskListTableInstance.updateRecords([e],[t])}getTaskInfoByTaskListIndex(e,t){const i=this.getRecordByIndex(e,t),s=i==null?void 0:i.type,a=this.parsedOptions.startDateField,r=this.parsedOptions.endDateField,o=this.parsedOptions.progressField,l=j(i==null?void 0:i[a]).getTime(),h=j(i==null?void 0:i[r]).getTime();if(s&&!(i!=null&&i[a])||!s&&(h<this.parsedOptions._minDateTime||l>this.parsedOptions._maxDateTime||!(i!=null&&i[a])||!(i!=null&&i[r])))return{taskDays:0,progress:0,startDate:null,endDate:null,taskRecord:i};const d=Ii(i[o]);let u,p;return this.parsedOptions.timeScaleIncludeHour?(u=j(Math.min(Math.max(this.parsedOptions._minDateTime,l),this.parsedOptions._maxDateTime)),p=Ut(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)):(u=j(Math.min(Math.max(this.parsedOptions._minDateTime,l),this.parsedOptions._maxDateTime),!0),p=ce(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)),{taskRecord:i,taskDays:(p.getTime()-u.getTime()+1)/864e5,startDate:u,endDate:p,progress:d}}_updateStartDateToTaskRecord(e,t,i){var s;const a=this.getRecordByIndex(t,i),r=this.parsedOptions.startDateField,o=(s=this.parsedOptions.dateFormat)!==null&&s!==void 0?s:$e(a[r]),l=re(e,o);if(a[r]=l,!G(i)){const h=this.getRecordIndexByTaskShowIndex(t);this._updateRecordToListTable(a,h)}}_updateEndDateToTaskRecord(e,t,i){var s;const a=this.getRecordByIndex(t,i),r=this.parsedOptions.endDateField,o=(s=this.parsedOptions.dateFormat)!==null&&s!==void 0?s:$e(a[r]),l=re(e,o);if(a[r]=l,!G(i)){const h=this.getRecordIndexByTaskShowIndex(t);this._updateRecordToListTable(a,h)}}_updateStartEndDateToTaskRecord(e,t,i,s){var a;const r=this.getRecordByIndex(i,s),o=this.parsedOptions.startDateField,l=this.parsedOptions.endDateField,h=(a=this.parsedOptions.dateFormat)!==null&&a!==void 0?a:$e(r[o]),d=re(e,h);r[o]=d;const u=re(t,h);if(r[l]=u,!G(s)){const p=this.getRecordIndexByTaskShowIndex(i);this._updateRecordToListTable(r,p)}}_dragOrderTaskRecord(e,t,i,s){this.data.adjustOrder(e,t,i,s)}updateTaskRecord(e,t,i){if(G(i)){const a=typeof t=="number"?t:t[0];return this._updateRecordToListTable(e,[a,i]),void this._refreshTaskBar(a,i)}if(Array.isArray(t)){const a=t[0],r=t[1];return this._updateRecordToListTable(e,G(r)?[a,r]:a),void this._refreshTaskBar(a,r)}const s=t;this._updateRecordToListTable(e,s),this._refreshTaskBar(s,void 0)}setPixelRatio(e){var t;(t=this.taskListTableInstance)===null||t===void 0||t.setPixelRatio(e),this.parsedOptions.pixelRatio=e,this.scenegraph.setPixelRatio(e)}_resize(){var e;this._updateSize(),(e=this.taskListTableInstance)===null||e===void 0||e.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._syncPropsFromTable(),this.scenegraph.resize(),Ze(this)}_syncPropsFromTable(){this.itemCount=this.taskListTableInstance?this.taskListTableInstance.rowCount-this.taskListTableInstance.columnHeaderLevelCount:this.records.length,this.headerHeight=this.getAllHeaderRowsHeight(),this.drawHeight=Math.min(this.getAllRowsHeight(),this.tableNoFrameHeight),this.gridHeight=this.drawHeight-this.headerHeight}getContext(){return this.context}release(){var e,t;(e=super.release)===null||e===void 0||e.call(this),this.eventManager.release(),(t=this.taskListTableInstance)===null||t===void 0||t.release();const{parentElement:i}=this.element;i&&(i.removeChild(this.element),this.verticalSplitResizeLine&&i.removeChild(this.verticalSplitResizeLine),this.horizontalSplitLine&&i.removeChild(this.horizontalSplitLine)),this.scenegraph=null}updateOption(e){var t,i,s,a,r;if(this.parsedOptions={},this.options=e,this.taskTableWidth=typeof((t=e==null?void 0:e.taskListTable)===null||t===void 0?void 0:t.tableWidth)=="number"?(i=e==null?void 0:e.taskListTable)===null||i===void 0?void 0:i.tableWidth:-1,this.taskTableColumns=(a=(s=e==null?void 0:e.taskListTable)===null||s===void 0?void 0:s.columns)!==null&&a!==void 0?a:[],this.records=(r=e==null?void 0:e.records)!==null&&r!==void 0?r:[],this._sortScales(),zt(this),this.data.setRecords(this.records),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.taskListTableInstance){const o=this._generateListTableOptions();this.taskListTableInstance.updateOption(o),this._updateListTableSize(this.taskListTableInstance)}this._syncPropsFromTable(),this.scenegraph.updateStageBackground(),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",Ze(this),this.scenegraph.updateSceneGraph(),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}setRecords(e){this.records=e,this.data.setRecords(e),Ri(this),this.taskListTableInstance.setRecords(e),this._syncPropsFromTable(),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.scenegraph.refreshAll(),this.verticalSplitResizeLine.style.height=this.drawHeight+"px";const t=this.stateManager.scroll.horizontalBarPos,i=this.stateManager.scroll.verticalBarPos;this.scenegraph.setX(-t),this.scenegraph.setY(-i)}updateScales(e){const t=this.parsedOptions.sortedTimelineScales.length;if(this.options.timelineHeader.scales=e,this._sortScales(),Ai(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.scenegraph.refreshAll(),Ze(this),this.taskListTableInstance)if(this.taskListTableInstance.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let i=0;i<this.taskListTableInstance.columnHeaderLevelCount;i++)this.taskListTableInstance.setRowHeight(i,this.parsedOptions.timeLineHeaderRowHeights[i]);else{const i=this.getAllHeaderRowsHeight()/this.taskListTableInstance.columnHeaderLevelCount;for(let s=0;s<this.taskListTableInstance.columnHeaderLevelCount;s++)this.taskListTableInstance.setRowHeight(s,i)}t!==e.length&&this._resize()}updateDateRange(e,t){this.options.minDate=e,this.options.maxDate=t,Pi(this),this._generateTimeLineDateMap(),this._updateSize(),this.scenegraph.refreshAll(),this._scrollToMarkLine()}updateMarkLine(e){this.options.markLine=e,wt(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph()}addMarkLine(e){this.options.markLine=[...this.parsedOptions.markLine,e],wt(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph(),this.scenegraph.updateNextFrame()}updateCurrentMarkLine(e){const t=this.parsedOptions.markLine.findIndex(i=>i.date===e.date);t!==-1&&(this.options.markLine=[...this.parsedOptions.markLine.slice(0,t),Object.assign(Object.assign({},this.options.markLine[t]),e),...this.parsedOptions.markLine.slice(t+1)],wt(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph(),this.scenegraph.updateNextFrame())}_scrollToMarkLine(){if(this.parsedOptions.scrollToMarkLineDate&&this.parsedOptions.minDate){const e=this.parsedOptions.minDate,{unit:t,step:i}=this.parsedOptions.reverseSortedTimelineScales[0],s=E(this.parsedOptions.scrollToMarkLineDate,e,t,i)*this.parsedOptions.timelineColWidth-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(s)}}scrollToMarkLine(e){if(!e||!this.parsedOptions.minDate)return;const t=this.parsedOptions.minDate,{unit:i,step:s}=this.parsedOptions.reverseSortedTimelineScales[0],a=E(e,t,i,s)*this.parsedOptions.timelineColWidth-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(a)}addLink(e){this.parsedOptions.dependencyLinks.push(e),this.scenegraph.dependencyLink.initLinkLine(this.parsedOptions.dependencyLinks.length-1),this.scenegraph.updateNextFrame()}deleteLink(e){if(this.parsedOptions.dependencyLinkDeletable){const t=this.parsedOptions.dependencyLinks.findIndex(i=>i.type===e.type&&i.linkedFromTaskKey===e.linkedFromTaskKey&&i.linkedToTaskKey===e.linkedToTaskKey);if(t!==-1){const i=this.parsedOptions.dependencyLinks[t];this.parsedOptions.dependencyLinks.splice(t,1),this.scenegraph.dependencyLink.deleteLink(i),this.scenegraph.updateNextFrame()}}}get scrollTop(){return this.stateManager.scrollTop}set scrollTop(e){this.stateManager.setScrollTop(e)}get scrollLeft(){return this.stateManager.scrollLeft}set scrollLeft(e){this.stateManager.setScrollLeft(e)}getTaskBarRelativeRect(e){const t=this.scenegraph.taskBar.getTaskBarNodeByIndex(e);return{left:t.attribute.x+this.taskListTableInstance.tableNoFrameWidth+this.taskListTableInstance.tableX+this.tableX-this.scrollLeft,top:t.attribute.y+this.tableY+this.headerHeight-this.scrollTop,width:t.attribute.width,height:t.attribute.height}}getDateColWidth(e){return this.parsedOptions.timelineColWidth}getDateColsWidth(e,t){return(t-e+1)*this.parsedOptions.timelineColWidth}getDateRangeByIndex(e){const t=this.parsedOptions.reverseSortedTimelineScales[0];return e<t.timelineDates.length?{startDate:t.timelineDates[e].startDate,endDate:t.timelineDates[e].endDate}:null}parseTimeFormat(e){return $e(e)}getTaskBarStyle(e,t){if(typeof this.parsedOptions.taskBarStyle=="function"){const{startDate:i,endDate:s,taskRecord:a}=this.getTaskInfoByTaskListIndex(e,t),r={index:e,startDate:i,endDate:s,taskRecord:a,ganttInstance:this};return this.parsedOptions.taskBarStyle(r)}return this.parsedOptions.taskBarStyle}}const es=ni({__name:"vtable",setup(n){const e=si(),t=new jt,i=new wi;It("input",t),It("date-input",i);const s=Ee(),a=Ee(),r=Ee(),o=Ee(),l=Ee(),h=Ee(),u={overscrollBehavior:"none",records:Ti,taskListTable:{columns:[{field:"title",title:"title",width:"auto",sort:!0,tree:!0,editor:"input"},{field:"start",title:"start",width:"auto",sort:!0,editor:"date-input"},{field:"end",title:"end",width:"auto",sort:!0,editor:"date-input"},{field:"priority",title:"priority",width:"auto",sort:!0,editor:"input"},{field:"progress",title:"progress",width:"auto",sort:!0,headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:250,minTableWidth:100,maxTableWidth:600},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#e1e4e8",cornerRadius:8},verticalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},horizontalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},verticalSplitLineMoveable:!0,verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:40,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",moveable:!0,hoverBarStyle:{barOverlayColor:"rgba(99, 144, 0, 0.4)"},labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left",textOverflow:"ellipsis"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:8}},timelineHeader:{colWidth:100,backgroundColor:"#EEF1F5",horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},scales:[{unit:"week",step:1,startOfWeek:"sunday",format(S){return`Week ${S.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom",textStick:!0}},{unit:"day",step:1,format(S){return S.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom"}}]},markLine:[{date:"2024-07-28",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]},content:""},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]},content:""}],rowSeriesNumber:{title:"行号",dragOrder:!0},scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"scrolling",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}},c={records:xi,taskListTable:{columns:[{field:"title",title:"title",width:"auto",tree:!0},{field:"start",title:"start",width:"auto",editor:"date-input"},{field:"end",title:"end",width:"auto",editor:"date-input"},{field:"priority",title:"priority",width:"auto",editor:"input"},{field:"progress",title:"progress",width:"auto",headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:400,minTableWidth:100,maxTableWidth:600},dependency:{links:[{type:U.FinishToStart,linkedFromTaskKey:1,linkedToTaskKey:2},{type:U.StartToFinish,linkedFromTaskKey:2,linkedToTaskKey:3},{type:U.StartToStart,linkedFromTaskKey:3,linkedToTaskKey:4},{type:U.FinishToFinish,linkedFromTaskKey:4,linkedToTaskKey:5}],linkSelectedLineStyle:{shadowBlur:5,shadowColor:"red",lineColor:"red",lineWidth:1}},frame:{verticalSplitLineMoveable:!0,outerFrameStyle:{borderLineWidth:2,cornerRadius:8},verticalSplitLine:{lineWidth:3,lineColor:"#e1e4e8"},verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:60,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:10},selectedBarStyle:{shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black",borderColor:"red",borderLineWidth:1}},timelineHeader:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},backgroundColor:"#EEF1F5",colWidth:60,scales:[{unit:"week",step:1,startOfWeek:"sunday",format(S){return`Week ${S.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"red"}},{unit:"day",step:1,format(S){return S.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"red"}}]},minDate:"2024-07-14",maxDate:"2024-10-15",rowSeriesNumber:{title:"Row number",dragOrder:!0},scrollStyle:{visible:"scrolling"},overscrollBehavior:"none"},g=["#aecde6","#c6a49a","#ffb582","#eec1de","#b3d9b3","#cccccc","#e59a9c","#d9d1a5","#c9bede"],_=["#1f77b4","#8c564b","#ff7f0e","#e377c2","#2ca02c","#7f7f7f","#d62728","#bcbd22","#9467bd"],k={records:Bi,taskListTable:{columns:[{field:"title",title:"TASK",width:"200",headerStyle:{textAlign:"center",fontSize:20,fontWeight:"bold"},style:{},customLayout:S=>{const{table:v,row:x,col:C,rect:w}=S,O=v.getCellOriginRecord(C,x),{height:B,width:D}=w??v.getCellRect(C,x),H=new W({y:10,x:20,height:B-20,width:D-40,fill:"#ddd",display:"flex",flexDirection:"column",cornerRadius:30}),N=new he({text:O.developer,fontSize:16,fontFamily:"sans-serif",fill:_[S.row],fontWeight:"bold",maxLineWidth:D-120,boundsPadding:[10,0,0,0],alignSelf:"center"});H.add(N);const X=new he({text:`${re(new Date(O.start),"mm/dd")}-${re(new Date(O.end),"mm/dd")}`,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"black",boundsPadding:[10,0,0,0],alignSelf:"center"});return H.add(X),{rootContainer:H,expectedWidth:160}}}],tableWidth:"auto"},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#E1E4E8",cornerRadius:8}},grid:{horizontalLine:{lineWidth:2,lineColor:"#d5d9ee"}},headerRowHeight:60,rowHeight:80,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",barStyle:{width:60},customLayout:S=>{const v=_.length,{width:x,height:C,index:w,taskDays:O,progress:B,taskRecord:D}=S,H=new W({width:x,height:C,cornerRadius:30,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{offset:0,color:g[w%v]},{offset:.5,color:_[w%v]},{offset:1,color:g[w%v]}]},display:"flex",flexDirection:"row",flexWrap:"nowrap"}),N=new W({height:C,width:60,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});H.add(N);const X=new Ve({width:50,height:50,image:D.avatar,cornerRadius:25});N.add(X);const P=new W({height:C,width:x-120,display:"flex",flexDirection:"column"});H.add(P);const z=new he({text:D.developer,fontSize:16,fontFamily:"sans-serif",fill:"white",fontWeight:"bold",maxLineWidth:x-120,boundsPadding:[10,0,0,0]});P.add(z);const Y=new he({text:`${O} days`,fontSize:13,fontFamily:"sans-serif",fill:"white",boundsPadding:[10,0,0,0]});if(P.add(Y),x>=120){const K=new W({cornerRadius:20,fill:"white",height:40,width:40,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boundsPadding:[10,0,0,0]});H.add(K);const V=new he({text:`${B}%`,fontSize:12,fontFamily:"sans-serif",fill:"black",alignSelf:"center",fontWeight:"bold",maxLineWidth:(x-60)/2,boundsPadding:[0,0,0,0]});K.add(V)}return{rootContainer:H}},hoverBarStyle:{cornerRadius:30}},timelineHeader:{backgroundColor:"#f0f0fb",colWidth:80,scales:[{unit:"day",step:1,format(S){return S.dateIndex.toString()},customLayout:S=>{const{width:v,height:x,startDate:C,dateIndex:w}=S,O=new W({width:v,height:x,display:"flex",flexDirection:"row",flexWrap:"nowrap"}),B=new W({height:x,width:30,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});O.add(B);const D=new Ve({width:20,height:30,image:'<svg t="1724675965803" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4299" width="200" height="200"><path d="M53.085678 141.319468C23.790257 141.319468 0 165.035326 0 194.34775L0 918.084273C0 947.295126 23.796789 971.112572 53.085678 971.112572L970.914322 971.112572C1000.209743 971.112572 1024 947.396696 1024 918.084273L1024 194.34775C1024 165.136896 1000.203211 141.319468 970.914322 141.319468L776.827586 141.319468 812.137931 176.629813 812.137931 88.275862C812.137931 68.774506 796.328942 52.965517 776.827586 52.965517 757.32623 52.965517 741.517241 68.774506 741.517241 88.275862L741.517241 176.629813 741.517241 211.940158 776.827586 211.940158 970.914322 211.940158C961.186763 211.940158 953.37931 204.125926 953.37931 194.34775L953.37931 918.084273C953.37931 908.344373 961.25643 900.491882 970.914322 900.491882L53.085678 900.491882C62.813237 900.491882 70.62069 908.306097 70.62069 918.084273L70.62069 194.34775C70.62069 204.087649 62.74357 211.940158 53.085678 211.940158L247.172414 211.940158C266.67377 211.940158 282.482759 196.131169 282.482759 176.629813 282.482759 157.128439 266.67377 141.319468 247.172414 141.319468L53.085678 141.319468ZM211.862069 176.629813C211.862069 196.131169 227.671058 211.940158 247.172414 211.940158 266.67377 211.940158 282.482759 196.131169 282.482759 176.629813L282.482759 88.275862C282.482759 68.774506 266.67377 52.965517 247.172414 52.965517 227.671058 52.965517 211.862069 68.774506 211.862069 88.275862L211.862069 176.629813ZM1024 353.181537 1024 317.871192 988.689655 317.871192 35.310345 317.871192 0 317.871192 0 353.181537 0 441.457399C0 460.958755 15.808989 476.767744 35.310345 476.767744 54.811701 476.767744 70.62069 460.958755 70.62069 441.457399L70.62069 353.181537 35.310345 388.491882 988.689655 388.491882 953.37931 353.181537 953.37931 441.457399C953.37931 460.958755 969.188299 476.767744 988.689655 476.767744 1008.191011 476.767744 1024 460.958755 1024 441.457399L1024 353.181537ZM776.937913 582.62069C796.439287 582.62069 812.248258 566.811701 812.248258 547.310345 812.248258 527.808989 796.439287 512 776.937913 512L247.172414 512C227.671058 512 211.862069 527.808989 211.862069 547.310345 211.862069 566.811701 227.671058 582.62069 247.172414 582.62069L776.937913 582.62069ZM247.172414 688.551724C227.671058 688.551724 211.862069 704.360713 211.862069 723.862069 211.862069 743.363425 227.671058 759.172414 247.172414 759.172414L600.386189 759.172414C619.887563 759.172414 635.696534 743.363425 635.696534 723.862069 635.696534 704.360713 619.887563 688.551724 600.386189 688.551724L247.172414 688.551724ZM776.827586 211.940158 741.517241 176.629813 741.517241 247.328574C741.517241 266.829948 757.32623 282.638919 776.827586 282.638919 796.328942 282.638919 812.137931 266.829948 812.137931 247.328574L812.137931 176.629813 812.137931 141.319468 776.827586 141.319468 247.172414 141.319468C227.671058 141.319468 211.862069 157.128439 211.862069 176.629813 211.862069 196.131169 227.671058 211.940158 247.172414 211.940158L776.827586 211.940158ZM282.482759 176.629813C282.482759 157.128439 266.67377 141.319468 247.172414 141.319468 227.671058 141.319468 211.862069 157.128439 211.862069 176.629813L211.862069 247.328574C211.862069 266.829948 227.671058 282.638919 247.172414 282.638919 266.67377 282.638919 282.482759 266.829948 282.482759 247.328574L282.482759 176.629813Z" fill="#389BFF" p-id="4300"></path></svg>'});B.add(D);const H=new W({height:x,width:v-30,display:"flex",flexDirection:"column"});O.add(H);const N=new he({text:String(w).padStart(2,"0"),fontSize:20,fontWeight:"bold",fontFamily:"sans-serif",fill:"#777",textAlign:"right",maxLineWidth:v-30,boundsPadding:[15,0,0,0]});H.add(N);const X=new he({text:Vi(C,"short").toLocaleUpperCase(),fontSize:12,fontFamily:"sans-serif",fill:"#777",boundsPadding:[0,0,0,0]});return H.add(X),{rootContainer:O}}}]},minDate:"2024-07-20",maxDate:"2024-08-15",markLine:[{date:"2024-07-29",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]},content:""},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]},content:""}],scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"focus",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}};function f(){o.value=new Ct(s.value,b(u)),l.value=new Ct(a.value,b(c)),h.value=new Ct(r.value,b(k))}function b(S){return e.darkMode?(S.taskListTable.theme=Li,S.timelineHeader.backgroundColor="#212121",S.underlayBackgroundColor="#000"):(S.taskListTable.theme=Xe,S.timelineHeader.backgroundColor="#f0f0fb",S.underlayBackgroundColor="#fff"),S}const L=ai(()=>e.darkMode,S=>{var v,x,C;(v=o.value)==null||v.release(),(x=l.value)==null||x.release(),(C=h.value)==null||C.release(),f()});return ri(()=>{f()}),li(()=>{L()}),(S,v)=>{const x=ii,C=di,w=vi;return hi(),oi(w,{vertical:"",size:16},{default:Ge(()=>[je(C,{bordered:!1,title:"VTableGantt",class:"h-full card-wrapper"},{default:Ge(()=>[je(x,{label:"More Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1}),je(C,{bordered:!1,class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"basicGanttDomRef",ref:s,class:"relative h-400px"},null,512)]),_:1}),je(C,{bordered:!1,class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"linkGanttDomRef",ref:a,class:"relative h-400px"},null,512)]),_:1}),je(C,{bordered:!1,class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"customGanttDomRef",ref:r,class:"relative h-400px"},null,512)]),_:1})]),_:1})}}});export{es as default};
